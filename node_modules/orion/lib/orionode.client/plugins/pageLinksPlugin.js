!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=i.shift();)e();s=!1}function t(e){i.push(e),s||(s=!0,a())}function r(e){return function(t){e(t)}}function n(e,t,n){try{var o=e(t),i=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof i)if(o===n.promise)n.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?n._parentCancel=s.bind(o):delete n._parentCancel,i.call(o,r(n.resolve),r(n.reject),r(n.progress))}else n.resolve(o)}catch(a){n.reject(a)}}function o(){function e(){for(var e;e=l.shift();){var t=e.deferred,r="fulfilled"===u?"resolve":"reject",o=e[r];"function"==typeof o?n(o,a,t):t[r](a)}}function r(r){delete c._parentCancel,u="rejected",a=r,l.length&&t(e)}function i(n){function s(e){return function(t){u&&"assumed"!==u||e(t)}}delete c._parentCancel;try{var f=n&&("object"==typeof n||"function"==typeof n)&&n.then;if("function"==typeof f)if(n===c)r(new TypeError);else{u="assumed";var p=n&&n.cancel;if("function"!=typeof p){var h=new o;n=h.promise;try{f(h.resolve,h.reject,h.progress)}catch(d){h.reject(d)}p=n.cancel,f=n.then}a=n,f.call(n,s(i),s(r)),c._parentCancel=p.bind(n)}else u="fulfilled",a=n,l.length&&t(e)}catch(m){s(r)(m)}}function s(){var e=c._parentCancel;if(e)delete c._parentCancel,e();else if(!u){var t=new Error("Cancel");t.name="Cancel",r(t)}}var a,u,l=[],c=this;this.resolve=function(e){return u||i(e),c},this.reject=function(e){return u||r(e),c},this.progress=function(e){return u||l.forEach(function(t){if(t.progress)try{t.progress(e)}catch(r){}}),c.promise},this.cancel=function(){return c._parentCancel?setTimeout(s,0):s(),c},this.then=function(r,n,i){var s=new o;return s._parentCancel=c.promise.cancel,l.push({resolve:r,reject:n,progress:i,deferred:s}),("fulfilled"===u||"rejected"===u)&&t(e),s.promise},this.promise={then:c.then,cancel:c.cancel}}var i=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var r=document.createElement("div"),n=new MutationObserver(e);return n.observe(r,{attributes:!0}),function(){r.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function r(e,t){a||(s[e]=t,0===--i&&u.resolve(s))}function n(e,n){if(!a){if(t)try{return void r(e,t(n))}catch(o){n=o}u.reject(n)}}var i=e.length,s=[],a=!1,u=new o;return u.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?u.resolve(s):e.forEach(function(e,t){e.then(r.bind(void 0,t),n.bind(void 0,t))}),u.promise},o.when=function(e,t,r,n){var i,s;return e&&"function"==typeof e.then?i=e:(s=new o,s.resolve(e),i=s.promise),i.then(t,r,n)},o}),define("orion/PageUtil",[],function(){function e(){var e=window.location.href.split("#")[1];return e=e?"#"+e:""}function t(e){e=e||window.location.toString();var t={resource:""},r=e.indexOf("#");if(-1!==r){var n=e.substring(r+1);if(0!==n.length){var o=n.split(",");t.resource=decodeURIComponent(o[0]);for(var i=1;i<o.length;i++){var s=o[i],a=/([^=]*)(=?)(.*)/.exec(s),u=decodeURIComponent(a[1]||""),l=decodeURIComponent(a[3]||"");""!==u&&"resource"!==u&&(t[u]=l)}}}return t}function r(e,t){var r=e;if(-1===e.indexOf("://")){var o=document.createElement("a");o.href=e,r=o.href}var i=!1;return i=t?t.some(function(e){return new RegExp("^"+e+":","i").test(r)}):n.test(r),i?e:(console.log("Illegal URL Scheme: '"+e+"'"),"")}var n=new RegExp("^http[s]?","i");return{hash:e,matchResourceParameters:t,validateURLScheme:r}}),define("orion/URITemplate",[],function(){function e(e){this._text=e}function t(e){return e.replace("%25","%")}function r(e,r){if("U"===r)return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()});if("U+R"===r)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(f,t);if("U+R-,"===r)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw new Error("Unknown allowed character set: "+r)}function n(e,t,n){for(var o=[],i=0;i<e.length;i++)"undefined"!=typeof e[i]&&o.push(r(e[i],t));return o.join(n)}function o(e,t,n,o){for(var i=Object.keys(e),s=[],a=0;a<i.length;a++)"undefined"!=typeof e[i[a]]&&s.push(r(i[a],t)+n+r(e[i[a]],t));return s.join(o)}function i(e){for(var t=[],r=e.split(","),n=0;n<r.length;n++){var o=r[n].match(c);if(null===o)throw new Error("Bad VarSpec: "+e);t.push({name:o[1],explode:!!o[2],prefix:o[3]?parseInt(o[3],10):-1})}return t}function s(e){if(0===e.length)throw new Error("Invalid Expression: 0 length expression");this._operator=l[e[0]],this._operator?e=e.substring(1):this._operator=l.NUL,this._varSpecList=i(e)}function a(t){for(var r=[],n=0,o=t.indexOf("{",n);-1!==o;){r.push(new e(t.substring(n,o)));var i=t.indexOf("}",o+1);if(-1===i)throw new Error("Invalid template: "+t);r.push(new s(t.substring(o+1,i))),n=i+1,o=t.indexOf("{",n)}return r.push(new e(t.substring(n))),r}function u(e){this._templateComponents=a(e)}var l={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"&",named:!0,ifemp:"=",allow:"U"},"&":{first:"&",sep:"&",named:!0,ifemp:"=",allow:"U"},"#":{first:"#",sep:",",named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},c=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,f=/%25[0-9A-F][0-9A-F]/g;return e.prototype={expand:function(){return encodeURI(this._text)}},s.prototype={expand:function(e){for(var t=[],i=0;i<this._varSpecList.length;i++){var s=this._varSpecList[i],a=s.name,u=e[a],l=typeof u;if("undefined"!==l&&null!==u){var c=0===t.length?this._operator.first:this._operator.sep;if("string"===l)this._operator.named&&(c+=r(a,"U+R"),c+=0===u.length?this._operator.ifemp:"="),-1!==s.prefix&&s.prefix<u.length&&(u=u.substring(0,s.prefix)),c+=r(u,this._operator.allow);else if(Array.isArray(u)){if(0===u.length)continue;if(s.explode)c+=n(u,this._operator.allow,this._operator.sep);else{var f=n(u,this._operator.allow,",");this._operator.named&&(c+=r(a,"U+R"),c+=0===f.length?this._operator.ifemp:"="),c+=f}}else{if("object"!==l)throw new Error("bad param type: "+a+" : "+l);if(0===Object.keys(u).length)continue;if(s.explode)c+=o(u,this._operator.allow,"=",this._operator.sep);else{var p=o(u,this._operator.allow,",",",");this._operator.named&&(c+=r(a,"U+R"),c+=0===p.length?this._operator.ifemp:"="),c+=p}}t.push(c)}}return t.join("")}},u.prototype={expand:function(e){for(var t=[],r=0;r<this._templateComponents.length;r++)t.push(this._templateComponents[r].expand(e));return t.join("")}},u}),define("orion/i18nUtil",["require","orion/Deferred"],function(e,t){function r(e){var t=/\$\{([^\}]+)\}/g,r=arguments;return 2===r.length&&r[1]&&"object"==typeof r[1]?e.replace(t,function(e,t){return r[1][t]}):e.replace(t,function(e,t){return r[(t<<0)+1]})}function n(e){var t=localStorage.getItem("orion/messageBundle/"+e);if(t){var r=JSON.parse(t);if(r._expires&&r._expires>(new Date).getTime())return delete r._expires,r}return null}function o(e,t){t._expires=(new Date).getTime()+9e5,localStorage.setItem("orion/messageBundle/"+e,JSON.stringify(t)),delete t._expires}function i(r){function i(t,n,o){e(t,function(e){"undefined"==typeof e?o(new Error(r)):n.apply(null,Array.prototype.slice.call(arguments))},o)}function a(){e(["i18n!"+r],function(e){e&&o(r,e),l.resolve(e)})}function u(e){l.reject(e)}if(s[r])return s[r];var l=new t;s[r]=l;var c=n(r);if(c)return l.resolve(c),l;try{i([r],a,function(){requirejs.undef(r),i(["orion/i18n!"+r],a,u)})}catch(f){i(["orion/i18n!"+r],a,u)}return l}var s={};return{getMessageBundle:i,formatMessage:r}}),define("orion/objects",[],function(){function e(e){for(var t=Object.prototype.hasOwnProperty,r=1,n=arguments.length;n>r;r++){var o=arguments[r];for(var i in o)t.call(o,i)&&(e[i]=o[i])}return e}return{clone:function(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var r=Object.create(Object.getPrototypeOf(t));return e(r,t),r},mixin:e,toArray:function(e){return Array.isArray(e)?e:[e]}}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function r(e){return 0===e.length?"":e.join("&")}function n(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),r=t[1]?decodeURIComponent(t[1]):"",n=t[2]?decodeURIComponent(t[2]):"";return[r,n]}function o(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function i(e,r){var o="",i=[],s=0;return{next:function(){if(o!==e.query&&(o=e.query,i=t(o)),s<i.length){var a=n(i[s++]);switch(r){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw S}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var r=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=r+e.path}}else e.path=t.path}function u(e){return e.toLowerCase()}function l(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function c(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function f(e){e.scheme&&(e.scheme=u(e.scheme)),e.port&&(e.port=l(e.port)),e.host&&e.path&&(e.path=c(e.path))}function p(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function h(e,t){if("string"!=typeof e)throw new TypeError;e=p(e);var r=y.exec(e);if(!r)return null;var n={};if(n.scheme=r[1]||"",n.scheme&&!b.test(n.scheme))return null;var o=r[2];if(o){var i=_.exec(o);if(n.userinfo=i[1],n.host=i[2],n.port=i[3],n.port&&!x.test(n.port))return null}return n.path=r[3],n.query=r[4],n.fragment=r[5],a(n,t),f(n),n}function d(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function m(e,t){var r;if(t){if(t=t.href||t,r=h(t),!r||!r.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:r})}var n=h(e,r);if(!n)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:n,writable:!0});var o=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?o:null},enumerable:!0})}try{var g;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(g=new window.URL("http://www.w3.org?q")).protocol&&g.query)return}catch(v){}var y=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,_=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,w=/^\S*$/,b=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,x=/^\d*$/,j=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,U=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,R=/^([^?#\s]*)$/,L=/^([^\s]*)$/,E=w,O=/([^:]*):?(.*)/,S="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),C={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(r){e(r);var o,i=t(this._url.query);return i.some(function(e){var t=n(e);return t[0]===r?(o=t[1],!0):void 0}),o},enumerable:!0},set:{value:function(i,s){e(i),e(s);var a=t(this._url.query),u=a.some(function(e,t){var r=n(e);return r[0]===i?(r[1]=s,a[t]=o(r),!0):void 0});u||a.push(o([i,s])),this._url.query=r(a)},enumerable:!0},has:{value:function(r){e(r);var o=t(this._url.query);return o.some(function(e){var t=n(e);return t[0]===r?!0:void 0})},enumerable:!0},"delete":{value:function(o){e(o);var i=t(this._url.query),s=i.filter(function(e){var t=n(e);return t[0]!==o});return s.length!==i.length?(this._url.query=r(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var r=i(this._url,"keys+values");try{for(;;){var n=r.next();e.call(t,n[1],n[0],this)}}catch(o){if(o!==S)throw o}},enumerable:!0},keys:{value:function(){return i(this._url,"keys")},enumerable:!0},values:{value:function(){return i(this._url,"values")},enumerable:!0},items:{value:function(){return i(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(r){e(r);var o=[],i=t(this._url.query);return i.forEach(function(e){var t=n(e);t[0]===r&&o.push(t[1])}),o},enumerable:!0},append:{value:function(n,i){e(n),e(i);var s=t(this._url.query);s.push(o([n,i])),this._url.query=r(s)},enumerable:!0}}),Object.defineProperties(m.prototype,{href:{get:function(){return this._url?d(this._url):this._input},set:function(t){e(t),this._input=t,this._url=h(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var r=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===r||b.test(r))&&(this._url.scheme=u(r))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=O.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var r=O.exec(this._userinfo),n=[encodeURIComponent(t||"")];r[2]&&n.push(r[2]),this._userinfo=n.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=O.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var r=O.exec(this._userinfo),n=[r[1]||""];t&&n.push(encodeURIComponent(t)),this._userinfo=n.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var r=U.exec(t);r&&(this._url.host=r[1],this._url.port=l(r[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var r=j.exec(t);r&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===C[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var r=x.exec(t);r&&(this._url.port=l(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var r=R.exec(t);r&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?c(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var r=L.exec(t);r&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var r=E.exec(t);r&&(this._url.fragment=t)}},enumerable:!0}});var I=window.URL||window.webkitURL;I&&I.createObjectURL&&(Object.defineProperty(m,"createObjectURL",{value:I.createObjectURL.bind(I),enumerable:!1}),Object.defineProperty(m,"revokeObjectURL",{value:I.revokeObjectURL.bind(I),enumerable:!1})),window.URL=m}(),define("orion/URL-shim",function(){}),define("orion/PageLinks",["require","orion/Deferred","orion/PageUtil","orion/URITemplate","orion/i18nUtil","orion/objects","orion/URL-shim"],function(e,t,r,n,o,i){function s(){return e.toUrl?new URL(e.toUrl("orion/../"),window.location.href).href.slice(0,-1):new URL("/",window.location.href).href.slice(0,-1)}function a(e,t){return c(e,t).then(function(e){return new h(e)})}function u(e){var t={};return e.getPropertyKeys().forEach(function(r){"objectClass"!==r&&"service.names"!==r&&"service.id"!==r&&"__plugin__"!==r&&(t[r]=e.getProperty(r))}),t}function l(e){return o.getMessageBundle(e.nls).then(function(t){return e.textContent=e.nameKey?t[e.nameKey]:e.name,e},function(){return e.textContent=e.nameKey||e.name,e})}function c(e,o){o=o||"orion.page.link";var i=e.getServiceReferences(o),a=r.matchResourceParameters(window.location.href),c=s(),f={OrionHome:c,Location:a.resource},p=[];return i.forEach(function(e){var o=u(e);if(o.uriTemplate&&(o.nls||o.name)){var i=new n(o.uriTemplate),s=i.expand(f);s=r.validateURLScheme(s),o.href=s,o.nls?p.push(l(o)):(o.textContent=o.name,p.push((new t).resolve(o)))}}),t.all(p)}function f(e){var r;if(!g){r=[];var n=e.getServiceReferences("orion.page.link.category");return n.forEach(function(n){var o=u(n);o.id&&(o.name||o.nameKey)&&(o.service=e.getService(n),o.nls?r.push(l(o)):(o.textContent=o.name,r.push((new t).resolve(o))))}),t.all(r).then(function(e){return g=new p(e)})}return(new t).resolve(g)}function p(e){var t=this.categories=Object.create(null);e.forEach(function(e){t[e.id]=e})}function h(e){this.allPageLinks=e,this.allPageLinks.sort(d)}function d(e,t){var r=e.textContent&&e.textContent.toLowerCase(),n=t.textContent&&t.textContent.toLowerCase();return n>r?-1:r>n?1:0}function m(e,t,r){var n=document.createElement("a");return n.href=e,n.target=t,n.classList.add("targetSelector"),n.textContent=r,n}var g;return i.mixin(p.prototype,{getCategoryIDs:function(){return Object.keys(this.categories)},getCategory:function(e){return this.categories[e]||null}}),i.mixin(h.prototype,{createLinkElements:function(){return this.allPageLinks.map(function(e){return m(e.href,"_self",e.textContent)})},getAllLinks:function(){return this.allPageLinks}}),{getCategoriesInfo:f,getPageLinksInfo:a,getOrionHome:s}}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function r(r){function n(e){h&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),h===self?h.postMessage(e):h.postMessage(e,"*"))}function o(){var e=[];return Object.keys(w).forEach(function(t){var r=w[t];e.push({serviceId:t,names:r.names,methods:r.methods,properties:r.properties})}),{headers:f||{},services:e}}function i(e,t){if(t&&t instanceof XMLHttpRequest){var r,n;try{r=t.status,n=t.statusText}catch(o){r=0,n=""}return{status:r||0,statusText:n}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,i)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(r){if(!h)return(new e).reject(new Error("plugin not connected"));r.id=String(d++);var n=new e;y[r.id]=n,n.then(null,function(e){p&&e instanceof Error&&"Cancel"===e.name&&b({requestId:r.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return r.params.forEach(function(e,i){if("[object Object]"===o.call(e)&&!(e instanceof t)){var s,a;for(s in e)"[object Function]"===o.call(e[s])&&(a=a||[],a.push(s));if(a){var u=m++;_[u]=e;var l=function(){delete _[u]};n.then(l,l),r.params[i]=new t(u,a)}}}),b(r),n.promise}function u(e,t){e||0===e?b({id:e,result:null,error:t}):console.log(t)}function l(e,t,r,n){n.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var r={};e.__methods.forEach(function(t){r[t]=function(){return a({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),n[t]=r}});var o=void 0===typeof e?null:{id:e,result:null,error:null};try{var i=r.apply(t,n);if(!o)return;i&&"function"==typeof i.then?(v[e]=i,i.then(function(t){delete v[e],o.result=t,b(o)},function(t){v[e]&&(delete v[e],o.error=s(t),b(o))},function(){b({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=i,b(o))}catch(u){o&&(o.error=s(u),b(o))}}function c(e){if(e.source===h||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var r=t.method,n=t.params||[];if("serviceId"in t){var o=w[t.serviceId];o||u(t.id,"service not found"),o=o.implementation,r in o?l(t.id,o,o[r],n):u(t.id,"method not found")}else if("objectId"in t){var i=_[t.objectId];i||u(t.id,"object not found"),!r in i?l(t.id,i,i[r],n):u(t.id,"method not found")}else if("requestId"in t){var s=v[t.requestId];s&&"cancel"===r&&s.cancel&&s.cancel.apply(s,n)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var a=y[t.responseId];a&&"progress"===r&&a.progress&&a.progress.apply(a,n)}}else{var c=y[String(t.id)];delete y[String(t.id)],t.error?c.reject(t.error):c.resolve(t.result)}}catch(f){console.log("Plugin._messageHandler "+f)}}}var f=r,p=!1,h=null,d=0,m=0,g=0,v={},y={},_={},w={},b=n;this.updateHeaders=function(e){if(p)throw new Error("Cannot update headers. Plugin Provider is connected");f=e},this.registerService=function(e,t,r){if(p)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var n=null,o=[];for(n in t)"function"==typeof t[n]&&o.push(n);w[g++]={names:e,methods:o,implementation:t,properties:r||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(p)return void(e&&e());if("undefined"==typeof window)h=self;else if(window!==window.parent)h=window.parent;else{if(null===window.opener)return void(t&&t("No valid plugin target"));h=window.opener}addEventListener("message",c,!1);var r={method:"plugin",params:[o()]};n(r),p=!0,e&&e()},this.disconnect=function(){p&&(removeEventListener("message",c),h=null,p=!1)}}return r}),define("plugins/pageLinksPlugin",["orion/PageLinks","orion/plugin","orion/URITemplate"],function(e,t,r){var n={},o={name:"Orion Page Links",version:"1.0",description:"This plugin provides the top-level page links for Orion."},i=new t(o);i.registerService("orion.page.link.category",null,{id:"edit",nameKey:"Editor",nls:"orion/nls/messages",imageClass:"core-sprite-edit",order:10}),i.registerService("orion.page.link.category",null,{id:"shell",nameKey:"Shell",nls:"orion/nls/messages",imageClass:"core-sprite-shell",order:40}),i.registerService("orion.page.link.category",null,{id:"settings",nameKey:"Settings",nls:"orion/widgets/nls/messages",imageClass:"core-sprite-gear",order:60}),i.registerService("orion.page.link",null,{nameKey:"EditorLinkWorkspace",nls:"orion/nls/messages",tooltip:"Edit code",category:"edit",order:1e3,uriTemplate:"{+OrionHome}/edit/edit.html"}),i.registerService("orion.page.link",n,{nameKey:"ShellLinkWorkspace",id:"orion.shell",nls:"orion/nls/messages",category:"shell",order:1e3,uriTemplate:"{+OrionHome}/shell/shellPage.html"}),i.registerService("orion.page.link",null,{nameKey:"Settings",id:"orion.settings",nls:"orion/widgets/nls/messages",category:"settings",order:1e3,uriTemplate:"{+OrionHome}/settings/settings.html"}),i.registerService("orion.page.link.related",null,{id:"orion.editFromMetadata",nameKey:"EditorRelatedLink",nls:"orion/nls/messages",tooltip:"Open Editor page",category:"edit",order:1,validationProperties:[{source:"ChildrenLocation|ContentLocation",variableName:"EditorLocation",replacements:[{pattern:"\\?depth=1$",replacement:""}]}],uriTemplate:"{+OrionHome}/edit/edit.html#{,EditorLocation}"}),i.registerService("orion.page.link.related",null,{id:"orion.editParent",nameKey:"EditorRelatedLinkParent",nls:"orion/nls/messages",category:"edit",order:3,validationProperties:[{source:"Parents[0]:Location",variableName:"EditorLocation",replacements:[{pattern:"\\?depth=1$",replacement:""}]}],uriTemplate:"{+OrionHome}/edit/edit.html#{,EditorLocation}"}),i.registerService("orion.page.link.related",null,{id:"orion.editProjectRoot",nameKey:"EditorRelatedLinkProj",nls:"orion/nls/messages",category:"edit",order:5,validationProperties:[{source:"Parents[-1]:Location",variableName:"EditorLocation",replacements:[{pattern:"\\?depth=1$",replacement:""}]}],uriTemplate:"{+OrionHome}/edit/edit.html#{,EditorLocation}"}),i.registerService("orion.page.link.user",null,{id:"orion.help",nameKey:"Help",nls:"orion/widgets/nls/messages",uriTemplate:"{+OrionHome}/help/help.html",category:"user.0"}),i.registerService("orion.page.link.user",null,{id:"orion.report.bug",nameKey:"Report a Bug",nls:"orion/widgets/nls/messages",uriTemplate:"https://bugs.eclipse.org/bugs/enter_bug.cgi?product=Orion&component=Client&version=5.0",category:"user.0"});var s=document.createElement("a");s.href="./contentTemplates/helloWorld.zip";var a=document.createElement("a");a.href="./contentTemplates/pluginHelloWorld.zip",i.registerService("orion.core.content",null,{id:"orion.content.html5",nameKey:"Sample HTML5 Site",nls:"orion/nls/messages",descriptionKey:"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.",contentURITemplate:s.href}),i.registerService("orion.core.content",null,{id:"orion.content.plugin",nameKey:"Sample Orion Plugin",nls:"orion/nls/messages",descriptionKey:"Generate a sample plugin for integrating with Orion.",contentURITemplate:a.href});var u="http://orion-plugins.googlecode.com/git/index.html#?target={InstallTarget}&version={Version}&OrionHome={OrionHome}";i.registerService("orion.core.getplugins",null,{uri:decodeURIComponent(new r(u).expand({Version:"5.0",InstallTarget:e.getOrionHome()+"/settings/settings.html",OrionHome:e.getOrionHome()}))}),i.connect()});