!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=o.shift();)e();s=!1}function t(e){o.push(e),s||(s=!0,u())}function r(e){return function(t){e(t)}}function n(e,t,n){try{var i=e(t),o=i&&("object"==typeof i||"function"==typeof i)&&i.then;if("function"==typeof o)if(i===n.promise)n.reject(new TypeError);else{var s=i.cancel;"function"==typeof s?n._parentCancel=s.bind(i):delete n._parentCancel,o.call(i,r(n.resolve),r(n.reject),r(n.progress))}else n.resolve(i)}catch(u){n.reject(u)}}function i(){function e(){for(var e;e=c.shift();){var t=e.deferred,r="fulfilled"===a?"resolve":"reject",i=e[r];"function"==typeof i?n(i,u,t):t[r](u)}}function r(r){delete l._parentCancel,a="rejected",u=r,c.length&&t(e)}function o(n){function s(e){return function(t){a&&"assumed"!==a||e(t)}}delete l._parentCancel;try{var f=n&&("object"==typeof n||"function"==typeof n)&&n.then;if("function"==typeof f)if(n===l)r(new TypeError);else{a="assumed";var p=n&&n.cancel;if("function"!=typeof p){var h=new i;n=h.promise;try{f(h.resolve,h.reject,h.progress)}catch(d){h.reject(d)}p=n.cancel,f=n.then}u=n,f.call(n,s(o),s(r)),l._parentCancel=p.bind(n)}else a="fulfilled",u=n,c.length&&t(e)}catch(g){s(r)(g)}}function s(){var e=l._parentCancel;if(e)delete l._parentCancel,e();else if(!a){var t=new Error("Cancel");t.name="Cancel",r(t)}}var u,a,c=[],l=this;this.resolve=function(e){return a||o(e),l},this.reject=function(e){return a||r(e),l},this.progress=function(e){return a||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(r){}}),l.promise},this.cancel=function(){return l._parentCancel?setTimeout(s,0):s(),l},this.then=function(r,n,o){var s=new i;return s._parentCancel=l.promise.cancel,c.push({resolve:r,reject:n,progress:o,deferred:s}),("fulfilled"===a||"rejected"===a)&&t(e),s.promise},this.promise={then:l.then,cancel:l.cancel}}var o=[],s=!1,u=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var r=document.createElement("div"),n=new MutationObserver(e);return n.observe(r,{attributes:!0}),function(){r.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return i.all=function(e,t){function r(e,t){u||(s[e]=t,0===--o&&a.resolve(s))}function n(e,n){if(!u){if(t)try{return void r(e,t(n))}catch(i){n=i}a.reject(n)}}var o=e.length,s=[],u=!1,a=new i;return a.then(void 0,function(){u=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===o?a.resolve(s):e.forEach(function(e,t){e.then(r.bind(void 0,t),n.bind(void 0,t))}),a.promise},i.when=function(e,t,r,n){var o,s;return e&&"function"==typeof e.then?o=e:(s=new i,s.resolve(e),o=s.promise),o.then(t,r,n)},i}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function r(r){function n(e){h&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),h===self?h.postMessage(e):h.postMessage(e,"*"))}function i(){var e=[];return Object.keys(w).forEach(function(t){var r=w[t];e.push({serviceId:t,names:r.names,methods:r.methods,properties:r.properties})}),{headers:f||{},services:e}}function o(e,t){if(t&&t instanceof XMLHttpRequest){var r,n;try{r=t.status,n=t.statusText}catch(i){r=0,n=""}return{status:r||0,statusText:n}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,o)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function u(r){if(!h)return(new e).reject(new Error("plugin not connected"));r.id=String(d++);var n=new e;y[r.id]=n,n.then(null,function(e){p&&e instanceof Error&&"Cancel"===e.name&&_({requestId:r.id,method:"cancel",params:e.message?[e.message]:[]})});var i=Object.prototype.toString;return r.params.forEach(function(e,o){if("[object Object]"===i.call(e)&&!(e instanceof t)){var s,u;for(s in e)"[object Function]"===i.call(e[s])&&(u=u||[],u.push(s));if(u){var a=g++;b[a]=e;var c=function(){delete b[a]};n.then(c,c),r.params[o]=new t(a,u)}}}),_(r),n.promise}function a(e,t){e||0===e?_({id:e,result:null,error:t}):console.log(t)}function c(e,t,r,n){n.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var r={};e.__methods.forEach(function(t){r[t]=function(){return u({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),n[t]=r}});var i=void 0===typeof e?null:{id:e,result:null,error:null};try{var o=r.apply(t,n);if(!i)return;o&&"function"==typeof o.then?(v[e]=o,o.then(function(t){delete v[e],i.result=t,_(i)},function(t){v[e]&&(delete v[e],i.error=s(t),_(i))},function(){_({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(i.result=o,_(i))}catch(a){i&&(i.error=s(a),_(i))}}function l(e){if(e.source===h||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var r=t.method,n=t.params||[];if("serviceId"in t){var i=w[t.serviceId];i||a(t.id,"service not found"),i=i.implementation,r in i?c(t.id,i,i[r],n):a(t.id,"method not found")}else if("objectId"in t){var o=b[t.objectId];o||a(t.id,"object not found"),!r in o?c(t.id,o,o[r],n):a(t.id,"method not found")}else if("requestId"in t){var s=v[t.requestId];s&&"cancel"===r&&s.cancel&&s.cancel.apply(s,n)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var u=y[t.responseId];u&&"progress"===r&&u.progress&&u.progress.apply(u,n)}}else{var l=y[String(t.id)];delete y[String(t.id)],t.error?l.reject(t.error):l.resolve(t.result)}}catch(f){console.log("Plugin._messageHandler "+f)}}}var f=r,p=!1,h=null,d=0,g=0,m=0,v={},y={},b={},w={},_=n;this.updateHeaders=function(e){if(p)throw new Error("Cannot update headers. Plugin Provider is connected");f=e},this.registerService=function(e,t,r){if(p)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var n=null,i=[];for(n in t)"function"==typeof t[n]&&i.push(n);w[m++]={names:e,methods:i,implementation:t,properties:r||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(p)return void(e&&e());if("undefined"==typeof window)h=self;else if(window!==window.parent)h=window.parent;else{if(null===window.opener)return void(t&&t("No valid plugin target"));h=window.opener}addEventListener("message",l,!1);var r={method:"plugin",params:[i()]};n(r),p=!0,e&&e()},this.disconnect=function(){p&&(removeEventListener("message",l),h=null,p=!1)}}return r}),define("orion/i18nUtil",["require","orion/Deferred"],function(e,t){function r(e){var t=/\$\{([^\}]+)\}/g,r=arguments;return 2===r.length&&r[1]&&"object"==typeof r[1]?e.replace(t,function(e,t){return r[1][t]}):e.replace(t,function(e,t){return r[(t<<0)+1]})}function n(e){var t=localStorage.getItem("orion/messageBundle/"+e);if(t){var r=JSON.parse(t);if(r._expires&&r._expires>(new Date).getTime())return delete r._expires,r}return null}function i(e,t){t._expires=(new Date).getTime()+9e5,localStorage.setItem("orion/messageBundle/"+e,JSON.stringify(t)),delete t._expires}function o(r){function o(t,n,i){e(t,function(e){"undefined"==typeof e?i(new Error(r)):n.apply(null,Array.prototype.slice.call(arguments))},i)}function u(){e(["i18n!"+r],function(e){e&&i(r,e),c.resolve(e)})}function a(e){c.reject(e)}if(s[r])return s[r];var c=new t;s[r]=c;var l=n(r);if(l)return c.resolve(l),c;try{o([r],u,function(){requirejs.undef(r),o(["orion/i18n!"+r],u,a)})}catch(f){o(["orion/i18n!"+r],u,a)}return c}var s={};return{getMessageBundle:o,formatMessage:r}}),define("orion/xsrfUtils",[],function(){function e(){var e,t,r,i=document.cookie.split(";");for(e=0;e<i.length;e++)if(t=i[e].substr(0,i[e].indexOf("=")).trim(),r=i[e].substr(i[e].indexOf("=")+1).trim(),t==n)return r}function t(t){var r=e();r&&(t[n]=r)}function r(t){var r=e();r&&t.setRequestHeader(n,r)}var n="x-csrf-token";return{XSRF_TOKEN:n,getCSRFToken:e,setNonceHeader:t,addCSRFNonce:r}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function r(e){return 0===e.length?"":e.join("&")}function n(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),r=t[1]?decodeURIComponent(t[1]):"",n=t[2]?decodeURIComponent(t[2]):"";return[r,n]}function i(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function o(e,r){var i="",o=[],s=0;return{next:function(){if(i!==e.query&&(i=e.query,o=t(i)),s<o.length){var u=n(o[s++]);switch(r){case"keys":return u[0];case"values":return u[1];case"keys+values":return[u[0],u[1]];default:throw new TypeError}}throw R}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function u(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var r=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=r+e.path}}else e.path=t.path}function a(e){return e.toLowerCase()}function c(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function l(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function f(e){e.scheme&&(e.scheme=a(e.scheme)),e.port&&(e.port=c(e.port)),e.host&&e.path&&(e.path=l(e.path))}function p(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function h(e,t){if("string"!=typeof e)throw new TypeError;e=p(e);var r=y.exec(e);if(!r)return null;var n={};if(n.scheme=r[1]||"",n.scheme&&!_.test(n.scheme))return null;var i=r[2];if(i){var o=b.exec(i);if(n.userinfo=o[1],n.host=o[2],n.port=o[3],n.port&&!j.test(n.port))return null}return n.path=r[3],n.query=r[4],n.fragment=r[5],u(n,t),f(n),n}function d(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function g(e,t){var r;if(t){if(t=t.href||t,r=h(t),!r||!r.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:r})}var n=h(e,r);if(!n)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:n,writable:!0});var i=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?i:null},enumerable:!0})}try{var m;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(m=new window.URL("http://www.w3.org?q")).protocol&&m.query)return}catch(v){}var y=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,b=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,w=/^\S*$/,_=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,j=/^\d*$/,P=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,S=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,x=/^([^?#\s]*)$/,O=/^([^\s]*)$/,T=w,E=/([^:]*):?(.*)/,R="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),I={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(r){e(r);var i,o=t(this._url.query);return o.some(function(e){var t=n(e);return t[0]===r?(i=t[1],!0):void 0}),i},enumerable:!0},set:{value:function(o,s){e(o),e(s);var u=t(this._url.query),a=u.some(function(e,t){var r=n(e);return r[0]===o?(r[1]=s,u[t]=i(r),!0):void 0});a||u.push(i([o,s])),this._url.query=r(u)},enumerable:!0},has:{value:function(r){e(r);var i=t(this._url.query);return i.some(function(e){var t=n(e);return t[0]===r?!0:void 0})},enumerable:!0},"delete":{value:function(i){e(i);var o=t(this._url.query),s=o.filter(function(e){var t=n(e);return t[0]!==i});return s.length!==o.length?(this._url.query=r(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var r=o(this._url,"keys+values");try{for(;;){var n=r.next();e.call(t,n[1],n[0],this)}}catch(i){if(i!==R)throw i}},enumerable:!0},keys:{value:function(){return o(this._url,"keys")},enumerable:!0},values:{value:function(){return o(this._url,"values")},enumerable:!0},items:{value:function(){return o(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(r){e(r);var i=[],o=t(this._url.query);return o.forEach(function(e){var t=n(e);t[0]===r&&i.push(t[1])}),i},enumerable:!0},append:{value:function(n,o){e(n),e(o);var s=t(this._url.query);s.push(i([n,o])),this._url.query=r(s)},enumerable:!0}}),Object.defineProperties(g.prototype,{href:{get:function(){return this._url?d(this._url):this._input},set:function(t){e(t),this._input=t,this._url=h(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var r=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===r||_.test(r))&&(this._url.scheme=a(r))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=E.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var r=E.exec(this._userinfo),n=[encodeURIComponent(t||"")];r[2]&&n.push(r[2]),this._userinfo=n.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=E.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var r=E.exec(this._userinfo),n=[r[1]||""];t&&n.push(encodeURIComponent(t)),this._userinfo=n.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var r=S.exec(t);r&&(this._url.host=r[1],this._url.port=c(r[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var r=P.exec(t);r&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===I[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var r=j.exec(t);r&&(this._url.port=c(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var r=x.exec(t);r&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?l(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var r=O.exec(t);r&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var r=T.exec(t);r&&(this._url.fragment=t)}},enumerable:!0}});var $=window.URL||window.webkitURL;$&&$.createObjectURL&&(Object.defineProperty(g,"createObjectURL",{value:$.createObjectURL.bind($),enumerable:!1}),Object.defineProperty(g,"revokeObjectURL",{value:$.revokeObjectURL.bind($),enumerable:!1})),window.URL=g}(),define("orion/URL-shim",function(){}),define("orion/xhr",["orion/Deferred","orion/xsrfUtils","orion/URL-shim"],function(e,t){function r(e,t,r,n){var i,o="undefined"!=typeof r.response?r.response:r.responseText,s="string"==typeof o?o:null;try{i=r.status}catch(u){i=0}var a={args:t,response:o,responseText:s,status:i,url:e,xhr:r};return"undefined"!=typeof n&&(a.error=n),a}function n(e){return new URL(location.href).origin===new URL(e,location.href).origin}function i(i,o,s){s=s||{};var u=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,a=new e,c=s.headers||{};n(o)&&t.setNonceHeader(c);var l,f=s.log||!1;"undefined"==typeof c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof s.data||"POST"!==i&&"PUT"!==i||(l=s.data);var p=!1,h=!1;a.promise.then(void 0,function(e){p=!0,!h&&e instanceof Error&&"Cancel"===e.name&&u.abort()}),u.onabort=function(){if(h=!0,!p){var e=new Error("Cancel");e.name="Cancel",a.reject(e)}},u.onload=function(){var e=r(o,s,u);200<=u.status&&u.status<400?a.resolve(e):(a.reject(e),f&&"undefined"!=typeof console&&console.log(new Error(u.statusText)))},u.onerror=function(){var e=r(o,s,u);a.reject(e),f&&"undefined"!=typeof console&&console.log(new Error(u.statusText))},u.onprogress=function(e){e.xhr=u,a.progress(e)};try{if(u.open(i,o,!0),"string"==typeof s.responseType&&(u.responseType=s.responseType),"number"==typeof s.timeout)if("number"==typeof u.timeout)u.timeout=s.timeout,u.addEventListener("timeout",function(){a.reject(r(o,s,u,"Timeout exceeded"))});else{var d=setTimeout(function(){a.reject(r(o,s,u,"Timeout exceeded"))},s.timeout);a.promise.then(clearTimeout.bind(null,d),clearTimeout.bind(null,d))}Object.keys(c).forEach(function(e){u.setRequestHeader(e,c[e])}),u.send(l||null)}catch(g){a.reject(r(o,s,u,g))}return a.promise}return i}),define("orion/regex",[],function(){function e(e){return e.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&")}function t(e){var t=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(e);return t?{pattern:t[1],flags:t[2]}:null}return{escape:e,parse:t}}),define("plugins/site/siteServiceImpl",["require","orion/i18nUtil","orion/xhr","orion/regex"],function(e,t,r,n){function i(e){var t=document.createElement("a");return t.href=e,t.href}function o(){var t=e.toUrl("._"),r=i(t);return r.substring(0,r.length-2)}function s(e){return-1!==e.indexOf(":")?e.substring(e.indexOf(window.location.host)+window.location.host.length):e}function u(e,t,r){return e.HostingStatus.URL+("/"!==t[0]?"/":"")+t+(r.Directory?"/":"")}function a(e){return new RegExp("^/").test(e)}function c(e){return g.href=e,g.href}function l(e){return e&&"object"==typeof e&&Object.keys(e).forEach(function(t){var r=e[t];-1!==t.indexOf("Location")?e[t]=c(r):l(r)}),e}function f(e,t){for(var r,n=e.split("/"),i=n[1],o=0;o<t.length;o++){var s=t[o];if(s.Id===i){n[1]=s.Name,r=n.join("/");break}}return r}function p(e,t,n){return n&&"undefined"!=typeof n.data&&(n.data=JSON.stringify(n.data)),r.apply(null,Array.prototype.slice.call(arguments)).then(function(e){return JSON.parse(e.response||null)})}function h(e){this.projects={},this.getProjects=function(t){var r={"Orion-Version":"1"};return this.projects[t]||(this.projects[t]=p("GET",e,{headers:r}).then(function(e){for(var n,i=e.Workspaces,o=0;o<i.length&&(n=i[o],n.Id!==t);o++);return p("GET",n.Location,{headers:r}).then(function(e){return e.Children||[]})})),this.projects[t]}}function d(e,r,i){this.filePrefix=e,this.cache=new h(r),this.makeAbsolute=r&&-1!==r.indexOf("://"),this.selfHostingRules=i;var u=i.Rules,a=i.Types.File,c=i.Types.API;this._generateSelfHostingMappings=function(e){var r="http://localhost"+s(o());return u.map(function(n){var i;return i=n.type===a?t.formatMessage.apply(t,[n.targetPattern].concat(e)):t.formatMessage(n.targetPattern,r),{Source:n.source,Target:i}})},this._matchesSelfHostingTemplate=function(e,t){var r=/(\$\{[^}]+?\})/,i=n.escape("http://localhost")+"(:\\d+)?"+n.escape(s(o()));return u.every(function(o){return t.Mappings.some(function(t){if(t.Source===o.source){var s;o.type===a?s=n.escape(e)+".*?":o.type===c&&(s=i);var u=[];return o.targetPattern.split(r).forEach(function(e){u.push(r.test(e)?s:n.escape(e))}),new RegExp(u.join("")).test(t.Target)}return!1})})}}var g=document.createElement("a");return d.prototype={getSiteConfigurations:function(){var t=e.toUrl("site._");return t=t.substring(0,t.length-2),p("GET",t,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return e.SiteConfigurations}).then(function(e){return this.makeAbsolute&&l(e),e}.bind(this))},loadSiteConfiguration:function(e){return p("GET",e,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&l(e),e}.bind(this))},createSiteConfiguration:function(t,r,n,i,o){function s(e){return e.replace(/ /g,"-").replace(/[^A-Za-z0-9-_]/g,"").toLowerCase()}var u={Name:t,Workspace:r,HostHint:s(t)};n&&(u.Mappings=n),i&&(u.HostHint=i),o&&(u.HostingStatus=o);var a=e.toUrl("site._");return a=a.substring(0,a.length-2),p("POST",a,{data:u,headers:{"Content-Type":"application/json; charset=utf-8","Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&l(e),e}.bind(this))},updateSiteConfiguration:function(e,t){return p("PUT",e,{data:t,headers:{"Content-Type":"application/json; charset=utf-8","Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&l(e),e}.bind(this))},deleteSiteConfiguration:function(e){return p("DELETE",e,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&l(e),e}.bind(this))},toInternalForm:function(e){var t,r=s(this.filePrefix),n=s(e);return 0===n.indexOf(r)&&(t=n.substring(r.length)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t},toFileLocation:function(t){function r(e){return e.filter(function(e){return""!==e})}var n=e.toUrl(this.filePrefix+t+"._");n=n.substring(0,n.length-2);var o=t.split("/");return 1===r(o).length&&(n+="/"),s(i(n))},getMappingObject:function(e,t,r){var n=this.toInternalForm(t);return this.cache.getProjects(e.Workspace).then(function(e){var t=f(n,e);return{Source:r,Target:n,FriendlyPath:t||r}})},getMappingProposals:function(e){var t=this;return this.cache.getProjects(e.Workspace).then(function(e){return e.map(function(e){return{Source:"/"+e.Name,Target:t.toInternalForm(e.Location),FriendlyPath:"/"+e.Name}})})},updateMappingsDisplayStrings:function(e){return this.cache.getProjects(e.Workspace).then(function(t){for(var r=e.Mappings,n=0;n<r.length;n++){var i=r[n];a(i.Target)&&(i.FriendlyPath=f(i.Target,t))}return e})},parseInternalForm:function(e,t){return a(t)?this.cache.getProjects(e.Workspace).then(function(e){for(var r=t.split("/"),n=0;n<e.length;n++){var i=e[n];if(r[1]===i.Name)return r[1]=i.Id,r.join("/")}}):null},isSelfHostingSite:function(e){var t=this;return this.cache.getProjects(e.Workspace).then(function(r){return r.some(function(r){var n=t.toInternalForm(r.Location);return t._matchesSelfHostingTemplate(n,e)})})},convertToSelfHosting:function(e,t){var r=t.map(this.toInternalForm.bind(this)),n=this._generateSelfHostingMappings(r);return e.Mappings=n,e},getURLOnSite:function(e,t){var r=e.Mappings,n=this.toInternalForm(t.Location);if(!r)return null;for(var i=0;i<r.length;i++){var o=r[i];if(o.Target===n)return u(e,o.Source,t)}return null}},{SiteImpl:d}}),define("plugins/site/selfHostingRules",[],function(){var e=0,t=1,r=[{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.ui/web/index.html"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.ui/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.help/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.users/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.core/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.editor/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.cf/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.git/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.javascript/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.webtools/web"},{type:t,source:"/file",targetPattern:"${0}file"},{type:t,source:"/prefs",targetPattern:"${0}prefs"},{type:t,source:"/workspace",targetPattern:"${0}workspace"},{type:t,source:"/users",targetPattern:"${0}users"},{type:t,source:"/authenticationPlugin.html",targetPattern:"${0}authenticationPlugin.html"},{type:t,source:"/login",targetPattern:"${0}login"},{type:t,source:"/loginstatic",targetPattern:"${0}loginstatic"},{type:t,source:"/useremailconfirmation",targetPattern:"${0}useremailconfirmation"},{type:t,source:"/site",targetPattern:"${0}site"},{type:t,source:"/gitapi",targetPattern:"${0}gitapi"},{type:t,source:"/xfer",targetPattern:"${0}xfer"},{type:t,source:"/filesearch",targetPattern:"${0}filesearch"},{type:t,source:"/index.jsp",targetPattern:"${0}index.jsp"},{type:t,source:"/plugins/git",targetPattern:"${0}plugins/git"},{type:t,source:"/plugins/user",targetPattern:"${0}plugins/user"},{type:t,source:"/logout",targetPattern:"${0}logout"},{type:t,source:"/task",targetPattern:"${0}task"},{type:t,source:"/cfapi",targetPattern:"${0}cfapi"},{type:t,source:"/docker",targetPattern:"${0}docker"}];return{Rules:r,Types:{File:e,API:t}}}),define("plugins/site/sitePlugin",["orion/plugin","plugins/site/siteServiceImpl","plugins/site/selfHostingRules"],function(e,t,r){function n(e){var t=document.createElement("a");return t.href=e,t.href}function i(e){e=n(e);try{if(window.location.host===parent.location.host&&window.location.protocol===parent.location.protocol)return e.substring(parent.location.href.indexOf(parent.location.host)+parent.location.host.length)}catch(t){}return e}function o(e){return[{source:"Location|Directory"},{source:"Location",match:"^"+e}]}var s=i("../../site"),u=i("../../file"),a=i("../../workspace"),c=document.createElement("a");c.href="../../mixloginstatic/LoginWindow.html";var l=c.href,f={name:"Orion Site Service",version:"1.0",description:"This plugin provides virtual site support for hosting client web applications from your Orion workspace.",login:l},p=new e(f),h=document.createElement("a");h.href="/",p.registerService("orion.page.link.category",null,{id:"sites",nameKey:"Sites",nls:"orion/nls/messages",imageClass:"core-sprite-sites",order:50,uriTemplate:"{+OrionHome}/sites/"}),p.registerService("orion.page.link",null,{nameKey:"Sites",id:"orion.sites",nls:"orion/nls/messages",category:"sites",order:1e3,uriTemplate:"{+OrionHome}/sites/sites.html"}),p.registerService("orion.page.link",null,{nameKey:"Sites",id:"orion.sites.2",nls:"orion/nls/messages",category:"sites",order:10,uriTemplate:"{+OrionHome}/sites/sites.html"}),p.registerService("orion.navigate.command",null,{id:"orion.site."+h.hostname+".viewon",nameKey:"View on Site",tooltipKey:"View this file or folder on a web site hosted by Orion",nls:"orion/nls/messages",forceSingleItem:!0,category:"sites",validationProperties:o(u),uriTemplate:"{+OrionHome}/sites/view.html#,file={,Location}"}),p.registerService("orion.page.link.related",null,{id:"orion.site."+h.hostname+".viewon",nameKey:"View on Site",tooltipKey:"View this file or folder on a web site hosted by Orion",nls:"orion/nls/messages",category:"sites",validationProperties:o(u),uriTemplate:"{+OrionHome}/sites/view.html#,file={,Location}"}),p.registerService("orion.site",new t.SiteImpl(u,a,r),{id:"orion.site."+h.hostname,name:"Orion Sites at "+h.hostname,pattern:s,filePattern:u,canSelfHost:!0,selfHostingConfig:{folders:[{name:"org.eclipse.orion.client",labelKey:"orionClientLabel",nls:"orion/sites/nls/messages"}]}}),p.connect()});