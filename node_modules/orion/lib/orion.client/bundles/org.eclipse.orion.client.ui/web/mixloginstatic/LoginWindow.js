define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=u;d&&t.length&&(u=[],e(t))}function n(){d||(d=!0,a&&clearInterval(a),t())}function o(e){return d?e(c):u.push(e),o}var i,r,a,s="undefined"!=typeof window&&window.document,d=!s,c=s?document:null,u=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),r=document.createElement("div");try{i=null===window.frameElement}catch(l){}r.doScroll&&i&&window.external&&(a=setInterval(function(){try{r.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return o.version="2.0.1",o.load=function(e,t,n,i){i.isBuild?n(null):o(n)},o}),function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=r.shift();)e();a=!1}function t(e){r.push(e),a||(a=!0,s())}function n(e){return function(t){e(t)}}function o(e,t,o){try{var i=e(t),r=i&&("object"==typeof i||"function"==typeof i)&&i.then;if("function"==typeof r)if(i===o.promise)o.reject(new TypeError);else{var a=i.cancel;"function"==typeof a?o._parentCancel=a.bind(i):delete o._parentCancel,r.call(i,n(o.resolve),n(o.reject),n(o.progress))}else o.resolve(i)}catch(s){o.reject(s)}}function i(){function e(){for(var e;e=c.shift();){var t=e.deferred,n="fulfilled"===d?"resolve":"reject",i=e[n];"function"==typeof i?o(i,s,t):t[n](s)}}function n(n){delete u._parentCancel,d="rejected",s=n,c.length&&t(e)}function r(o){function a(e){return function(t){d&&"assumed"!==d||e(t)}}delete u._parentCancel;try{var l=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof l)if(o===u)n(new TypeError);else{d="assumed";var f=o&&o.cancel;if("function"!=typeof f){var m=new i;o=m.promise;try{l(m.resolve,m.reject,m.progress)}catch(g){m.reject(g)}f=o.cancel,l=o.then}s=o,l.call(o,a(r),a(n)),u._parentCancel=f.bind(o)}else d="fulfilled",s=o,c.length&&t(e)}catch(p){a(n)(p)}}function a(){var e=u._parentCancel;if(e)delete u._parentCancel,e();else if(!d){var t=new Error("Cancel");t.name="Cancel",n(t)}}var s,d,c=[],u=this;this.resolve=function(e){return d||r(e),u},this.reject=function(e){return d||n(e),u},this.progress=function(e){return d||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),u.promise},this.cancel=function(){return u._parentCancel?setTimeout(a,0):a(),u},this.then=function(n,o,r){var a=new i;return a._parentCancel=u.promise.cancel,c.push({resolve:n,reject:o,progress:r,deferred:a}),("fulfilled"===d||"rejected"===d)&&t(e),a.promise},this.promise={then:u.then,cancel:u.cancel}}var r=[],a=!1,s=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),o=new MutationObserver(e);return o.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return i.all=function(e,t){function n(e,t){s||(a[e]=t,0===--r&&d.resolve(a))}function o(e,o){if(!s){if(t)try{return void n(e,t(o))}catch(i){o=i}d.reject(o)}}var r=e.length,a=[],s=!1,d=new i;return d.then(void 0,function(){s=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===r?d.resolve(a):e.forEach(function(e,t){e.then(n.bind(void 0,t),o.bind(void 0,t))}),d.promise},i.when=function(e,t,n,o){var r,a;return e&&"function"==typeof e.then?r=e:(a=new i,a.resolve(e),r=a.promise),r.then(t,n,o)},i}),define("orion/xhr",["orion/Deferred"],function(e){function t(e,t,n,o){var i,r="undefined"!=typeof n.response?n.response:n.responseText,a="string"==typeof r?r:null;try{i=n.status}catch(s){i=0}var d={args:t,response:r,responseText:a,status:i,url:e,xhr:n};return"undefined"!=typeof o&&(d.error=o),d}function n(n,o,i){i=i||{};var r,a=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,s=new e,d=i.headers||{},c=i.log||!1;"undefined"==typeof d["X-Requested-With"]&&(d["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof i.data||"POST"!==n&&"PUT"!==n||(r=i.data);var u=!1,l=!1;s.promise.then(void 0,function(e){u=!0,!l&&e instanceof Error&&"Cancel"===e.name&&a.abort()}),a.onabort=function(){if(l=!0,!u){var e=new Error("Cancel");e.name="Cancel",s.reject(e)}},a.onload=function(){var e=t(o,i,a);200<=a.status&&a.status<400?s.resolve(e):(s.reject(e),c&&"undefined"!=typeof console&&console.log(new Error(a.statusText)))},a.onerror=function(){var e=t(o,i,a);s.reject(e),c&&"undefined"!=typeof console&&console.log(new Error(a.statusText))},a.onprogress=function(e){e.xhr=a,s.progress(e)};try{if(a.open(n,o,!0),"string"==typeof i.responseType&&(a.responseType=i.responseType),"number"==typeof i.timeout)if("number"==typeof a.timeout)a.timeout=i.timeout,a.addEventListener("timeout",function(){s.reject(t(o,i,a,"Timeout exceeded"))});else{var f=setTimeout(function(){s.reject(t(o,i,a,"Timeout exceeded"))},i.timeout);s.promise.then(clearTimeout.bind(null,f),clearTimeout.bind(null,f))}Object.keys(d).forEach(function(e){a.setRequestHeader(e,d[e])}),a.send(r||null)}catch(m){s.reject(t(o,i,a,m))}return s.promise}return n}),define("orion/PageUtil",[],function(){function e(){var e=window.location.href.split("#")[1];return e=e?"#"+e:""}function t(e){e=e||window.location.toString();var t={resource:""},n=e.indexOf("#");if(-1!==n){var o=e.substring(n+1);if(0!==o.length){var i=o.split(",");t.resource=decodeURIComponent(i[0]);for(var r=1;r<i.length;r++){var a=i[r],s=/([^=]*)(=?)(.*)/.exec(a),d=decodeURIComponent(s[1]||""),c=decodeURIComponent(s[3]||"");""!==d&&"resource"!==d&&(t[d]=c)}}}return t}function n(e,t){var n=e;if(-1===e.indexOf("://")){var i=document.createElement("a");i.href=e,n=i.href}var r=!1;return r=t?t.some(function(e){return new RegExp("^"+e+":","i").test(n)}):o.test(n),r?e:(console.log("Illegal URL Scheme: '"+e+"'"),"")}var o=new RegExp("^http[s]?","i");return{hash:e,matchResourceParameters:t,validateURLScheme:n}}),define("orion/util",[],function(){function e(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,n){return t[(n<<0)+1]})}function t(e,t){return e.createElementNS?e.createElementNS(h,t):e.createElement(t)}var n=navigator.userAgent,o=-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?document.documentMode:void 0,i=parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0,r=-1!==n.indexOf("Opera")?parseFloat(n.split("Version/")[1]):void 0,a=parseFloat(n.split("Chrome/")[1])||void 0,s=-1!==n.indexOf("Safari")&&!a,d=parseFloat(n.split("WebKit/")[1])||void 0,c=-1!==n.indexOf("Android"),u=-1!==n.indexOf("iPad"),l=-1!==n.indexOf("iPhone"),f=u||l,m=-1!==navigator.platform.indexOf("Mac"),g=-1!==navigator.platform.indexOf("Win"),p=-1!==navigator.platform.indexOf("Linux"),y="undefined"!=typeof document&&"ontouchstart"in document.createElement("input"),v=g?"\r\n":"\n",h="http://www.w3.org/1999/xhtml";return{formatMessage:e,createElement:t,isIE:o,isFirefox:i,isOpera:r,isChrome:a,isSafari:s,isWebkit:d,isAndroid:c,isIPad:u,isIPhone:l,isIOS:f,isMac:m,isWindows:g,isLinux:p,isTouch:y,platformDelimiter:v}}),define("orion/webui/littlelib",["orion/util"],function(e){function t(e,t){return t||(t=document),t.querySelector(e)}function n(e,t){return t||(t=document),t.querySelectorAll(e)}function o(e,t){return Array.prototype.slice.call(n(e,t))}function i(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function r(e,t){if(!e||!t)return!1;if(e===t)return!0;var n=e.compareDocumentPosition(t);return Boolean(16&n)}function a(e){var t=e.getBoundingClientRect();return{left:t.left+document.documentElement.scrollLeft,top:t.top+document.documentElement.scrollTop,width:t.width,height:t.height}}function s(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}}function d(t){var n=t.tabIndex;if(0===n&&e.isIE){var o={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0};o[t.nodeName.toLowerCase()]||t.attributes.tabIndex||(n=-1)}return n}function c(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=c(e.childNodes[t]);if(n)return n}return null}function u(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=e.childNodes.length-1;t>=0;t--){var n=u(e.childNodes[t]);if(n)return n}return null}function l(e,t){if(3===e.nodeType){var n=h.exec(e.nodeValue);n&&n.length>1&&t(e,n)}if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++)l(e.childNodes[o],t)}function f(e,t){l(e,function(e,n){var o=t[n[1]]||n[1];e.parentNode.replaceChild(document.createTextNode(o),e)})}function m(e,t){l(e,function(e,n){var o=t[n[1]];if(o){var i=document.createRange(),r=n.index;i.setStart(e,r),i.setEnd(e,r+n[0].length),i.deleteContents(),i.insertNode(o)}})}function g(t,n){function o(e){w.forEach(function(t){var n=!1,o=t.excludeNodes.some(function(t){return document.body.contains(t)?(n=!0,t.contains(e.target)):!1});if(n&&!o)try{t.dismiss(e)}catch(i){"undefined"!=typeof console&&console&&console.error(i&&i.message)}}),w=w.filter(function(e){return e.excludeNodes.some(function(e){return document.body.contains(e)})})}null===w&&(w=[],document.addEventListener("click",o,!0),e.isIOS&&document.addEventListener("touchend",function(e){function t(){e.target.removeEventListener("click",t)}0===e.touches.length&&e.target.addEventListener("click",t)},!1)),w.push({excludeNodes:t,dismiss:n})}function p(e){w=w.filter(function(t){return e!==t.dismiss})}function y(e){window.document.all&&(e.keyCode=0),e.preventDefault&&(e.preventDefault(),e.stopPropagation())}function v(e){for(var t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++)t[n].parentNode.style.pointerEvents=e?"":"none"}var h=/\$\{([^\}]+)\}/,w=null,E={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46};return{$:t,$$:n,$$array:o,node:i,contains:r,bounds:a,empty:s,firstTabbable:c,lastTabbable:u,stop:y,processTextNodes:f,processDOMNodes:m,addAutoDismiss:g,setFramesEnabled:v,removeAutoDismiss:p,KEY:E}}),function(){function e(e){if(void 0===v)v=e;else if(v!=e)throw"you cannot combine the navigator.id.watch() API with navigator.id.getVerifiedEmail() or navigator.id.get()this site should instead use navigator.id.request() and navigator.id.watch()"}function t(){if(h)try{if(!l){var e=window.document,t=e.createElement("iframe");t.style.display="none",e.body.appendChild(t),t.src=f+"/communication_iframe",l=d.build({window:t.contentWindow,origin:f,scope:"mozid_ni",onReady:function(){l.call({method:"loaded",success:function(){y.ready&&y.ready()},error:function(){}})}}),l.bind("logout",function(){y.logout&&y.logout()}),l.bind("login",function(e,t){y.login&&y.login(t)})}}catch(n){l=void 0}}function n(e){return"undefined"!=typeof e}function o(e){try{console.warn(e)}catch(t){}}function i(e,t){return n(e[t])?(o(t+" has been deprecated"),!0):void 0}function r(e,t,o){if(n(e[t])&&n(e[o]))throw"you cannot supply *both* "+t+" and "+o;i(e,t)&&(e[o]=e[t],delete e[t])}function a(e){if("object"==typeof e){if(e.onlogin&&"function"!=typeof e.onlogin||e.onlogout&&"function"!=typeof e.onlogout||e.onready&&"function"!=typeof e.onready)throw"non-function where function expected in parameters to navigator.id.watch()";if(!e.onlogin)throw"'onlogin' is a required argument to navigator.id.watch()";if(!e.onlogout)throw"'onlogout' is a required argument to navigator.id.watch()";y.login=e.onlogin||null,y.logout=e.onlogout||null,y.ready=e.onready||null,t(),r(e,"loggedInEmail","loggedInUser"),"undefined"!=typeof e.loggedInUser&&l&&l.notify({method:"loggedInUser",params:e.loggedInUser})}}function s(e){if(i(e,"requiredEmail"),r(e,"tosURL","termsOfService"),r(e,"privacyURL","privacyPolicy"),e.termsOfService&&!e.privacyPolicy&&o("termsOfService ignored unless privacyPolicy also defined"),e.privacyPolicy&&!e.termsOfService&&o("privacyPolicy ignored unless termsOfService also defined"),u)try{u.focus()}catch(t){}else{if(!c.isSupported()){var n=c.getNoSupportReason(),a="unsupported_dialog";return"LOCALSTORAGE_DISABLED"===n&&(a="cookies_disabled"),void(u=window.open(f+"/"+a,null,p))}l&&l.notify({method:"dialog_running"}),u=WinChan.open({url:f+"/sign_in",relay_url:f+"/relay",window_features:p,window_name:"__persona_dialog",params:{method:"get",params:e}},function(t,n){if(l&&(!t&&n&&n.email&&l.notify({method:"loggedInUser",params:n.email}),l.notify({method:"dialog_complete"})),u=void 0,!t&&n&&n.assertion)try{y.login&&y.login(n.assertion)}catch(o){}"client closed window"!==t&&n||(e&&e.oncancel&&e.oncancel(),delete e.oncancel)})}}var d=function(){function e(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}function t(e,t,n){for(var o=i[t][n],r=0;r<o.length;r++)o[r].win===e&&o.splice(r,1);0===i[t][n].length&&delete i[t][n]}function n(e,t,n,o){function r(t){for(var n=0;n<t.length;n++)if(t[n].win===e)return!0;return!1}var a=!1;if("*"===t){for(var s in i)if(i.hasOwnProperty(s)&&"*"!==s&&"object"==typeof i[s][n]&&(a=r(i[s][n])))break}else i["*"]&&i["*"][n]&&(a=r(i["*"][n])),!a&&i[t]&&i[t][n]&&(a=r(i[t][n]));if(a)throw"A channel is already bound to the same window which overlaps with origin '"+t+"' and has scope '"+n+"'";"object"!=typeof i[t]&&(i[t]={}),"object"!=typeof i[t][n]&&(i[t][n]=[]),i[t][n].push({win:e,handler:o})}var o=Math.floor(1000001*Math.random()),i={},r={},a=function(e){try{var t=JSON.parse(e.data);if("object"!=typeof t||null===t)throw"malformed"}catch(e){return}var n,o,a,s=e.source,d=e.origin;if("string"==typeof t.method){var c=t.method.split("::");2==c.length?(n=c[0],a=c[1]):a=t.method}if("undefined"!=typeof t.id&&(o=t.id),"string"==typeof a){var u=!1;if(i[d]&&i[d][n])for(var l=0;l<i[d][n].length;l++)if(i[d][n][l].win===s){i[d][n][l].handler(d,a,t),u=!0;break}if(!u&&i["*"]&&i["*"][n])for(var l=0;l<i["*"][n].length;l++)if(i["*"][n][l].win===s){i["*"][n][l].handler(d,a,t);break}}else"undefined"!=typeof o&&r[o]&&r[o](d,a,t)};return window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent&&window.attachEvent("onmessage",a),{build:function(i){var a=function(e){if(i.debugOutput&&window.console&&window.console.log){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(t){}console.log("["+c+"] "+e)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof i)throw"Channel build invoked without a proper object argument";if(!i.window||!i.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===i.window)throw"target window is same as present window -- not allowed";var s=!1;if("string"==typeof i.origin){var d;"*"===i.origin?s=!0:null!==(d=i.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(i.origin=d[0].toLowerCase(),s=!0)}if(!s)throw"Channel.build() called with an invalid origin";if("undefined"!=typeof i.scope){if("string"!=typeof i.scope)throw"scope, when specified, must be a string";if(i.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var c=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=0;5>n;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),u={},l={},f={},m=!1,g=[],p=function(e,t,n){var o=!1,i=!1;return{origin:t,invoke:function(t,o){if(!f[e])throw"attempting to invoke a callback of a nonexistent transaction: "+e;for(var i=!1,r=0;r<n.length;r++)if(t===n[r]){i=!0;break}if(!i)throw"request supports no such callback '"+t+"'";w({id:e,callback:t,params:o})},error:function(t,n){if(i=!0,!f[e])throw"error called for nonexistent message: "+e;delete f[e],w({id:e,error:t,message:n})},complete:function(t){if(i=!0,!f[e])throw"complete called for nonexistent message: "+e;delete f[e],w({id:e,result:t})},delayReturn:function(e){return"boolean"==typeof e&&(o=e===!0),o},completed:function(){return i}}},y=function(e,t,n){return window.setTimeout(function(){if(l[e]){var o="timeout ("+t+"ms) exceeded on method '"+n+"'";l[e].error("timeout_error",o),delete l[e],delete r[e]}},t)},v=function(t,n,o){if("function"==typeof i.gotMessageObserver)try{i.gotMessageObserver(t,o)}catch(s){a("gotMessageObserver() raised an exception: "+s.toString())}if(o.id&&n){if(u[n]){var d=p(o.id,t,o.callbacks?o.callbacks:[]);f[o.id]={};try{if(o.callbacks&&e(o.callbacks)&&o.callbacks.length>0)for(var c=0;c<o.callbacks.length;c++){for(var m=o.callbacks[c],g=o.params,y=m.split("/"),v=0;v<y.length-1;v++){var h=y[v];"object"!=typeof g[h]&&(g[h]={}),g=g[h]}g[y[y.length-1]]=function(){var e=m;return function(t){return d.invoke(e,t)}}()}var w=u[n](d,o.params);!d.delayReturn()&&!d.completed()&&d.complete(w)}catch(s){var E="runtime_error",b=null;if("string"==typeof s?b=s:"object"==typeof s&&(s&&e(s)&&2==s.length?(E=s[0],b=s[1]):"string"==typeof s.error&&(E=s.error,s.message?"string"==typeof s.message?b=s.message:s=s.message:b="")),null===b)try{b=JSON.stringify(s),"undefined"==typeof b&&(b=s.toString())}catch(I){b=s.toString()}d.error(E,b)}}}else o.id&&o.callback?l[o.id]&&l[o.id].callbacks&&l[o.id].callbacks[o.callback]?l[o.id].callbacks[o.callback](o.params):a("ignoring invalid callback, id:"+o.id+" ("+o.callback+")"):o.id?l[o.id]?(o.error?l[o.id].error(o.error,o.message):void 0!==o.result?l[o.id].success(o.result):l[o.id].success(),delete l[o.id],delete r[o.id]):a("ignoring invalid response: "+o.id):n&&u[n]&&u[n](null,o.params)};n(i.window,i.origin,"string"==typeof i.scope?i.scope:"",v);var h=function(e){return"string"==typeof i.scope&&i.scope.length&&(e=[i.scope,e].join("::")),e},w=function(e,t){if(!e)throw"postMessage called with null message";var n=m?"post  ":"queue ";if(a(n+" message: "+JSON.stringify(e)),t||m){if("function"==typeof i.postMessageObserver)try{i.postMessageObserver(i.origin,e)}catch(o){a("postMessageObserver() raised an exception: "+o.toString())}i.window.postMessage(JSON.stringify(e),i.origin)}else g.push(e)},E=function(e,t){if(a("ready msg received"),m)throw"received ready message while in ready state.  help!";for(c+="ping"===t?"-R":"-L",b.unbind("__ready"),m=!0,a("ready msg accepted."),"ping"===t&&b.notify({method:"__ready",params:"pong"});g.length;)w(g.pop());"function"==typeof i.onReady&&i.onReady(b)},b={unbind:function(e){if(u[e]){if(delete u[e])return!0;throw"can't delete method: "+e}return!1},bind:function(e,t){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";if(u[e])throw"method '"+e+"' is already bound!";return u[e]=t,this},call:function(e){if(!e)throw"missing arguments to call function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to call must be string";if(!e.success||"function"!=typeof e.success)throw"'success' callback missing from call";var t={},n=[],i=function(e,o){if("object"==typeof o)for(var r in o)if(o.hasOwnProperty(r)){var a=e+(e.length?"/":"")+r;"function"==typeof o[r]?(t[a]=o[r],n.push(a),delete o[r]):"object"==typeof o[r]&&i(a,o[r])}};i("",e.params);var a={id:o,method:h(e.method),params:e.params};n.length&&(a.callbacks=n),e.timeout&&y(o,e.timeout,h(e.method)),l[o]={callbacks:t,error:e.error,success:e.success},r[o]=v,o++,w(a)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";w({method:h(e.method),params:e.params})},destroy:function(){t(i.window,i.origin,"string"==typeof i.scope?i.scope:""),window.removeEventListener?window.removeEventListener("message",v,!1):window.detachEvent&&window.detachEvent("onmessage",v),m=!1,u={},f={},l={},i.origin=null,g=[],a("channel destroyed"),c=""}};return b.bind("__ready",E),setTimeout(function(){},0),b}}}();WinChan=function(){function e(e){/^https?:\/\//.test(e)||(e=window.location.href);var t=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(e);return t?t[1]:e}function t(){return window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage}function n(){try{var e=navigator.userAgent;return-1!=e.indexOf("Fennec/")||-1!=e.indexOf("Firefox/")&&-1!=e.indexOf("Android")}catch(t){}return!1}function o(){var e=-1;if("Microsoft Internet Explorer"===navigator.appName){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return e>=8}function i(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener&&e.removeEventListener(t,n,!1)}function r(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,!1)}var a="__winchan_relay_frame",s="die",d=o();return t()?{open:function(t,o){function c(e){try{var t=JSON.parse(e.data);"ready"===t.a?g.postMessage(y,m):"error"===t.a?o&&(o(t.d),o=null):"response"===t.a&&(i(window,"message",c),i(window,"unload",u),u(),o&&(o(null,t.d),o=null))}catch(n){}}function u(){if(f&&document.body.removeChild(f),f=void 0,p)try{p.close()}catch(e){g.postMessage(s,m)}p=g=void 0}if(!o)throw"missing required callback argument";var l;t.url||(l="missing required 'url' parameter"),t.relay_url||(l="missing required 'relay_url' parameter"),l&&setTimeout(function(){o(l)},0),t.window_name||(t.window_name=null),(!t.window_features||n())&&(t.window_features=void 0);var f,m=e(t.url);if(m!==e(t.relay_url))return setTimeout(function(){o("invalid arguments: origin of url and relay_url must match")},0);var g;d&&(f=document.createElement("iframe"),f.setAttribute("src",t.relay_url),f.style.display="none",f.setAttribute("name",a),document.body.appendChild(f),g=f.contentWindow);var p=window.open(t.url,t.window_name,t.window_features);g||(g=p);var y=JSON.stringify({a:"request",d:t.params});return r(window,"unload",u),r(window,"message",c),{close:u,focus:function(){if(p)try{p.focus()}catch(e){}}}}}:{open:function(e,t,n,o){setTimeout(function(){o("unsupported browser")},0)}}}();var c=function(){function e(){return c}function t(){return c=r()||i()||o()||n(),!c}function n(){return window.JSON&&window.JSON.stringify&&window.JSON.parse?void 0:"JSON_NOT_SUPPORTED"}function o(){return u.postMessage?void 0:"POSTMESSAGE_NOT_SUPPORTED"}function i(){try{var e="localStorage"in u&&null!==u.localStorage;if(!e)return"LOCALSTORAGE_NOT_SUPPORTED";u.localStorage.setItem("test","true"),u.localStorage.removeItem("test")}catch(t){return"LOCALSTORAGE_DISABLED"}}function r(){return a()}function a(){var e=s(),t=e>-1&&8>e;return t?"BAD_IE_VERSION":void 0}function s(){var e=-1;if("Microsoft Internet Explorer"==l.appName){var t=l.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return e}function d(e,t){l=e,u=t}var c,u=window,l=navigator;return{setTestEnv:d,isSupported:t,getNoSupportReason:e}}();if(navigator.id||(navigator.id={}),!navigator.id.request||navigator.id._shimmed){var u,l,f="https://login.persona.org",m=navigator.userAgent,g=-1!=m.indexOf("Fennec/")||-1!=m.indexOf("Firefox/")&&-1!=m.indexOf("Android"),p=g?void 0:"menubar=0,location=1,resizable=1,scrollbars=1,status=0,dialog=1,minimizable=1,width=700,height=375",y={login:null,logout:null,ready:null},v=void 0,h=c.isSupported();navigator.id={request:function(t){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");return t=t||{},e(!1),t.returnTo||(t.returnTo=document.location.pathname),s(t)},watch:function(t){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");e(!1),a(t)},logout:function(e){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");t(),l&&l.notify({method:"logout"}),"function"==typeof e&&setTimeout(e,0)},get:function(t,n){var o={};n=n||{},o.privacyPolicy=n.privacyPolicy||void 0,o.termsOfService=n.termsOfService||void 0,o.privacyURL=n.privacyURL||void 0,o.tosURL=n.tosURL||void 0,i(n,"silent")?t&&setTimeout(function(){t(null)},0):(e(!0),a({onlogin:function(e){t&&(t(e),t=null)},onlogout:function(){}}),o.oncancel=function(){t&&(t(null),t=null),y.login=y.logout=y.ready=null},s(o))},getVerifiedEmail:function(t){o("navigator.id.getVerifiedEmail has been deprecated"),e(!0),navigator.id.get(t)},_shimmed:!0}}}(),define("persona/include",function(){}),define("mixloginstatic/LoginWindow",["domReady","orion/xhr","orion/PageUtil","orion/webui/littlelib","persona/include"],function(e,t,n,o){function i(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(window.location.href);return null!==n?n[1]:void 0}function r(e){var t,n,o,i,r,a,s,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=d.indexOf(e.charAt(u++)),r=d.indexOf(e.charAt(u++)),a=d.indexOf(e.charAt(u++)),s=d.indexOf(e.charAt(u++)),t=i<<2|r>>4,n=(15&r)<<4|a>>2,o=(3&a)<<6|s,c+=String.fromCharCode(t),64!==a&&(c+=String.fromCharCode(n)),64!==s&&(c+=String.fromCharCode(o));c=c.replace(/\r\n/g,"\n");for(var l="",f=0;f<c.length;f++){var m=c.charCodeAt(f);128>m?l+=String.fromCharCode(m):m>127&&2048>m?(l+=String.fromCharCode(m>>6|192),l+=String.fromCharCode(63&m|128)):(l+=String.fromCharCode(m>>12|224),l+=String.fromCharCode(m>>6&63|128),l+=String.fromCharCode(63&m|128))}return l}function a(e){"undefined"!=typeof e&&(document.getElementById("errorMessage").textContent=e),document.getElementById("errorWin").style.visibility=""}function s(){document.getElementById("errorMessage").textContent="Â ",document.getElementById("errorWin").style.visibility="hidden"}function d(e,t){a(t)}function c(){var e;if(""===document.getElementById("reset").value&&""===document.getElementById("resetEmail").value)return void d(!0,"Provide username or email to reset.");var t=new XMLHttpRequest;t.onreadystatechange=function(){if(s(),4===t.readyState)if(200===t.status)e=JSON.parse(t.responseText),e.Message?d(!1,e.Message):a();else{try{if(e=JSON.parse(t.responseText),e.Message)return void d(!0,e.Message)}catch(n){}d(!0,t.statusText)}},t.open("POST","../useremailconfirmation",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("Orion-Version","1"),t.send("{login='"+document.getElementById("reset").value+"', email='"+document.getElementById("resetEmail").value+"'}"),d(!1,"Sending password reset confirmation...")}function u(){var e=new RegExp("[\\?&]redirect=([^&#]*)"),t=e.exec(window.location.href);return null===t?null:t[1]}function l(){var e=u();return null!==e&&(e=decodeURIComponent(e),n.validateURLScheme(e))?void(window.location=e):void window.close()}function f(e){if(""!==e&&null!==e){var t=u();return null!==t&&n.validateURLScheme(decodeURIComponent(t))?"../login/openid?openid="+encodeURIComponent(e)+"&redirect="+t:"../login/openid?openid="+encodeURIComponent(e)}}function m(e){var t=!1;return("click"===e.type||13===e.keyCode)&&(t=!0),e.stopPropagation(),t}function g(e){m(e)&&(k=!0,navigator.id.request())}function p(){var e=null;navigator.id.watch({loggedInUser:e,onlogin:function(e){k&&t("POST","../login/persona",{headers:{"Content-type":"application/x-www-form-urlencoded","Orion-Version":"1"},data:"assertion="+encodeURIComponent(e)}).then(function(){l()},function(e){a(JSON.parse(e.responseText).error)})},onlogout:function(){}})}function y(e,t){if(e||(e=document.getElementById("login").value.trim(),t=document.getElementById("password").value),e.length>0&&t.length>0){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)if(200!==n.status&&-1!==window.location.href.indexOf("http")){var e=JSON.parse(n.responseText);a(e.error)}else l()};var o="login="+encodeURIComponent(e)+"&password="+encodeURIComponent(t);n.open("POST","../login/form",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Orion-Version","1"),n.send(o)}}function v(){return document.getElementById("create_password").value!==document.getElementById("create_passwordRetype").value?(a("Passwords don't match!"),!1):(s(),!0)}function h(){document.getElementById("newUserHeaderShown").style.visibility="hidden",document.getElementById("orionOpen").style.visibility="",(R||B)&&(document.getElementById("orionRegister").style.visibility=""),document.getElementById("registerButton").focus()}function w(){if(!v())return document.getElementById("create_password").setAttribute("aria-invalid","true"),void document.getElementById("create_passwordRetype").setAttribute("aria-invalid","true");document.getElementById("create_password").setAttribute("aria-invalid","false"),document.getElementById("create_passwordRetype").setAttribute("aria-invalid","false");var e=new XMLHttpRequest,t=document.getElementById("create_login").value,n=document.getElementById("create_password").value,o=document.getElementById("create_email").value;e.onreadystatechange=function(){if(4===e.readyState)if(200!==e.status&&-1!==window.location.href.indexOf("http")){if(!e.responseText)return;var o=JSON.parse(e.responseText);a(o.Message),201===e.status&&h()}else y(t,n)};var i="login="+encodeURIComponent(t)+"&password="+encodeURIComponent(n)+"&email="+encodeURIComponent(o);e.open("POST","../users",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("Orion-Version","1"),e.send(i)}function E(e){if(m(e)){if(!R&&B)return void window.open(B);document.getElementById("orionOpen").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionLoginForm").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("newUserHeaderShown").style.visibility="",document.getElementById("create_login").focus()}}function b(){document.getElementById("orionRegister").style.visibility="hidden"}function I(){document.getElementById("orionLoginForm").style.visibility="hidden",R||B||(document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionReset").style.height="212px"),document.getElementById("newUserHeaderShown").style.display="none",document.getElementById("orionReset").style.visibility="",document.getElementById("reset").focus()}function S(){document.getElementById("orionLoginForm").style.visibility="",document.getElementById("newUserHeaderShown").style.display="",document.getElementById("orionReset").style.visibility="hidden"}function O(e){m(e)&&(o.stop(e),document.getElementById("orionOpen").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionLoginForm").style.visibility="",document.getElementById("login").focus())}function x(){document.getElementById("orionLoginForm").style.visibility="hidden",document.getElementById("orionOpen").style.visibility="",(R||B)&&(document.getElementById("orionRegister").style.visibility=""),document.getElementById("orionLogin").focus(),s()}function C(e){m(e)&&e.srcElement.click()}var R,B,L,k=!1;e(function(){p(document.getElementById("personaLogin"));var e=i("error");if(e){var n=r(e);a(n)}var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){var e=JSON.parse(s.responseText);R=e.CanAddUsers,L=e.ForceEmail,document.getElementById("create_email").setAttribute("aria-required",L),B=e.RegistrationURI,R||B||b(),document.getElementById("login-window").style.display="",document.getElementById("orionLogin").focus()}},s.open("POST","../login/canaddusers",!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.setRequestHeader("Orion-Version","1"),s.send();var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){var e=JSON.parse(d.responseText);e.emailConfigured===!1&&(document.getElementById("resetUserLink").style.display="none")}},d.open("POST","../useremailconfirmation/cansendemails",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.setRequestHeader("Orion-Version","1"),d.send(),t("GET","../server-status.json",{timeout:15e3}).then(function(e){var t=JSON.parse(e.response),n=t.messages;
if(n.length>0){var o=new Date,i=new Date(n[0].startdate);if(i.setHours(0,0,0,0),i>o)return;var r=new Date(n[0].enddate);if(r.setHours(23,59,59),o>=r)return;document.getElementById("orionInfoArea").style.visibility="",document.getElementById("orionInfoMessage").textContent=n[0].title}},function(){}),document.getElementById("login").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(y(),o.stop(e))}),document.getElementById("password").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(y(),o.stop(e))}),document.getElementById("loginButton").addEventListener("click",function(){y()}),document.getElementById("orionLoginForm").addEventListener("keyup",function(e){e.keyCode===o.KEY.ESCAPE&&(x(),o.stop(e))}),document.getElementById("resetUserLink").addEventListener("click",I),document.getElementById("reset").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(c(),o.stop(e))}),document.getElementById("resetEmail").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(c(),o.stop(e))}),document.getElementById("registerButton").addEventListener("click",E),document.getElementById("registerButton").addEventListener("keydown",E),document.getElementById("create_password").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():v()}),document.getElementById("create_passwordRetype").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():v()}),document.getElementById("newUserHeaderShown").addEventListener("keyup",function(e){e.keyCode===o.KEY.ESCAPE&&h()}),document.getElementById("createButton").addEventListener("click",w),document.getElementById("cancelLoginButton").addEventListener("click",x),document.getElementById("newUserHeaderShown").onkeyup=function(e){e.keyCode===o.KEY.ESCAPE&&h()},document.getElementById("hideRegisterButton").addEventListener("click",h),document.getElementById("googleLogin").href=f("https://www.google.com/accounts/o8/id"),document.getElementById("googleLogin").addEventListener("keydown",C),document.getElementById("orionLogin").addEventListener("click",O),document.getElementById("orionLogin").onkeydown=O,document.getElementById("personaLogin").onclick=g,document.getElementById("personaLogin").onkeydown=g,document.getElementById("cancelResetButton").onclick=S,document.getElementById("sendResetButton").onclick=c})});