!function(){function e(){for(var e=navigator.userAgent,t={browser:!1,version:!1},i=1,n=[{name:"Chrome/Chromium",regExp:/(?:chrome|crios|chromium)\/(\d+)/i,minVersion:24},{name:"Firefox",regExp:/firefox\/(\d+)/i,minVersion:17},{name:"Microsoft Internet Explorer",regExp:/msie\s(\d+)/i,minVersion:10},{name:"Microsoft Internet Explorer",regExp:/Trident\/(\d+)/i,minVersion:6},{name:"Safari",regExp:/version\/(\d+).*?safari/i,minVersion:6}],r=0;r<n.length;r++){var o=n[r],s=e.match(o.regExp);if(s){t.browser=!0,t.version=s[i]>=o.minVersion,t.name=o.name;break}}return t}function t(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}function i(e){throw alert(e),new Error("unsupported browser")}var n=e();if(n.browser)n.version||i("Sorry, your browser version is not supported.\n\nTo use Orion, please upgrade to the latest version of "+n.name+".\n");else if(t()&&!localStorage.skipBrowserCheck){if(!confirm("Sorry, your browser is not supported. The latest version of Chrome, Firefox or Safari web browser is recommended.\nContinue anyway?"))throw"unsupported browser";localStorage.skipBrowserCheck=1}else t()||i("Sorry, your browser is not supported.\n\nTo use Orion, the latest version of the Chrome, Firefox, or Safari web browser is recommended.\n");return{isSupportedBrowser:e,supportsLocalStorage:t,throwBrowserAlert:i}}(),define("orion/browserCompatibility",function(){}),function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=o.shift();)e();s=!1}function t(e){o.push(e),s||(s=!0,a())}function i(e){return function(t){e(t)}}function n(e,t,n){try{var r=e(t),o=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof o)if(r===n.promise)n.reject(new TypeError);else{var s=r.cancel;"function"==typeof s?n._parentCancel=s.bind(r):delete n._parentCancel,o.call(r,i(n.resolve),i(n.reject),i(n.progress))}else n.resolve(r)}catch(a){n.reject(a)}}function r(){function e(){for(var e;e=c.shift();){var t=e.deferred,i="fulfilled"===l?"resolve":"reject",r=e[i];"function"==typeof r?n(r,a,t):t[i](a)}}function i(i){delete d._parentCancel,l="rejected",a=i,c.length&&t(e)}function o(n){function s(e){return function(t){l&&"assumed"!==l||e(t)}}delete d._parentCancel;try{var h=n&&("object"==typeof n||"function"==typeof n)&&n.then;if("function"==typeof h)if(n===d)i(new TypeError);else{l="assumed";var u=n&&n.cancel;if("function"!=typeof u){var p=new r;n=p.promise;try{h(p.resolve,p.reject,p.progress)}catch(f){p.reject(f)}u=n.cancel,h=n.then}a=n,h.call(n,s(o),s(i)),d._parentCancel=u.bind(n)}else l="fulfilled",a=n,c.length&&t(e)}catch(m){s(i)(m)}}function s(){var e=d._parentCancel;if(e)delete d._parentCancel,e();else if(!l){var t=new Error("Cancel");t.name="Cancel",i(t)}}var a,l,c=[],d=this;this.resolve=function(e){return l||o(e),d},this.reject=function(e){return l||i(e),d},this.progress=function(e){return l||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(i){}}),d.promise},this.cancel=function(){return d._parentCancel?setTimeout(s,0):s(),d},this.then=function(i,n,o){var s=new r;return s._parentCancel=d.promise.cancel,c.push({resolve:i,reject:n,progress:o,deferred:s}),("fulfilled"===l||"rejected"===l)&&t(e),s.promise},this.promise={then:d.then,cancel:d.cancel}}var o=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var i=document.createElement("div"),n=new MutationObserver(e);return n.observe(i,{attributes:!0}),function(){i.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return r.all=function(e,t){function i(e,t){a||(s[e]=t,0===--o&&l.resolve(s))}function n(e,n){if(!a){if(t)try{return void i(e,t(n))}catch(r){n=r}l.reject(n)}}var o=e.length,s=[],a=!1,l=new r;return l.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===o?l.resolve(s):e.forEach(function(e,t){e.then(i.bind(void 0,t),n.bind(void 0,t))}),l.promise},r.when=function(e,t,i,n){var o,s;return e&&"function"==typeof e.then?o=e:(s=new r,s.resolve(e),o=s.promise),o.then(t,i,n)},r}),define("orion/EventTarget",[],function(){function e(){this._namedListeners={}}return e.prototype={dispatchEvent:function(e){if(!e.type)throw new Error("unspecified type");var t=this._namedListeners[e.type];return t&&t.forEach(function(t){try{"function"==typeof t?t(e):t.handleEvent(e)}catch(i){"undefined"!=typeof console&&console.log(i)}}),!e.defaultPrevented},addEventListener:function(e,t){("function"==typeof t||t.handleEvent)&&(this._namedListeners[e]=this._namedListeners[e]||[],this._namedListeners[e].push(t))},removeEventListener:function(e,t){var i=this._namedListeners[e];if(i)for(var n=0;n<i.length;n++)if(i[n]===t){1===i.length?delete this._namedListeners[e]:i.splice(n,1);break}}},e.prototype.constructor=e,e.attach=function(t){var i=new e;t.dispatchEvent=i.dispatchEvent.bind(i),t.addEventListener=i.addEventListener.bind(i),t.removeEventListener=i.removeEventListener.bind(i)},e}),define("orion/serviceregistry",["orion/Deferred","orion/EventTarget"],function(e,t){function i(e,t,i){this._properties=i||{},this._properties["service.id"]=e,this._properties.objectClass=t,this._properties["service.names"]=t}function n(e,t,i){this._serviceId=e,this._serviceReference=t,this._internalRegistry=i}function r(t,i){function n(n){return function(){var r;try{if(!i())throw new Error("Service was unregistered");var o=t[n].apply(t,Array.prototype.slice.call(arguments));if(o&&"function"==typeof o.then)return o;r=new e,r.resolve(o)}catch(s){r=new e,r.reject(s)}return r.promise}}var r;for(r in t)"function"==typeof t[r]&&(this[r]=n(r))}function o(e,t){this.type=e,this.serviceReference=t}function s(){this._entries=[],this._namedReferences={},this._serviceEventTarget=new t;var e=this;this._internalRegistry={isRegistered:function(t){return e._entries[t]?!0:!1},unregisterService:function(t){var i=e._entries[t];if(!i)throw new Error("Service has already been unregistered: "+t);var n=i.reference;e._serviceEventTarget.dispatchEvent(new o("unregistering",n)),e._entries[t]=null;var r=n.getProperty("objectClass");r.forEach(function(t){for(var i=e._namedReferences[t],r=0;r<i.length;r++)if(i[r]===n){1===i.length?delete e._namedReferences[t]:i.splice(r,1);break}})},modifyService:function(t){var i=e._entries[t];if(!i)throw new Error("Service not found while trying to send modified event: "+t);var n=i.reference;e._serviceEventTarget.dispatchEvent(new o("modified",n))}}}return i.prototype={getPropertyKeys:function(){var e,t=[];for(e in this._properties)this._properties.hasOwnProperty(e)&&t.push(e);return t},getProperty:function(e){return this._properties[e]}},i.prototype.constructor=i,n.prototype={unregister:function(){this._internalRegistry.unregisterService(this._serviceId)},getReference:function(){if(!this._internalRegistry.isRegistered(this._serviceId))throw new Error("Service has already been unregistered: "+this._serviceId);return this._serviceReference},setProperties:function(e){var t=this._serviceReference._properties;this._serviceReference._properties=e||{},e["service.id"]=this._serviceId,e.objectClass=t.objectClass,e["service.names"]=t["service.names"],this._internalRegistry.modifyService(this._serviceId)}},n.prototype.constructor=n,s.prototype={getService:function(e){var t;if("string"==typeof e){var i=this._namedReferences[e];i&&i.some(function(e){return t=this._entries[e.getProperty("service.id")].service,!!t},this)}else{var n=this._entries[e.getProperty("service.id")];n&&(t=n.service)}return t||null},getServiceReferences:function(e){if(e)return this._namedReferences[e]?this._namedReferences[e]:[];var t=[];return this._entries.forEach(function(e){e&&t.push(e.reference)}),t},registerService:function(e,t,s){if("undefined"==typeof t||null===t)throw new Error("invalid service");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var a=this._entries.length,l=new i(a,e,s),c=this._namedReferences;e.forEach(function(e){c[e]=c[e]||[],c[e].push(l)});var d=new r(t,this._internalRegistry.isRegistered.bind(null,a));this._entries.push({reference:l,service:d});var h=this._internalRegistry;return this._serviceEventTarget.dispatchEvent(new o("registered",l)),new n(a,l,h)},addEventListener:function(e,t){this._serviceEventTarget.addEventListener(e,t)},removeEventListener:function(e,t){this._serviceEventTarget.removeEventListener(e,t)}},s.prototype.constructor=s,{ServiceRegistry:s}}),define("orion/xhr",["orion/Deferred"],function(e){function t(e,t,i,n){var r,o="undefined"!=typeof i.response?i.response:i.responseText,s="string"==typeof o?o:null;try{r=i.status}catch(a){r=0}var l={args:t,response:o,responseText:s,status:r,url:e,xhr:i};return"undefined"!=typeof n&&(l.error=n),l}function i(i,n,r){r=r||{};var o,s=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,a=new e,l=r.headers||{},c=r.log||!1;"undefined"==typeof l["X-Requested-With"]&&(l["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof r.data||"POST"!==i&&"PUT"!==i||(o=r.data);var d=!1,h=!1;a.promise.then(void 0,function(e){d=!0,!h&&e instanceof Error&&"Cancel"===e.name&&s.abort()}),s.onabort=function(){if(h=!0,!d){var e=new Error("Cancel");e.name="Cancel",a.reject(e)}},s.onload=function(){var e=t(n,r,s);200<=s.status&&s.status<400?a.resolve(e):(a.reject(e),c&&"undefined"!=typeof console&&console.log(new Error(s.statusText)))},s.onerror=function(){var e=t(n,r,s);a.reject(e),c&&"undefined"!=typeof console&&console.log(new Error(s.statusText))},s.onprogress=function(e){e.xhr=s,a.progress(e)};try{if(s.open(i,n,!0),"string"==typeof r.responseType&&(s.responseType=r.responseType),"number"==typeof r.timeout)if("number"==typeof s.timeout)s.timeout=r.timeout,s.addEventListener("timeout",function(){a.reject(t(n,r,s,"Timeout exceeded"))});else{var u=setTimeout(function(){a.reject(t(n,r,s,"Timeout exceeded"))},r.timeout);a.promise.then(clearTimeout.bind(null,u),clearTimeout.bind(null,u))}Object.keys(l).forEach(function(e){s.setRequestHeader(e,l[e])}),s.send(o||null)}catch(p){a.reject(t(n,r,s,p))}return a.promise}return i}),define("orion/preferences",["require","orion/Deferred","orion/xhr"],function(e,t,i){function n(e,t){this._name=e,this._providers=t,this._flushPending=!1,this._cached=null,this._stores=[],this._pendingDeletes=[],this._dirty=[]}function r(e,t){return{get:function(i,n){if(0===t)return null;var r=localStorage.getItem(e+i);if(null===r)return null;var o=JSON.parse(r);return n||-1===t||o._expires&&o._expires>(new Date).getTime()?(delete o._expires,o):null},set:function(i,n){if(0!==t)if(-1!==t&&(n._expires=(new Date).getTime()+1e3*t),0===Object.keys(n).length)localStorage.removeItem(e+i);else{var r=JSON.stringify(n);localStorage.setItem(e+i,r),delete n._expires}},remove:function(t){localStorage.removeItem(e+t)}}}function o(e){this._currentPromises={},this._cache=new r("/orion/preferences/user",3600),this._service=null,this.available=function(){if(!this._service){var t=e.getServiceReferences("orion.core.preference.provider");t.length>0&&(this._service=e.getService(t[0]))}return!!this._service}}function s(e){this._location=e,this._currentPromise=null,this._cache=new r("/orion/preferences/default",3600)}function a(){this._cache=new r("/orion/preferences/local",-1)}function l(t,i){this._userProvider=new o(t),this._localProvider=new a,i=i||"defaults.pref",-1===i.indexOf("://")&&(i=e.toUrl(i)),this._defaultsProvider=new s(i),this._serviceRegistration=t.registerService("orion.core.preference",this)}return n.prototype={_flush:function(){for(var e=[],i=0;i<this._stores.length;++i){var n=this._stores[i];if(-1!==this._dirty.indexOf(n)&&e.push(this._providers[i].put(this._name,n)),this._pendingDeletes[i]&&this._pendingDeletes[i].length>0){for(var r=0;r<this._pendingDeletes[i].length;r++)e.push(this._providers[i].remove(this._name,this._pendingDeletes[i][r]));delete this._pendingDeletes[i]}}return this._dirty=[],t.all(e)},_scheduleFlush:function(e){e&&-1===this._dirty.indexOf(e)&&this._dirty.push(e),this._flushPending||(this._flushPending=!0,window.setTimeout(function(){this._flushPending&&(this._flushPending=!1,this._flush())}.bind(this),0))},_getCached:function(){if(!this._cached){this._cached={};for(var e=0;e<this._stores.length;++e){var t=this._stores[e];for(var i in t)t.hasOwnProperty(i)&&"undefined"==typeof this._cached[i]&&(this._cached[i]=t[i])}}return this._cached},keys:function(){return Object.keys(this._getCached())},get:function(e){var t=this._getCached();return t[e]},put:function(e,t){if(0!==this._stores.length){var i=this._stores[0];i[e]!==t&&(i[e]=t,this._cached=null,this._scheduleFlush(i))}},remove:function(e){for(var t=0;t<this._stores.length;++t){var i=this._stores[t];if(i.hasOwnProperty(e))return delete i[e],this._pendingDeletes[t]||(this._pendingDeletes[t]=[]),this._pendingDeletes[t].push(e),this._cached=null,this._scheduleFlush(),!0}return!1},clear:function(){for(var e=0;e<this._stores.length;++e)this._stores[e]={},this._scheduleFlush(this._stores[e]);this._cached=null},sync:function(e){if(this._flushPending)return this._flushPending=!1,this._flush();for(var i=this,n=[],r=0;r<this._providers.length;++r)n.push(this._providers[r].get(this._name,e).then(function(e){return function(t){i._stores[e]=t}}(r)));return t.all(n).then(function(){i._cached=null,i._getCached()})},flush:function(){this._flush()}},o.prototype={get:function(e,i){if(this._currentPromises[e])return this._currentPromises[e];var n=new t,r=null;if(i?this._cache.remove(e):r=this._cache.get(e),null!==r)n.resolve(r);else{this._currentPromises[e]=n;var o=this;this._service.get(e).then(function(t){o._cache.set(e,t),delete o._currentPromises[e],n.resolve(t)},function(t){if(404===t.status){var i={};o._cache.set(e,i),delete o._currentPromises[e],n.resolve(i)}else delete o._currentPromises[e],n.resolve(o._cache.get(e,!0)||{})})}return n},put:function(e,t){return this._cache.set(e,t),this._service.put(e,t)},remove:function(e,t){var i=this._cache.get(e);return delete i[t],this._cache.set(e,i),this._service.remove(e,t)}},s.prototype={get:function(e,n){if(this._currentPromise)return this._currentPromise;var r=new t,o=null;if(n?this._cache.remove(e):o=this._cache.get(e),null!==o)r.resolve(o);else{this._currentPromise=r;var s=this;i("GET",this._location,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(t){var i=JSON.parse(t.response);s._cache.set(e,i[e]||{}),s._currentPromise=null,r.resolve(i[e]||{})},function(t){if(401===t.xhr.status||404===t.xhr.status)s._cache.set(e,{}),s._currentPromise=null,r.resolve({});else{s._currentPromise=null;var i=s._cache.get(e,!0);r.resolve(null!==i?i[e]||{}:{})}})}return r},put:function(){var e=new t;return e.resolve(),e},remove:function(e,t){var i=this._cache.get(e);delete i[t],this.put(e,i)}},a.prototype={get:function(e){var i=new t,n=this._cache.get(e);return i.resolve(null!==n?n:{}),i},put:function(e,i){var n=new t;return this._cache.set(e,i),n.resolve(),n},remove:function(e,t){var i=this._cache.get(e);delete i[t],this.put(e,i)}},l.DEFAULT_SCOPE=1,l.LOCAL_SCOPE=2,l.USER_SCOPE=4,l.prototype={listenForChangedSettings:function(e,t,i){return(!t||"number"!=typeof t||t>7||1>t)&&(i=t,t=l.DEFAULT_SCOPE|l.LOCAL_SCOPE|l.USER_SCOPE),window.addEventListener("storage",i,!1),0!==(l.USER_SCOPE&t)?"/orion/preferences/user"+e:0!==(l.LOCAL_SCOPE&t)?"/orion/preferences/local"+e:"/orion/preferences/default"+e},getPreferences:function(e,t){(!t||"number"!=typeof t||t>7||1>t)&&(t=l.DEFAULT_SCOPE|l.LOCAL_SCOPE|l.USER_SCOPE);var i=[];l.USER_SCOPE&t&&this._userProvider.available()&&i.push(this._userProvider),l.LOCAL_SCOPE&t&&i.push(this._localProvider),l.DEFAULT_SCOPE&t&&i.push(this._defaultsProvider);var r=new n(e,i),o=r.sync().then(function(){return r});return o},getSetting:function(e,t,i){for(var n,r=0;r<e.length;r++)if(e[r].label===t)for(var o=0;o<e[r].data.length;o++)if(e[r].data[o].label===i){n=e[r].data[o].value;break}return n}},{PreferencesService:l}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function i(e){return 0===e.length?"":e.join("&")}function n(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),i=t[1]?decodeURIComponent(t[1]):"",n=t[2]?decodeURIComponent(t[2]):"";return[i,n]}function r(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function o(e,i){var r="",o=[],s=0;return{next:function(){if(r!==e.query&&(r=e.query,o=t(r)),s<o.length){var a=n(o[s++]);switch(i){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw T}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var i=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=i+e.path}}else e.path=t.path}function l(e){return e.toLowerCase()}function c(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function d(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function h(e){e.scheme&&(e.scheme=l(e.scheme)),e.port&&(e.port=c(e.port)),e.host&&e.path&&(e.path=d(e.path))}function u(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function p(e,t){if("string"!=typeof e)throw new TypeError;e=u(e);var i=y.exec(e);if(!i)return null;var n={};if(n.scheme=i[1]||"",n.scheme&&!C.test(n.scheme))return null;var r=i[2];if(r){var o=_.exec(r);if(n.userinfo=o[1],n.host=o[2],n.port=o[3],n.port&&!b.test(n.port))return null}return n.path=i[3],n.query=i[4],n.fragment=i[5],a(n,t),h(n),n}function f(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function m(e,t){var i;if(t){if(t=t.href||t,i=p(t),!i||!i.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:i})}var n=p(e,i);if(!n)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:n,writable:!0});var r=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?r:null},enumerable:!0})}try{var g;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(g=new window.URL("http://www.w3.org?q")).protocol&&g.query)return}catch(v){}var y=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,_=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,w=/^\S*$/,C=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,b=/^\d*$/,S=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,E=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,L=/^([^?#\s]*)$/,x=/^([^\s]*)$/,k=w,N=/([^:]*):?(.*)/,T="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),P={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(i){e(i);var r,o=t(this._url.query);return o.some(function(e){var t=n(e);return t[0]===i?(r=t[1],!0):void 0}),r},enumerable:!0},set:{value:function(o,s){e(o),e(s);var a=t(this._url.query),l=a.some(function(e,t){var i=n(e);return i[0]===o?(i[1]=s,a[t]=r(i),!0):void 0});l||a.push(r([o,s])),this._url.query=i(a)},enumerable:!0},has:{value:function(i){e(i);var r=t(this._url.query);return r.some(function(e){var t=n(e);return t[0]===i?!0:void 0})},enumerable:!0},"delete":{value:function(r){e(r);var o=t(this._url.query),s=o.filter(function(e){var t=n(e);return t[0]!==r});return s.length!==o.length?(this._url.query=i(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var i=o(this._url,"keys+values");try{for(;;){var n=i.next();e.call(t,n[1],n[0],this)}}catch(r){if(r!==T)throw r}},enumerable:!0},keys:{value:function(){return o(this._url,"keys")},enumerable:!0},values:{value:function(){return o(this._url,"values")},enumerable:!0},items:{value:function(){return o(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(i){e(i);var r=[],o=t(this._url.query);return o.forEach(function(e){var t=n(e);t[0]===i&&r.push(t[1])}),r},enumerable:!0},append:{value:function(n,o){e(n),e(o);var s=t(this._url.query);s.push(r([n,o])),this._url.query=i(s)},enumerable:!0}}),Object.defineProperties(m.prototype,{href:{get:function(){return this._url?f(this._url):this._input},set:function(t){e(t),this._input=t,this._url=p(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var i=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===i||C.test(i))&&(this._url.scheme=l(i))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=N.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var i=N.exec(this._userinfo),n=[encodeURIComponent(t||"")];i[2]&&n.push(i[2]),this._userinfo=n.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=N.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var i=N.exec(this._userinfo),n=[i[1]||""];t&&n.push(encodeURIComponent(t)),this._userinfo=n.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var i=E.exec(t);i&&(this._url.host=i[1],this._url.port=c(i[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var i=S.exec(t);i&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===P[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var i=b.exec(t);i&&(this._url.port=c(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var i=L.exec(t);i&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?d(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var i=x.exec(t);i&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var i=k.exec(t);i&&(this._url.fragment=t)}},enumerable:!0}});var R=window.URL||window.webkitURL;R&&R.createObjectURL&&(Object.defineProperty(m,"createObjectURL",{value:R.createObjectURL.bind(R),enumerable:!1}),Object.defineProperty(m,"revokeObjectURL",{value:R.revokeObjectURL.bind(R),enumerable:!1})),window.URL=m}(),define("orion/URL-shim",function(){}),define("orion/pluginregistry",["orion/Deferred","orion/EventTarget","orion/URL-shim"],function(e,t){function i(e,t){var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;i.sort(),n.sort();for(var r=0,o=i.length;o>r;r++){var s=i[r];if(s!==n[r])return!1;var a=e[s],l=t[s];if(a!==l&&JSON.stringify(a)!==JSON.stringify(l))return!1}return!0}function n(e){if(-1===e.indexOf("://"))try{return new URL(e,location.href).href}catch(t){}return e}function r(e){function t(){return i=i||Object.keys(e)}var i=null,n={key:function(e){return t()[e]},getItem:function(t){return e[t]},setItem:function(t,n){e[t]=n,i=null},removeItem:function(t){delete e[t],i=null},clear:function(){t().forEach(function(t){delete e[t]}.bind(this)),i=null}};return Object.defineProperty(n,"length",{get:function(){return t().length}}),n}function o(e,t){if(t&&t instanceof XMLHttpRequest){var i,n;try{i=t.status,n=t.statusText}catch(r){i=0,n=""}return{status:i||0,statusText:n}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,o)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(e,t){this.type=e,this.plugin=t}function l(e,t){this.__objectId=e,this.__methods=t}function c(n,r,o){function c(e){C&&o.postMessage(e,C)}function d(t){if(!C)return(new e).reject(new Error("plugin not connected"));t.id=String(R++);var i=new e;O[t.id]=i,i.then(null,function(e){"active"===T&&e instanceof Error&&"Cancel"===e.name&&c({requestId:t.id,method:"cancel",params:e.message?[e.message]:[]})});var n=Object.prototype.toString;return t.params.forEach(function(e,r){if("[object Object]"===n.call(e)&&!(e instanceof l)){var o,s;for(o in e)"[object Function]"===n.call(e[o])&&(s=s||[],s.push(o));if(s){var a=I++;F[a]=e;var c=function(){delete F[a]};i.then(c,c),t.params[r]=new l(a,s)}}}),o.postMessage(t,C),i.promise}function h(e,t){e||0===e?c({id:e,result:null,error:t}):console.log(t)}function u(e,t,i,n){n.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var i={};e.__methods.forEach(function(t){i[t]=function(){return d({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),n[t]=i}});var r=void 0===typeof e?null:{id:e,result:null,error:null};try{var o=i.apply(t,n);if(!r)return;o&&"function"==typeof o.then?(A[e]=o,o.then(function(t){delete A[e],r.result=t,c(r)},function(t){A[e]&&(delete A[e],r.error=s(t),c(r))},function(){c({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(r.result=o,c(r))}catch(a){r&&(r.error=s(a),c(r))}}function p(e){try{if(e.method){var t=e.method,i=e.params||[];if("serviceId"in e){var n=M[e.serviceId];n||h(e.id,"service not found"),t in n?u(e.id,n,n[t],i):h(e.id,"method not found")}else if("objectId"in e){var r=F[e.objectId];r||h(e.id,"object not found"),t in r?u(e.id,r,r[t],i):h(e.id,"method not found")}else if("requestId"in e){var s=A[e.requestId];s&&"cancel"===t&&s.cancel&&s.cancel.apply(s,i)}else if("responseId"in e){var a=O[e.responseId];a&&"progress"===t&&a.progress&&a.progress.apply(a,i)}else if("plugin"===e.method){var l=e.params[0];S({headers:l.headers,services:l.services}).then(function(){w&&w.resolve(y)})}else{if("timeout"!==e.method)throw new Error("Bad method: "+e.method);w&&w.reject(e.error)}}else{var c=O[String(e.id)];if(delete O[String(e.id)],e.error){var d=o.handleServiceError(y,e.error);c.reject(d)}else c.resolve(e.result)}}catch(p){console.log("Plugin._messageHandler "+p)}}function f(e){var i={};if(e.methods&&(e.methods.forEach(function(t){i[t]=function(){var i={serviceId:e.serviceId,method:t,params:Array.prototype.slice.call(arguments)};return"active"===T?d(i):y.start({"transient":!0}).then(function(){return d(i)})}}),i.addEventListener&&i.removeEventListener)){var n=new t,r=I++;F[r]={handleEvent:n.dispatchEvent.bind(n)};var o=new l(r,["handleEvent"]),s=i.addEventListener;i.addEventListener=function(e,t){n._namedListeners[e]||s(e,o),n.addEventListener(e,t)};var a=i.removeEventListener;i.removeEventListener=function(e,t){n.removeEventListener(e,t),n._namedListeners[e]||a(e,o)}}return i}function m(e){var t=JSON.parse(JSON.stringify(e.properties));t.__plugin__=n;var i=e.names||e.type||[];return Array.isArray(i)||(i=[i]),t.objectClass=i,t}function g(e){var t=f(e),i=m(e),n=o.registerService(e.names||e.type,t,i);P[e.serviceId]={registration:n,proxy:t}}function v(){o.persist(n,{created:E,headers:L,services:x,autostart:k,lastModified:N})}var y=this;r=r||{};var _,w,C,b,S,E=r.created||(new Date).getTime(),L=r.headers||{},x=r.services||[],k=r.autostart,N=r.lastModified||0,T="installed",P={},R=0,I=0,A={},O={},F={},M={};this._persist=v,this._resolve=function(){T="resolved",o.dispatchEvent(new a("resolved",y))},this._getAutostart=function(){return k},this._getCreated=function(){return E},this.getLocation=function(){return n},this.getHeaders=function(){return JSON.parse(JSON.stringify(L))},this.getName=function(){var e=this.getHeaders();return e?e.name||"":null},this.getVersion=function(){var e=this.getHeaders();return e?e.version||"0.0.0":null},this.getLastModified=function(){return N},this.getServiceReferences=function(){var e=[];return Object.keys(P).forEach(function(t){e.push(P[t].registration.getReference())}),e},this.setParent=function(t){return b!==t?(b=t,y.stop({"transient":!0}).then(function(){return"started"===k?y.start({"transient":!0}):"lazy"===k?y.start({lazy:!0,"transient":!0}):void 0})):(new e).resolve()},this.getState=function(){return T},this.start=function(t){if("uninstalled"===T)return(new e).reject(new Error("Plugin is uninstalled"));if(_)return _.promise.then(this.start.bind(this,t));if("active"===T)return(new e).resolve();if(!t||!t.transient){var i=t&&t.lazy?"lazy":"started";i!==k&&(k=i,v())}var r=o.getState();if("starting"!==r&&"active"!==r)return t.transient?(new e).reject(new Error("start transient error")):(new e).resolve();if("installed"===T)try{this._resolve()}catch(s){return(new e).reject(s)}if("resolved"===T&&x.forEach(function(e){g(e)}),t&&t.lazy)return"starting"!==T&&(T="starting",o.dispatchEvent(new a("lazy activation",y))),(new e).resolve();var l=new e;return _=l,T="starting",o.dispatchEvent(new a("starting",y)),w=new e,C=o.connect(n,p,b),w.then(function(){w=null,T="active",o.dispatchEvent(new a("started",y)),_=null,l.resolve()},function(){w=null,T="stopping",o.dispatchEvent(new a("stopping",y)),Object.keys(P).forEach(function(e){P[e].registration.unregister(),delete P[e]}),o.disconnect(C),C=null,T="resolved",_=null,o.dispatchEvent(new a("stopped",y)),l.reject(new Error("plugin activation error"))}),l.promise},this.stop=function(t){if("uninstalled"===T)return(new e).reject(new Error("Plugin is uninstalled"));if(_)return _.promise.then(this.stop.bind(this,t));if(t&&t.transient||"stopped"!==k&&(k="stopped",v()),"active"!==T&&"starting"!==T)return(new e).resolve();var i=new e;return _=i,T="stopping",o.dispatchEvent(new a("stopping",y)),Object.keys(P).forEach(function(e){P[e].registration.unregister(),delete P[e]}),C&&(o.disconnect(C),C=null),T="resolved",_=null,o.dispatchEvent(new a("stopped",y)),i.resolve(),i.promise},S=function(t){if("uninstalled"===T)return(new e).reject(new Error("Plugin is uninstalled"));if(!t)return 0===N&&(N=(new Date).getTime(),v()),o.loadManifest(n).then(S);var r=L,s=x,l=k;if(L=t.headers||{},x=t.services||{},k=t.autostart||k,t.lastModified?N=t.lastModified:(N=(new Date).getTime(),v()),i(L,r)&&i(x,s)&&k===l)return(new e).resolve();if("active"===T||"starting"===T){var c=[];Object.keys(x).forEach(function(e){var t=x[e];c.push(e);var n=P[e];if(n){if(i(t.methods,Object.keys(n.proxy))){var r=m(t),o=n.registration.getReference(),s={};return o.getPropertyKeys().forEach(function(e){s[e]=o.getProperty(e)}),void(i(r,s)||n.registration.setProperties(r))}n.registration.unregister(),delete P[e]}g(t)}),Object.keys(P).forEach(function(e){-1===c.indexOf(e)&&(P[e].registration.unregister(),delete P[e])})}return"active"===T&&(o.disconnect(C),w=new e,C=o.connect(n,p,b),w.then(function(){w=null},function(){w=null,T="stopping",o.dispatchEvent(new a("stopping"),y),Object.keys(P).forEach(function(e){P[e].registration.unregister(),delete P[e]}),o.disconnect(C),C=null,T="resolved",o.dispatchEvent(new a("stopped",y))})),(new e).resolve()},this.update=function(e){return S(e).then(function(){o.dispatchEvent(new a("updated",y))})},this.uninstall=function(){return"uninstalled"===T?(new e).reject(new Error("Plugin is uninstalled")):"active"===T||"starting"===T||"stopping"===T?this.stop().then(this.uninstall.bind(this),this.uninstall.bind(this)):(o.removePlugin(this),T="uninstalled",o.dispatchEvent(new a("uninstalled",y)),(new e).resolve())}}function d(i,o){function s(e){var t=e.source;f.some(function(i){if(t===i.target){try{var n;if("undefined"==typeof i.useStructuredClone){var r="string"!=typeof e.data;n=r?e.data:JSON.parse(e.data),i.useStructuredClone=r
}else n=i.useStructuredClone?e.data:JSON.parse(e.data);i.handler(n)}catch(o){}return!0}})}o=o||{};var l=o.storage||localStorage;l.getItem||(l=r(l));var d,u="installed",p=[],f=[],m=new t,g={},v={registerService:i.registerService.bind(i),connect:function(e,t,i,n){function r(e){var i=new Error(e);i.name="timeout",t({method:"timeout",error:i})}var o={handler:t,url:e},s=setTimeout(r.bind(null,"Load timeout for: "+e),n||15e3),a=document.createElement("iframe");return a.name=e+"_"+(new Date).getTime(),a.src=e,a.onload=function(){clearTimeout(s),s=setTimeout(r.bind(null,"Plugin handshake timeout for: "+e),5e3)},a.sandbox="allow-scripts allow-same-origin",a.style.width=a.style.height="100%",a.frameBorder=0,(i||d).appendChild(a),o.target=a.contentWindow,o.close=function(){if(clearTimeout(s),a){var e=a.parentNode;e&&e.removeChild(a),a=null}},f.push(o),o},disconnect:function(e){for(var t=0;t<f.length;t++)if(e===f[t]){f.splice(t,1);try{e.close()}catch(i){}break}},removePlugin:function(e){for(var t=0;t<p.length;t++)if(e===p[t]){p.splice(t,1);break}l.removeItem("plugin."+e.getLocation())},persist:function(e,t){l.setItem("plugin."+e,JSON.stringify(t))},postMessage:function(e,t){t.target.postMessage(t.useStructuredClone?e:JSON.stringify(e),t.url)},dispatchEvent:function(e){try{m.dispatchEvent(e)}catch(t){console&&console.log("PluginRegistry.dispatchEvent "+t)}},loadManifest:function(t){var i=new e,n=v.connect(t,function(e){if(n&&e.method)if("manifest"===e.method||"plugin"===e.method){var t=e.params[0];v.disconnect(n),n=null,i.resolve(t)}else"timeout"===e.method&&(v.disconnect(n),n=null,i.reject(e.error))});return i.promise},getState:function(){return u},handleServiceError:function(e,t){if(t&&401===t.status){var i=e.getHeaders(),n=e.getName()||e.getLocation(),r=document.createElement("span");if(r.appendChild(document.createTextNode("Authentication required for: "+n+".")),i.login){r.appendChild(document.createTextNode(" "));var o=document.createElement("a");o.target="_blank",o.textContent="Login",o.href=i.login,h.test(o.href)?(r.appendChild(o),r.appendChild(document.createTextNode(" and re-try the request."))):console.log("Illegal Login URL: "+i.login)}var s=new XMLSerializer;return{Severity:"Error",HTML:!0,Message:s.serializeToString(r)}}if(t.__isError){var a=t;t=new Error(a.message),Object.keys(a).forEach(function(e){t[e]=a[e]}),delete t.__isError}return t}};this.getLocation=function(){return"System"},this.getHeaders=function(){return{}},this.getName=function(){return"System"},this.getVersion=function(){return"0.0.0"},this.getLastModified=function(){return 0},this.getState=v.getState,this.init=function(){if("starting"!==u&&"active"!==u&&"stopping"!==u){addEventListener("message",s,!1);for(var e=[],t=0,i=l.length;i>t;t++)e.push(l.key(t));e.forEach(function(e){if(0===e.indexOf("plugin.")){var t=e.substring("plugin.".length),i=JSON.parse(l.getItem(e));i.created&&p.push(new c(t,i,v))}}),p.sort(function(e,t){return e._getCreated()<t._getCreated()?-1:1}),o.parent?d=o.parent:(d=document.createElement("div"),o.visible||(d.style.display="none",d.style.visibility="hidden"),document.body.appendChild(d)),o.plugins&&Object.keys(o.plugins).forEach(function(e){e=n(e);var t=this.getPlugin(e);if(!t){var i=o.plugins[e];"object"!=typeof i&&(i={}),i.autostart=i.autostart||o.defaultAutostart||"lazy",p.push(new c(e,i,v))}}.bind(this)),u="starting"}},this.start=function(){if("starting"!==u&&this.init(),"starting"!==u)return(new e).reject("Cannot start framework. Framework is already "+u+".");var t=[],i=(new Date).getTime();return p.forEach(function(e){var n=e._getAutostart();return 0===e.getLastModified()?void t.push(e.update().then(function(){return"started"===n?e.start({"transient":!0}):"lazy"===n?e.start({lazy:!0,"transient":!0}):void e._resolve()})):void("started"===n?t.push(e.start({"transient":!0})):"lazy"===n?(t.push(e.start({lazy:!0,"transient":!0})),i>e.getLastModified()+864e5&&e.update()):e._resolve())}),e.all(t,function(e){console.log("PluginRegistry.stop "+e)}).then(function(){u="active"})},this.stop=function(){if("starting"!==u&&"active"!==u)return(new e).reject("Cannot stop registry. Registry is already "+u+".");u="stopping";var t=[];return p.forEach(function(e){t.push(e.stop({"transient":!0}))}),e.all(t,function(e){console.log("PluginRegistry.stop "+e)}).then(function(){if(!o.parent){var e=d.parentNode;e&&e.removeChild(d)}d=null,removeEventListener("message",s),u="resolved"})},this.update=function(){this.stop().then(this.start.bind(this))},this.uninstall=function(){return(new e).reject("Cannot uninstall registry")},this.installPlugin=function(t,i){t=n(t);var r=this.getPlugin(t);if(r)return(new e).resolve(r);if(g[t])return g[t];if(i)return r=new c(t,i,v),p.push(r),r._persist(),v.dispatchEvent(new a("installed",r)),(new e).resolve(r);var o=v.loadManifest(t).then(function(e){return r=new c(t,e,v),p.push(r),r._persist(),delete g[t],v.dispatchEvent(new a("installed",r)),r},function(e){throw delete g[t],e});return g[t]=o,o},this.getPlugins=function(){return p.slice()},this.getPlugin=function(e){var t=null;return e=n(e),p.some(function(i){return e===i.getLocation()?(t=i,!0):void 0}),t},this.addEventListener=m.addEventListener.bind(m),this.removeEventListener=m.removeEventListener.bind(m),this.resolvePlugins=function(){var e=!0;return p.forEach(function(t){e=e&&t._resolve()}),e}}var h=new RegExp("^http[s]?","i");return{Plugin:c,PluginRegistry:d}}),define("orion/objects",[],function(){function e(e){for(var t=Object.prototype.hasOwnProperty,i=1,n=arguments.length;n>i;i++){var r=arguments[i];for(var o in r)t.call(r,o)&&(e[o]=r[o])}return e}return{clone:function(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var i=Object.create(Object.getPrototypeOf(t));return e(i,t),i},mixin:e,toArray:function(e){return Array.isArray(e)?e:[e]}}}),define("orion/serviceTracker",[],function(){function e(e,n){function r(e){var t=e.getProperty("service.id"),i=this.addingService(e);i&&(c[t]=e,d[t]=i)}function o(e){var t=e.getProperty("service.id"),i=d[t];delete c[t],delete d[t],this.removedService(e,i)}function s(e){return-1!==e.getProperty("objectClass").indexOf(n)}this.serviceRegistry=e;var a,l,c={},d={},h=t;this.close=function(){if(h!==i)throw"Already closed";h=t,e.removeEventListener("registered",a),e.removeEventListener("unregistering",l),a=null,l=null;var n=this;this.getServiceReferences().forEach(function(e){o.call(n,e)}),"function"==typeof this.onClose&&this.onClose()},this.getServiceReferences=function(){var e=Object.keys(c);return e.length?e.map(function(e){return c[e]}):null},this.open=function(){if(h!==t)throw"Already open";h=i;var c=this;a=function(e){return s(e.serviceReference)&&(r.call(c,e.serviceReference),"function"==typeof c.onServiceAdded)?c.onServiceAdded(e.serviceReference,c.serviceRegistry.getService(e.serviceReference)):void 0},l=function(e){s(e.serviceReference)&&o.call(c,e.serviceReference)},e.addEventListener("registered",a),e.addEventListener("unregistering",l),e.getServiceReferences(n).forEach(function(t){return r.call(c,t),"function"==typeof c.onServiceAdded?c.onServiceAdded(t,e.getService(t)):void 0}),"function"==typeof this.onOpen&&this.onOpen()}}var t=0,i=1;return e.prototype={addingService:function(e){return this.serviceRegistry.getService(e)},onOpen:null,onClose:null,onServiceAdded:null,removedService:function(){}},e}),define("orion/config",["orion/Deferred","orion/objects","orion/preferences","orion/serviceTracker"],function(e,t,i,n){var r,o,s,a,l,c=i.PreferencesService,d=c.DEFAULT_SCOPE,h="pid",u="orion.cm.managedservice",p="/cm/configurations";return r=function(t,i,r){function o(e,t,i){d[e]||(d[e]=[]),p[e]||(p[e]=[]),d[e].push(t),p[e].push(i)}function s(e,t,i){var n=d[e],r=p[e];n.length>1?n.splice(n.indexOf(t),1):delete d[e],r.length>1?r.splice(r.indexOf(i),1):delete p[e]}function a(e){return d[e]||[]}function l(e){return p[e]||[]}function c(e,t,n){t.forEach(function(r,o){try{var s=e[o].getProperty("__plugin__"),a=s&&i.getPlugin(s);(!s||a&&"active"===a.getState())&&t[o].updated(n)}catch(l){"undefined"!=typeof console&&console.log(l)}})}n.call(this,t,u);var d={},p={},f=function(i){var n=[];return i.plugin.getServiceReferences().forEach(function(e){if(-1!==e.getProperty("objectClass").indexOf(u)){var i=e.getProperty(h),o=t.getService(e);if(i&&o){var s=r._find(i),a=s&&s.getProperties();n.push(o.updated(a))}}}),e.all(n)};this.addingService=function(e){var i=e.getProperty(h),n=t.getService(e);return i&&n?(o(i,e,n),n):null},this.onServiceAdded=function(e,t){var i=e.getProperty(h),n=r._find(i);c([e],[t],n&&n.getProperties())},this.onOpen=function(){i.addEventListener("started",f)},this.onClose=function(){i.removeEventListener("started",f)},this.notifyUpdated=function(e){var t=e.getPid();c(a(t),l(t),e.getProperties())},this.notifyDeleted=function(e){var t=e.getPid();c(a(t),l(t),null)},this.removedService=function(e,t){var i=e.getProperty(h);s(i,e,t)}},o=function(){function e(e,t,i){this.store=new s(this,i),this.configAdmin=new a(this,this.store),this.tracker=new r(e,t,this.store)}return e.prototype={getConfigurationAdmin:function(){var e=this;return this.configAdmin._init().then(function(t){return e.tracker.open(),t})},notifyDeleted:function(e){this.tracker.notifyDeleted(e)},notifyUpdated:function(e){this.tracker.notifyUpdated(e)}},e}(),a=function(){function e(e,t){this.factory=e,this.store=t}return e.prototype={_prefName:p,_init:function(){var e=this;return this.store._init().then(function(){return e})},getConfiguration:function(e){return this.store.get(e)},getDefaultConfiguration:function(e){return this.store._find(e,d)},listConfigurations:function(){return this.store.list()}},e}(),s=function(){function t(t,i){this.factory=t,this.prefsService=i,this.configs=this.defaultConfigs=null,this.pref=null;var n=this;this.initPromise=e.all([this.prefsService.getPreferences(p,d),this.prefsService.getPreferences(p)]).then(function(e){var t=e[0];n.pref=e[1],n.defaultConfigs=n._toConfigs(t,!0),n.configs=n._toConfigs(n.pref,!1,t)})}return t.prototype={_toConfigs:function(e,t,i){var n=Object.create(null),r=this;return e.keys().forEach(function(o){if(!n[o]){var s=e.get(o),a=i&&i.get(o);"object"==typeof s&&null!==s&&Object.keys(s).length>0&&(s[h]=o,n[o]=new l(r.factory,r,s,t,a))}}),n},_init:function(){return this.initPromise},_find:function(e,t){return t===c.DEFAULT_SCOPE?this.defaultConfigs[e]||null:this.configs[e]||null},get:function(e){var t=this._find(e),i=this._find(e,d);if(!t){var n=i&&i.getProperties(!0);t=new l(this.factory,this,e,!1,n),this.configs[e]=t}return t},list:function(){var e=this,t=[];return this.pref.keys().forEach(function(i){var n=e._find(i);n&&null!==n.getProperties()&&t.push(n)}),t},remove:function(e){this.pref.remove(e),delete this.configs[e]},save:function(e,t){var i=t.getProperties(!0)||{},n=this._find(e,d);if(n){var r=n.getProperties(!0);Object.keys(r).forEach(function(e){Object.prototype.hasOwnProperty.call(i,e)&&i[e]===r[e]&&delete i[e]})}this.pref.put(e,i)}},t}(),l=function(){function e(e,i){i=t.clone(i),delete i[h],e.properties=i}function i(t,i,n,r,o){if(this.factory=t,this.store=i,this.readOnly=r,null!==n&&"object"==typeof n)this.pid=n[h],e(this,n);else{if("string"!=typeof n)throw new Error("Invalid pid/properties "+n);this.pid=n,this.properties=null}if(o){var s=this;Object.keys(o).forEach(function(e){e===h||Object.prototype.hasOwnProperty.call(s.properties,e)||(s.properties[e]=o[e])})}}return i.prototype={_checkReadOnly:function(){if(this.readOnly)throw new Error("Configuration is read only")},_checkRemoved:function(){if(this.removed)throw new Error("Configuration was removed")},getPid:function(){return this._checkRemoved(),this.pid},getProperties:function(e){this._checkRemoved();var i=null;return this.properties&&(i=t.clone(this.properties),e||(i[h]=this.pid)),i},remove:function(){this._checkReadOnly(),this._checkRemoved(),this.factory.notifyDeleted(this),this.store.remove(this.pid),this.removed=!0},update:function(t){this._checkReadOnly(),this._checkRemoved(),e(this,t),this.store.save(this.pid,this),this.factory.notifyUpdated(this)},toString:function(){return"[ConfigImpl pid: "+this.pid+", properties: "+JSON.stringify(this.properties)+"]"}},i}(),{ConfigurationAdminFactory:o}}),define("orion/bootstrap",["require","orion/Deferred","orion/serviceregistry","orion/preferences","orion/pluginregistry","orion/config"],function(e,t,i,n,r,o){function s(){if(a)return a;a=new t;var s=new i.ServiceRegistry,l=new n.PreferencesService(s);return l.getPreferences("/plugins").then(function(i){var n={plugins:{}};i.keys().forEach(function(t){var r=e.toUrl(t);n.plugins[r]=i[t]});var c=new r.PluginRegistry(s,n);return c.start().then(function(){return s.getServiceReferences("orion.core.preference.provider").length>0?l.getPreferences("/plugins",l.USER_SCOPE).then(function(i){var n=[];return i.keys().forEach(function(t){var i=e.toUrl(t);c.getPlugin(i)||n.push(c.installPlugin(i,{autostart:"lazy"}).then(function(e){return e.update().then(function(){return e.start({lazy:!0})})}))}),t.all(n,function(e){console.log(e)})}):void 0}).then(function(){return new o.ConfigurationAdminFactory(s,c,l).getConfigurationAdmin().then(s.registerService.bind(s,"orion.cm.configadmin"))}).then(function(){var e=s.getService("orion.core.auth");if(e){var t=e.getUser().then(function(t){return t?void localStorage.setItem("lastLogin",(new Date).getTime()):e.getAuthForm(window.location.href).then(function(e){setTimeout(function(){window.location=e},0)})}),i=localStorage.getItem("lastLogin");if(!i||i<(new Date).getTime()-9e5)return t}}).then(function(){var e={serviceRegistry:s,preferences:l,pluginRegistry:c};return a.resolve(e),e})})}var a;return{startup:s}}),function(){function e(e,t,i,n,r,o){t[e]&&(i.push(e),(t[e]===!0||1===t[e])&&n.push(r+e+"/"+o))}function t(e,t,i,n,r){var o=n+t+"/"+r;require._fileExists(e.toUrl(o+".js"))&&i.push(o)}function i(e,t,n){var r;for(r in t)!t.hasOwnProperty(r)||e.hasOwnProperty(r)&&!n?"object"==typeof t[r]&&i(e[r],t[r],n):e[r]=t[r]}var n=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(r){var o=r.config?r.config():{};return o=o||{},{version:"2.0.1+",load:function(r,s,a,l){l=l||{},l.locale&&(o.locale=l.locale);var c,d,h,u=n.exec(r),p=u[1],f=u[4],m=u[5],g=f.split("-"),v=[],y={},_="";if(u[5]?(p=u[1],c=p+m):(c=r,m=u[4],f=o.locale,f||(f=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=f.split("-")),l.isBuild){for(v.push(c),t(s,"root",v,p,m),d=0;d<g.length;d++)h=g[d],_+=(_?"-":"")+h,t(s,_,v,p,m);s(v,function(){a()})}else s([c],function(t){var n,r=[];for(e("root",t,r,v,p,m),d=0;d<g.length;d++)n=g[d],_+=(_?"-":"")+n,e(_,t,r,v,p,m);s(v,function(){var e,n,o;for(e=r.length-1;e>-1&&r[e];e--)o=r[e],n=t[o],(n===!0||1===n)&&(n=s(p+o+"/"+m)),i(y,n);a(y)})})}}})}(),define("orion/i18n",[],function(){return{load:function(e,t,i,n){n=n||{};var r=/(^.*(?:^|\/)nls(?:\/|$))([^\/]*)\/?([^\/]*)/,o=r.exec(e);if(!o)return void i(null);if(!t.defined||t.defined(e))try{return void i(t(e))}catch(s){}if(n.isBuild||n.isTest)return void i({});if(t.specified&&!t.specified("orion/bootstrap"))return void i({});var a=o[1],l=o[3]?o[2]:"",c=o[3]||o[2];t(["orion/bootstrap"],function(s){s.startup().then(function(s){var d=s.serviceRegistry,h=d.getServiceReferences("orion.i18n.message");if(l){var u=h.some(function(t){return e===t.getProperty("name")?(d.getService(t).getMessageBundle().then(function(e){i(e)},function(){i({})}),!0):!1});u||i({})}else{var p,f={};h.forEach(function(e){var i=e.getProperty("name");if((o=r.exec(i))&&a===o[1]&&c===(o[3]||o[2]))if(l=o[3]?o[2]:""){var s=n.locale||("undefined"!=typeof navigator?navigator.language||navigator.userLanguage:null);if(!s||0!==s.toLowerCase().indexOf(l.toLowerCase()))return;f[l]=!0,t.specified&&t.specified(i)||define(i,["orion/i18n!"+i],function(e){return e})}else p=e}),t.specified&&t.specified(e)?i(f):p?d.getService(p).getMessageBundle().then(function(t){Object.keys(f).forEach(function(e){"undefined"==typeof t[e]&&(t[e]=f[e])}),define(e,[],t),i(t)},function(){define(e,[],f),i(f)}):(define(e,[],f),i(f))}})})}}}),define("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Workspace Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Show Workspace",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer","Orion Markdown Editor":"Orion Markdown Editor","Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor","View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.","Show a list of all the keybindings on this page":"Show a list of all the keybindings on this page","Show Keys":"Show Keys","Hide or show the page banner and footer":"Hide or show the page banner and footer","Toggle banner and footer":"Toggle banner and footer","Choose a file by name and open an editor on it":"Choose a file by name and open an editor on it","Find File Named...":"Find File Named...","System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item","Can't search: no search service is available":"Can't search: no search service is available","could not find banner parent, id was ":"could not find banner parent, id was ",Related:"Related",Options:"Options",FAQ:"FAQ","Report a Bug":"Bugs","Privacy Policy":"Privacy","Terms of Use":"Terms","Copyright Agent":"Copyright","Orion Logo":"Orion Logo","Orion is in Beta. Please try it out but BEWARE your data may be lost.":"@buildLabel@","LOG: ":"LOG: ",View:"View","no parent":"no parent","no tree model":"no tree model","no renderer":"no renderer","could not find table row ":"could not find table row ","Resource is out of sync with the server. Do you want to save it anyway?":"Resource is out of sync with the server. Do you want to save it anyway?",Operations:"Operations","Operations running":"Operations running","Some operations finished with warning":"Some operations finished with warning","Some operations finished with error":"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",More:"More","Recent searches":"Recent searches","Regular expression":"Regular expression","Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification","Operations - Press spacebar to show current operations":"Operations - Press spacebar to show current operations","Type a keyword or wild card to search in root":"Type a keyword or wild card to search in root","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site","Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.","Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",UnknownError:"An unknown error occurred.",UnknownWarning:"An unknown warning occurred.",Filter:"Filter (* = any string, ? = any character)","To view the browser's context menu, trigger the context menu again.":"To view the browser's context menu, trigger the context menu again.",Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu"}),define("orion/nls/messages",["orion/i18n!orion/nls/messages","orion/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/util",[],function(){function e(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,i){return t[(i<<0)+1]})}function t(e,t){return e.createElementNS?e.createElementNS(y,t):e.createElement(t)}var i=navigator.userAgent,n=-1!==i.indexOf("MSIE")||-1!==i.indexOf("Trident")?document.documentMode:void 0,r=parseFloat(i.split("Firefox/")[1]||i.split("Minefield/")[1])||void 0,o=-1!==i.indexOf("Opera")?parseFloat(i.split("Version/")[1]):void 0,s=parseFloat(i.split("Chrome/")[1])||void 0,a=-1!==i.indexOf("Safari")&&!s,l=parseFloat(i.split("WebKit/")[1])||void 0,c=-1!==i.indexOf("Android"),d=-1!==i.indexOf("iPad"),h=-1!==i.indexOf("iPhone"),u=d||h,p=-1!==navigator.platform.indexOf("Mac"),f=-1!==navigator.platform.indexOf("Win"),m=-1!==navigator.platform.indexOf("Linux"),g="undefined"!=typeof document&&"ontouchstart"in document.createElement("input"),v=f?"\r\n":"\n",y="http://www.w3.org/1999/xhtml";return{formatMessage:e,createElement:t,isIE:n,isFirefox:r,isOpera:o,isChrome:s,isSafari:a,isWebkit:l,isAndroid:c,isIPad:d,isIPhone:h,isIOS:u,isMac:p,isWindows:f,isLinux:m,isTouch:g,platformDelimiter:v}}),define("orion/webui/littlelib",["orion/util"],function(e){function t(e,t){return t||(t=document),t.querySelector(e)}function i(e,t){return t||(t=document),t.querySelectorAll(e)}function n(e,t){return Array.prototype.slice.call(i(e,t))}function r(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function o(e,t){if(!e||!t)return!1;if(e===t)return!0;var i=e.compareDocumentPosition(t);return Boolean(16&i)}function s(e){var t=e.getBoundingClientRect();return{left:t.left+document.documentElement.scrollLeft,top:t.top+document.documentElement.scrollTop,width:t.width,height:t.height}}function a(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}}function l(t){var i=t.tabIndex;if(0===i&&e.isIE){var n={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0};n[t.nodeName.toLowerCase()]||t.attributes.tabIndex||(i=-1)}return i}function c(e){if(l(e)>=0)return e;if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var i=c(e.childNodes[t]);if(i)return i}return null}function d(e){if(l(e)>=0)return e;if(e.hasChildNodes())for(var t=e.childNodes.length-1;t>=0;t--){var i=d(e.childNodes[t]);if(i)return i}return null}function h(e,t){if(3===e.nodeType){var i=y.exec(e.nodeValue);i&&i.length>1&&t(e,i)}if(e.hasChildNodes())for(var n=0;n<e.childNodes.length;n++)h(e.childNodes[n],t)}function u(e,t){h(e,function(e,i){var n=t[i[1]]||i[1];e.parentNode.replaceChild(document.createTextNode(n),e)})}function p(e,t){h(e,function(e,i){var n=t[i[1]];if(n){var r=document.createRange(),o=i.index;r.setStart(e,o),r.setEnd(e,o+i[0].length),r.deleteContents(),r.insertNode(n)}})}function f(t,i){function n(e){_.forEach(function(t){var i=!1,n=t.excludeNodes.some(function(t){return document.body.contains(t)?(i=!0,t.contains(e.target)):!1});if(i&&!n)try{t.dismiss(e)}catch(r){"undefined"!=typeof console&&console&&console.error(r&&r.message)}}),_=_.filter(function(e){return e.excludeNodes.some(function(e){return document.body.contains(e)})})}null===_&&(_=[],document.addEventListener("click",n,!0),e.isIOS&&document.addEventListener("touchend",function(e){function t(){e.target.removeEventListener("click",t)}0===e.touches.length&&e.target.addEventListener("click",t)},!1)),_.push({excludeNodes:t,dismiss:i})}function m(e){_=_.filter(function(t){return e!==t.dismiss})}function g(e){window.document.all&&(e.keyCode=0),e.preventDefault&&(e.preventDefault(),e.stopPropagation())}function v(e){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++)t[i].parentNode.style.pointerEvents=e?"":"none"}var y=/\$\{([^\}]+)\}/,_=null,w={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46};return{$:t,$$:i,$$array:n,node:r,contains:o,bounds:s,empty:a,firstTabbable:c,lastTabbable:d,stop:g,processTextNodes:u,processDOMNodes:p,addAutoDismiss:f,setFramesEnabled:v,removeAutoDismiss:m,KEY:w}}),define("text",["module"],function(e){var t,i,n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,a=s&&location.protocol&&location.protocol.replace(/\:/,""),l=s&&location.hostname,c=s&&(location.port||void 0),d=[],h=e.config&&e.config()||{};return t={version:"2.0.5",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(o);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=n[t];try{e=new ActiveXObject(i)}catch(r){}if(e){n=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,o=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!s||o>1)?(t=e.substring(0,o),i=e.substring(o+1,e.length)):t=e,n=i||t,o=n.indexOf("!"),-1!==o&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,r){var o,s,a,l=t.xdRegExp.exec(e);return l?(o=l[2],s=l[3],s=s.split(":"),a=s[1],s=s[0],!(o&&o!==i||s&&s.toLowerCase()!==n.toLowerCase()||(a||s)&&a!==r)):!0},finishLoad:function(e,i,n,r){n=i?t.strip(n):n,h.isBuild&&(d[e]=n),r(n)},load:function(e,i,n,r){if(r.isBuild&&!r.inlineText)return void n();h.isBuild=r.isBuild;var o=t.parseName(e),d=o.moduleName+(o.ext?"."+o.ext:""),u=i.toUrl(d),p=h.useXhr||t.useXhr;!s||p(u,a,l,c)?t.get(u,function(i){t.finishLoad(e,o.strip,i,n)},function(e){n.error&&n.error(e)}):i([d],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)})},write:function(e,i,n){if(d.hasOwnProperty(i)){var r=t.jsEscape(d[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,r,o){var s=t.parseName(i),a=s.ext?"."+s.ext:"",l=s.moduleName+a,c=n.toUrl(s.moduleName+a)+".js";t.load(l,n,function(){var i=function(e){return r(c,e)};i.asModule=function(e,t){return r.asModule(e,c,t)},t.write(e,l,i,o)},o)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(i=require.nodeRequire("fs"),t.get=function(e,t){var n=i.readFileSync(e,"utf8");0===n.indexOf("﻿")&&(n=n.substring(1)),t(n)}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,i,n,r){var o,s=t.createXhr();if(s.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);h.onXhr&&h.onXhr(s,e),s.onreadystatechange=function(){var t,r;4===s.readyState&&(t=s.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=s,n(r)):i(s.responseText))},s.send(null)}:("rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var i,n,r="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),l="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(s),i.append(n);l=String(i.toString())}finally{a.close()}t(l)}),t}),define("text!orion/banner/slideout.html",[],function(){return'<div id="slideContainer" class="slideParameters slideContainer">\r\n	<span id="pageCommandParameters" class="layoutLeft parameters"></span>\r\n	<span id="pageCommandDismiss" class="layoutRight parametersDismiss"></span>\r\n</div>'}),define("orion/commonHTMLFragments",["require","orion/webui/littlelib","text!orion/banner/slideout.html"],function(e,t,i){function n(e){var n=document.createElement("div");n.innerHTML=i;var r=t.$("#slideContainer",n);return r.id=e+r.id,r=t.$("#pageCommandParameters",n),r.id=e+r.id,r=t.$("#pageCommandDismiss",n),r.id=e+r.id,n.innerHTML}return{slideoutHTMLFragment:n}}),define("orion/keyBinding",["orion/util"],function(e){function t(e,t,i,n,r,o){this.type=o||"keydown",this.keyCode="string"==typeof e&&"keydown"===this.type?e.toUpperCase().charCodeAt(0):e,this.mod1=void 0!==t&&null!==t?t:!1,this.mod2=void 0!==i&&null!==i?i:!1,this.mod3=void 0!==n&&null!==n?n:!1,this.mod4=void 0!==r&&null!==r?r:!1}function i(e){this.keys=e}return t.prototype={getKeys:function(){return[this]},match:function(t,i){if(void 0!==i){if(0!==i)return!1}else if(t instanceof Array){if(t.length>1)return!1;t=t[0]}if(t.type!==this.type)return!1;if(this.keyCode===t.keyCode||this.keyCode===String.fromCharCode(e.isOpera?t.which:void 0!==t.charCode?t.charCode:t.keyCode)){var n=e.isMac?t.metaKey:t.ctrlKey;return this.mod1!==n?!1:"keydown"===this.type&&this.mod2!==t.shiftKey?!1:this.mod3!==t.altKey?!1:e.isMac&&this.mod4!==t.ctrlKey?!1:!0}return!1},equals:function(e){return e?this.keyCode!==e.keyCode?!1:this.mod1!==e.mod1?!1:this.mod2!==e.mod2?!1:this.mod3!==e.mod3?!1:this.mod4!==e.mod4?!1:this.type!==e.type?!1:!0:!1}},i.prototype={getKeys:function(){return this.keys.slice(0)},match:function(e,t){var i=this.keys;if(void 0!==t)return t>i.length?!1:i[t].match(e)?t===i.length-1?!0:t+1:!1;if(e instanceof Array||(e=[e]),e.length>i.length)return!1;var n;for(n=0;n<e.length;n++)if(!i[n].match(e[n]))return!1;return n===i.length?!0:n},equals:function(e){if(!e.keys)return!1;if(e.keys.length!==this.keys.length)return!1;for(var t=0;t<e.keys.length;t++)if(!e.keys[t].equals(this.keys[t]))return!1;return!0}},{KeyBinding:t,KeyStroke:t,KeySequence:i}}),define("orion/webui/dropdown",["require","orion/webui/littlelib","orion/EventTarget"],function(e,t,i){function n(e){i.attach(this),this._init(e)}function r(e,t){t=void 0===t?"span":t;var i=document.createElement(t);i.tabIndex=0,i.className="dropdownMenuItem",i.role="menuitem";var n=document.createElement("span");n.appendChild(document.createTextNode(e)),n.classList.add("dropdownCommandName"),i.appendChild(n);var r=document.createElement("li");return r.appendChild(i),r}function o(){var e=document.createElement("li");return e.classList.add("dropdownSeparator"),e}function s(e,t){var i=document.createElement("span");i.classList.add("dropdownKeyBinding"),i.appendChild(document.createTextNode(t)),e.appendChild(i)}return n.prototype={_init:function(e){if(this._dropdownNode=t.node(e.dropdown),!this._dropdownNode)throw"no dom node for dropdown found";if(this._populate=e.populate,this._selectionClass=e.selectionClass,this._parentDropdown=e.parentDropdown,this._positioningNode=e.positioningNode,!this._parentDropdown)for(var i=this._dropdownNode.parentNode;i&&document!==i;){if(i.classList&&i.classList.contains("dropdownMenu")){this._parentDropdown=i.dropdown;break}i=i.parentNode}if(this._dropdownNode.tabIndex=0,this._triggerNode=e.triggerNode?e.triggerNode:t.$(".dropdownTrigger",this._dropdownNode.parentNode),!this._triggerNode)throw"no dom node for dropdown trigger found";if(!e.skipTriggerEventListeners){var n=this;this._triggerNode.addEventListener("click",function(e){n.toggle(e)&&t.stop(e)},!1),"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&(n.toggle(),t.stop(e))},!1)}this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(e){var i=this;e.addEventListener("click",function(e){i.toggle(e)&&t.stop(e)},!1)},toggle:function(e){return this.isVisible()?this.close():this.open(e)},isVisible:function(){return this._isVisible
},open:function(e){var i=!1;if(!this.isVisible()){this.dispatchEvent({type:"triggered",dropdown:this,event:e}),t.setFramesEnabled(!1),this._populate&&(this.empty(),this._populate(this._dropdownNode));var n=this.getItems();if(n.length>0){if(!this._hookedAutoDismiss){this._boundAutoDismiss?t.removeAutoDismiss(this._boundAutoDismiss):this._boundAutoDismiss=this._autoDismiss.bind(this);var r=t.$$array(".dropdownSubMenu",this._dropdownNode);t.addAutoDismiss([this._triggerNode].concat(r),this._boundAutoDismiss),this._hookedAutoDismiss=!0}this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),this._dropdownNode.classList.add("dropdownMenuOpen"),this._isVisible=!0,this._positionDropdown(e),this._focusDropdownNode(),i=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this)}}return i},_focusDropdownNode:function(){this._dropdownNode.focus()},_autoDismiss:function(e){if(this.close(!1)&&this._dropdownNode.contains(e.target))for(var t=this._parentDropdown;t;)t.close(!1),t=t._parentDropdown},_positionDropdown:function(){if(this._dropdownNode.style.left="",this._dropdownNode.style.top="",this._positioningNode)return void(this._dropdownNode.style.left=this._positioningNode.offsetLeft+"px");var e=t.bounds(this._dropdownNode),i=t.bounds(document.body);if(e.left+e.width>i.left+i.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-e.width+"px";else{var n=t.bounds(this._boundingNode(this._triggerNode)),r=t.bounds(this._triggerNode);this._dropdownNode.style.left=r.left-n.left-e.width+r.width+"px"}var o=e.top+e.height-(i.top+i.height);o>0&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-o)+"px")},_boundingNode:function(e){var t=window.getComputedStyle(e,null);if(null===t)return e;var i=t.getPropertyValue("position");return"absolute"!==i&&e.parentNode&&e!==document.body?this._boundingNode(e.parentNode):e},close:function(e){var i=!1;return this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),t.setFramesEnabled(!0),e&&this._triggerNode.focus(),this._isVisible=!1,this._selectedItem&&(this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=null),i=!0),i},getItems:function(){var e=t.$$array("li:not(.dropdownSeparator) > .dropdownMenuItem",this._dropdownNode,!0),i=[],n=this;return e.forEach(function(e){e.parentNode.parentNode===n._dropdownNode&&i.push(e)}),i.forEach(function(e){e._hasDropdownMouseover||(e.addEventListener("mouseover",function(i){e.dropdown?e.dropdown.open(i):(n._closeSelectedSubmenu(),t.stop(i)),n._selectItem(e)}),e._hasDropdownMouseover=!0)}),i},empty:function(){var e=t.$$array("li",this._dropdownNode),i=this;e.forEach(function(e){e.parentNode===i._dropdownNode&&e.parentNode.removeChild(e)}),this._hookedAutoDismiss=!1},_dropdownKeyDown:function(e){if(e.keyCode===t.KEY.UP||e.keyCode===t.KEY.DOWN||e.keyCode===t.KEY.RIGHT||e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.LEFT){var i=this.getItems();if(i.length&&i.length>0){if(this._selectedItem){var n=i.indexOf(this._selectedItem);0>n&&(n=i.indexOf(this._selectedItem.parentNode)),n>=0&&(e.keyCode===t.KEY.UP&&n>0?(n--,this._selectItem(i[n])):e.keyCode===t.KEY.DOWN&&n<i.length-1?(n++,this._selectItem(i[n])):e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.RIGHT?this._selectedItem.classList.contains("dropdownTrigger")&&this._selectedItem.dropdown?(this._selectedItem.dropdown.open(),this._selectedItem.dropdown._selectItem()):e.keyCode===t.KEY.ENTER&&this._selectedItem.click():e.keyCode===t.KEY.LEFT&&this._selectedItem.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&(this.close(!0),this._parentDropdown&&this._parentDropdown._dropdownNode.focus()))}else this._selectItem(i[0]);t.stop(e)}}else e.keyCode===t.KEY.ESCAPE&&(this.close(!0),t.stop(e))},_selectItem:function(e){var t=e||this.getItems()[0];t&&(this._selectedItem&&this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=t,this._selectedItem.classList.add("dropdownMenuItemSelected")),document.activeElement!==this._dropdownNode&&this._dropdownNode.focus()},submenuOpen:function(e){e!==this._selectedSubmenu&&(this._closeSelectedSubmenu(),this._selectedSubmenu=e)},_closeSelectedSubmenu:function(){for(var e=this._selectedSubmenu;e;)e.close(),e=e._selectedSubmenu},destroy:function(){this.empty(),this._boundAutoDismiss&&t.removeAutoDismiss(this._boundAutoDismiss)},appendMenuItem:function(e,t){var i=r(e,t);return this._dropdownNode.appendChild(i),i},appendSeparator:function(){var e=o();return this._dropdownNode.appendChild(e),e}},n.prototype.constructor=n,{Dropdown:n,appendKeyBindingString:s,createMenuItem:r,createSeparator:o}}),define("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'<button class="dropdownTrigger">${ButtonText}<!--span class="dropdownArrowDown core-sprite-openarrow"></span--></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'<button class="dropdownTrigger dropdownDefaultButton">${ButtonText}<span class="dropdownArrowDown core-sprite-openarrow"></span></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/submenutriggerbutton.html",[],function(){return'<li class="dropdownSubMenu"><span class="dropdownTrigger dropdownMenuItem" role="menuitem" tabindex="0"><span class="dropdownCommandName">${ButtonText}</span><span class="dropdownArrowRight core-sprite-closedarrow"></span></span><ul class="dropdownMenu"></ul></li>'}),define("text!orion/webui/checkedmenuitem.html",[],function(){return'<li><label class="dropdownMenuItem"><input class="checkedMenuItem" role="menuitem" type="checkbox" />${ItemText}</label></li>'}),define("orion/webui/tooltip",["require","orion/webui/littlelib"],function(e,t){function i(e){this._init(e)}return i.prototype={_init:function(e){if(this._node=t.node(e.node),!this._node)throw"no dom node for tooltip found";this._position=e.position||["right","above","below","left"],this._text=e.text,this._hideDelay=void 0===e.hideDelay?200:e.hideDelay,this._tailSize=e.tailSize||10,this._trigger=e.trigger||"mouseover",this._afterShowing=e.afterShowing,this._afterHiding=e.afterHiding;var i=this;if("click"===this._trigger)this._showDelay=0,this._node.addEventListener("click",this._clickHandler=function(e){e.target===i._node&&(i.show(),t.stop(e))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===e.showDelay?500:e.showDelay;var n=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(e){t.contains(i._node,e.target)&&(i.show(),t.stop(e))},!1),this._leaveHandler=function(e){t.contains(i._node,e.target)&&i.hide()};for(var r=0;r<n.length;r++)this._node.addEventListener(n[r],this._leaveHandler,!1)}},_makeTipNode:function(){if(!this._tip){if(this._tip=document.createElement("span"),this._tip.classList.add("tooltipContainer"),this._tipInner=document.createElement("div"),this._tipInner.classList.add("tooltip"),this._text){this._tipTextContent=document.createElement("div"),this._tipTextContent.classList.add("textContent"),this._tipInner.appendChild(this._tipTextContent);var e=document.createTextNode(this._text);this._tipTextContent.appendChild(e)}this._tip.appendChild(this._tipInner),document.body.appendChild(this._tip);var i=this;t.addAutoDismiss([this._tip,this._node],function(){i.hide()}),"mouseover"===this._trigger&&(this._tipInner.role="tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(){i._timeout&&(window.clearTimeout(i._timeout),i._timeout=null),i._tip.addEventListener("mouseout",function(e){t.contains(i._tip,e.target)&&(i.hide(),t.stop(e))},!1)},!1))}return this._tip},_positionTip:function(e,i){this._makeTipNode(),"left"===e?this._tipInner.classList.add("left"):this._tipInner.classList.remove("left");var n,r=this._node;for(n=t.bounds(r);r&&!n.width&&!n.height;r=r.parentNode)n=t.bounds(r);var o,s,a=t.bounds(this._tipInner);switch(e){case"above":o=n.top-a.height-this._tailSize-1,s=n.left-this._tailSize;break;case"below":o=n.top+n.height+this._tailSize+1,s=n.left-this._tailSize;break;case"left":o=n.top-this._tailSize/2,s=n.left-a.width-this._tailSize-1;break;default:o=n.top-this._tailSize/2,s=n.left+n.width+this._tailSize+1}var l=t.bounds(document.documentElement);if(o+a.height>l.height){if(!i)return!1;o=l.height-a.height-1}if(s+a.width>l.width){if(!i)return!1;s=l.width-a.width-1}if(0>s){if(!i)return!1;s=4}if(0>o){if(!i)return!1;o=4}return this._tail&&this._tail.previousPosition!==e&&(this._tip.removeChild(this._tail),this._tail=null),this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+e),"above"===e||"left"===e?this._tip.appendChild(this._tail):this._tip.insertBefore(this._tail,this._tipInner),this._tail.previousPosition=e),this._tip.style.top=o+"px",this._tip.style.left=s+"px",!0},contentContainer:function(){return this._makeTipNode(),this._tipInner},show:function(){this._tip&&this._tip.classList.contains("tooltipShowing")||(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=window.setTimeout(this._showImmediately.bind(this),this._showDelay):this._showImmediately())},_showImmediately:function(){for(var e=!1,t=0;!e&&t<this._position.length;)e=this._positionTip(this._position[t]),t++;e||this._positionTip(this._position[0],!0),this._tip.classList.add("tooltipShowing"),this._afterShowing&&this._afterShowing()},hide:function(e){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._tip&&this._tip.classList.contains("tooltipShowing")){void 0===e&&(e=this._hideDelay);var t=this;this._timeout=window.setTimeout(function(){t._tip.classList.remove("tooltipShowing"),t._tip.removeAttribute("style"),t._afterHiding&&t._afterHiding()},e)}},destroy:function(){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._tip&&(document.body.removeChild(this._tip),this._tip=null,this._tipInner=null,this._tipTextContent=null,this._tail=null),this._node){this._node.removeEventListener("click",this._clickHandler,!1),this._node.removeEventListener("mouseover",this._mouseoverHandler,!1);for(var e=["mouseout","click"],t=0;t<e.length;t++)this._node.removeEventListener(e[t],this._leaveHandler,!1)}}},i.prototype.constructor=i,{Tooltip:i}}),define("orion/commands",["orion/util","orion/webui/littlelib","orion/webui/dropdown","text!orion/webui/dropdowntriggerbutton.html","text!orion/webui/dropdowntriggerbuttonwitharrow.html","text!orion/webui/submenutriggerbutton.html","text!orion/webui/checkedmenuitem.html","orion/webui/tooltip"],function(e,t,i,n,r,o,s,a){function l(e){S=e}function c(e){var t=e.invocation;if(t){var i=e.command;if(i.hrefCallback){var n=i.hrefCallback.call(t.handler||window,t);return n.then?n.then(function(e){window.open(e)}):window.open(n),!0}if(t.commandRegistry)return t.commandRegistry._invoke(t),!0;if(i.onClick||i.callback)return window.setTimeout(function(){(i.onClick||i.callback).call(t.handler||window,t)},0),!0}return!1}function d(e,i){for(var n in i)if(i[n]&&i[n].keyBinding&&i[n].command&&i[n].keyBinding.match(e)){var r=i[n],o=r.keyBinding;if((!o.domScope||t.contains(t.node(o.domScope),e.target))&&c(r))return void t.stop(e)}}function h(){var e={};if(S){var t,i,n;for(i=Object.keys(E),t=0;t<i.length;t++)n=i[t],e[n]=E[n];var r=S();for(i=Object.keys(r),t=0;t<i.length;t++)n=i[t],e[n]=r[n]}else e=E;return e}function u(e){d(e,h())}function p(t,i){function n(t){if(e.isMac){if(t.metaKey&&!t.altKey)return t.shiftKey||t.ctrlKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.ctrlKey)return!1}else{if(t.ctrlKey&&!t.altKey)return t.shiftKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.altKey&&!t.ctrlKey)return!1}if(t["char"])return t["char"].length>0;if(t.charCode||t.keyCode){var i=t.charCode||t.keyCode;switch(i){case 8:case 9:case 13:case 46:return!0;default:return i>=32&&112>i||i>123}}return!1}if(t=t||window.event,n(t)){if("true"===t.target.contentEditable)return;var r=t.target.nodeName.toLowerCase();if("input"===r){var o=t.target.type.toLowerCase();switch(o){case"text":case"password":case"search":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"range":case"tel":case"time":case"url":case"week":return}}else if("textarea"===r)return}i?i(t):u(t)}function f(){this._init()}function m(e,t,i){t.classList.add("commandImage");var n;return e.imageClass?e.addImageClassToElement?t.classList.add(e.imageClass):(n=document.createElement("span"),t.appendChild(n),n.classList.add(e.spriteClass),n.classList.add(e.imageClass)):(n=new Image,n.alt=e.name,n.name=i,n.id=i,n.src=e.image,t.appendChild(n)),n}function g(e,o,s,a,l,c,d,h,u){if(e=t.node(e),!e)throw"no parent node was specified";var p=document.createRange();p.selectNode(e);var f=p.createContextualFragment(u?r:n);t.processTextNodes(f,{ButtonText:o}),e.appendChild(f);var g,v,y=e.lastChild;return u?(g=y.previousSibling,v=g.lastChild):g=y.previousSibling,a?g.classList.add(a):(g.classList.add("orionButton"),g.classList.add("commandButton")),l&&(c||(g.textContent="",g.setAttribute("aria-label",o)),m({spriteClass:"commandSprite",imageClass:l},g,o),g.classList.add("orionButton")),g.dropdown=new i.Dropdown({dropdown:y,populate:s,selectionClass:d,skipTriggerEventListeners:!!v,positioningNode:h}),y.dropdown=g.dropdown,{menuButton:g,menu:y,dropdown:g.dropdown,dropdownArrow:v}}function v(e,i,n,r){if(e=t.node(e),!e)throw"no parent node was specified";var o=document.createRange();o.selectNode(e);var a=o.createContextualFragment(s);t.processTextNodes(a,{ItemText:i}),e.appendChild(a);var l=e.lastChild,c=t.$(".checkedMenuItem",l);return c.checked=n,c.addEventListener("change",r,!1),c}function y(e,t,i,n,r,o,s){var l;if(o=o||!t.name&&t.hasImage(),t.hrefCallback){l=document.createElement("a"),l.id=n,o&&t.hasImage()?m(t,l,n):(l.className="commandLink",l.appendChild(document.createTextNode(t.name)));var c=t.hrefCallback.call(i.handler,i);c.then?c.then(function(e){l.href=e}):l.href=c?c:"#"}else{if(l=document.createElement("button"),l.className="orionButton",o)t.hasImage()?(m(t,l,n),t.name&&l.setAttribute("aria-label",t.name)):(l.classList.add("commandButton"),l.classList.add("commandMissingImageButton"),l.appendChild(document.createTextNode(t.name)));else{l.classList.add("commandButton");var d=document.createTextNode(t.name);l.appendChild(d)}var h=s||t.callback;h&&(t.onClick=h,l.addEventListener("click",function(){h.call(i.handler,i)},!1))}if("ul"===e.nodeName.toLowerCase()){var u=document.createElement("li");e.appendChild(u),e=u}else l.classList.add("commandMargins");return e.appendChild(l),t.tooltip&&(l.commandTooltip=new a.Tooltip({node:l,text:t.tooltip,position:["above","below","right","left"]})),r&&(E[t.id]={keyBinding:r,command:t,invocation:i}),l}function _(e,n,r,o,s,l){var c,d,h=e.dropdown;if(n.hrefCallback){d=i.createMenuItem(n.name,"a"),c=d.firstElementChild;var u=n.hrefCallback.call(r.handler,r);u.then?u.then(function(e){c.href=e}):c.href=u?u:"#",c.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&c.click()},!1)}else{d=i.createMenuItem(n.name),c=d.firstElementChild;var p=s||n.callback;p&&(n.onClick=p,c.addEventListener("click",function(){h.close(!0),p.call(r.handler,r)},!1),c.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&(e.preventDefault(),c.click())},!1))}return n.tooltip&&(c.commandTooltip=new a.Tooltip({node:c,text:n.tooltip,position:["above","below","right","left"]})),l&&i.appendKeyBindingString(c,l),e.appendChild(d),o&&(E[n.id]={keyBinding:o,command:n,invocation:r}),c}function w(e,t,i,n,r){this.commandRegistry=r,this.handler=e,this.items=t,this.userData=i,this.command=n,n.parameters&&(this.parameters=n.parameters.makeCopy()),this.id=n.id}function C(e){this._init(e)}var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",S=null,E={};return f.prototype={setProxy:function(e){this.proxy=e},setKeyBindings:function(e){this.bindings=e},_init:function(){var e=this;document.addEventListener("keydown",function(i){return p(i,function(i){var n=e.proxy,r=e.bindings;if(r&&n)for(var o=0;o<r.length;o++)r[o].match(i)&&(n.processKey({type:i.type,keyCode:i.keyCode,altKey:i.altKey,ctrlKey:i.ctrlKey,metaKey:i.metaKey,shiftKey:i.shiftKey}),t.stop(i))})})}},window.document.addEventListener("keydown",p,!1),w.prototype={collectsParameters:function(){return this.commandRegistry&&this.commandRegistry.collectsParameters()},makeCopy:function(e){var t=new w(this.handler,this.items,this.userData,this.command,this.commandRegistry);return t.domNode=this.domNode,t.domParent=this.domParent,e?t.parameters=e.makeCopy():this.parameters&&(t.parameters=this.parameters.makeCopy()),t}},w.prototype.constructor=w,C.prototype={_init:function(e){this.id=e.id,this.name=e.name,this.tooltip=e.tooltip,this.callback=e.callback,this.hrefCallback=e.hrefCallback,this.choiceCallback=e.choiceCallback,this.positioningNode=e.positioningNode,this.image=e.image||b,this.imageClass=e.imageClass,this.addImageClassToElement=e.addImageClassToElement,this.selectionClass=e.selectionClass,this.spriteClass=e.spriteClass||"commandSprite",this.visibleWhen=e.visibleWhen,this.parameters=e.parameters,this.isEditor=e.isEditor},populateChoicesMenu:function(e,i,n,r,o){var s=this.getChoices(i,n,r),a=s.some(function(e){return e.checked});s.forEach(function(n){if(n.name){var r=document.createElement("li");e.appendChild(r);var s=document.createElement("span");if(s.tabIndex=0,s.role="menuitem",s.classList.add("dropdownMenuItem"),a){var l=document.createElement("span");l.classList.add("check"),l.appendChild(document.createTextNode(n.checked?"●":"")),s.appendChild(l)}var c=document.createTextNode(n.name);s.appendChild(c),r.appendChild(s),s.choice=n,s.addEventListener("click",function(e){e.target.choice&&e.target.choice.callback.call(e.target.choice,i)},!1),s.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&e.target.choice&&e.target.choice.callback.call(e.target.choice,i)},!1)}else o._generateMenuSeparator(e)})},getChoices:function(e,t,i){return this.choiceCallback?this.choiceCallback.call(t,e,i):null},makeChoiceCallback:function(e,t){return function(i){e.callback&&e.callback.call(e,t,i)}},hasImage:function(){return this.imageClass||this.image!==b}},C.prototype.constructor=C,{Command:C,CommandInvocation:w,createDropdownMenu:g,createCheckedMenuItem:v,createCommandItem:y,createCommandMenuItem:_,executeBinding:c,setKeyBindingProvider:l,localKeyBindings:E,CommandsProxy:f,getKeyBindings:h,processKey:u,NO_IMAGE:b,_testMethodProcessKey:d}}),define("orion/explorers/navigationUtils",[],function(){function e(e,t){r||e&&(e.push({domNode:t}),t.tabIndex=-1,t.style.outline="none")}function t(t,i,n){if(t){var r=t.getGridNavHolder(i,!0);r&&e(r,n)}}function i(e,t){if(e)for(var i=0;i<e.length;i++)if(e[i].domNode===t)return void e.splice(i,1)}var n=navigator.userAgent,r=-1!==n.indexOf("iPad");return{addNavGrid:t,generateNavGrid:e,removeNavGrid:i}}),define("orion/PageUtil",[],function(){function e(){var e=window.location.href.split("#")[1];return e=e?"#"+e:""}function t(e){e=e||window.location.toString();var t={resource:""},i=e.indexOf("#");if(-1!==i){var n=e.substring(i+1);if(0!==n.length){var r=n.split(",");t.resource=decodeURIComponent(r[0]);for(var o=1;o<r.length;o++){var s=r[o],a=/([^=]*)(=?)(.*)/.exec(s),l=decodeURIComponent(a[1]||""),c=decodeURIComponent(a[3]||"");""!==l&&"resource"!==l&&(t[l]=c)}}}return t}function i(e,t){var i=e;if(-1===e.indexOf("://")){var r=document.createElement("a");r.href=e,i=r.href}var o=!1;return o=t?t.some(function(e){return new RegExp("^"+e+":","i").test(i)}):n.test(i),o?e:(console.log("Illegal URL Scheme: '"+e+"'"),"")}var n=new RegExp("^http[s]?","i");return{hash:e,matchResourceParameters:t,validateURLScheme:i}}),define("orion/uiUtils",["orion/webui/littlelib"],function(e){function t(t){var i="",n=-1!==navigator.platform.indexOf("Mac");if(n?(t.mod4&&(i+="⌃"),t.mod3&&(i+="⌥"),t.mod2&&(i+="⇧"),t.mod1&&(i+="⌘")):(t.mod1&&(i+="Ctrl+"),t.mod2&&(i+="Shift+"),t.mod3&&(i+="Alt+")),t.alphaKey)return i+t.alphaKey;if("keypress"===t.type)return i+t.keyCode;for(var r in e.KEY)if(e.KEY[r]===t.keyCode){if(n)switch(e.KEY[r]){case e.KEY.BKSPC:r="⌫";break;case e.KEY.TAB:r="⇥";break;case e.KEY.ENTER:r="⏎";break;case e.KEY.ESCAPE:r="⎋";break;case e.KEY.SPACE:r="␣";break;case e.KEY.PAGEUP:r="⇞";break;case e.KEY.PAGEDOWN:r="⇟";break;case e.KEY.END:r="⇲";break;case e.KEY.HOME:r="⇱";break;case e.KEY.DEL:r="⌦"}switch(e.KEY[r]){case e.KEY.DOWN:r="↓";break;case e.KEY.UP:r="↑";break;case e.KEY.RIGHT:r="→";break;case e.KEY.LEFT:r="←"}return i+r}var o;switch(t.keyCode){case 59:o=t.mod2?":":";";break;case 61:o=t.mod2?"+":"=";break;case 188:o=t.mod2?"<":",";break;case 190:o=t.mod2?">":".";break;case 191:o=t.mod2?"?":"/";break;case 192:o=t.mod2?"~":"`";break;case 219:o=t.mod2?"{":"[";break;case 220:o=t.mod2?"|":"\\";break;case 221:o=t.mod2?"}":"]";break;case 222:o=t.mod2?'"':"'"}return o?i+o:t.keyCode>=112&&t.keyCode<=123?i+"F"+(t.keyCode-111):i+String.fromCharCode(t.keyCode)}function i(e){for(var i="",n=e.getKeys(),r=0;r<n.length;r++)0!==r&&(i+=" "),i+=t(n[r]);return i}function n(t){var i=t.id,n=t.refNode,r=t.hideRefNode,o=t.initialText,s=t.onComplete,a=t.onEditDestroy,l=t.selectTo,c=t.isInitialValid,d=t.insertAsChild,h=!1,u=function(t){return function(l){if(!h){var d=e.node(i),u=d.value;if(d)return t&&l.keyCode===e.KEY.ESCAPE?(r&&(n.style.display="inline"),h=!0,d.parentNode.removeChild(d),void(a&&a())):void(t&&l.keyCode!==e.KEY.ENTER||(0===u.length||!c&&u===o?(r&&(n.style.display="inline"),h=!0):(s(u),r&&n.parentNode&&(n.style.display="inline"),h=!0),d.parentNode&&d.parentNode.removeChild(d),a&&a()))}}},p=document.createElement("input");p.id=i,p.value=o||"",d?n.appendChild(p):n.parentNode.insertBefore(p,n.nextSibling),p.classList.add("userEditBoxPrompt"),r&&(n.style.display="none"),p.addEventListener("keydown",u(!0),!1),p.addEventListener("blur",u(!1),!1),window.setTimeout(function(){if(p.focus(),o){var t=e.node(i),n=l?o.indexOf(l):-1;if(n>0)if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveStart("character",0),r.moveEnd("character",n),r.select()}else t.setSelectionRange?t.setSelectionRange(0,n):void 0!==t.selectionStart&&(t.selectionStart=0,t.selectionEnd=n);else t.select()}},0)}function r(e){var t=-1!==window.navigator.platform.indexOf("Mac");return t&&e.metaKey||!t&&e.ctrlKey}function o(e,t){t&&r(t)?window.open(e):window.location=e}function s(t,i){var n=document.createElement("button");return n.className="orionButton commandButton commandMargins",n.addEventListener("click",function(t){i(),e.stop(t)},!1),t&&n.appendChild(document.createTextNode(t)),n}function a(){}function l(e){switch(e.tagName.toLowerCase()){case"button":case"fieldset":case"form":case"input":case"keygen":case"label":case"legend":case"meter":case"optgroup":case"output":case"progress":case"select":case"textarea":return!0}return!1}return{getUserKeyString:i,getUserText:n,openInNewWindow:r,followLink:o,createButton:s,createDropdownButton:a,isFormElement:l}}),define("orion/commandRegistry",["orion/commands","orion/explorers/navigationUtils","orion/PageUtil","orion/uiUtils","orion/webui/littlelib","orion/webui/dropdown","orion/webui/tooltip","text!orion/webui/checkedmenuitem.html","text!orion/webui/dropdowntriggerbutton.html","text!orion/webui/submenutriggerbutton.html"],function(e,t,i,n,r,o,s,a,l,c){function d(e){this._commandList={},this._contributionsByScopeId={},this._activeBindings={},this._urlBindings={},this._pendingBindings={},this._init(e),this._parameterCollector=null}function h(e,t){this.token=e,this.parameterName=t}function u(e,t,i){this.event=e,this.handler=t,this.capture=i||!1}function p(e,t,i,n,r,o){this.name=e,this.type=t,this.label=i,this.value=n,this.lines=r||1,this.eventListeners=Array.isArray(o)?o:o?[o]:[]}function f(e,t,i){this._storeParameters(e),this._hasOptionalParameters=t&&t.hasOptionalParameters,this._options=t,this.optionsRequested=!1,this.getParameters=i,this.clientCollect=t&&t.clientCollect,this.getParameterElement=t&&t.getParameterElement,this.getSubmitName=t&&t.getSubmitName}return d.prototype={_init:function(t){this._selectionService=t.selection;var i=this;e.setKeyBindingProvider(function(){return i._activeBindings})},processURL:function(e){for(var t in this._urlBindings)if(this._urlBindings[t]&&this._urlBindings[t].urlBinding&&this._urlBindings[t].command){var i=this._urlBindings[t].urlBinding.match(e);if(i){var n=this._urlBindings[t],r=n.command,o=n.invocation;if(o&&o.parameters&&r.callback){o.parameters.setValue(i.parameterName,i.parameterValue);var s=this;return void window.setTimeout(function(){s._invoke(o)},0)}}}},findCommand:function(e){return this._commandList[e]},runCommand:function(t,i,n,r,o,s){var a=this;if(i){var l=this._commandList[t],c=l&&(l.visibleWhen?l.visibleWhen(i):!0);if(c&&l.callback){var d=new e.CommandInvocation(n,i,o,l,a);return d.domParent=s,a._invoke(d,r)}}else{var h=this._urlBindings[t];if(h&&h.command&&h.command.callback)return a._invoke(h.invocation,r)}},getSelectionService:function(){return this._selectionService},setParameterCollector:function(e){this._parameterCollector=e},openParameterCollector:function(e,t,i){this._parameterCollector&&(this._parameterCollector.close(),this._parameterCollector.open(e,t,i))},confirm:function(e,t,i,n,r,o){var s=!1;if(this._parameterCollector&&!r){var a=this;this._parameterCollector.close();var l=this._parameterCollector.open(e,function(e,r){var o=document.createElement("span");o.classList.add("parameterPrompt"),o.textContent=t,e.appendChild(o);var l=document.createElement("button");l.addEventListener("click",function(){s=!0,a._parameterCollector.close()},!1),r.appendChild(l),l.appendChild(document.createTextNode(i)),l.className="dismissButton";var c=document.createElement("button");return c.addEventListener("click",function(){s=!1,a._parameterCollector.close()},!1),r.appendChild(c),c.appendChild(document.createTextNode(n)),c.className="dismissButton",l},function(){o(s)});if(l)return}s=window.confirm(t),o(s)},closeParameterCollector:function(){this._parameterCollector&&this._parameterCollector.close()},collectsParameters:function(){return this._parameterCollector},_invoke:function(e,t){return this._collectAndInvoke(e.makeCopy(t),!1)},_collectAndInvoke:function(e,t,i){if(e){if(!(this._parameterCollector&&e.parameters&&e.parameters.hasParameters()&&(t||e.parameters.shouldCollectParameters())))return e.command.callback.call(e.handler||window,e);var n=!1;if(e.parameters.updateParameters(e),e.parameters.shouldCollectParameters()&&(n=this._parameterCollector.collectParameters(e,i),!n)){var r=new s.Tooltip({node:e.domNode,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above","left"]}),o=r.contentContainer();o.classList.add("parameterPopup");var a=window.document.activeElement,l=this._parameterCollector.getFillFunction(e,function(){a&&a.focus(),r.destroy()},i)(o);r.show(),window.setTimeout(function(){l.focus(),l.select()},0),n=!0}if(!n)return e.command.callback.call(e.handler||window,e)}else window.console.log("Client attempted to invoke command without an available (rendered) command invocation")},collectParameters:function(e,t){this._collectAndInvoke(e,!0,t)},showKeyBindings:function(t){function i(t){return function(){e.executeBinding(t)}}var r,o,s={},a=[];for(var l in this._activeBindings)o=this._activeBindings[l],o&&o.keyBinding&&o.command&&(o.command.name||o.command.tooltip)&&a.push(o);a.sort(function(e,t){var i=e.command.name||e.command.tooltip,n=t.command.name||t.command.tooltip;return i.localeCompare(n)});for(var c=0;c<a.length;c++)o=a[c],o.keyBinding.scopeName?(s[o.keyBinding.scopeName]||(s[o.keyBinding.scopeName]=[]),s[o.keyBinding.scopeName].push(o)):(r=n.getUserKeyString(o.keyBinding),t.createItem(r,o.command.name||o.command.tooltip,i(o)));for(var d in s)s[d].length&&s[d].length>0&&(t.createHeader(d),s[d].forEach(function(e){r=n.getUserKeyString(e.keyBinding),t.createItem(r,e.command.name||e.command.tooltip,i(e))}))},addCommand:function(e){this._commandList[e.id]=e;var t=this._pendingBindings[e.id];if(t){var i=this;t.forEach(function(t){i._addBinding(e,t.type,t.binding,t.bindingOnly)}),delete this._pendingBindings[e.id]}},addCommandGroup:function(e,t,i,n,r,o,s,a,l,c){this._contributionsByScopeId[e]||(this._contributionsByScopeId[e]={});var d=this._contributionsByScopeId[e];r&&(d=this._createEntryForPath(d,r)),d[t]?(n&&(d[t].title=n),i&&(d[t].position=i),s&&(d[t].imageClass=s),a&&(d[t].tooltip=a),l&&(d[t].selectionClass=l),c===!0?d[t].pretendDefaultActionId=!0:d[t].defaultActionId=c,d[t].emptyGroupMessage=o):(d[t]={title:n,position:i,emptyGroupMessage:o,imageClass:s,tooltip:a,selectionClass:l,defaultActionId:c===!0?null:c,pretendDefaultActionId:c===!0,children:{}},d.sortedContributions=null)},_createEntryForPath:function(e,t){if(t){var i=t.split("/");i.forEach(function(t){t.length>1&&(e[t]||(e[t]={position:0,children:{}},e.sortedContributions=null),e=e[t].children)})}return e},registerSelectionService:function(e,t){this._contributionsByScopeId[e]||(this._contributionsByScopeId[e]={}),this._contributionsByScopeId[e].localSelectionService=t},registerCommandContribution:function(e,t,i,n,r,o,s){this._contributionsByScopeId[e]||(this._contributionsByScopeId[e]={});var a=this._contributionsByScopeId[e];n&&(a=this._createEntryForPath(a,n)),a[t]={position:i};var l;o&&(l=this._commandList[t],l?this._addBinding(l,"key",o,r):this._addPendingBinding(t,"key",o,r)),s&&(l=this._commandList[t],l?this._addBinding(l,"url",s,r):this._addPendingBinding(t,"url",s,r)),a.sortedContributions=null},unregisterCommandContribution:function(e,t,i){if(this._contributionsByScopeId[e]){delete this._commandList[t],delete this._activeBindings[t],delete this._urlBindings[t],delete this._pendingBindings[t];var n=this._contributionsByScopeId[e];if(i){var r=i.split("/");r.forEach(function(e){if(e.length>1){if(!n[e])return;n=n[e].children}})}delete n[t],n.sortedContributions=null}},_addBinding:function(e,t,i,n){if(!e.id)throw new Error("No command id: "+e);"key"===t?this._activeBindings[e.id]={command:e,keyBinding:i,bindingOnly:n}:"url"===t&&(this._urlBindings[e.id]={command:e,urlBinding:i,bindingOnly:n})},_addPendingBinding:function(e,t,i,n){this._pendingBindings[e]=this._pendingBindings[e]||[],this._pendingBindings[e].push({type:t,binding:i,bindingOnly:n})},_checkForTrailingSeparator:function(e,t,i){var n;if(("tool"===t||"button"===t)&&(n=e.childNodes.length>0?e.childNodes[e.childNodes.length-1]:null,n&&n.classList.contains("commandSeparator")))return i?(e.removeChild(n),!1):!0;if("menu"===t){var o=r.$$array("li > *",e);if(o.length>0&&o[o.length-1].classList.contains("dropdownSeparator"))return n=o[o.length-1],i?(n.parentNode.parentNode.removeChild(n.parentNode),!1):!0}return!1},renderCommands:function(e,t,i,n,o,s,a){if("string"!=typeof e)throw"a scope id for rendering must be specified";if(t=r.node(t),!t)throw"no parent";var l=this._contributionsByScopeId[e];if(!i&&l){var c=l.localSelectionService||this._selectionService,d=this;return void(c&&c.getSelections(function(i){d.renderCommands(e,t,i,n,o,s)}))}l&&(this._render(l,t,i,n,o||"button",s,a),this._checkForTrailingSeparator(t,o,!0))},destroy:function(e){if(e=r.node(e),!e)throw"no parent";for(;e.hasChildNodes();){var t=e.firstChild;t.commandTooltip&&t.commandTooltip.destroy(),t.emptyGroupTooltip&&t.emptyGroupTooltip.destroy(),this.destroy(t),e.removeChild(t)}},_render:function(i,r,o,a,l,c,d){var h=i.sortedContributions;
if(!h){h=[];var u=!1;for(var p in i)if(Object.prototype.hasOwnProperty.call(i,p)){var f=i[p];f&&"number"==typeof f.position&&(f.id=p,h.push(f),u=!0)}u&&(h.sort(function(e,t){return e.position-t.position}),i.sortedContributions=h)}var m=0,g=this;h.forEach(function(i){function h(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var u,p;if(i.imageClass||(i.imageClass=null),i.children&&Object.getOwnPropertyNames(i.children).length>0){var f,v=i.children;if("tool"===l||"button"===l)if(i.title){var y;if(i.defaultActionId){var _=g._commandList[i.defaultActionId];_&&(_.visibleWhen?_.visibleWhen(o):!0)?(y=new e.CommandInvocation(a,o,c,_,g),y.domParent=r):i.pretendDefaultActionId=!0}f=g._createDropdownMenu(r,i.title,null,null,i.imageClass,i.tooltip,i.selectionClass,null,y,i.pretendDefaultActionId),d&&t.generateNavGrid(d,f.menuButton),f&&(g._render(i.children,f.menu,o,a,"menu",c,d),g._checkForTrailingSeparator(f.menu,"menu",!0),0===f.menu.childNodes.length?i.emptyGroupMessage?f.menuButton.emptyGroupTooltip||(f.menuButton.emptyGroupTooltip=new s.Tooltip({node:f.menuButton,text:i.emptyGroupMessage,trigger:"click",position:["below","right","above","left"]})):(d&&t.removeNavGrid(d,f.menuButton),h(f.menu),h(f.menuButton),h(f.destroyButton)):f.menuButton.style.visibility="visible")}else{var w;if(r.childNodes.length>0&&!g._checkForTrailingSeparator(r,l)&&(w=g.generateSeparatorImage(r)),g._render(v,r,o,a,l,c,d),r.childNodes.length>0){var C=r.childNodes[r.childNodes.length-1];C!==w&&(w=g.generateSeparatorImage(r))}}else if(i.title){var b=g._createDropdownMenu(r,i.title,!0,null,null,i.imageClass);b&&(g._render(v,b.menu,o,a,"menu",c,d),g._checkForTrailingSeparator(b.menu,"menu",!0),0===b.menu.childNodes.length&&b.destroyButton&&r.removeChild(b.destroyButton))}else r.childNodes.length>0&&g._generateMenuSeparator(r),g._render(v,r,o,a,l,c,d),g._generateMenuSeparator(r)}else{var S=g._commandList[i.id],E=S?!0:!1,L=null,x=null;if(S){p=new e.CommandInvocation(a,o,c,S,g),p.domParent=r;var k=!1;try{k=E&&(S.visibleWhen?S.visibleWhen(o):!0)}catch(N){throw console.log(N),N}g._activeBindings[S.id]&&g._activeBindings[S.id].keyBinding&&(L=g._activeBindings[S.id],L.invocation=k?p:null,L.bindingOnly&&(E=!1)),g._urlBindings[S.id]&&g._urlBindings[S.id].urlBinding&&(x=g._urlBindings[S.id],x.invocation=k?p:null,x.bindingOnly&&(E=!1)),E=E&&k}if(E)if(S.choiceCallback){var T,P;"tool"===l||"button"===l?(T=r,P=!1,"ul"===r.nodeName.toLowerCase()&&(T=document.createElement("li"),r.appendChild(T))):(T=r,P=!0);var R=function(e){S.populateChoicesMenu(e,o,a,c,g)};g._createDropdownMenu(T,S.name,P,R.bind(S),S.imageClass,S.tooltip||S.title,S.selectionClass,S.positioningNode)}else{p.handler=p.handler||this,p.domParent=r;var I,A=function(){g._invoke(p)};if("menu"===l){var O=null;L&&L.keyBinding&&(O=n.getUserKeyString(L.keyBinding)),I=e.createCommandMenuItem(r,S,p,null,A,O)}else u=l+S.id+m,I=e.createCommandItem(r,S,p,u,null,"tool"===l,A);t.generateNavGrid(d,I),p.domNode=I,m++}}})},_createDropdownMenu:function(t,i,n,a,l,d,h,u,p,f){if(t=r.node(t),!t||!r.contains(document.body,t))return null;var m,g,v,y,_=t;if(n){var w=document.createRange();w.selectNode(t);var C=w.createContextualFragment(c);r.processTextNodes(C,{ButtonText:i}),t.appendChild(C),y=t.lastChild,g=y.lastChild,m=g.previousSibling,m.dropdown=new o.Dropdown({dropdown:g,populate:a,parentDropdown:t.dropdown}),g.dropdown=m.dropdown}else{"ul"===t.nodeName.toLowerCase()&&(_=document.createElement("li"),t.appendChild(_),y=_);var b=null;l&&(b="dropdownButtonWithIcon",d=d||i),d=l?d||i:d;var S=e.createDropdownMenu(_,i,a,b,l,!1,h,u,p||f);if(v=S.dropdownArrow,m=S.menuButton,v){p&&(p.domNode=S.menuButton);var E=this;m.onclick=function(e){var t=r.bounds(v);e.clientX>=t.left&&S.dropdown?S.dropdown.toggle(e):E._invoke(p)},S.dropdown&&(m.onkeydown=function(e){r.KEY.DOWN===e.keyCode&&(S.dropdown.toggle(e),r.stop(e))})}g=S.menu;var L,x=p&&p.command&&(p.command.tooltip||p.command.name);x?L=p.command.tooltip||p.command.name:x&&(L=d),L&&(m.commandTooltip=new s.Tooltip({node:m,text:L,position:["above","below","right","left"]}))}return{menuButton:m,menu:g,dropdown:m.dropdown,destroyButton:y,dropdownArrow:v}},_generateMenuSeparator:function(e){if(!this._checkForTrailingSeparator(e,"menu")){var t=document.createElement("li");t.classList.add("dropdownSeparator");var i=document.createElement("span");i.classList.add("dropdownSeparator"),t.appendChild(i),e.appendChild(t)}},generateSeparatorImage:function(e){var t;return"ul"===e.nodeName.toLowerCase()?(t=document.createElement("li"),e.appendChild(t)):(t=document.createElement("span"),e.appendChild(t)),t.classList.add("core-sprite-sep"),t.classList.add("imageSprite"),t.classList.add("commandSeparator"),t}},d.prototype.constructor=d,h.prototype={match:function(e){var t=i.matchResourceParameters(e);return"undefined"!=typeof t[this.token]?(this.parameterValue=t[this.token],this):null}},h.prototype.constructor=h,u.prototype.constructor=u,p.prototype={optionsRequested:function(){return this.optionsRequested}},p.prototype.constructor=p,f.prototype={_storeParameters:function(e){if(this.parameterTable=null,e){var t=this.parameterTable={};e.forEach(function(e){t[e.name]=e})}},updateParameters:function(e){"function"==typeof this.getParameters&&this._storeParameters(this.getParameters(e))},hasParameters:function(){return null!==this.parameterTable},shouldCollectParameters:function(){return!this.clientCollect&&this.hasParameters()},parameterNamed:function(e){return this.parameterTable[e]},valueFor:function(e){var t=this.parameterTable[e];return t?t.value:null},setValue:function(e,t){var i=this.parameterTable[e];i&&(i.value=t)},forEach:function(e){for(var t in this.parameterTable)this.parameterTable[t].type&&this.parameterTable[t].name&&e(this.parameterTable[t])},makeCopy:function(){var e=[];this.forEach(function(t){var i=new p(t.name,t.type,t.label,t.value,t.lines,t.eventListeners);e.push(i)});var t=new f(e,this._options,this.getParameters);return t.clientCollect=this.clientCollect,t},hasOptionalParameters:function(){return this._hasOptionalParameters}},f.prototype.constructor=f,{CommandRegistry:d,URLBinding:h,ParametersDescription:f,CommandParameter:p,CommandEventListener:u}}),define("orion/parameterCollectors",["i18n!orion/nls/messages","require","orion/webui/littlelib"],function(e,t,i){function n(e,t){this._activeContainer=null,this._getElementsFunction=e,this._toolbarLayoutFunction=t}return n.prototype={close:function(){this._activeElements&&(this._activeElements.parameterArea&&i.empty(this._activeElements.parameterArea),this._activeElements.slideContainer&&this._activeElements.slideContainer.classList.remove("slideContainerActive"),this._activeElements.dismissArea&&i.empty(this._activeElements.dismissArea),this._activeElements.commandNode&&this._activeElements.commandNode.classList.remove("activeCommand"),this._toolbarLayoutFunction(this._activeElements),this._activeElements.onClose&&this._activeElements.onClose(),this._oldFocusNode&&(this._oldFocusNode.focus(),this._oldFocusNode=null)),this._activeElements=null},open:function(t,n,r){if("string"==typeof t&&(t=i.node(t)),this._activeElements&&this._activeElements.slideContainer&&this._activeElements.commandNode===t)return this._activeElements.focusNode&&this._activeElements.focusNode.focus(),!0;if(this.close(),this._activeElements=null,this._activeElements=this._getElementsFunction(t),this._activeElements&&this._activeElements.parameterArea&&this._activeElements.slideContainer){this._activeElements.onClose=r;var o=n(this._activeElements.parameterArea,this._activeElements.dismissArea);if(!o)return!1;this._activeElements.focusNode=o;var s=i.$$array("#closebox",this._activeElements.dismissArea||this._activeElements.parameterArea);if(0===s.length){var a=this._activeElements.dismissArea||this._activeElements.parameterArea;s=document.createElement("button"),s.id="closebox",s.className="imageSprite core-sprite-close dismissButton",s.title=e.Close,a.appendChild(s);var l=this;s.addEventListener("click",function(){l.close()},!1)}return this._activeElements.slideContainer.classList.add("slideContainerActive"),this._toolbarLayoutFunction(this._activeElements),o&&(this._oldFocusNode=window.document.activeElement,window.setTimeout(function(){o.focus(),o.select&&o.select()},0)),this._activeElements.commandNode&&this._activeElements.commandNode.classList.add("activeCommand"),!0}return!1},_collectAndCall:function(e,t){i.$$array("input",t).forEach(function(t){"checkbox"===t.type?e.parameters.setValue(t.parameterName,t.checked):"button"!==t.type&&e.parameters.setValue(t.parameterName,t.value.trim())}),i.$$array("textArea",t).forEach(function(t){e.parameters.setValue(t.parameterName,t.value.trim())});var n=e.parameters.getParameterElement;n&&e.parameters.forEach(function(i){var r=n(i,t);r&&("checkbox"===r.type?e.parameters.setValue(r.parameterName,r.checked):"button"!==r.type?e.parameters.setValue(r.parameterName,r.value.trim()):"textarea"!==r.type&&e.parameters.setValue(r.parameterName,r.value.trim()))}),e.command.callback&&e.command.callback.call(e.handler,e)},collectParameters:function(e,t){return e.parameters?(e.domNode&&e.domNode.classList.add("commandMarker"),this.open(e.domNode||e.domParent,this.getFillFunction(e,null,t))):!1},getFillFunction:function(t,n,r){var o=this;return function(s,a){var l=null,c=function(){n&&n(),o.close()},d=function(e){e.keyCode===i.KEY.ENTER&&(o._collectAndCall(t,s),c(),i.stop(e)),e.keyCode===i.KEY.ESCAPE&&("function"==typeof r&&r(),c(),i.stop(e))},h=t.parameters;h.forEach(function(e){var n=h.getParameterElement?h.getParameterElement(e,s):null,r=null;!n&&e.label&&(r=document.createElement("label"),r.classList.add("parameterInput"),r.setAttribute("for",e.name+"parameterCollector"),r.textContent=e.label,s.appendChild(r));var o=e.type,a=e.name+"parameterCollector",u=r||s;"text"===o&&"number"==typeof e.lines&&e.lines>1?(n||(n=document.createElement("textarea"),n.rows=e.lines,n.type="textarea",n.id=a,u.appendChild(n)),d=function(e){e.keyCode===i.KEY.ESCAPE&&(c(),i.stop(e))}):"boolean"===e.type?(n||(n=document.createElement("input"),n.type="checkbox",n.id=a,u.appendChild(n)),e.value&&(n.checked=!0)):(n||(n=document.createElement("input"),n.type=e.type,n.id=a,u.appendChild(n)),e.value&&(n.value=e.value)),n.classList.add("parameterInput"),n.setAttribute("speech","speech"),n.setAttribute("x-webkit-speech","x-webkit-speech"),n.parameterName=e.name,l||(l=n),e.eventListeners.length>0&&e.eventListeners.forEach(function(e){n.addEventListener(e.event,function(i){return e.handler(i,t)},e.capture)}),n.addEventListener("keydown",d,!1)});var u=a;u||(u=document.createElement("span"),u.classList.add("layoutRight"),u.classList.add("parametersDismiss"),s.appendChild(u));var p=function(e){e._collectAndCall(t,s),c()},f=function(e,t){var i=document.createElement("button");return t.appendChild(i),e&&i.appendChild(document.createTextNode(e)),i.classList.add("dismissButton"),i};if(t.parameters.hasOptionalParameters()){t.parameters.optionsRequested=!1;var m=f(e.More,u);m.addEventListener("click",function(){t.parameters.optionsRequested=!0,p(o)},!1)}var g=f(h.getSubmitName?h.getSubmitName(t):e.Submit,u);g.addEventListener("click",function(){p(o)},!1);var v=f(null,u);return v.id="closebox",v.classList.add("imageSprite"),v.classList.add("core-sprite-close"),v.title=e.Close,v.addEventListener("click",function(){c(),"function"==typeof r&&r()},!1),l}}},n.prototype.constructor=n,{CommandParameterCollector:n}}),define("orion/regex",[],function(){function e(e){return e.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&")}function t(e){var t=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(e);return t?{pattern:t[1],flags:t[2]}:null}return{escape:e,parse:t}}),define("orion/contentTypes",[],function(){function e(e,t){return-1!==e.indexOf(t)}function t(t,i){function n(t,i,n,r){var o=i.filename.indexOf(n)>=0,s=e(i.extension,r.toLowerCase());return(o||s)&&(!t||o&&e(t.extension,r.toLowerCase()))?i:t}if("string"!=typeof t)return null;for(var r=t&&t.split(".").pop(),o=null,s=0;s<i.length;s++){var a=i[s];n(o,a,t,r)===a&&(o=a)}return o}function i(e){return null===e||"undefined"==typeof e?[]:Array.isArray(e)?e:[e]}function n(e){return i(e).map(function(e){return String.prototype.toLowerCase.call(e)})}function r(e){return{id:e.id,name:e.name,image:e.image,imageClass:e.imageClass,"extends":e["extends"],extension:n(e.extension),filename:i(e.filename)}}function o(e){var t=Object.create(null);return e.map(r).forEach(function(e){Object.prototype.hasOwnProperty.call(t,e.id)||(t[e.id]=e)}),t}function s(e){for(var t=e.getServiceReferences(c).concat(e.getServiceReferences(d)),n=[],r=0;r<t.length;r++)for(var s=t[r],a=i(s.getProperty("contentTypes")),l=0;l<a.length;l++)n.push(a[l]);return o(n)}function a(e){if(e&&e.registerService)this.serviceRegistry=e,this.map=s(e),e.registerService(l,this);else{if(!Array.isArray(e))throw new Error("Invalid parameter");this.serviceRegistry=null,this.map=o(e)}}var l="orion.core.contentTypeRegistry",c="orion.core.contenttype",d="orion.file.contenttype";return a.prototype={getContentTypes:function(){var e=this.getContentTypesMap(),t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(e[i]);return t},getContentTypesMap:function(){return this.map},getFileContentType:function(e){return t(e.Name,this.getContentTypes())},getFilenameContentType:function(e){return t(e,this.getContentTypes())},getContentType:function(e){return this.map[e]||null},isExtensionOf:function(e,t){if(e="string"==typeof e?this.getContentType(e):e,t="string"==typeof t?this.getContentType(t):t,!e||!t)return!1;if(e.id===t.id)return!0;for(var i=e,n={};i&&(i=this.getContentType(i["extends"]));){if(i.id===t.id)return!0;if(n[i.id])throw new Error("Cycle: "+i.id);n[i.id]=!0}return!1},isSomeExtensionOf:function(e,t){for(var i=0;i<t.length;i++)if(this.isExtensionOf(e,t[i]))return!0;return!1}},{ContentTypeRegistry:a,getFilenameContentType:t}}),define("orion/URITemplate",[],function(){function e(e){this._text=e}function t(e){return e.replace("%25","%")}function i(e,i){if("U"===i)return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()});if("U+R"===i)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(h,t);if("U+R-,"===i)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw new Error("Unknown allowed character set: "+i)}function n(e,t,n){for(var r=[],o=0;o<e.length;o++)"undefined"!=typeof e[o]&&r.push(i(e[o],t));return r.join(n)}function r(e,t,n,r){for(var o=Object.keys(e),s=[],a=0;a<o.length;a++)"undefined"!=typeof e[o[a]]&&s.push(i(o[a],t)+n+i(e[o[a]],t));return s.join(r)}function o(e){for(var t=[],i=e.split(","),n=0;n<i.length;n++){var r=i[n].match(d);if(null===r)throw new Error("Bad VarSpec: "+e);t.push({name:r[1],explode:!!r[2],prefix:r[3]?parseInt(r[3],10):-1})}return t}function s(e){if(0===e.length)throw new Error("Invalid Expression: 0 length expression");this._operator=c[e[0]],this._operator?e=e.substring(1):this._operator=c.NUL,this._varSpecList=o(e)}function a(t){for(var i=[],n=0,r=t.indexOf("{",n);-1!==r;){i.push(new e(t.substring(n,r)));var o=t.indexOf("}",r+1);if(-1===o)throw new Error("Invalid template: "+t);i.push(new s(t.substring(r+1,o))),n=o+1,r=t.indexOf("{",n)}return i.push(new e(t.substring(n))),i}function l(e){this._templateComponents=a(e)}var c={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"&",named:!0,ifemp:"=",allow:"U"},"&":{first:"&",sep:"&",named:!0,ifemp:"=",allow:"U"},"#":{first:"#",sep:",",named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},d=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,h=/%25[0-9A-F][0-9A-F]/g;return e.prototype={expand:function(){return encodeURI(this._text)}},s.prototype={expand:function(e){for(var t=[],o=0;o<this._varSpecList.length;o++){var s=this._varSpecList[o],a=s.name,l=e[a],c=typeof l;if("undefined"!==c&&null!==l){var d=0===t.length?this._operator.first:this._operator.sep;if("string"===c)this._operator.named&&(d+=i(a,"U+R"),d+=0===l.length?this._operator.ifemp:"="),-1!==s.prefix&&s.prefix<l.length&&(l=l.substring(0,s.prefix)),d+=i(l,this._operator.allow);else if(Array.isArray(l)){if(0===l.length)continue;if(s.explode)d+=n(l,this._operator.allow,this._operator.sep);else{var h=n(l,this._operator.allow,",");this._operator.named&&(d+=i(a,"U+R"),d+=0===h.length?this._operator.ifemp:"="),d+=h}}else{if("object"!==c)throw new Error("bad param type: "+a+" : "+c);if(0===Object.keys(l).length)continue;if(s.explode)d+=r(l,this._operator.allow,"=",this._operator.sep);else{var u=r(l,this._operator.allow,",",",");this._operator.named&&(d+=i(a,"U+R"),d+=0===u.length?this._operator.ifemp:"="),d+=u}}t.push(d)}}return t.join("")}},l.prototype={expand:function(e){for(var t=[],i=0;i<this._templateComponents.length;i++)t.push(this._templateComponents[i].expand(e));return t.join("")}},l}),define("orion/i18nUtil",["require","orion/Deferred"],function(e,t){function i(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,i){return t[(i<<0)+1]})}function n(e){var t=localStorage.getItem("orion/messageBundle/"+e);if(t){var i=JSON.parse(t);if(i._expires&&i._expires>(new Date).getTime())return delete i._expires,i}return null}function r(e,t){t._expires=(new Date).getTime()+9e5,localStorage.setItem("orion/messageBundle/"+e,JSON.stringify(t)),delete t._expires}function o(i){function o(t){t?e(["i18n!"+i],function(e){e&&r(i,e),l.resolve(e)}):a(new Error(i))}function a(e){l.reject(e)}if(s[i])return s[i];var l=new t;s[i]=l;var c=n(i);if(c)return l.resolve(c),l;try{e([i],o,a)}catch(d){e(["orion/i18n!"+i],o,a)}return l}var s={};return{getMessageBundle:o,formatMessage:i}}),define("orion/PageLinks",["require","orion/Deferred","orion/PageUtil","orion/URITemplate","orion/i18nUtil","orion/objects","orion/URL-shim"],function(e,t,i,n,r,o){function s(){return e.toUrl?new URL(e.toUrl("orion/../"),window.location.href).href.slice(0,-1):new URL("/",window.location.href).href.slice(0,-1)}function a(e,t){return d(e,t).then(function(e){return new p(e)})}function l(e){var t={};return e.getPropertyKeys().forEach(function(i){"objectClass"!==i&&"service.names"!==i&&"service.id"!==i&&"__plugin__"!==i&&(t[i]=e.getProperty(i))}),t}function c(e){return r.getMessageBundle(e.nls).then(function(t){return e.textContent=e.nameKey?t[e.nameKey]:e.name,e},function(){return e.textContent=e.nameKey||e.name,e})}function d(e,r){r=r||"orion.page.link";var o=e.getServiceReferences(r),a=i.matchResourceParameters(window.location.href),d=s(),h={OrionHome:d,Location:a.resource},u=[];return o.forEach(function(e){var r=l(e);if(r.uriTemplate&&(r.nls||r.name)){var o=new n(r.uriTemplate),s=o.expand(h);s=i.validateURLScheme(s),r.href=s,r.nls?u.push(c(r)):(r.textContent=r.name,u.push((new t).resolve(r)))}}),t.all(u)}function h(e){var i;if(!g){i=[];var n=e.getServiceReferences("orion.page.link.category");return n.forEach(function(n){var r=l(n);r.id&&(r.name||r.nameKey)&&(r.service=e.getService(n),r.nls?i.push(c(r)):(r.textContent=r.name,i.push((new t).resolve(r))))}),t.all(i).then(function(e){return g=new u(e)})}return(new t).resolve(g)}function u(e){var t=this.categories=Object.create(null);e.forEach(function(e){t[e.id]=e})}function p(e){this.allPageLinks=e,this.allPageLinks.sort(f)}function f(e,t){var i=e.textContent&&e.textContent.toLowerCase(),n=t.textContent&&t.textContent.toLowerCase();return n>i?-1:i>n?1:0}function m(e,t,i){var n=document.createElement("a");return n.href=e,n.target=t,n.classList.add("targetSelector"),n.textContent=i,n}var g;return o.mixin(u.prototype,{getCategoryIDs:function(){return Object.keys(this.categories)},getCategory:function(e){return this.categories[e]||null}}),o.mixin(p.prototype,{createLinkElements:function(){return this.allPageLinks.map(function(e){return m(e.href,"_self",e.textContent)})},getAllLinks:function(){return this.allPageLinks}}),{getCategoriesInfo:h,getPageLinksInfo:a,getOrionHome:s}}),define("orion/edit/nls/root/messages",{Editor:"Editor",switchEditor:"Switch Editor",Fetching:"Fetching: ${0}",confirmUnsavedChanges:"There are unsaved changes.  Do you still want to navigate away?",searchFiles:"Search Files...",searchTerm:"Enter search term:",unsavedChanges:"There are unsaved changes.",unsavedAutoSaveChanges:"Please stay on the page until Auto Save is complete.",Save:"Save",Saved:"Saved",Blame:"Blame",BlameTooltip:"Show blame annotations",saveOutOfSync:"Resource is out of sync with the server. Do you want to save it anyway?",loadOutOfSync:"Resource is out of sync with the server. Do you want to load it anyway? This will overwrite your local changes.",ReadingMetadata:"Reading metadata of ${0}",ReadingMetadataError:"Can not get metadata of ${0}",Reading:"Reading ${0}",readonly:"Read Only.",saveFile:"Save this file",gotoLine:"Go to Line...",gotoLineTooltip:"Go to specified line number",gotoLinePrompt:"Go to line:",Undo:"Undo",Redo:"Redo",Find:"Find...",noResponse:"No response from server.  Check your internet connection and try again.",savingFile:"Saving file ${0}",running:"Running ${0}","Saving...":"Saving...",View:"View",SidePanel:"Side Panel",SidePanelTooltip:"Choose what to show in the side panel.",Actions:"Actions",Navigator:"Navigator",FolderNavigator:"Folder Navigator",Project:"Project",New:"New",File:"File",Edit:"Edit",Tools:"Tools",Add:"Add",noActions:"There are no actions for the current selection.",NoFile:"Use the ${0} to create new files and folders. Click a file to start coding.",LocalEditorSettings:"Local Editor Settings",NoProject:"${0} is not a project. To convert it to a project use ${1}.",NoProjects:"There are no projects in your workspace. Use the ${0} menu to create projects.",disconnected:"(disconnected)",ChooseFS:"Choose Filesystem",ChooseFSTooltip:"Choose the filesystem you want to view.",FSTitle:"${0} (${1})",Deploy:"Deploy","Deploy As":"Deploy As",Import:"Import",Export:"Export",OpenWith:"Open With",OpenRelated:"Open Related",Dependency:"Dependency",UnnamedCommand:"Unnamed"}),define("orion/edit/nls/messages",["orion/i18n!orion/edit/nls/messages","orion/edit/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/extensionCommands",["require","orion/Deferred","orion/commands","orion/regex","orion/contentTypes","orion/URITemplate","orion/i18nUtil","orion/URL-shim","orion/PageLinks","i18n!orion/edit/nls/messages"],function(e,t,i,n,r,o,s,a,l,c){function d(e){var t={},i=e.getPropertyKeys();return i.forEach(function(i){t[i]=e.getProperty(i)}),t}function h(e){return e.id||e.name}var u={},p=l.getOrionHome();u._cloneItemWithoutChildren=function v(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var i in e)"children"!==i&&"Children"!==i&&(t[i]=v(e[i]));return t},u._getOpenWithNavCommandExtensions=function(e){function t(){for(var t=e.getServiceReferences("orion.edit.editor"),i=[],n=0;n<t.length;n++){var r=t[n],o=r.getProperty("id");i.push({id:o,"default":r.getProperty("default")||!1,name:r.getProperty("name"),nameKey:r.getProperty("nameKey"),nls:r.getProperty("nls"),uriTemplate:r.getProperty("orionTemplate")||r.getProperty("uriTemplate"),validationProperties:r.getProperty("validationProperties")||[]})}return i}function i(e,t){for(var i=e.getServiceReferences("orion.navigate.openWith"),n=[],r=[],o=0;o<i.length;o++){var s=i[o];if(s.getProperty("editor")===t.id){var a=s.getProperty("contentType");a instanceof Array?n=n.concat(a):n.push(a||"*/*");var l=s.getProperty("excludedContentTypes");l instanceof Array?r=r.concat(l):null!==l&&"undefined"!=typeof l&&r.push(l)}}return 0===n.length&&(n=null),0===r.length&&(r=null),{contentTypes:n,excludedContentTypes:r}}for(var n,r=t(),o=[],s="orion.editor",a=0;a<r.length;a++){var l=r[a],c=i(e,l),d=c.contentTypes,h=c.excludedContentTypes,u={name:l.name||l.id,nameKey:l.nameKey,id:"eclipse.openWithCommand."+l.id,contentType:d,excludedContentTypes:h,uriTemplate:l.uriTemplate,nls:l.nls,forceSingleItem:!0,isEditor:l["default"]?"default":"editor",validationProperties:l.validationProperties},p={properties:u,service:{}};l.id===s?n=p:o.push(p)}return n&&o.push(n),o},u._makeValidator=function(e,t,i,n){function s(e,t,i,n,r){var o,s=!1;if("!"===t.charAt(0))return"undefined"==typeof e[t.substring(1)];if("undefined"!=typeof e[t]){if("undefined"==typeof i)o=e[t],s=!0;else if("string"==typeof i){if(!n.variableName)return new RegExp(i).test(e[t]);var a=new RegExp(i).exec(e[t]);if(a){var l=a[0];o="before"===n.variableMatchPosition?e[t].substring(0,a.index):"after"===n.variableMatchPosition?e[t].substring(a.index+l.length):"only"===n.variableMatchPosition?l:e[t],s=!0}}else e[t]===i&&(o=e[t],s=!0);var c=n.variableName,d=n.replacements;if(s&&c&&(r[c]=o,r.itemCached=e,d)){if("string"!=typeof o)return window.console.log("Cannot replace "+c+", value is not a string: "+o),s;for(var h=0;h<d.length;h++){var u=!1;if(d[h].pattern){var p=d[h].pattern,f=d[h].replacement||"";r[c]=r[c].replace(new RegExp(p),f).replace(new RegExp(p),f)}else u=!0;u&&window.console.log("Invalid replacements specified in validation property.  "+d[h])}}return s}return!1}function a(e,t,i,n){var r,o,l,c,d=i.match;if((l=t.indexOf("["))>=0){if((c=t.indexOf("]"))<0)return!1;var h,u,p=t.substring(0,l);if(!(h=e[p])||!Array.isArray(h))return!1;if(r=t.substring(l+1,c),u=parseInt(r,10),isNaN(u))return!1;0>u&&(u+=h.length),o=t.substring(c+1),t=p+":"+String(u)+o}return t.indexOf("|")>=0?(r=t.substring(0,t.indexOf("|")),o=t.substring(t.indexOf("|")+1),a(e,r,i,n)?!0:a(e,o,i,n)):t.indexOf(":")>=0?(r=t.substring(0,t.indexOf(":")),o=t.substring(t.indexOf(":")+1),e[r]?a(e[r],o,i,n):!1):s(e,t,d,i,n)}function l(t,i,n){if(n.info.validationProperties)for(var o=0;o<n.info.validationProperties.length;o++){var s=n.info.validationProperties[o];if("undefined"==typeof s.source)return window.console.log("Invalid validationProperties in "+e.id+".  No source property specified."),!1;var l=a(t,s.source,s,n);if(!l)return!1}var c=!0,d=i?r.getFilenameContentType(t.Name,i):null;return d=d||{id:"application/octet-stream"},n.info.excludedContentTypes&&i&&(c=n.info.excludedContentTypes.every(function(e){var t=e.replace(/([*?])/g,".$1");return-1!==d.id.search(t)?!1:!0})),c&&n.info.contentType&&i&&(c=n.info.contentType.some(function(e){var t=e.replace(/([*?])/g,".$1");return-1!==d.id.search(t)?!0:!1})),c}var c={info:e};return c.validationFunction=function(e){if("function"==typeof n&&(e=n.call(this,e)),e){if(Array.isArray(e)){if((this.info.forceSingleItem||this.info.uriTemplate)&&1!==e.length)return!1;if(e.length<1)return!1}else e=[e];for(var t=0;t<e.length;t++)if(!l(e[t],i,this))return!1;return!0}return!1},c.generatesURI=function(){return!!this.info.uriTemplate},c.getURI=function(e){if(this.info.uriTemplate){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);if(this.info.validationProperties)for(var n=0;n<this.info.validationProperties.length;n++){var r=this.info.validationProperties[n];if(r.source&&r.variableName){var s=this.itemCached===e&&this[r.variableName];s||a(e,r.source,r,this),e[r.variableName]?window.console.log("Variable name "+r.variableName+" in the extension "+this.info.id+" conflicts with an existing property in the item metadata."):t[r.variableName]=this[r.variableName]}}t.OrionHome=p;var l=new o(this.info.uriTemplate);return l.expand(t)}return null},c};var f=c.UnnamedCommand,m="";u._createCommandOptions=function(e,i,n,r,o,a){function l(t,s){var l=u._makeValidator(e,n,r,a);if(t.visibleWhen=l.validationFunction.bind(l),o)if(l.generatesURI.bind(l)())t.hrefCallback=function(e){var t=Array.isArray(e.items)?e.items[0]:e.items;return l.getURI.bind(l)(t)};else{var c=e;t.callback=function(e){var r;if(c.forceSingleItem){var o=Array.isArray(e.items)?e.items[0]:e.items;r=u._cloneItemWithoutChildren(o)}else if(Array.isArray(e.items)){r=[];for(var s=0;s<e.items.length;s++)r.push(u._cloneItemWithoutChildren(e.items[s]))}else r=u._cloneItemWithoutChildren(e.items);if(n)var a=n.getService("orion.page.progress");i.run?a?a.progress(i.run(r),"Running command: "+t.name):i.run(r):n&&(a?a.progress(n.getService(i).run(r),"Running command: "+t.name):n.getService(i).run(r))}}s.resolve(t)}var c=new t;if(e.nls){var d=function(t){var i,n;if(t){var r=e.nameKey&&t[e.nameKey],o=e.tooltipKey&&t[e.tooltipKey];i=r||e.name||f,n=o||e.tooltip||m}else i=e.name||e.nameKey||f,n=e.tooltip||e.tooltipKey||m;var s={name:i,image:e.image,id:h(e),tooltip:n,isEditor:e.isEditor,showGlobally:e.showGlobally};l(s,c)};s.getMessageBundle(e.nls).then(d,d.bind(this,null))}else{var p={name:e.name,image:e.image,id:h(e),tooltip:e.tooltip,isEditor:e.isEditor,showGlobally:e.showGlobally};l(p,c)}return c},u.getOpenWithCommand=function(e,t,i){for(var n,r=i||u.getOpenWithCommands(e),o=0;o<r.length;o++)if(r[o].visibleWhen(t)){var s="default"===r[o].isEditor;if((!n||s)&&(n=r[o],s))break}return n},u.getOpenWithCommands=function(e){var t=[];for(var i in e._commandList){var n=e._commandList[i];n.isEditor&&t.push(n)}return t};var g;return u.createAndPlaceFileCommandsExtension=function(e,t,i,n,r,o){var s=o?"all":void 0,a=!!o;return u.createFileCommands(e,null,s,a,t).then(function(e){return r&&0<e.length&&(t.addCommandGroup(i,"eclipse.openWith",1e3,c.OpenWith,r,null,null,null,"dropdownSelection"),t.addCommandGroup(i,"eclipse.fileCommandExtensions",1e3,c.OpenRelated,r)),e.forEach(function(e){var o=null;r&&(o=e.isEditor?r+"/eclipse.openWith":r+"/eclipse.fileCommandExtensions"),t.registerCommandContribution(i,e.id,n,o)}),{}})},u.createFileCommands=function(e,n,r,o,s){function a(){var i=e.getService("orion.core.contentTypeRegistry")||n;return g||t.when(i.getContentTypes(),function(e){return g=e})}r=void 0===r?"global":r,o=void 0===o?!0:o;var l=[];return u._cachedFileCommands||u._createCachedFileCommands(e),("all"===r||"global"===r)&&u._cachedFileCommands.forEach(function(e){var t=e.properties;("all"===r||t.forceSingleItem&&t.showGlobally)&&l.push(e)}),t.when(a(),function(){o&&(u._cachedOpenWithExtensions||(u._cachedOpenWithExtensions=u._getOpenWithNavCommandExtensions(e,g)),l=l.concat(u._cachedOpenWithExtensions),s._addedOpenWithCommands=o);var n=l.map(function(n){var r=n.properties,o=n.service,a=s.findCommand(h(r));return a?(new t).resolve(a):u._createCommandOptions(r,o,e,g,!0).then(function(e){var t=new i.Command(e);return s.addCommand(t),t})});return t.all(n,function(e){return{_error:e}}).then(function(e){return e})})},u._createCachedFileCommands=function(e){var t=e.getServiceReferences("orion.navigate.command");u._cachedFileCommands=[];for(var i=0;i<t.length;i++){var n=t[i].getProperty("id");if("orion.navigateFromMetadata"!==n){var r=e.getService(t[i]),o=d(t[i]);u._cachedFileCommands.push({properties:o,service:r})}}},u.getFileCommandIds=function(){var e=[];if(!u._cachedFileCommands)throw"extensionCommandUtils._cachedFileCommands is not initialized";return u._cachedFileCommands.length&&(e=u._cachedFileCommands.map(function(e){return e.properties.id})),e},u.createOpenWithCommands=function(e,i,n){return n&&n._addedOpenWithCommands?(new t).resolve(u.getOpenWithCommands(n)):u.createFileCommands(e,i,"none",!0,n)},u}),define("orion/breadcrumbs",["require","orion/webui/littlelib"],function(e,t){function i(e){this._init(e)}return i.prototype={_init:function(e){var i=t.node(e.container);if(!i)throw"no parent container";this._container=i,i.classList.remove("currentLocation"),this._id=e.id||"eclipse.breadcrumbs",this._resource=e.resource||null,this._rootSegmentName=e.rootSegmentName,this._workspaceRootSegmentName=e.workspaceRootSegmentName,this._workspaceRootURL=e.workspaceRootURL,this._makeHref=e.makeHref,this._makeFinalHref=e.makeFinalHref,this._maxLength=e.maxLength,this.path="",this.measure(),this.render()
},getNavigatorWorkspaceRootSegment:function(){if(this._workspaceRootSegmentName){var i;if(this._resource&&this._resource.Parents&&!this._resource.skip){i=document.createElement("a");var n=this._workspaceRootURL?this._workspaceRootURL:"";this._makeHref?this._makeHref(i,n):i.href=e.toUrl("edit/edit.html")+"#"+n}else i=document.createElement("span");return t.empty(i),i.appendChild(document.createTextNode(this._workspaceRootSegmentName)),i}return null},MAX_LENGTH:500,INCLUDE_FIRST_SECTION:!0,segments:[],buildSegment:function(e){var t=document.createElement("a");return t.classList.add("breadcrumb"),t.appendChild(document.createTextNode(e)),t},addSegmentHref:function(t,i){this._makeHref?this._makeHref(t,i.Location,i):t.href=e.toUrl("edit/edit.html")+"#"+i.ChildrenLocation},buildSegments:function(e,t){if(this._resource.Parents){var i,n,r=this._resource.Parents.slice(0);if(r){var o=r.slice(0);"reverse"===t&&(o=o.reverse().slice(0)),o.forEach(function(t){t.skip||(e?(n=e,e=null):n=t.Name,i=this.buildSegment(n),this.path+=t.Name,this.addSegmentHref(i,t),i.include=!1,this.segments.push(i))}.bind(this))}}},addDivider:function(){var e=document.createElement("span");e.appendChild(document.createTextNode(" / ")),this.path+="/",e.classList.add("breadcrumbSeparator"),this.append(e)},refresh:function(){this.crumbs=t.node(this._id),this.crumbs?t.empty(this.crumbs):(this.crumbs=document.createElement("span"),this.crumbs.id=this._id,this._container.appendChild(this.crumbs),this.dirty=document.createElement("span"),this.dirty.id="dirty",this.dirty.className="modifiedFileMarker",this._container.appendChild(this.dirty)),this.crumbs.style.width="auto",this.crumbs.style.visibility="visible",this.crumbs.parentNode.className="currentLocation",this.crumbs.parentNode.style.width="auto"},append:function(e){this.crumbs.appendChild(e)},addTitle:function(e,t){var i=t||document.title;0===this.crumbs.childNodes.length&&(e=document.createElement("span"),e.appendChild(document.createTextNode(i)),e.classList.add("breadcrumb"),e.classList.add("currentLocation"),this.append(e))},finalSegment:function(e,t){if(!this._resource.skip){var i;i=t?t:this._resource.Name,this._makeFinalHref?(e=this.buildSegment(i),this.addSegmentHref(e,this._resource)):(e=document.createElement("span"),e.appendChild(document.createTextNode(i))),e.classList.add("currentLocation"),this.path+=this._resource.Name,this.append(e)}},firstSegment:function(e){if(e){if(this.append(e),!this._resource||!this._resource.Parents||this._resource.skip)return this._resource.skip||(e.href=""),void e.classList.add("currentLocation");e.classList.add("breadcrumb"),this.addDivider()}},drawSegments:function(){if(this._resource.Parents){var e=this.segments.slice(0);e.forEach(function(e){e.include===!0&&(this.append(e),this.addDivider())}.bind(this))}},measureSegments:function(){if(this.INCLUDE_FIRST_SECTION=!0,this._resource.Parents){var e=this.segments.slice(0).reverse();e.forEach(function(e){this.append(e),this.addDivider(),this.crumbs.offsetWidth<this.MAX_LENGTH?e.include=!0:this.INCLUDE_FIRST_SECTION=!1}.bind(this)),this.segments=e.reverse()}},measure:function(){var e=this._container;e.style.width="auto",this.MAX_LENGTH=this._maxLength?this._maxLength:e.offsetWidth,this.refresh(),this.segments=[],this.crumbs.style.visibility="hidden";var t=this.getNavigatorWorkspaceRootSegment(),i=this._rootSegmentName;i?this.addTitle(t,i):(this.finalSegment(t,i),this._resource&&this._resource.Parents&&(this.buildSegments(i,"reverse"),this.measureSegments(),this.firstSegment(t)),this.crumbs.offsetWidth>=this.MAX_LENGTH&&(this.INCLUDE_FIRST_SECTION=!1))},render:function(){this.refresh();var e=this.getNavigatorWorkspaceRootSegment(),t=this._rootSegmentName;t?this.addTitle(e,t):(this.INCLUDE_FIRST_SECTION===!0&&this.firstSegment(e),this._resource&&this._resource.Parents&&(this.drawSegments(),this.finalSegment(e,t))),this.crumbs.parentNode.style.width=this.crumbs.offsetWidth+20+"px"}},i.prototype.constructor=i,{BreadCrumbs:i}}),define("orion/webui/splitter",["orion/EventTarget","orion/util","orion/webui/littlelib"],function(e,t,i){function n(t){e.attach(this),this._init(t)}var r=5,o="horizontal",s="vertical";return n.prototype={_init:function(e){if(this._tracking=null,this._animationDelay=501,this._closeReversely=e.closeReversely,this.$node=i.node(e.node),!this.$node)throw"no dom node for splitter found";if(this.$sideNode=i.node(e.sidePanel),!this.$sideNode)throw"no dom node for side panel found";if(this.$mainNode=i.node(e.mainPanel),!this.$mainNode)throw"no dom node for main panel found";this._vertical=e.vertical||!1;var n=this.$node.classList;n.add("split"),n.add(this._vertical?"splitVerticalLayout":"splitLayout"),n=this.$sideNode.classList,n.add("hasSplit"),n.add(this._vertical?"sidePanelVerticalLayout":"sidePanelLayout"),n=this.$mainNode.classList,n.add("hasSplit"),n.add(this._vertical?"mainPanelVerticalLayout":"mainPanelLayout"),this._prefix="/orion/splitter/"+(this.$node.id||document.body.id||""),e.toggle&&(this._thumb=document.createElement("div"),this.$node.appendChild(this._thumb),this._thumb.classList.add("splitThumb"),this._thumb.classList.add(this._vertical?"splitVerticalThumbLayout":"splitThumbLayout")),this._closeByDefault="closed"===this.$node.getAttribute("data-initial-state"),"undefined"!=typeof e.closeByDefault&&(this._closeByDefault=e.closeByDefault),this._initializeFromStoredSettings(),this._closed?(this._closed=!1,this._thumbDown(!0,!0)):this._adjustToSplitPosition(),this.$node.style.visibility="visible",this.$mainNode.style.display="block",this.$sideNode.style.display="block",t.isIOS||t.isAndroid?(this.$node.addEventListener("touchstart",this._touchStart.bind(this),!1),this._thumb&&this._thumb.addEventListener("touchstart",this._touchStart.bind(this),!1),this.$node.addEventListener("touchmove",this._touchMove.bind(this),!1),this.$node.addEventListener("touchend",this._touchEnd.bind(this),!1)):(this.$node.addEventListener("mousedown",this._mouseDown.bind(this),!1),window.addEventListener("mouseup",this._mouseUp.bind(this),!1)),window.addEventListener("resize",this._resize.bind(this),!1)},isClosed:function(){return this._closed},getOrientation:function(){return this._vertical?s:o},setOrientation:function(e){var t=e===s;if(t!==this._vertical){this._vertical=t;var i=this.$node.classList;i.toggle("splitLayout"),i.toggle("splitVerticalLayout"),this.$node.style.left="",this.$node.style.top="",i=this.$sideNode.classList,i.toggle("sidePanelLayout"),i.toggle("sidePanelVerticalLayout"),this.$sideNode.style.left="",this.$sideNode.style.top="",this.$sideNode.style.width="",this.$sideNode.style.height="",i=this.$mainNode.classList,i.toggle("mainPanelLayout"),i.toggle("mainPanelVerticalLayout"),this.$mainNode.style.left="",this.$mainNode.style.top="",this.$mainNode.style.width="",this.$mainNode.style.height="",this._thumb&&(i=this._thumb.classList,i.toggle("splitThumbLayout"),i.toggle("splitVerticalThumbLayout")),this._initializeFromStoredSettings(),this._closed?(this._closed=!1,this._thumbDown(!0,!0)):this._adjustToSplitPosition()}},toggleSidePanel:function(){this._thumbDown()},openSidePanel:function(){this._closed||this._thumbDown()},addResizeListener:function(e){this.addEventListener("resize",function(t){e(t.node)})},_initializeFromStoredSettings:function(){var e=localStorage.getItem(this._prefix+"/toggleState");this._closed="string"==typeof e?"closed"===e:this._closeByDefault;var t,n=i.bounds(this.$node.parentNode),r=i.bounds(this.$node);this._vertical?(t=localStorage.getItem(this._prefix+"/yPosition"),t?(this._splitTop=parseInt(t,10),this._splitTop>n.top+n.height-r.height&&(this._splitTop=n.top+n.height/2)):this._closeByDefault&&(this._initialSplit=this._getSplitPosition(),this._splitTop=0)):(t=localStorage.getItem(this._prefix+"/xPosition"),t?(this._splitLeft=parseInt(t,10),this._splitLeft>n.left+n.width-r.width&&(this._splitLeft=n.left+n.width/2)):this._closeByDefault&&(this._initialSplit=this._getSplitPosition(),this._splitLeft=0))},_getSplitPosition:function(){var e=i.bounds(this.$node),t=i.bounds(this.$node.parentNode);return this.vertical?e.top-t.top:e.left-t.left},_adjustToSplitPosition:function(e){var t=i.bounds(this.$node),n=i.bounds(this.$node.parentNode);if(this._vertical){this._splitHeight=t.height,(e||!this._splitTop)&&(this._splitTop=t.top,localStorage.setItem(this._prefix+"/yPosition",this._splitTop));var r=this._splitTop;r=this._splitTop-n.top,this.$sideNode.style.height=r+"px",this.$sideNode.style.display="block",this.$node.style.top=r+"px",this._resize()}else{this._splitWidth=t.width,(e||!this._splitLeft)&&(this._splitLeft=t.left,localStorage.setItem(this._prefix+"/xPosition",this._splitLeft));var o=this._splitLeft;o=this._splitLeft-n.left,this.$sideNode.style.width=o+"px",this.$sideNode.style.display="block",this.$node.style.left=o+"px",this._resize()}},_resize:function(e,t,n){e=e||0;var r=i.bounds(this.$node.parentNode),o=i.bounds(this.$node);this._vertical?(void 0===n&&(n=o.top-r.top),n+=o.height,this.$mainNode.style.top=n+"px"):(void 0===t&&(t=o.left-r.left),t+=o.width,this.$mainNode.style.left=t+"px");var s=this;window.setTimeout(function(){s._notifyResizeListeners(s.$mainNode),s._notifyResizeListeners(s.$sideNode)},e)},_notifyResizeListeners:function(e){this.dispatchEvent({type:"resize",node:e})},_notifyToggleListeners:function(){this.dispatchEvent({type:"toggle",closed:this._closed})},_thumbDown:function(e,t){e||this._addAnimation();var n=this._splitTop,r=this._splitLeft;if(this._closed)this._closed=!1,this._splitLeft||this._splitTop||"number"!=typeof this._initialSplit||(n=r=this._initialSplit);else if(this._closed=!0,this._closeReversely){var o=i.bounds(this.$node.parentNode),s=i.bounds(this.$node);this._vertical?n=o.height-s.height:r=o.width-s.width}else n=r=0;this._vertical?(this.$sideNode.style.height=n+"px",this.$node.style.top=n+"px"):(this.$sideNode.style.width=r+"px",this.$node.style.left=r+"px"),this._resize(this._animationDelay,r,n),e||this._removeAnimation(),t||localStorage.setItem(this._prefix+"/toggleState",this._closed?"closed":null);var a=this;window.setTimeout(function(){a._notifyToggleListeners()},this._animationDelay)},_removeAnimation:function(){var e=this;window.setTimeout(function(){e.$sideNode.classList.remove(e._vertical?"sidePanelVerticalLayoutAnimation":"sidePanelLayoutAnimation"),e.$mainNode.classList.remove(e._vertical?"mainPanelVerticalLayoutAnimation":"mainPanelLayoutAnimation"),e.$node.classList.remove(e._vertical?"splitVerticalLayoutAnimation":"splitLayoutAnimation")},this._animationDelay)},_addAnimation:function(){this.$sideNode.classList.add(this._vertical?"sidePanelVerticalLayoutAnimation":"sidePanelLayoutAnimation"),this.$mainNode.classList.add(this._vertical?"mainPanelVerticalLayoutAnimation":"mainPanelLayoutAnimation"),this.$node.classList.add(this._vertical?"splitVerticalLayoutAnimation":"splitLayoutAnimation")},_down:function(){this.$node.classList.add("splitTracking"),this.$mainNode.classList.add("panelTracking"),this.$sideNode.classList.add("panelTracking")},_move:function(e,t){var n=i.bounds(this.$node.parentNode);if(this._vertical){this._splitTop=t,this._splitTop<n.top+r?this._splitTop=n.top+r:this._splitTop>n.top+n.height-r&&(this._splitTop=n.top+n.height-r);var o=this._splitTop;o=this._splitTop-n.top,this.$node.style.top=o+"px"}else{this._splitLeft=e,this._splitLeft<n.left+r?this._splitLeft=n.left+r:this._splitLeft>n.left+n.width-r&&(this._splitLeft=n.left+n.width-r);var s=this._splitLeft;s=this._splitLeft-n.left,this.$node.style.left=s+"px"}this._adjustToSplitPosition(!0)},_up:function(){this.$node.classList.remove("splitTracking"),this.$mainNode.classList.remove("panelTracking"),this.$sideNode.classList.remove("panelTracking")},_mouseDown:function(e){return e.target===this._thumb?(i.stop(e),this._thumbDown()):void(this._tracking||(this._down(e),this._tracking=this._mouseMove.bind(this),window.addEventListener("mousemove",this._tracking),i.setFramesEnabled(!1),i.stop(e)))},_mouseMove:function(e){this._tracking&&this._move(e.clientX,e.clientY)},_mouseUp:function(e){this._tracking&&(i.setFramesEnabled(!0),window.removeEventListener("mousemove",this._tracking),this._tracking=null,this._up(),i.stop(e))},_touchStart:function(e){var t=e.touches;if(1===t.length){if(i.stop(e),e.target===this._thumb)return this._thumbDown();this._down(e),this._touching=!0}},_touchMove:function(e){if(this._touching){var t=e.touches;if(1===t.length){var i=t[0];this._move(i.clientX,i.clientY)}}},_touchEnd:function(e){var t=e.touches;0===t.length&&(this._touching=!1,this._up())}},n.prototype.constructor=n,{Splitter:n,ORIENTATION_HORIZONTAL:o,ORIENTATION_VERTICAL:s}}),define("orion/keyAssist",["i18n!orion/nls/messages","orion/webui/littlelib","orion/util"],function(e,t,i){function n(e){this.commandRegistry=e.commandRegistry,this.create(),this._filterString="",this._providers=[]}return n.prototype={addProvider:function(e){this._providers.push(e)},create:function(){var n=this._keyAssistDiv=document.createElement("div");n.id="keyAssist",n.style.display="none",n.classList.add("keyAssistFloat"),n.setAttribute("role","menu");var r=this._keyAssistInput=document.createElement("input");r.classList.add("keyAssistInput"),r.type="text",r.placeholder=e["Filter bindings"],n.appendChild(r);var o=this._keyAssistContents=document.createElement("div");o.classList.add("keyAssistContents"),(i.isIOS||i.isAndroid)&&(o.style.overflowY="auto"),n.appendChild(o);var s=this._keyAssistTable=document.createElement("table");s.tabIndex=0,s.classList.add("keyAssistList"),o.appendChild(s),document.body.appendChild(n),r.addEventListener("keydown",function(e){this._keyDown(e)}.bind(this)),s.addEventListener("keydown",function(e){this._keyDown(e)}.bind(this)),r.addEventListener("input",function(){this.filterChanged()}.bind(this)),o.addEventListener(i.isFirefox?"DOMMouseScroll":"mousewheel",function(e){this._scrollWheel(e)}.bind(this)),document.addEventListener("keydown",function(e){e.keyCode===t.KEY.ESCAPE&&this.hide()}.bind(this)),t.addAutoDismiss([n],function(){this.hide()}.bind(this))},createContents:function(){var i=this._keyAssistTable;t.empty(i),this._selectedIndex=-1,this._selectedRow=null,this._keyAssistContents.scrollTop=0,this._idCount=0;for(var n=0;n<this._providers.length;n++)this._providers[n].showKeyBindings(this);this.createHeader(e.Global),this.commandRegistry.showKeyBindings(this)},createItem:function(e,t,i){if(this._filterString){var n,r=this._filterString.toLowerCase();if(r!==this._filterString?(r=this._filterString,n=function(e){return e}):n=function(e){return e.toLowerCase()},-1===n(t).indexOf(r)&&-1===n(e).indexOf(r)&&-1===n(this._lastHeader).indexOf(r))return}var o=this._keyAssistTable.insertRow(-1);o.id="keyAssist-keyBinding-"+this._idCount++,o.setAttribute("role","menuitem"),o._execute=i,o.classList.add("keyAssistItem"),o.addEventListener("click",function(e){this._selectedRow=o,this.execute(),e.preventDefault()}.bind(this));var s=o.insertCell(-1);s.classList.add("keyAssistName"),s.appendChild(document.createTextNode(t)),s=o.insertCell(-1),s.classList.add("keyAssistAccel"),s.appendChild(document.createTextNode(e))},createHeader:function(e){this._lastHeader=e;var t=this._keyAssistTable.insertRow(-1);t.classList.add("keyAssistSection");var i=t.insertCell(-1),n=document.createElement("h2");n.appendChild(document.createTextNode(e)),i.appendChild(n)},execute:function(){window.setTimeout(function(){this.hide();var e=this._selectedRow;this._selectedRow=null,e&&e._execute&&e._execute()}.bind(this),0)},filterChanged:function(){this._timeout&&window.clearTimeout(this._timeout),this._timeout=window.setTimeout(function(){this._timeout=null;var e=this._keyAssistInput.value;this._filterString!==e&&(this._filterString=e,this.createContents())}.bind(this),100)},hide:function(){if(this.isVisible()){var e=document.activeElement,t=this._keyAssistDiv,i=t===e||0!==(16&t.compareDocumentPosition(e));t.style.display="none",i&&1!==document.compareDocumentPosition(this._previousActiveElement)&&this._previousActiveElement.focus(),this._previousActiveElement=null}},isVisible:function(){return"block"===this._keyAssistDiv.style.display},removeProvider:function(e){var t=this._providers.indexOf(e);-1!==t&&this._providers.splice(t,1)},select:function(e){var t,i=this._keyAssistTable.querySelectorAll(".keyAssistItem");if(0===i.length)return void(this._selectedIndex=-1);var n=this._selectedIndex;if(n+=e?1:-1,n%=i.length,0>n&&(n=i.length-1),-1!==this._selectedIndex&&(t=i[this._selectedIndex],t.classList.remove("selected"),this._selectedRow=null),this._selectedIndex=n,-1!==this._selectedIndex){this._selectedRow=t=i[this._selectedIndex],t.classList.add("selected"),this._keyAssistTable.setAttribute("aria-activedescendant",t.id),this._keyAssistTable.focus();var r=t.getBoundingClientRect(),o=this._keyAssistContents,s=o.getBoundingClientRect();t.offsetTop<o.scrollTop?0===n?o.scrollTop=0:t.scrollIntoView(!0):r.bottom>s.bottom&&t.scrollIntoView(!1)}},show:function(){this.isVisible()||(this._previousActiveElement=document.activeElement,this.createContents(),this._keyAssistContents.style.height=Math.floor(.75*this._keyAssistDiv.parentNode.clientHeight)+"px",this._keyAssistDiv.style.display="block",this._keyAssistInput.value=this._filterString,this._keyAssistInput.focus(),this._keyAssistInput.select())},_keyDown:function(e){if(40===e.keyCode)this.select(!0);else if(38===e.keyCode)this.select(!1);else{if(13!==e.keyCode)return;this.execute()}e.preventDefault()},_scrollWheel:function(e){var t=0;t=i.isIE||i.isOpera?-e.wheelDelta:i.isFirefox?40*e.detail:-e.wheelDeltaY;var n=this._keyAssistContents,r=n.scrollTop;return n.scrollTop+=t,r!==n.scrollTop?(e.preventDefault&&e.preventDefault(),!1):void 0}},{KeyAssistPanel:n}}),define("orion/widgets/themes/ThemePreferences",[],function(){function e(e,t){this._preferences=e,this._themeData=t;var i=t.getThemeStorageInfo();this._themeVersion=i.version;var n=e.listenForChangedSettings(i.storage,2,function(e){e.key===n&&this.apply()}.bind(this))}return e.prototype={_initialize:function(e,t,i){var n,r;void 0===this._themeVersion||i.get("version")===this._themeVersion?(n=i.get(e.styleset),r=i.get("selected"),r&&(r=JSON.parse(r))):(n=null,r=null),n||(n=t.getStyles(),i.put(e.styleset,JSON.stringify(n))),r&&void 0!==r[e.selectedKey]||(r=r||{},r[e.selectedKey]=e.defaultTheme,i.put("selected",JSON.stringify(r))),i.put("version",this._themeVersion)},apply:function(){this.setTheme()},getTheme:function(e){var t=this._themeData,i=t.getThemeStorageInfo();this._preferences.getPreferences(i.storage,2).then(function(n){this._initialize(i,t,n);var r,o=JSON.parse(n.get("selected")),s=JSON.parse(n.get(i.styleset));if(s)for(var a=0;a<s.length;a++)if(s[a].name===o[i.selectedKey]){r=s[a];break}e({style:r,styles:s})}.bind(this))},setTheme:function(e,t){var i=this._themeData,n=i.getThemeStorageInfo();this._preferences.getPreferences(n.storage,2).then(function(r){this._initialize(n,i,r);var o=JSON.parse(r.get("selected"));e||(e=o[n.selectedKey]),o[n.selectedKey]=e,r.put("selected",JSON.stringify(o)),t?r.put(n.styleset,JSON.stringify(t)):t=JSON.parse(r.get(n.styleset));for(var s=0;s<t.length;s++)if(t[s].name===o[n.selectedKey]){i.processSettings(t[s]);break}r.put("version",this._themeVersion)}.bind(this))},setFontSize:function(e){var t=this._themeData,i=t.getThemeStorageInfo();this._preferences.getPreferences(i.storage,2).then(function(n){this._initialize(i,t,n);var r,o=JSON.parse(n.get("selected")),s=JSON.parse(n.get(i.styleset));if(s)for(var a=0;a<s.length;a++)s[a].fontSize=e,s[a].name===o[i.selectedKey]&&(r=s[a]);n.put(i.styleset,JSON.stringify(s)),t.processSettings(r)}.bind(this))}},{ThemePreferences:e}}),define("orion/settings/nls/root/messages",{"Plugin Description":"Plugin Description",Create:"Create","Loading...":"Loading...","Label:":"Label:",Title:"Title",Plugins:"Plugins","User Profile":"User Profile",Git:"Git","Git Settings":"Git Settings",General:"General",Navigation:"Navigation",Links:"Links","Open in same tab":"Open in same tab","Open in new tab":"Open in new tab",Font:"Font",Family:"Family","Sans Serif":"Sans Serif",Serif:"Serif",Size:"Size","8pt":"8pt","9pt":"9pt","10pt":"10pt","12pt":"12pt",Color:"Color",Background:"Background",Strings:"Strings","String Types":"String Types",blue:"blue",Weight:"Weight",Normal:"Normal",Bold:"Bold",Comments:"Comments","Comment Types":"Comment Types",green:"green",Keywords:"Keywords","Keyword Types":"Keyword Types",darkred:"darkred",Categories:"Categories",Username:"Username","Full Name":"Full Name","Email Address":"Email Address","Email Confirmed":"Email Confirmed",Account:"Account","Current Password":"Current Password","New Password":"New Password","Verify Password":"Verify Password",Password:"Password",OpenId:"OpenId",AOL:"AOL",Yahoo:"Yahoo",Google:"Google",Unlink:"Unlink",Link:"Link",Unlinked:"Unlinked",Linked:"Linked","Linked Accounts":"Linked Accounts","Git Email Address":"Git Email Address","Git Username":"Git Username","Git Credentials Storage":"Git Credentials Storage",Update:"Update","Update Profile Settings":"Update Profile Settings","Update Git User Settings":"Update Git User Settings","Update Git Credentials":"Update Git Credentials","User profile data successfully updated.":"User profile data successfully updated.","Git user data successfully updated.":"Git user data successfully updated.","Git Credentials successfully updated.":"Git Credentials successfully updated.","Edit Plugin JavaScript":"Edit Plugin JavaScript","Install Plugin":"Install Plugin","Plugin Name:":"Plugin Name:","Author Name:":"Author Name:","Licence:":"Licence:","Description:":"Description:","A plugin for Eclipse Orion":"A plugin for Eclipse Orion","Plugin Link":"Plugin Link",Install:"Install","Install a plugin by specifying its URL":"Install a plugin by specifying its URL","Plugin URL:":"Plugin URL:",Disable:"Disable",DisableTooltip:"Disable the plugin",Enable:"Enable",EnableTooltip:"Enable the plugin","Reload all":"Reload all","Reload all installed plugins":"Reload all installed plugins","Create a new Orion Plugin":"Create a new Orion Plugin","Find More Orion Plugins":"Find More Orion Plugins","Get Plugins":"Get Plugins",Reload:"Reload","Reload the plugin":"Reload the plugin",Delete:"Delete","Delete this plugin from the configuration":"Delete this plugin from the configuration",DeleteUser:"Delete User Profile as well as workspaces and projects",DeleteUserComfirmation:"WARNING: This will permanently delete your user profile as well all your work!","Type a plugin url here ...":"Type a plugin url here ...","Installed ":"Installed ","Installing ":"Installing ","Already installed":"Already installed"," plugin":" plugin","Reloaded ":"Reloaded ","Uninstalled ":"Uninstalled ","Are you sure you want to uninstall '":"Are you sure you want to uninstall '",Services:"Services",Value:"Value","JavaScript Object":"JavaScript Object","click here, then check javascript console to drill down":"click here, then check javascript console to drill down",Item:"Item","Git Config":"Git Config","Clear Git Credentials":"Clear Git Credentials","Enable Storage":"Enable Storage","Please be aware that your credentials will be stored persistently in the browser.":"Please be aware that your credentials will be stored persistently in the browser.","Do you wish to enable the Key Storage?":"Do you wish to enable the Key Storage?",general:"General",validation:"Validation","Deleted git credentials for ${0}":"Deleted git credentials for ${0}",Editor:"Editor",editorSettings:"Settings",EditorThemes:"Themes",Import:"Import","Import a theme":"Import a theme",Export:"Export","Export a theme":"Export a theme","Theme name:":"Theme name:",yourTheme:"yourTheme",fileManagement:"File Management",typing:"Typing",autoSave:"Auto Save",autoSaveTimeout:"Save interval (ms)",autoLoad:"Auto Load",saveDiffs:"Save file as diffs",trimTrailingWhiteSpace:"Trim Trailing Whitespace on Save",Restore:"Restore Defaults",Default:"Default",keys:"Keys",tabs:"Tabs",tabSize:"Tab Size",expandTab:"Insert spaces for tabs",smoothScrolling:"Smooth Scrolling",scrollAnimation:"Scrolling Animation",scrollAnimationTimeout:"Scrolling Duration (ms)",keyBindings:"Key Bindings",rulers:"Rulers",annotationRuler:"Show Annotation Ruler",lineNumberRuler:"Show Line Number Ruler",foldingRuler:"Show Folding Ruler",overviewRuler:"Show Overview Ruler",whitespaces:"White Spaces",wrapping:"Wrapping",wordWrap:"Word Wrap",showMargin:"Show Margin",marginOffset:"Margin Column",showTabs:"Show Tabs",showSpaces:"Show Spaces",autoSaveTimeoutInvalid:"Invalid save interval.",scrollAnimationTimeoutInvalid:"Invalid scrolling duration.",tabSizeInvalid:"Invalid tab size.",localSettingsTooltip:"Toggle whether this setting is shown in the local editor settings drop down.",editorSettingsInfo:"Use the ${0} and ${1} to toggle whether a given setting is shown in the local editor settings drop down ${2}.",autoPairParentheses:"Autopair (Parentheses)",autoPairBraces:"Autopair {Braces}",autoPairSquareBrackets:"Autopair [Square] Brackets",autoPairAngleBrackets:"Autopair <Angle> Brackets",autoPairQuotations:'Autopair "Strings"',autoCompleteComments:"Autocomplete /** Block Comments */",smartIndentation:"Smart Indentation",sourceControl:"Source Control",showBlame:"Show Blame",languageTools:"Language Tools",showOccurrences:"Show Occurrences",contentAssistAutoTrigger:"Show Content Assist automatically","Editor preferences updated":"Editor preferences updated","Editor defaults restored":"Editor defaults restored",Theme:"Theme","Font Size":"Font Size","New Theme Name:":"New Theme Name:","Font Size:":"Font Size:","UI Theme":"UI Theme","Navigation Bar":"Navigation Bar","Navigation Text":"Navigation Text","Search Box":"Search Box","Tool Panel":"Tool Panel","Selection Bar":"Selection Bar",Location:"Location",Content:"Content","Main Panel":"Main Panel",Button:"Button","Button Text":"Button Text","Section Text":"Section Text","Side Panel":"Side Panel","Line Color":"Line Color","Line Numbers":"Line Numbers",Foreground:"Foreground","Current Line":"Current Line","HTML Attribute":"HTML Attribute","Overview Ruler":"Overview Ruler","HTML Tag":"HTML Tag","Annotation Ruler":"Annotation Ruler","Show Guide":"Show Guide","Check Guide":"Check Guide",Cancel:"Cancel","Revert Theme":"Revert Theme","Update Theme":"Update Theme","Theme:":"Theme:",clickDiagram:"Click diagram to style.",clickUpdate:"Click Update button to save preview.","CSS Class Name":"CSS Class Name","CSS Attribute":"CSS Attribute","CSS Value":"CSS Value","CSS Text":"CSS Text","COLOR:":"Color:","NEW COLOR:":"New Color:",Ok:"Ok","OR HEX:":"Or Hex: ",splitEditors:"Split Editors",splitOrientation:"Split Orientation",horizontal:"Horizontal",vertical:"Vertical"}),define("orion/settings/nls/messages",["orion/i18n!orion/settings/nls/messages","orion/settings/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/editor/eventTarget",[],function(){function e(){}return e.addMixin=function(t){var i=e.prototype;for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},e.prototype={addEventListener:function(e,t,i){this._eventTypes||(this._eventTypes={});var n=this._eventTypes[e];n||(n=this._eventTypes[e]={level:0,listeners:[]});var r=n.listeners;r.push({listener:t,useCapture:i})},dispatchEvent:function(e){var t=e.type;this._dispatchEvent("pre"+t,e),this._dispatchEvent(t,e),this._dispatchEvent("post"+t,e)},_dispatchEvent:function(e,t){var i=this._eventTypes?this._eventTypes[e]:null;if(i){var n=i.listeners;try{if(i.level++,n)for(var r=0,o=n.length;o>r;r++)if(n[r]){var s=n[r].listener;"function"==typeof s?s.call(this,t):s.handleEvent&&"function"==typeof s.handleEvent&&s.handleEvent(t)}}finally{if(i.level--,i.compact&&0===i.level){for(var a=n.length-1;a>=0;a--)n[a]||n.splice(a,1);0===n.length&&delete this._eventTypes[e],i.compact=!1}}}},isListening:function(e){return this._eventTypes?void 0!==this._eventTypes[e]:!1},removeEventListener:function(e,t,i){if(this._eventTypes){var n=this._eventTypes[e];if(n){for(var r=n.listeners,o=0,s=r.length;s>o;o++){var a=r[o];if(a&&a.listener===t&&a.useCapture===i){0!==n.level?(r[o]=null,n.compact=!0):r.splice(o,1);break}}0===r.length&&delete this._eventTypes[e]}}}},{EventTarget:e}}),define("orion/editor/textTheme",["require","orion/editor/eventTarget","orion/util"],function(e,t,i){function n(e){e=e||{},this._document=e.document||document}var r="orion-theme-",o={};return n.getTheme=function(e){e=e||"default";var t=o[e];return t||(t=o[e]=new n),t},n.prototype={getThemeClass:function(){return this._themeClass},setThemeClass:function(e,t){var i=this,n=i._themeClass;i._themeClass=e,this._load(e,t,function(){i.onThemeChanged({type:"ThemeChanged",oldValue:n,newValue:i.getThemeClass()})})},onThemeChanged:function(e){return this.dispatchEvent(e)},buildStyleSheet:function(e,t){function i(t,i,r){i&&(n.push("."+e+" ."+t+" {"),n.push("	"+(r?"background-color":"color")+": "+i+";"),n.push("}"))}var n=[];return n.push(""),n.push("."+e+" {"),t.fontFamily&&n.push("	font-family: "+t.fontFamily+";"),t.fontSize&&n.push("	font-size: "+t.fontSize+";"),t.fontSize&&n.push("	color: "+t.text+";"),n.push("}"),n.push("."+e+".textview {"),t.background&&n.push("	background-color: "+t.background+";"),n.push("}"),n.push("."+e+" .textviewLeftRuler {"),t.leftRuler&&n.push("	border-right: 1px solid "+t.leftRuler+";"),n.push("}"),n.push("."+e+" .textviewRightRuler {"),t.rightRuler&&n.push("	border-left: 1px solid "+t.rightRuler+";"),n.push("}"),i("ruler.annotations",t.annotationRuler,!0),i("ruler.lines",t.annotationRuler,!0),i("ruler.folding",t.annotationRuler,!0),i("ruler.overview",t.overviewRuler,!0),i("rulerLines",t.lineNumber,!1),i("rulerLines.even",t.lineNumberEven,!1),i("rulerLines.odd",t.lineNumberOdd,!1),i("annotationLine.currentLine",t.currentLine,!0),i("entity-name-tag",t.keyword,!1),i("entity-other-attribute-name",t.attribute,!1),i("string-quoted",t.string,!1),i("meta.annotation.currentLine",t.currentLine,!0),i("keyword",t.keyword,!1),i("string",t.string,!1),i("constant",t.constant,!1),i("comment",t.comment,!1),i("comment.block.documentation",t.comment,!1),i("keyword.other.documentation.markup",t.comment,!1),i("keyword.other.documentation.markup",t.comment,!1),n.join("\n")},_createStyle:function(e,t,n,o){var s=this._document,a=r+e,l=s.getElementById(a);if(l){if(o||l.firstChild.data===t)return;l.removeChild(l.firstChild),l.appendChild(s.createTextNode(t))}else{o?(l=i.createElement(s,"link"),l.rel="stylesheet",l.type="text/css",l.href=t,l.addEventListener("load",function(){n()})):(l=i.createElement(s,"style"),l.appendChild(s.createTextNode(t))),l.id=a;var c=s.getElementsByTagName("head")[0]||s.documentElement;c.appendChild(l)}o||n()},_load:function(t,i,n){if(!t)return void n();if("string"==typeof i)return void this._createStyle(t,i,n);var r=i.href,o=".css";if(r.substring(r.length-o.length)!==o&&(r+=o),/^\//.test(r)||/[a-zA-Z0-9]+:\/\//i.test(r)||!e.toUrl)this._createStyle(t,r,n,!0);else{var s=this;e(["text!"+r],function(e){s._createStyle(t,e,n,!1)})}}},t.EventTarget.addMixin(n.prototype),{TextTheme:n}}),define("orion/widgets/themes/ThemeClass",[],function(){function e(e){this.attributes=[],this.element=document.createElement("div"),this.style=this.element.style,this.className=e,this.classString="."+e+"{ "}function t(){return this.classString=this.classString+this.style.cssText+this.closeString,this.classString}var i,n,r=null,o=" }\n";return e.prototype.className=r,e.prototype.classString=n,e.prototype.style=i,e.prototype.closeString=o,e.prototype.toString=t,{ThemeClass:e}}),define("orion/widgets/themes/container/ThemeSheetWriter",["orion/widgets/themes/ThemeClass"],function(e){function t(){}function i(){var t="",i=[],n=new e.ThemeClass("orionPage");n.style.backgroundColor="#fdfdfd",n.style.width="100%",n.style.height="100%",i.push(n);var r=new e.ThemeClass("topRowBanner");r.style.margin="0",r.style.border="0",r.style.backgroundColor=this.navbar,r.style.height="16px",r.style.padding="10px",r.style.paddingLeft="6px",r.style.paddingRight="2px",r.style.borderBottom="none",r.style.boxShadow="0 2px 2px 0 rgba(0, 0, 0, 0.1),0 1px 0 0 rgba(0, 0, 0, 0.1)",r.style.zIndex="100",i.push(r);
var o=new e.ThemeClass("a");o.style.textDecoration="none",o.style.color=this.content,i.push(o);var s=new e.ThemeClass("navlink");s.style.display="inline-block",s.style.padding="2px",s.style.color=this.content,s.style.verticalAlign="bottom",i.push(s);var a=new e.ThemeClass("primaryNav");a.style.color=this.navtext,a.style.fontSize="8pt",a.style.fontWeight="normal",a.style.paddingTop="0",a.style.verticalAlign="baseline",i.push(a);var l=new e.ThemeClass("primaryNav a");l.style.fontSize="8pt",l.style.color=this.navtext,l.style.marginRight="6px",l.style.marginLeft="6px",l.style.verticalAlign="baseline",l.style.textDecoration="none",i.push(l);var c=new e.ThemeClass("primaryNav a:hover");c.style.color="#bfbfbf",c.style.cursor="hand",c.style.color="white",c.style.fontWeight="normal",i.push(c);for(var d in i)t+=i[d].toString();return t}function n(){var t="",i=[],n=new e.ThemeClass("titleArea");n.style.margin="0",n.style.paddingTop="5px",n.style.border="0",n.style.background=this.location,n.style.background="-webkit-gradient(linear, left top, left bottom, color-stop(0%,"+this.location+"), color-stop(100%,"+this.location+"))",n.style.borderBottom="1px solid "+this.location,n.style.minHeight="20px",i.push(n);var r=new e.ThemeClass("breadcrumb");r.style.fontSize="8pt",r.style.textDecoration="none",r.style.color="#f1f1f2;",r.style.paddingTop="2px",i.push(r);var o=new e.ThemeClass("a.breadcrumb:hover");o.style.textDecoration="none",o.style.borderBottom="1px dotted",o.style.color="#F58B0F",o.style.cursor="pointer",i.push(o);var s=new e.ThemeClass("breadcrumbSeparator");s.style.fontSize="8pt",s.style.textDecoration="none",s.style.color=this.separator,s.style.fontWeight="bold",i.push(s);var a=new e.ThemeClass("currentLocation");a.style.fontWeight="bold",a.style.fontSize="8pt",a.style.color=this.breadcrumb,a.style.textDecoration="none",a.style.textWrap="normal",a.style.lineHeight="10pt",i.push(a);var l=new e.ThemeClass("a.currentLocation:hover");l.style.fontWeight="bold",l.style.fontSize="10pt",l.style.color="#666666",l.style.textDecoration="none",l.style.borderBottom="0",i.push(l);var c=new e.ThemeClass("navlinkonpage");if(c.style.color=this.content,c.style.verticalAlign="middle",i.push(c),this.bannerProgress){var d=new e.ThemeClass("topRowBanner .progressPane_running");d.style.borderColor=this.bannerProgress,i.push(d)}for(var h in i)t+=i[h].toString();return t}function r(){var t="",i=[],n=new e.ThemeClass("commandButton");n.style.color="#666",n.style.border="1px solid #dedede",n.style.backgroundColor="#ddd",n.style.textAlign="center",n.style.verticalAlign="middle",n.style.cursor="pointer",n.style.display="inline-block",n.style.padding="4px 6px",n.style.borderRadius="3px",n.style.lineHeight="12px",n.style.fontSize="9pt",n.style.userSelect="none",i.push(n);var r=new e.ThemeClass("commandButton:over");r.style.backgroundColor="#e6e6e6",r.style.border="1px solid #808080",i.push(r);var o=new e.ThemeClass("commandMenu");o.style.color="#222",o.style.display="inline-block",o.style.verticalAlign="baseline",o.style.margin="0",o.style.fontSize="8pt",o.style.fontWeight="normal",o.style.border="1px solid #dedede",o.style.backgroundColor="#efefef",o.style.cursor="pointer",o.style.borderRadius="1px",i.push(o);var s=new e.ThemeClass("commandMenuItem");s.style.border="0",s.style.padding="0",s.style.margin="0",i.push(s);for(var a in i)t+=i[a].toString();return t}function o(){var t="",i=[],n=new e.ThemeClass("searchbox");n.style.backgroundImage="url(../images/core_sprites.png)",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="4px -297px",n.style.width="12px",n.style.height="12px",n.style.backgroundColor=this.search,n.style.border="1px solid "+this.search,n.style.fontSize="11px",n.style.width="15em",n.style.height="16px",n.style.borderRadius="10px",n.style.color="#999",n.style.padding="0",n.style.paddingLeft="20px",n.style.marginLeft="5px",n.style.marginTop="6px !important",n.style.font="7pt Lucida Sans Unicode,Lucida Grande,Verdana,Arial,Helvetica,Myriad,Tahoma,clean,sans-serif !important",i.push(n);var r=new e.ThemeClass("searchbox:focus");r.style.color="white",r.style.outline="none",i.push(r);var o=new e.ThemeClass("checkedRow");o.style.cssText="background-color:"+this.selection+" !important;",i.push(o);var s=new e.ThemeClass("navbar-item-selected");s.style.background=this.selection,s.style.color=this.content,i.push(s);var a=new e.ThemeClass("auxpane");a.style.border="0",a.style.background=this.sidepanel,i.push(a);var l=new e.ThemeClass("mainpane");l.style.background=this.mainpanel,l.style.border=0,i.push(l);var c=new e.ThemeClass("mainToolbar");c.style.background=this.toolpanel,i.push(c);for(var d in i)t+=i[d].toString();return t}function s(){console.log(this.writeNavigationStyle()),console.log(this.writeLocationStyle()),console.log(this.writeMainStyle()),console.log(this.writeButtonStyle())}function a(e){e.navbar.value?(this.navbar=e.navbar.value,this.button=e.button.value,this.location=e.location.value,this.selection=e.selection.value,this.sidepanel=e.sidepanel.value,this.mainpanel=e.mainpanel.value,this.navtext=e.navtext.value,this.search=e.search.value,this.content=e.content.value,this.toolpanel=e.toolpanel.value,this.bannerProgress=e.bannerProgress.value):(this.navbar=e.navbar,this.button=e.button,this.location=e.location,this.selection=e.selection,this.sidepanel=e.sidepanel,this.mainpanel=e.mainpanel,this.navtext=e.navtext,this.search=e.search,this.content=e.content,this.toolpanel=e.toolpanel,this.bannerProgress=e.bannerProgress);var t=this.writeNavigationStyle()+this.writeLocationStyle()+this.writeMainStyle()+this.writeButtonStyle();return t}var l="white",c="#777777",d="#EFEFEF",h="#cedce7",u="#F7F7F7",p="white",f="#bfbfbf",m="#3087B3",g="#444",v="white";return t.prototype.navbar=l,t.prototype.button=c,t.prototype.location=d,t.prototype.selection=h,t.prototype.sidepanel=u,t.prototype.mainpanel=p,t.prototype.navtext=f,t.prototype.content=m,t.prototype.search=g,t.prototype.toolpanel=v,t.prototype.writeNavigationStyle=i,t.prototype.writeLocationStyle=n,t.prototype.writeButtonStyle=r,t.prototype.writeMainStyle=o,t.prototype.render=s,t.prototype.getSheet=a,{ThemeSheetWriter:t}}),define("orion/widgets/themes/ThemeVersion",[],function(){var e="6.0";return e}),define("orion/widgets/themes/container/ThemeData",["i18n!orion/settings/nls/messages","orion/editor/textTheme","orion/widgets/themes/container/ThemeSheetWriter","orion/widgets/themes/ThemeVersion"],function(e,t,i,n){function r(){}function o(){this.styles=[];var e=new r;e.name="Orion",e.navbar="white",e.button="#EFEFEF",e.location="#efefef",e.selection="FEC",e.sidepanel="#FBFBFB",e.mainpanel="white",e.toolpanel="white",e.navtext="#bfbfbf",e.content="#3087B3",e.search="#444",e.breadcrumb="#3087B3",e.separator="#333",e.bannerProgress="whitesmoke",this.styles.push(e);var t=new r;t.name="Orion2014",t.navbar="white",t.button="#EFEFEF",t.location="#EFEFEF",t.selection="FEC",t.sidepanel="#EEEEEE",t.mainpanel="#EEEEEE",t.toolpanel="#EEEEEE",t.navtext="#BFBFBF",t.content="#333333",t.search="#444444",t.breadcrumb="#333333",t.separator="#333333",t.bannerProgress="orange",this.styles.push(t);var i=new r;i.name="Green Zone",i.navbar="seagreen",i.button="lavender",i.location="darkseagreen",i.selection="moccasin",i.sidepanel="aliceblue",i.mainpanel="white",i.toolpanel="white",i.navtext="#FBFBFB",i.content="darkgreen",i.search="darkgreen",i.breadcrumb="#3087B3",i.separator="seagreen",i.bannerProgress="#F2F2F2",this.styles.push(i);var n=new r;n.name="Pretty In Pink",n.navbar="plum",n.button="lavender",n.location="pink",n.selection="lavender",n.sidepanel="seashell",n.mainpanel="white",n.toolpanel="white",n.navtext="#FBFBFB",n.content="mediumorchid",n.search="violet",n.breadcrumb="#3087B3",n.separator="plum",n.bannerProgress="#F2F2F2",this.styles.push(n);var o=new r;o.name="Blue Monday",o.navbar="cornflowerblue",o.button="lavender",o.location="skyblue",o.selection="lavender",o.sidepanel="aliceblue",o.mainpanel="white",o.toolpanel="white",o.navtext="#FBFBFB",o.content="royalblue",o.search="royalblue",o.breadcrumb="#3087B3",o.separator="cornflowerblue",o.bannerProgress="#F2F2F2",this.styles.push(o);var s=new r;s.name="Vanilla Skies",s.navbar="sandybrown",s.button="lemmonchiffon",s.location="cornsilk",s.selection="lemonchiffon",s.sidepanel="white",s.mainpanel="white",s.toolpanel="white",s.navtext="lemonchiffon",s.content="chocolate",s.search="moccasin",s.breadcrumb="#3087B3",s.separator="sandybrown",s.bannerProgress="#F2F2F2",this.styles.push(s);var a=new r;a.name="Beetlejuice",a.navbar="indigo",a.button="slateblue",a.location="darkslateblue",a.selection="silver",a.sidepanel="lavender",a.mainpanel="white",a.toolpanel="white",a.navtext="#FBFBFB",a.content="mediumslateblue",a.search="#444",a.breadcrumb="#3087B3",a.separator="indigo",a.bannerProgress="#F2F2F2",this.styles.push(a);var l=new r;l.name="Red",l.navbar="#CD2127",l.button="#777777",l.location="#D85F56",l.selection="lightcoral",l.sidepanel="#EFDAB2",l.mainpanel="#FDFADD",l.toolpanel="#FDFADD",l.navtext="#FBFBFB",l.content="darkred",l.search="#D85F56",l.breadcrumb="darkred",l.separator="#CD2127",l.bannerProgress="#F2F2F2",this.styles.push(l)}function s(){return this.styles}function a(){return{storage:"/themes",styleset:"styles",defaultTheme:"Orion2014",selectedKey:"selected",version:n}}function l(){var t=10,i=10,n=350,r=32,o=29,s=t+r+o,a={};a.top=t,a.left=i,a.width=n,a.height=n,a.shapes=[{type:"RECTANGLE",name:e["Navigation Bar"],x:i,y:t,width:n,height:r,family:"navbar",fill:"#333",order:1},{type:"TEXT",name:e["Navigation Text"],label:"UserName",x:i+n-70,y:t+20,family:"navtext",fill:"#bfbfbf",font:"8pt sans-serif"},{type:"ROUNDRECTANGLE",name:e["Search Box"],x:i+n-145,y:t+10,width:70,height:12,family:"search",fill:"#444",order:3},{type:"RECTANGLE",name:e["Tool Panel"],x:i+.4*n,y:s,width:.6*n-1,height:30,family:"toolpanel",fill:"white",order:4},{type:"RECTANGLE",name:e["Selection Bar"],x:i+.4*n+5,y:s+62,width:.6*n-10,height:20,family:"selection",fill:"#FEC",order:7},{type:"RECTANGLE",name:e.Location,x:i,y:t+r,width:n,height:o,family:"location",fill:"#efefef",order:8},{type:"TEXT",name:e["Navigation Text"],label:"Navigator",x:i+50,y:t+20,family:"navtext",fill:"#bfbfbf",font:"8pt sans-serif",order:2},{type:"TEXT",name:e.Content,label:"Breadcrumb",x:i+5,y:t+r+18,family:"content",fill:"#3087B3",font:"8pt sans-serif"},{type:"TEXT",name:e.Content,label:"/",x:i+68,y:t+r+18,family:"content",fill:"#3087B3",font:"8pt sans-serif",order:9},{type:"TEXT",name:e.Content,label:"Location",x:i+74,y:t+r+18,family:"content",fill:"#3087B3",font:"8pt sans-serif"},{type:"RECTANGLE",name:e["Main Panel"],x:i+.4*n,y:s+30,width:.6*n-1,height:n-s+t-31,family:"mainpanel",fill:"white",order:6},{type:"ROUNDRECTANGLE",name:e.Button,x:i+.4*n+5,y:s+5,width:37,height:20,family:"button",fill:"#EFEFEF",order:11},{type:"TEXT",name:e["Button Text"],label:"Button",x:i+.4*n+8,y:s+19,family:"navbar",fill:"#333",font:"8pt sans-serif"},{type:"TRIANGLE",name:"userMenu",x1:i+n-7,y1:t+14,x2:i+n-13,y2:t+14,x3:i+n-10,y3:t+19,family:"userMenu",fill:"#BFBFBF"},{type:"TRIANGLE",name:"userMenu",x1:i+10,y1:s+17,x2:i+16,y2:s+17,x3:i+13,y3:s+22,family:"userMenu",fill:"#BFBFBF"},{type:"TEXT",name:e["Section Text"],label:"Section",x:i+20,y:s+23,family:"navbar",fill:"#333",font:"8pt sans-serif"},{type:"LINE",name:e["Line Color"],x1:i+.4*n,y1:s+30,x2:i+n,y2:s+30,linewidth:2,fill:"#DEDEDE"},{type:"LINE",name:e["Line Color"],x1:i+.4*n,y1:s,x2:i+.4*n,y2:t+n,linewidth:2,fill:"#DEDEDE"},{type:"LINE",name:e["Line Color"],x1:i+10,y1:s+29,x2:i+.4*n-10,y2:s+29,linewidth:2,fill:"#DEDEDE"},{type:"RECTANGLE",name:e["Side Panel"],x:i,y:s,width:.4*n,height:n-s+t,family:"sidepanel",fill:"#FBFBFB",order:12},{type:"TRIANGLE",name:"userMenu",x1:i+n-7,y1:t+14,x2:i+n-13,y2:t+14,x3:i+n-10,y3:t+19,family:"userMenu",fill:"#BFBFBF"},{type:"TRIANGLE",name:"userMenu",x1:i+10,y1:s+17,x2:i+16,y2:s+17,x3:i+13,y3:s+22,family:"userMenu",fill:"#BFBFBF"},{type:"TEXT",name:e["Navigation Text"],label:"Navigator",x:i+50,y:t+20,family:"navtext",fill:"#bfbfbf",font:"8pt sans-serif",order:2},{type:"TRIANGLE",name:"userMenu",x1:i+n-7,y1:t+14,x2:i+n-13,y2:t+14,x3:i+n-10,y3:t+19,family:"userMenu",fill:"#BFBFBF"},{type:"TRIANGLE",name:"userMenu",x1:i+10,y1:s+17,x2:i+16,y2:s+17,x3:i+13,y3:s+22,family:"userMenu",fill:"#BFBFBF"}];for(var l=0;3>l;l++)a.shapes.push({type:"TEXT",name:e.Content,label:"org.eclipse.orion.content",x:i+.4*n+20,y:s+56+20*l,fill:"#3087B3",family:"content"});for(var l=0;3>l;l++)a.shapes.push({type:"TEXT",name:e.Content,label:"Item",x:i+15,y:s+44+20*l,fill:"#3087B3",family:"content"});for(var c=0;3>c;c++)a.shapes.push({type:"TRIANGLE",name:"twisty",x1:i+.4*n+10,y1:s+50+20*c,x2:i+.4*n+15,y2:s+53+20*c,x3:i+.4*n+10,y3:s+56+20*c,family:"navbar",fill:"#333"});return a.shapes.push({type:"IMAGE",name:"logo",x:i+5,y:t+8,source:"../../images/orion-transparent.png",family:"logo"}),a}function c(e){var n=new i.ThemeSheetWriter,r="orionTheme",o=new t.TextTheme.getTheme(r);o.setThemeClass(r,n.getSheet(e))}return r.prototype.name="Orion",r.prototype.navbar="#404648",r.prototype.button="#EFEFEF",r.prototype.location="#333",r.prototype.breadcrumb="#3087B3",r.prototype.separator="#333",r.prototype.selection="FEC",r.prototype.sidepanel="#FBFBFB",r.prototype.mainpanel="white",r.prototype.toolpanel="white",r.prototype.navtext="#bfbfbf",r.prototype.content="#3087B3",r.prototype.search="#444",r.prototype.bannerProgress="white",o.prototype.styles=[],o.prototype.getStyles=s,o.prototype.getThemeStorageInfo=a,o.prototype.getViewData=l,o.prototype.processSettings=c,{ThemeData:o,getStyles:s}}),define("orion/widgets/nls/root/messages",{"no input":"no input","no output":"no output","Choose a Folder":"Choose a Folder",OK:"OK",Profile:"Profile","Sign out":"Sign out","N/A":"N/A","logged in since ":"logged in since ","Sign in":"Sign in","Authentication required!":"Authentication required!","Name:":"Name:","Plug-ins":"Plug-ins"," <No available services or timed out, check URL and try reloading>":" <No available services or timed out, check URL and try reloading>",Properties:"Properties"," (Service Id: ":" (Service Id: ",Services:"Services","SFTP Transfer":"SFTP Transfer","Remote host:":"Remote host:","Port:":"SFTP Port:","Remote path:":"Remote path:","User name:":"User name:","Password:":"Password:","Start Transfer":"Start Transfer","Location:":"Location:","orion.sftpConnections":"orion.sftpConnections","Drag a file here":"Drag a file here","unzip zips":"Unzip *.zip files","or if you prefer":"(or upload a file using the buttons below)",Upload:"Upload","Browse...":"Browse...","Import a file or zip":"Import a file or zip","Missing required argument: searchRenderer":"Missing required argument: searchRenderer","Missing required argument: favService":"Missing required argument: favService","Find File Named":"Find File Named","Type the name of a file to open (? = any character, * = any string):":"Type the name of a file to open (? = any character, * = any string):",Search:"Search","FileName FolderName":"FileName FolderName(Optional)","Searching...":"Searching...","Searching for occurrences of":'Searching for occurrences of: "${0}"',name:"name","orion.widgets.UserMenu":"orion.widgets.UserMenu",test:"test","Sign Out":"Sign Out","Sign Out ":"Sign Out ","</a>":"</a>",">":">","Sign In To ":"Sign In To ","Sign In":"Sign In",Help:"Help","Report a Bug":"Report a Bug","Keyboard Shortcuts":"Keyboard Shortcuts",Settings:"Settings","View profile of ":"View profile of ",Profiles:"Profiles","Information Needed":"Information Needed",Cancel:"Cancel","If the same file exists in both the source and destination:":"If the same file exists in both the source and destination:","Cancel the transfer":"Cancel the transfer","Always overwrite destination":"Always overwrite destination","Overwrite if source is newer":"Overwrite if source is newer",New:"New","Building file skeleton...":"Building file skeleton...",Add:"Add","Upload...":"Upload...","For a list of available commands type '${0}'.":"For a list of available commands type '${0}'.","Main Pages":"Main Pages","Related Links":"Related Links",Yes:"Yes",No:"No","Click or use delete key to delete the search term":"Click or use delete key to delete the search term"}),define("orion/widgets/nls/messages",["orion/i18n!orion/widgets/nls/messages","orion/widgets/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/widgets/userAssistance/UATaskPanel",["orion/webui/littlelib"],function(e){function t(t,i,n){this.elements=n,this.taskPanel=document.createElement("div"),this.taskPanel.className="UAContainer",this.taskPanel.innerHTML='<header class="UAHeader">Develop software from within the cloud</header>',this.elementNode=document.createElement("div"),this.switchesContainer=document.createElement("div"),this.switches=document.createElement("span"),this.radioButtons=[],this.elementNode.className="UAContainer-body",this.taskPanel.appendChild(this.elementNode),this.switchesContainer.className="UAContainer-switch-body",this.switches.className="UAContainer-switches",this.switchesContainer.innerHTML="",this.switchesContainer.appendChild(this.switches),this.taskPanel.appendChild(this.switchesContainer),i===!0?(this.container=document.createElement("div"),this.container.className="UAModal",this.container.appendChild(this.taskPanel),this.backdrop=document.createElement("div"),this.backdrop.className="UAModalBackground",document.body.appendChild(this.backdrop),document.body.appendChild(this.container),e.addAutoDismiss([this.container],this.destroy.bind(this))):t.appendChild(this.taskPanel),this.chosenSwitch=this.createSwitch(null,!0),this.chosenSwitch.firstChild.className="chosenCircle",this.initialize(),this.elements.forEach(this.createSwitch.bind(this))}return t.prototype.elementNode=null,t.prototype.switchesContainer=null,t.prototype.switches=null,t.prototype.radioButtons=null,t.prototype.chosenSwitch=null,t.prototype.addElement=function(e){var t=document.createElement("span");t.className="UAContainer-icon",t.innerHTML='<span class="workingSpan"><img src="'+e.image+'" id="'+e.label+'ImageNode" alt="'+e.alt+'" height="64" width="64"></span><span class="UAIcon-label"><span class="UALabel" id="'+e.label+'LabelNode" >'+e.label+"</span></span>",t.onmouseover=function(){var i=document.getElementById(e.label+"ImageNode");i.src=e.secondaryImage;var n=document.getElementById(e.label+"LabelNode");n.className="UALabel-live",t.className="UAContainer-icon-live"},t.onmouseout=function(){var i=document.getElementById(e.label+"ImageNode");i.src=e.image;var n=document.getElementById(e.label+"LabelNode");n.className="UALabel",t.className="UAContainer-icon"};var i=this;t.onclick=function(){i.showMedia(e)},this.elementNode.appendChild(t)},t.prototype.clearElements=function(){this.elementNode.innerHTML=""},t.prototype.showMedia=function(e){this.clearElements(),this.addElement(e);var t=document.createElement("span");t.className="UAContainer-media",t.innerHTML='<div></div><div></div><span class="mediaSpan"><img src="'+e.media+'" alt="'+e.alt+'" height="300" width="400"></span>',this.elementNode.appendChild(t),setTimeout(function(){t.style.opacity=1},100);var i=document.getElementById(e.label+"switch");this.chosenSwitch.firstChild.className="circle",this.chosenSwitch=i.parentNode,i.className="chosenCircle"},t.prototype.createSwitch=function(e){var t;t=e?e.label+"switch":"indexSwitch";var i=document.createElement("span");i.className="workingSpan",i.innerHTML='<div class="circle" id ="'+t+'"></div>';var n=this;return i.onclick=e?function(){n.showMedia(e)}:function(){n.initialize(),n.chosenSwitch.firstChild.className="circle",n.chosenSwitch=i,n.chosenSwitch.firstChild.className="chosenCircle"},this.switches.appendChild(i),this.radioButtons[this.radioButtons.length]=i,i},t.prototype.initialize=function(){this.clearElements(),this.elements.forEach(this.addElement.bind(this))},t.prototype.destroy=function(){document.body.removeChild(this.backdrop),document.body.removeChild(this.container)},t}),define("orion/webui/dialog",["i18n!orion/widgets/nls/messages","require","orion/webui/littlelib","orion/uiUtils"],function(e,t,i,n){function r(){}var o={dialog:null};return r.prototype={DISABLED:"disabled",CONTAINERTEMPLATE:'<div class="dialog" role="dialog"><div class="dialogTitle"><span id="title" class="dialogTitleText layoutLeft"></span><button aria-label="Close" class="dismissButton layoutRight core-sprite-close imageSprite" id="closeDialog"></button></div><div id="dialogContent" class="dialogContent layoutBlock"></div><div id="buttons" class="dialogButtons"></div></div>',_initialize:function(){var e=document.body;this.$frameParent=e,this.$$modalExclusions=this.$$modalExclusions||[];var t=document.createRange();t.selectNode(e);var n=t.createContextualFragment(this.CONTAINERTEMPLATE);e.appendChild(n),this.$frame=e.lastChild,this.title&&i.$("#title",this.$frame).appendChild(document.createTextNode(this.title)),this.$close=i.$("#closeDialog",this.$frame);var r=this;this.$close.addEventListener("click",function(){r.hide()},!1),this.$parent=i.$(".dialogContent",this.$frame),t=document.createRange(),t.selectNode(this.$parent);var o=t.createContextualFragment(this.TEMPLATE);this.messages&&i.processTextNodes(o,this.messages),this.$parent.appendChild(o),this.$buttonContainer=i.$(".dialogButtons",this.$frame),this._makeButtons(),this.$frame.addEventListener("keydown",function(e){e.keyCode===i.KEY.ESCAPE?r.hide():e.keyCode===i.KEY.ENTER&&"function"==typeof r._defaultCallback&&r._defaultCallback()},!1),this._bindElements(this.$parent),"function"==typeof this._bindToDom&&this._bindToDom(this.$parent)},_makeButtons:function(){if(this.$buttonContainer&&Array.isArray(this.buttons)){var e=this;this.buttons.forEach(function(t){var i=n.createButton(t.text,t.callback);t.id&&(i.id=t.id,e["$"+i.id]=i),t.isDefault&&(e._defaultCallback=t.callback,e._defaultButton=i),e.$buttonContainer.appendChild(i)})}},_makeModal:function(){var e=this;this.$frame.addEventListener("blur",function(t){e.$lastFocusedElement=t.target},!0),this._modalListener=function(t){var n=!i.contains(e.$frame,t.target);if(n)for(var r=0;r<e.$$modalExclusions.length;r++)if(i.contains(e.$$modalExclusions[r],t.target)){n=!1;break}n&&(window.setTimeout(function(){(e.$lastFocusedElement||e.$parent).focus()},0),i.stop(t))},this.$frameParent.addEventListener("focus",this._modalListener,!0),this.$frameParent.addEventListener("click",this._modalListener,!0);var t=this.$frameParent.childNodes,n=!1;this._addedBackdrop=[];for(var r=0;r<t.length;r++){for(var o=0;o<this.$$modalExclusions.length;o++)if(i.contains(this.$$modalExclusions[o],t[r])){n=!0;break}if(!n&&t[r]!==e.$frame&&t[r].classList&&!t[r].classList.contains("tooltipContainer")){var s=t[r];s.classList.contains("modalBackdrop")||(s.classList.add("modalBackdrop"),this._addedBackdrop.push(s))}}var a=i.lastTabbable(this.$buttonContainer)||i.lastTabbable(this.$parent);a&&a.addEventListener("keydown",function(t){if(t.keyCode===i.KEY.TAB){var n=e._getFirstFocusField();n&&n!==t.target&&n.focus(),i.stop(t)}},!1)},_addChildDialog:function(e){this.$$modalExclusions.push(e.$frame||e.$parent)},_inModalExclusion:function(e){return this.$$modalExclusions.some(function(t){return e.$frame===t||e.$parent===t})},_bindElements:function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];i.id&&(this["$"+i.id]=i),this._bindElements(i)}},hide:function(e){e||o.dialog!==this||(o.dialog=null),"function"==typeof this._beforeHiding&&this._beforeHiding(),this._modalListener&&(this.$frameParent.removeEventListener("focus",this._modalListener,!0),this.$frameParent.removeEventListener("click",this._modalListener,!0)),this.$frame.classList.remove("dialogShowing"),i.setFramesEnabled(!0),"function"==typeof this._afterHiding&&this._afterHiding();var t=this;this.keepAlive||window.setTimeout(function(){t.destroy()},0)},show:function(e){if(this.modal)if(this._makeModal(),o.dialog){if(!o.dialog._inModalExclusion(this))return void this.hide(!0)}else o.dialog=this;"function"==typeof this._beforeShowing&&this._beforeShowing(),i.setFramesEnabled(!1);var t,n,r=i.bounds(this.$frame),s=i.bounds(document.documentElement);if(e){var a=i.bounds(e);n=a.top+a.height+4,t=a.left+4,n+r.height>s.height&&(n=Math.max(0,s.height-r.height-4)),t+r.width>s.width&&(t=Math.max(0,s.width-r.width-4))}else t=Math.max(0,(s.width-r.width)/2),n=Math.max(0,(s.height-r.height)/2);if(this.$lastFocusedElement=document.activeElement,this.$frame.style.top=n+"px",this.$frame.style.left=t+"px",this.$frame.classList.add("dialogShowing"),"function"==typeof this._afterShowing&&this._afterShowing(),!this.customFocus){var l=this._getFirstFocusField();l.focus()}},_getFirstFocusField:function(){return i.firstTabbable(this.$parent)||this._defaultButton||i.firstTabbable(this.$buttonContainer)||this.$close},destroy:function(){this.$frame&&(o.dialog===this&&(o.dialog=null),i.setFramesEnabled(!0),this._addedBackdrop&&this._addedBackdrop.length>0&&this._addedBackdrop.forEach(function(e){e.classList.remove("modalBackdrop")}),this.$frameParent.removeEventListener("focus",this._modalListener,!0),this.$frameParent.removeEventListener("click",this._modalListener,!0),this.$frameParent.removeChild(this.$frame),this.$frame=void 0,this.$parent=void 0)}},r.prototype.constructor=r,{Dialog:r}}),define("orion/widgets/UserMenu",["i18n!orion/widgets/nls/messages","require","orion/webui/littlelib","orion/PageLinks","orion/widgets/userAssistance/UATaskPanel","orion/webui/dialog","orion/webui/dropdown"],function(e,t,i,n,r,o,s){function a(e){this._displaySignOut=!0,this._init(e)}return a.prototype={_init:function(e){if(this._dropdownNode=i.node(e.dropdownNode),!this._dropdownNode)throw"no dom node for dropdown found";this._dropdown=e.dropdown,this._serviceRegistry=e.serviceRegistry,this.authenticatedServices={},this.unauthenticatedServices={},this._noSeparator=e.noSeparator,this._dropDownItemClass=e.dropDownItemClass,this._keyAssistClass=e.keyAssistClass,void 0!==e.signOut&&(this._displaySignOut=e.signOut)},isSingleService:function(){return this.length(this.unauthenticatedServices)+this.length(this.authenticatedServices)===1},hasServices:function(){return this.length(this.unauthenticatedServices)+this.length(this.authenticatedServices)>0},length:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t},_makeMenuItem:function(e,t){var n=s.createMenuItem(e),r=n.firstElementChild;return"string"==typeof this._dropDownItemClass&&""!==this._dropDownItemClass&&r.classList.add(this._dropDownItemClass),r.addEventListener("click",t,!1),r.addEventListener("keydown",function(e){(e.keyCode===i.KEY.ENTER||e.keyCode===i.KEY.SPACE)&&t()},!1),r},_renderAuthenticatedService:function(t){var i=this,n=this.authenticatedServices[t].authService;if(n&&n.logout&&this._displaySignOut){var r=this._makeMenuItem(e["Sign Out"],function(){n.logout().then(function(){i.addUserItem(t,n,i.authenticatedServices[t].label),localStorage.removeItem(t),localStorage.removeItem("lastLogin");for(var e=localStorage.length-1;e>=0;e--){var r=localStorage.key(e);r&&0===r.indexOf("/orion/preferences/user")&&localStorage.removeItem(r)}n.getAuthForm(window.location.href).then(function(e){window.location=e})})});this._dropdownNode.appendChild(r.parentNode)}},renderServices:function(){function t(e){return o[e]||(o[e]=r.createDocumentFragment()),o[e]}var r=document,o=[],a=this._serviceRegistry;n.getPageLinksInfo(a,"orion.page.link.user").then(function(n){if(this._dropdown?this._dropdown.empty():this._dropdownNode&&i.empty(this._dropdownNode),n.getAllLinks().forEach(function(e){var n,o;e.category&&(o=/user\.(\d+)/.exec(e.category))&&(n=parseInt(o[1],10)),("number"!=typeof n||isNaN(n))&&(n=1);var s=t(n),a=r.createElement("li"),l=r.createElement("a");l.role="menuitem","string"==typeof this._dropDownItemClass?""!==this._dropDownItemClass&&l.classList.add(this._dropDownItemClass):l.classList.add("dropdownMenuItem"),l.href=e.href,l.textContent=e.textContent,a.appendChild(l),s.appendChild(a),l.addEventListener("keydown",function(e){(e.keyCode===i.KEY.ENTER||e.keyCode===i.KEY.SPACE)&&l.click()},!1)}.bind(this)),this.keyAssistFunction){var l=this._makeMenuItem(e["Keyboard Shortcuts"],this.keyAssistFunction);"string"==typeof this._keyAssistClass?""!==this._keyAssistClass&&l.classList.add(this._keyAssistClass):l.classList.add("key-assist-menuitem");var c=l.parentNode;t(0).appendChild(c)}var d=a.getServiceReferences("orion.page.getstarted")[0];if(d){var h=d.getProperty("data"),u=this._makeMenuItem("Getting Started",this.getStartedDialog.bind(this,h)),p=u.parentNode;t(0).appendChild(p)}var f=this;if(o.sort(function(e,t){return e-t}).forEach(function(e,t){if(t<o.length-1&&!this._noSeparator){var i=s.createSeparator();e.appendChild(i)}f._dropdownNode.appendChild(e)}.bind(this)),this.isSingleService())for(var m in this.authenticatedServices)this.authenticatedServices.hasOwnProperty(m)&&this._renderAuthenticatedService(m,0)}.bind(this))},getStartedDialog:function(e){new r(null,!0,e)},setKeyAssist:function(e){this.keyAssistFunction=e,this.renderServices()},addUserItem:function(e,t,i,n){n?(this.unauthenticatedServices[e]&&delete this.unauthenticatedServices[e],this.authenticatedServices[e]={authService:t,label:i,data:n}):(this.authenticatedServices[e]&&delete this.authenticatedServices[e],this.unauthenticatedServices[e]=this.unauthenticatedServices[e]?{authService:t,label:i,pending:this.unauthenticatedServices[e].pending}:{authService:t,label:i}),this.renderServices()}},a.prototype.constructor=a,{UserMenu:a}}),define("orion/crawler/nls/root/messages",{"Searching file:":"Searching file:","is not supported in this file system":"is not supported in this file system","${0} files found out of ${1}":"${0} files found out of ${1}","The search term on this location will not use indexed files.":"The search term on this location will not use indexed files.","It will take longer time. Do you want to proceed?":"It will take longer time. Do you want to proceed?","Search cancelled by user":"Search cancelled by user",Cancel:"Cancel"}),define("orion/crawler/nls/messages",["orion/i18n!orion/crawler/nls/messages","orion/crawler/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/searchUtils",["i18n!orion/nls/messages","require","orion/regex","orion/commandRegistry","orion/PageUtil","orion/URITemplate"],function(e,t,i,n,r,o){function s(e,t,n){var r="";n&&(r="^");var o=i.parse("/"+r+e.searchStr+"/");if(o){var s=o.pattern,a=o.flags;-1!==a.indexOf("i")||t.caseSensitive||(a+="i"),e.regExp={pattern:s,flags:a},e.wildCard=!0}}var a={};return a.ALL_FILE_TYPE="*.*",a.doSearch=function(t,i,n,r){if(t){var o=n,s=!0;if("*"===o&&(o=""),""===o&&(s=r&&r.type!==a.ALL_FILE_TYPE),s){var l=t.createSearchParams(o,!1,!1,r),c=a.generateSearchHref(l);window.location=c}}else window.alert(e["Can't search: no search service is available"])},a.generateSearchHelper=function(e,t){var i=e.keyword,n=i,r={};if(e.fileType&&e.fileType!==a.ALL_FILE_TYPE&&""===i&&(n="*."+e.fileType),e.regEx)r.searchStr=i,s(r,e,t);else{var o=i.indexOf("*")>-1,l=i.indexOf("?")>-1;o&&(i=i.split("*").join(".*")),l&&(i=i.split("?").join(".")),o||l||e.nameSearch?(r.searchStr=e.caseSensitive?i:i.toLowerCase(),s(r,e,t),r.wildCard=!0):(r.searchStr=e.caseSensitive?i.split("\\").join(""):i.split("\\").join("").toLowerCase(),r.wildCard=!1)}return r.searchStrLength=r.searchStr.length,{params:e,inFileQuery:r,displayedSearchTerm:n}},a.convertSearchParams=function(e){void 0!==e.rows&&(e.rows=parseInt(e.rows,10)),void 0!==e.start&&(e.start=parseInt(e.start,10)),"string"==typeof e.regEx&&(e.regEx="true"===e.regEx.toLowerCase()),"string"==typeof e.caseSensitive&&(e.caseSensitive="true"===e.caseSensitive.toLowerCase()),"string"==typeof e.nameSearch&&(e.nameSearch="true"===e.nameSearch.toLowerCase()),void 0!==e.fileNamePatterns&&(e.fileNamePatterns=a.getFileNamePatternsArray(e.fileNamePatterns))
},a.getFileNamePatternsArray=function(e){var t=void 0;if(e){var i=e.trim();i=i.replace(/^(\s*,\s*)+/g,""),i=i.replace(/([^\\]),(\s*,\s*)*/g,"$1/"),i=i.replace(/(\s*\/\s*)/g,"/"),i=i.replace(/\/\/+/g,"/"),i=i.replace(/\/+$/g,""),t=i.split("/")}return t},a.copySearchParams=function(e,t){var i={};for(var n in e)if(void 0!==e[n]&&null!==e[n]){if(!t&&"replace"===n)continue;i[n]=e[n]}return i},a.generateSearchHref=function(e){var i=t.toUrl("search/search.html"),n=a.copySearchParams(e,!0),r=n.resource;n.resource=void 0;var s;return s="undefined"!=typeof n.keyword?new o(i+"#{,resource,params*}").expand({resource:r,params:n}):new o(i+"#{,resource}").expand({resource:r})},a.generateFindURLBinding=function(e,t,i,n,r){var s={find:t.searchStr,regEx:t.wildCard?!0:void 0,caseSensitive:e.caseSensitive?!0:void 0,replaceWith:"string"==typeof n?n:void 0,atLine:"number"==typeof i?i:void 0};if(r)return s;var a=new o("{,params*}").expand({params:s});return","+a},a.convertFindURLBinding=function(e){"string"==typeof e.regEx&&(e.regEx="true"===e.regEx.toLowerCase()),"string"==typeof e.caseSensitive&&(e.caseSensitive="true"===e.caseSensitive.toLowerCase()),"string"==typeof e.atLine&&(e.atLine=parseInt(e.atLine,10))},a.replaceRegEx=function(e,t,i){var n=new RegExp(t.pattern,t.flags);return e.replace(n,i)},a.replaceStringLiteral=function(e,t,n){var r=i.parse("/"+t+"/gim");return a.replaceRegEx(e,r,n)},a.searchOnelineLiteral=function(e,t,i){for(var n,r=0,o=!1,s=[];;){if(n=t.indexOf(e.searchStr,r),0>n)break;if(s.push({startIndex:n,length:e.searchStrLength}),o=!0,i)break;r=n+e.searchStrLength}return o?s:null},a.findRegExp=function(e,t,i,n){if(!t)return null;i=i||"",i+=(-1===i.indexOf("g")?"g":"")+(-1===i.indexOf("m")?"m":"");var r=new RegExp(t,i),o=null;return o=r.exec(e.substring(n)),o&&{startIndex:o.index+n,length:o[0].length}},a.searchOnelineRegEx=function(e,t,i){for(var n=0,r=!1,o=[];;){var s=a.findRegExp(t,e.regExp.pattern,e.regExp.flags,n);if(!s)break;if(o.push(s),r=!0,i)break;n=s.startIndex+s.length}return r?o:null},a.generateNewContents=function(e,t,i,n,r,o){if(n&&t){e||(i.contents=[]);for(var s=0;s<t.length;s++){for(var l,c,d=t[s],h=!1,u=!1,p=[],f=0,m=0;m<n.children.length;m++){var g=n.children[m].lineNumber-1;if(g===s){for(f=m,c=0;c<n.children[m].matches.length;c++)n.children[m+c].checked!==!1&&p.push(c);u=p.length>0,l=n.children[m].matches,h=!0;break}}if(h){var v;if(u){var y=a.replaceCheckedMatches(d,r,l,p,o);for(v=y.replacedStr,c=0;c<n.children[f].matches.length;c++)n.children[f+c].newMatches=y.newMatches}else for(v=d,c=0;c<n.children[f].matches.length;c++)n.children[f+c].newMatches=n.children[f+c].matches;e?i.contents[s]=v:i.contents.push(v)}else e||i.contents.push(d)}}},a.generateMatchContext=function(e,t,i){var n,r,o=[],s=2*e+1;t.length<=s?(n=0,r=t.length-1):(n=i-e,0>n?(n=0,r=n+s-1):(r=i+e,r>t.length-1&&(r=t.length-1,n=r-s+1)));for(var a=n;r>=a;a++)o.push({context:t[a],current:a===i});return o},a.splitFile=function(e){for(var t=0,i=0,n=0,r=0,o=[];;){if(-1!==t&&n>=t&&(t=e.indexOf("\r",n)),-1!==i&&n>=i&&(i=e.indexOf("\n",n)),-1===i&&-1===t){o.push(e.substring(r));break}var s=1;-1!==t&&-1!==i?t+1===i?(s=2,n=i+1):n=(i>t?t:i)+1:n=-1!==t?t+1:i+1,o.push(e.substring(r,n-s)),r=n}return o},a.searchWithinFile=function(e,t,i,n,r,o){var s=a.splitFile(i);if(r&&(t.contents=s),t){t.children=[];for(var l=0,c=0;c<s.length;c++){var d=s[c];if(d&&d.length>0){var h,u=o?d:d.toLowerCase();if(h=e.wildCard?a.searchOnelineRegEx(e,u):a.searchOnelineLiteral(e,u)){var p,f=c+1;if(r)for(var m=0;m<h.length;m++){var g=m+1;p={parent:t,checked:t.checked,type:"detail",matches:h,lineNumber:f,matchNumber:g,name:d,location:t.location+"-"+f+"-"+g},t.children.push(p)}else p={parent:t,context:a.generateMatchContext(2,s,c),checked:t.checked,type:"detail",matches:h,lineNumber:f,name:d,location:t.location+"-"+f},t.children.push(p);l+=h.length}}}t.totalMatches=l}},a.replaceCheckedMatches=function(e,t,i,n,r){for(var o=r,s=0,a="",l=[],c=0;c<i.length;c++){s!==i[c].startIndex&&(a+=e.substring(s,i[c].startIndex)),i[c].length&&(o=i[c].length);for(var d=!1,h=0;h<n.length;h++)if(n[h]===c){d=!0;break}d?(l.push({startIndex:a.length,length:t.length}),a+=t):(l.push({startIndex:a.length,length:o}),a+=e.substring(i[c].startIndex,i[c].startIndex+o)),s=i[c].startIndex+o}return s<e.length&&(a+=e.substring(s)),{replacedStr:a,newMatches:l}},a.fullPathNameByMeta=function(e){var t=e.length,i="";if(t>0)for(var n=t-1;n>-1;n--){var r=""===i?"":"/";i=i+r+e[n].Name}return i},a.path2FolderName=function(e,t,i){var n=i?0:1;return e.substring(0,e.length-t.length-n)},a.getOpenSearchPref=function(e,t){e.getService("orion.core.preference").getPreferences("/cm/configurations").then(function(e){var i,n=e.get("nav.config");i=n&&"undefined"!==n["links.newtab"]&&n["links.newtab"]?!0:!1,t(i)})},a.setOpenSearchPref=function(e,t){e.getService("orion.core.preference").getPreferences("/window/favorites").then(function(e){e.put("openSearchPref",{openInNewTab:t})})},a}),define("orion/crawler/searchCrawler",["i18n!orion/crawler/nls/messages","require","orion/i18nUtil","orion/searchUtils","orion/contentTypes","orion/Deferred"],function(e,t,i,n,r,o){function s(e,t,i,r){this.registry=e,this.fileClient=t,this.fileLocations=[],this.fileSkeleton=[],this._hitCounter=0,this._totalCounter=0,this._searchOnName=r&&r.searchOnName,this._buildSkeletonOnly=r&&r.buildSkeletonOnly,this._fetchChildrenCallBack=r&&r.fetchChildrenCallBack,this._searchParams=i,this.searchHelper=this._searchOnName||this._buildSkeletonOnly?null:n.generateSearchHelper(i),this._location=r&&r.location,this._childrenLocation=r&&r.childrenLocation?r.childrenLocation:this._location,this._reportOnCancel=r&&r.reportOnCancel,this._cancelled=!1,this._statusService=this.registry.getService("orion.page.message"),this._progressService=this.registry.getService("orion.page.progress"),this._statusService&&this._statusService.setCancelFunction(function(){this._cancelFileContentsSearch()}.bind(this))}return s.prototype.search=function(e){var t=this.registry.getService("orion.core.contentTypeRegistry");this._onSearchComplete=e,this._cancelled=!1,this._deferredArray=[],t.getContentTypes().then(function(e){this.contentTypesCache=e;var t=this;this._visitRecursively(this._childrenLocation).then(function(){(!t._cancelled||t._reportOnCancel)&&t._reportResult(),t._cancelled&&t._HandleStatus({name:"Cancel"})}.bind(t),function(e){t._reportResult(),t._HandleStatus(e)}.bind(t))}.bind(this))},s.prototype.searchName=function(e,t){e&&(this._searchParams=e,this.searchHelper=n.generateSearchHelper(e,!0)),t&&(this.onSearchNameComplete=t);var i=[];if(this._cancelled=!1,this._deferredArray=[],this._sort(this.fileSkeleton),this.fileSkeleton.length>0){for(var r=0;r<this.fileSkeleton.length;r++){var o,s=this.fileSkeleton[r].Name.toLowerCase();if(o=this.searchHelper.inFileQuery.wildCard?n.searchOnelineRegEx(this.searchHelper.inFileQuery,s,!0):n.searchOnelineLiteral(this.searchHelper.inFileQuery,s,!0),o&&(i.push(this.fileSkeleton[r]),i.length>=this.searchHelper.params.rows))break}var a={numFound:i.length,docs:i};this.onSearchNameComplete({response:a})}else this.onSearchNameComplete({response:{numFound:0,docs:[]}})},s.prototype.buildSkeleton=function(e,t){this._buildingSkeleton=!0;var i=this.registry.getService("orion.core.contentTypeRegistry");this._cancelled=!1,this._deferredArray=[];var n=this;e(),i.getContentTypes().then(function(e){n.contentTypesCache=e,n._visitRecursively(n._childrenLocation).then(function(){n._buildingSkeleton=!1,t(),n.searchHelper&&!n._buildSkeletonOnly&&n.searchName()})})},s.prototype._sort=function(e){e.sort(function(e,t){var i,r;if("Path asc"===this._searchParams.sort){var o=e.Location&&e.Location.toLowerCase();i=n.path2FolderName(o,e.Name&&e.Name.toLowerCase(),!0);var s=t.Location&&t.Location.toLowerCase();return r=n.path2FolderName(s,t.Name&&t.Name.toLowerCase(),!0),r>i?-1:i>r?1:this._sortOnNameSingle(e,t)}return this._sortOnNameSingle(e,t)}.bind(this))},s.prototype._HandleStatus=function(t){this._statusService&&"Cancel"===t.name&&(console.log("Crawling search cancelled. Deferred array length : "+this._deferredArray.length),this._statusService.setProgressResult({Message:e["Search cancelled by user"],Severity:"Warning"}))},s.prototype._reportResult=function(){this._sort(this.fileLocations);var e={numFound:this.fileLocations.length,docs:this.fileLocations};this._onSearchComplete({response:e})},s.prototype._sortOnNameSingle=function(e,t){var i=e.Name&&e.Name.toLowerCase(),n=t.Name&&t.Name.toLowerCase();return n>i?-1:i>n?1:0},s.prototype._fileNameMatches=function(e){var t=!0;return this.searchHelper.params.fileNamePatterns&&(t=this.searchHelper.params.fileNamePatterns.some(function(t){var i="^"+t.replace(/([*?])/g,".$1")+"$";return e.match(i)})),t},s.prototype._visitRecursively=function(e){var t=[],i=this;return this._fetchChildrenCallBack&&this._fetchChildrenCallBack(e),(i._progressService?this._progressService.progress(i.fileClient.fetchChildren(e),"Crawling search for children of "+e):i.fileClient.fetchChildren(e)).then(function(e){for(var n=0;n<e.length;n++)if(void 0!==e[n].Directory&&e[n].Directory===!1){if(i._searchOnName)t.push(i._buildSingleSkeleton(e[n]));else if(i._buildSkeletonOnly)t.push(i._buildSingleSkeleton(e[n]));else if(!i._cancelled){var s=r.getFilenameContentType(e[n].Name,i.contentTypesCache);if(s&&("text/plain"===s["extends"]||"text/plain"===s.id)&&i._fileNameMatches(e[n].Name)){var a=i._sniffSearch(e[n]);t.push(a),i._deferredArray.push(a)}}}else if(e[n].Location){if(i._cancelled)break;var l=i._visitRecursively(e[n].ChildrenLocation);t.push(l),i._deferredArray.push(l)}return o.all(t)})},s.prototype._hitOnceWithinFile=function(e){var t,i=this._searchParams.caseSensitive?e:e.toLowerCase();return t=this.searchHelper.inFileQuery.wildCard?n.searchOnelineRegEx(this.searchHelper.inFileQuery,i,!0):n.searchOnelineLiteral(this.searchHelper.inFileQuery,i,!0)},s.prototype._reportSingleHit=function(e){if(!this._cancelled){e.LastModified=e.LocalTimeStamp,this.fileLocations.push(e),this._hitCounter++,this._sort(this.fileLocations);var t={numFound:this.fileLocations.length,docs:this.fileLocations};this._onSearchComplete({response:t},!0)}},s.prototype._cancelFileContentsSearch=function(){this._cancelled=!0,this._cancelled&&this._deferredArray.forEach(function(e){e.cancel()})},s.prototype._sniffSearch=function(t){this._totalCounter++;var n=this;if(!this._cancelled)return""!==this.searchHelper.params.keyword?(n._progressService?n._progressService.progress(n.fileClient.read(t.Location),"Reading file "+t.Location):n.fileClient.read(t.Location)).then(function(r){n._hitOnceWithinFile(r)&&n._reportSingleHit(t),n._statusService&&n._statusService.setProgressResult({Message:i.formatMessage(e["${0} files found out of ${1}"],n._hitCounter,n._totalCounter)},e.Cancel)},function(e){e&&e.message&&"cancel"!==e.message.toLowerCase()&&console.error("Error loading file content: "+e.message)}):(this._reportSingleHit(t),void(this._statusService&&this._statusService.setProgressResult({Message:i.formatMessage(e["${0} files found out of ${1}"],this._hitCounter,this._totalCounter)})))},s.prototype._buildSingleSkeleton=function(e){this._totalCounter++,this.fileSkeleton.push(e),this.searchHelper&&!this._buildSkeletonOnly&&this._totalCounter%100===0&&this.searchName();var t=new o;return t.resolve(this._totalCounter),t},s.prototype.constructor=s,{SearchCrawler:s}}),define("orion/webui/dialogs/OpenResourceDialog",["i18n!orion/widgets/nls/messages","orion/crawler/searchCrawler","orion/contentTypes","require","orion/webui/littlelib","orion/util","orion/webui/dialog"],function(e,t,i,n,r,o,s){function a(e){this._init(e)}return a.prototype=new s.Dialog,a.prototype.TEMPLATE='<div role="search"><div><label id="fileNameMessage" for="fileName">${Type the name of a file to open (? = any character, * = any string):}</label></div><div><input id="fileName" type="text" class="setting-control" style="width:90%;"/></div><div id="progress" style="padding: 2px 0 0; width: 100%;"><img src="'+n.toUrl("../../../images/progress_running.gif")+'" class="progressPane_running_dialog" id="crawlingProgress"></img></div><div id="results" style="max-height:250px; height:auto; overflow-y:auto;" aria-live="off"></div><div id="statusbar"></div></div>',a.prototype._init=function(t){if(this.title=t.title||e["Find File Named"],this.modal=!0,this.messages=e,this._searcher=t.searcher,this._progress=t.progress,this._onHide=t.onHide,this._contentTypeService=new i.ContentTypeRegistry(this._searcher.registry),!this._searcher)throw new Error("Missing required argument: searcher");if(this._searchDelay=t.searchDelay||500,this._time=0,this._searcher.setCrawler(null),this._forceUseCrawler=!1,this._initialText=t.initialText,this._message=t.message,this._nameSearch=!0,void 0!==t.nameSearch&&(this._nameSearch=t.nameSearch),this._searchOnRoot=!0,this._fileService=this._searcher.getFileService(),!this._fileService)throw new Error(e["Missing required argument: fileService"]);if(this._searchRenderer=t.searchRenderer,!this._searchRenderer||"function"!=typeof this._searchRenderer.makeRenderFunction)throw new Error(e["Missing required argument: searchRenderer"]);this._initialize()},a.prototype._bindToDom=function(i){var n=this;n.$crawlingProgress.style.display="none",this._nameSearch?this.$fileName.setAttribute("placeholder",e["FileName FolderName"]):this.$fileName.setAttribute("placeholder",e.Search),this.$fileName.addEventListener("input",function(){n._time=+new Date,n._timeoutId&&clearTimeout(n._timeoutId),n._timeoutId=setTimeout(n.checkSearch.bind(n),0)},!1),this.$fileName.addEventListener("keydown",function(e){if(e.keyCode===r.KEY.ENTER){var t=r.$("a",n.$results);t&&(r.stop(e),(o.isMac?e.metaKey:e.ctrlKey)?window.open(t.href):(window.location.href=t.href,n.hide()))}},!1),i.addEventListener("keydown",function(e){var t,i,o,s,a,l=function(e,t,i){return t<e.length-1?e[t+1]:i},c=function(e,t,i){return t>0?e[t-1]:i};(e.keyCode===r.KEY.DOWN||e.keyCode===r.KEY.UP)&&(t=r.$$array("a",n.$results),o=document.activeElement,s=t.indexOf(o),e.keyCode===r.KEY.DOWN?s>=0?(o.classList.remove("treeIterationCursor"),a=l(t,s,t[0]),a.focus(),a.classList.add("treeIterationCursor")):t.length>0&&(a=l(t,-1,t[0]),a.focus(),a.classList.add("treeIterationCursor")):s>=0?(o.classList.remove("treeIterationCursor"),i=n.$fileName,a=c(t,s,i),a.focus(),s>0&&a.classList.add("treeIterationCursor")):t.length>0&&(t[t.length-1].focus(),t[t.length-1].classList.add("treeIterationCursor")),r.stop(e))}),i.addEventListener("mouseup",function(e){e.target.focus()},!1),setTimeout(function(){if(n._forceUseCrawler||!n._fileService.getService(n._searcher.getSearchLocation()).search){var i=n._searchOnRoot?n._searcher.getSearchRootLocation():n._searcher.getChildrenLocation(),r=new t.SearchCrawler(n._searcher.registry,n._fileService,"",{searchOnName:!0,location:i});n._searcher.setCrawler(r),r.buildSkeleton(function(){n.$crawlingProgress.style.display="inline",n.$progress.appendChild(document.createTextNode(e["Building file skeleton..."]))},function(){n.$crawlingProgress.style.display="none",n.$progress.removeChild(n.$progress.lastChild)})}},0),this._message&&(this.$fileNameMessage.removeChild(this.$fileNameMessage.firstChild),this.$fileNameMessage.appendChild(document.createTextNode(this._message))),this._initialText&&(this.$fileName.value=this._initialText,this.doSearch())},a.prototype.checkSearch=function(){clearTimeout(this._timeoutId);var e=(new Date).getTime();e-this._time>this._searchDelay?(this._time=e,this.doSearch()):this._timeoutId=setTimeout(this.checkSearch.bind(this),50)},a.prototype._detectFolderKeyword=function(e){var t,i,n=e,r=null;return this._nameSearch&&(t=/(\S+)\s*(.*)/,i=t.exec(e),i&&3===i.length&&(i[1]&&(n=i[1]),i[2]&&(r=i[2]))),{keyword:n,folderKeyword:r}},a.prototype.doSearch=function(){var t=this.$fileName.value;if(t){var i=this._detectFolderKeyword(t),n=this._searcher.createSearchParams(i.keyword,this._nameSearch,this._searchOnRoot),s=this._searchRenderer.makeRenderFunction(this._contentTypeService,this.$results,!1,this.decorateResult.bind(this));this.currentSearch=s;var a=document.createElement("div");a.appendChild(document.createTextNode(this._nameSearch?e["Searching..."]:o.formatMessage(e["Searching for occurrences of"],t))),r.empty(this.$results),this.$results.appendChild(a),this._searcher.search(n,i.folderKeyword,function(){s===this.currentSearch&&s.apply(null,arguments)}.bind(this))}},a.prototype.decorateResult=function(e){function t(e){0!==e.button||e.ctrlKey||e.metaKey||i.hide()}for(var i=this,n=r.$$array("a",e),o=0;o<n.length;o++){var s=n[o];s.addEventListener("click",t,!1)}},a.prototype._beforeHiding=function(){clearTimeout(this._timeoutId)},a.prototype._afterHiding=function(){this._onHide&&this._onHide()},a.prototype.constructor=a,{OpenResourceDialog:a}}),define("text!orion/banner/banner.html",[],function(){return'<header id="banner" role="banner">\r\n	<!-- Requires some js code to bind the home link, link to progress image, and binding NLS variables  -->\r\n\r\n	<div id="staticBanner" class="layoutBlock topRowBanner"> <!-- primaryNav -->\r\n		<div id="centralNavigationArea" style="position:absolute;left:0;top:0;width:39px;height:36px; z-index:1;border-right:1px solid #ddd;"></div>\r\n\r\n		<!-- Static "Home" link. TODO delete this -->\r\n		<a id="home" class="layoutLeft "></a>\r\n\r\n		<!-- Left banner component: hamburger -->\r\n		<nav id="primaryNav" class="bannerLeftArea" style="z-index:2;" role="navigation">\r\n				<button class="centralNavigation commandSprite core-sprite-hamburger" type="button"id="centralNavigation"></button>\r\n		</nav>\r\n\r\n		<!-- Middle banner component: Breadcrumb bar -->\r\n		<div class="clear navigationBreadcrumb bannerMiddleArea" >\r\n			<div id="location" class="currentLocation"></div>\r\n		</div>\r\n\r\n		<!-- Right banner component: user identity -->\r\n		<div class="bannerRightArea" style="z-index:2;">\r\n			<!-- Global commands support. -->\r\n			<div id="globalActions" class="spacingLeft layoutLeft"></div>\r\n\r\n			<!-- Search. TODO delete this -->\r\n			<input type="text" id="search" autocomplete="off" class="layoutLeft spacingLeft searchbox" role="search" style="display:none;">\r\n			<div id="searchOptions" class="layoutLeft" style="padding-top:1px;display:none;"></div>\r\n\r\n			<!-- User identity menu and Progress -->\r\n			<div id="userMenu" class="spacingRight layoutRight" style="color:#ccc;line-height:16px;">\r\n				<div id="progressPane" class="progressWatch" tabindex="0" role="progressbar">\r\n					<div id="watchButton" class="watchButton"></div>\r\n					<div id="watchBody" class="watchBody">\r\n						<span class="hand longMinute">\r\n							<span class="darkSide"></span>\r\n						</span>\r\n						<span class="hand longHour">\r\n							<span class="darkSide"></span>\r\n						</span>\r\n					</div>\r\n				</div>\r\n				\r\n				<div style="position: absolute;right: 0px;top:0;width: 39px;height:36px; z-index:-50;border-left: 1px solid #ddd;"></div>\r\n				<span id="userTrigger" tabindex="0" role="button" class="dropdownTrigger" style="z-index:2;">\r\n				</span>\r\n				<ul id="userDropdown" class="dropdownMenu" role="menu"></ul>\r\n			</div>\r\n		</div>\r\n	</div>\r\n\r\n	<!-- IDE notification messages go in here -->\r\n	<div id="notificationArea" class="notificationHide">\r\n		<div class="layoutLeft" id="notifications" aria-live="assertive" aria-atomic="true"></div>\r\n		<div class="layoutRight"><button aria-label="Close" class="dismissButton layoutRight core-sprite-close imageSprite" type="button" id="closeNotifications"></span></div>\r\n	</div>\r\n</header>\r\n'}),define("text!orion/banner/footer.html",[],function(){return'<!--\r\n<footer id="footerContent" class="layoutBlock footerLayout" role="contentinfo">\r\n	<div class="logoFooter commandSprite core-sprite-orion-logo"></div>\r\n	<div class="footerBlock">${Orion is in Beta. Please try it out but BEWARE your data may be lost.}</div>\r\n	<div class="footerRightBlock">\r\n		<ul>\r\n			<li><a href="https://bugs.eclipse.org/bugs/enter_bug.cgi?product=Orion&version=5.0" target="_blank">${Report a Bug}</a>\r\n			<li><a href="http://www.eclipse.org/legal/privacy.php" target="_blank">${Privacy Policy}</a></li>\r\n			<li><a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">${Terms of Use}</a></li>\r\n			<li><a href="http://www.eclipse.org/legal/copyright.php" target="_blank">${Copyright Agent}</a></li>\r\n		</ul>\r\n	</div>\r\n</footer>\r\n-->'}),define("text!orion/banner/toolbar.html",[],function(){return'<ul class="layoutLeft commandList pageActions" id="pageActions"></ul>\r\n<ul class="layoutLeft commandList pageActions" id="selectionTools"></ul>\r\n<ul class="layoutLeft commandList pageActions" id="navActions"></ul>\r\n<div class="layoutLeft" style="padding-left:7px;padding-right:7px;margin-top:2px;" id="filterBox" style="visibility: hidden;"></div>\r\n<ul class="layoutRight commandList pageActions" id="settingsActions"></ul>\r\n<div class="layoutRight status" id="statusPane" role="status" aria-live="off"></div>\r\n<ul class="layoutRight commandList pageActions" id="pageNavigationActions"></ul>\r\n'}),define("orion/widgets/input/DropDownMenu",["orion/objects","orion/webui/littlelib"],function(e,t){function i(e,i,n){var r=t.node(e);if(!r)throw new Error("Parent node of dropdown menu not found");this._parent=r,n=n||{},this.options=n,this.navDropDownId=this._parent.id+"_navdropdown",this.selectionClass=n.selectionClass;var o=document.createElement("div");if(o.classList.add("dropdownMenu"),o.classList.add("dropdownMenuOpen"),o.id=this.navDropDownId,o.style.display="none",this._parent.appendChild(o),this._dropdownMenu=o,i=t.node(i),!i)throw"Trigger node of dropdown menu not found";this._triggerNode=i,"hidden"===this._triggerNode.style.visibility&&(this._triggerNode.style.visibility="visible"),n.noClick||(this._triggerNode.onclick=this.click.bind(this)),this._dropdownMenu.addEventListener("keydown",function(e){e.keyCode===t.KEY.ESCAPE&&this.clearPanel()}.bind(this))}return e.mixin(i.prototype,{click:function(){"none"===this._dropdownMenu.style.display?this.updateContent(this.getContentNode(),function(){t.setFramesEnabled(!1),this._dropdownMenu.style.display="",this._positionDropdown(),this.selectionClass&&this._triggerNode.classList.add(this.selectionClass),this.handle=t.addAutoDismiss([this._triggerNode,this._dropdownMenu],this.clearPanel.bind(this)),this.options.onShow&&this.options.onShow()}.bind(this)):this.clearPanel()},clearPanel:function(){this.isVisible()&&(this._dropdownMenu.style.display="none",t.setFramesEnabled(!0),this.selectionClass&&this._triggerNode.classList.remove(this.selectionClass),this.options.onHide&&this.options.onHide())},addContent:function(e){this._dropdownMenu.innerHTML=e},getContentNode:function(){return this._dropdownMenu},updateContent:function(e,t){t()},_positionDropdown:function(){this._dropdownMenu.style.right="";var e=t.bounds(this._dropdownMenu),i=t.bounds(document.body);if(e.left+e.width>i.left+i.width){var n=t.bounds(this._boundingNode(this._triggerNode)),r=t.bounds(this._triggerNode);this._dropdownMenu.style.right=n.width-(r.left-n.left+r.width)+"px"}},_boundingNode:function(e){var t=window.getComputedStyle(e,null);if(null===t)return e;var i=t.getPropertyValue("position");return"absolute"!==i&&e.parentNode&&e!==document.body?this._boundingNode(e.parentNode):e},isDestroyed:function(){return!this._dropdownMenu.parentNode},isVisible:function(){return"none"!==this._dropdownMenu.style.display&&!this.isDestroyed()},focus:function(){this._dropdownMenu.focus()},destroy:function(){this._parent&&(t.setFramesEnabled(!0),t.empty(this._parent),this._parent=this.select=null)}}),i}),define("orion/customGlobalCommands",[],function(){return{}}),define("orion/navigate/nls/root/messages",{"Click one of the tasks below to create an Orion folder.  You can upload, import, or generate files.":"Click one of the tasks below to create an Orion folder.  You can upload, import, or generate files.","Toggle Left Pane":"Toggle Left Pane","Open or close the left pane":"Open or close the left pane",Navigator:"Navigator","Strings Xtrnalizr":"Strings Xtrnalizr","Externalize Strings from JavaScript files in this folder":"Externalize strings from JavaScript files in this folder.","Choose a Folder":"Choose a Folder","Copy of ${0}":"Copy of ${0}","Enter a new name for '${0}'":"Enter a new name for '${0}'","Choose folder...":"Choose folder...",Rename:"Rename","Rename the selected files or folders":"Rename the selected files or folders","Compare with each other":"Compare with each other","Compare the selected 2 files with each other":"Compare the selected 2 files with each other","Compare with...":"Compare with...","Compare the selected folder with a specified folder":"Compare the selected folder with a specified folder",Delete:"Delete","Unknown item":"Unknown item","Are you sure you want to delete these ${0} items?":"Are you sure you want to delete these ${0} items?","Are you sure you want to delete '${0}'?":"Are you sure you want to delete '${0}'?","Export as zip":"Zip","Create a zip file of the folder contents and download it":"Create a zip file of the folder contents and download it","New File":"File","Create a new file":"Create a new file","Name:":"Name:","New Folder":"Folder","Folder name:":"Folder name:","Create a new folder":"Create a new folder","Creating folder":"Creating folder",Folder:"Folder","Create an empty folder":"Create an empty folder","Create an empty folder on the Orion server.  You can import, upload, or create content in the editor.":"Create an empty folder on the Orion server.  You can import, upload, or create content in the editor.","Sample HTML5 Site":"Sample HTML5 Site","Generate a sample":"Generate a sample",'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.':'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.',"Creating a folder for ${0}":"Creating a folder for ${0}","SFTP Import":"SFTP Import","Import content from SFTP":"Import content from SFTP","Import content from an SFTP location into an Orion folder.  You will be prompted for the SFTP location and credentials.":"Import content from an SFTP location into an Orion folder.  You will be prompted for the SFTP location and credentials.","Imported Content":"Imported Content","Upload a Zip":"Upload a Zip","Upload content from a local zip file":"Upload content from a local zip file","Upload content from a local zip file into an Orion folder.  You will be prompted for the local zip file.":"Upload content from a local zip file into an Orion folder.  You will be prompted for the local zip file.","Uploaded Content":"Uploaded Content","Creating an upload folder for ":"Creating an upload folder for ","Clone Git Repository":"Clone Git Repository","Clone a git repository":"Clone a git repository","Go to the Orion repositories page to provide a git repository URL.  Once the repository is created, it will appear in the Navigator.":"Go to the Orion repositories page to provide a git repository URL.  Once the repository is created, it will appear in the Navigator.","Link to Server":"Link to Server","Link to existing content on the server":"Link to existing content on the server","Create a folder that links to an existing folder on the server.":"Create a folder that links to an existing folder on the server.","Server path:":"Server path:","The name and server location were not specified.":"The name and server location were not specified.","Go Up":"Go Up","Move up to the parent folder":"Move up to the parent folder","Go Into":"Go Into","Move into the selected folder":"Move into the selected folder","File or zip archive":"File or zip archive","Import a file or zip archive from your local file system":"Import a file or zip archive from your local file system","SFTP from...":"SFTP","Copy files and folders from a specified SFTP connection":"Copy files and folders from a specified SFTP connection","Importing from ${0}":"Importing from ${0}","SFTP to...":"SFTP","Copy files and folders to a specified SFTP location":"Copy files and folders to a specified SFTP location",Exporting:"Exporting to ${0}","Pasting ${0}":"Pasting ${0}","Copy to":"Copy to","Move to":"Move to","Copying ${0}":"Copying ${0}","Moving ${0}":"Moving ${0}","Renaming ${0}":"Renaming ${0}","Deleting ${0}":"Deleting ${0}","Creating ${0}":"Creating ${0}","Linking to ${0}":"Linking to ${0}","Move files and folders to a new location":"Move files and folders to a new location",Cut:"Cut",Copy:"Copy","Fetching children of ":"Fetching children of ",Paste:"Paste","Cannot paste into the Workspace root":"Cannot paste into the Workspace root","Open With":"Open With","Loading ":"Loading ",New:"New",File:"File",Actions:"Actions","Orion Content":"Orion Content"," is not supported in this file system":" is not supported in this file system","Create new content":"Create new content","Import from HTTP...":"HTTP","File URL:":"File URL:","Import a file from a URL and optionally unzip it":"Import a file from a URL and optionally unzip it","Unzip *.zip files:":"Unzip *.zip files:","Extracted from:":"Extracted from:","Did not drop ${0}.  Folder drop is not supported in this browser.":"Did not drop ${0}.  Folder drop is not supported in this browser.","You cannot copy files directly into the workspace.  Create a folder first.":"You cannot copy files directly into the workspace.  Create a folder first.","Unzip ${0}?":"Unzip ${0}?","Upload progress: ":"Upload progress: ","Uploading ":"Uploading ","Cancel upload":"Cancel upload","Uploading the following file failed: ":"Uploading the following file failed: ","Enter project name:":"Enter project name:","Creating project ":"Creating project ",NoFile:"Use the ${0} menu to create new files and folders. Click a file to start coding.",Download:"Download",Download_tooltips:"Download the file contents as the displayed name","Downloading...":"Reading file contents...","Download not supported":"Contents download is not supported in this browser."}),define("orion/navigate/nls/messages",["orion/i18n!orion/navigate/nls/messages","orion/navigate/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/fileClient",["i18n!orion/navigate/nls/messages","orion/Deferred","orion/i18nUtil"],function(e,t,i){function n(t,i,n){if(!t[i])throw i+e[" is not supported in this file system"];return t[i].apply(t,n)}function r(i,o,s,a){if(!i.readBlob)throw e["source file service does not support binary read"];if(!s.writeBlob)throw e["target file service does not support binary write"];if("/"!==o[o.length-1])return n(i,"readBlob",[o]).then(function(e){return n(s,"writeBlob",[a,e])});var l=a.substring(0,a.length-1),c=decodeURIComponent(l.substring(l.lastIndexOf("/")+1)),d=l.substring(0,l.lastIndexOf("/")+1);return n(s,"createFolder",[d,c]).then(function(){},function(){}).then(function(){return n(i,"fetchChildren",[o]).then(function(e){for(var n=[],o=0;o<e.length;++o){var l=e[o].Location,c=l;e[o].Directory&&(c=l.substring(0,l.length-1));var d=decodeURIComponent(c.substring(c.lastIndexOf("/")+1)),h=a+encodeURIComponent(d);e[o].Directory&&(h+="/"),n[o]=r(i,l,s,h)}return t.all(n)})})}function o(n,r){function o(i){var n=new t;return n.reject(e["No Matching FileService for location:"]+i),n}var s=n.getServiceReferences("orion.core.file"),a=s;if(r){a=[];for(var l=0;l<s.length;++l)r(s[l])&&a.push(s[l])}for(var c=[],d=[],h=[],u=[],p={fetchChildren:function(){var e=new t;return e.resolve(u),e},createWorkspace:function(){var i=new t;return i.reject(e["no file service"]),i},loadWorkspaces:function(){var i=new t;return i.reject(e["no file service"]),i},loadWorkspace:function(){var i=new t;return window.setTimeout(function(){i.resolve({Directory:!0,Length:0,LocalTimeStamp:0,Name:e["File Servers"],Location:"/",Children:u,ChildrenLocation:"/"})},100),i},search:o,createProject:o,createFolder:o,createFile:o,deleteFile:o,moveFile:o,copyFile:o,read:o,write:o},f=0;f<a.length;++f){u[f]={Directory:!0,Length:0,LocalTimeStamp:0,Location:a[f].getProperty("top"),ChildrenLocation:a[f].getProperty("top"),Name:a[f].getProperty("Name")};
var m=a[f].getProperty("pattern")||a[f].getProperty("top").replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");"^"!==m[0]&&(m="^"+m),c[f]=new RegExp(m),d[f]=n.getService(a[f]),h[f]=a[f].getProperty("Name"),a[f].getProperty("NameKey")&&a[f].getProperty("nls")&&i.getMessageBundle(a[f].getProperty("nls")).then(function(e,t){u[e].Name=t[a[e].getProperty("NameKey")],h[e]=t[a[e].getProperty("NameKey")]}.bind(this,f))}this._getServiceIndex=function(t){if("/"===t)return-1;if(!t||t.length&&0===t.length)return d[0]?0:-1;for(var i=0;i<c.length;++i)if(c[i].test(t))return i;throw e["No Matching FileService for location:"]+t},this._getService=function(e){var t=this._getServiceIndex(e);return-1===t?p:d[t]},this._getServiceName=function(e){var t=this._getServiceIndex(e);return-1===t?p.Name:h[t]},this._getServiceRootURL=function(e){var t=this._getServiceIndex(e);return-1===t?p.Location:u[t].Location}}return o.prototype={getService:function(e){return this._getService(e)},fileServiceName:function(e){return this._getServiceName(e)},fileServiceRootURL:function(e){return this._getServiceRootURL(e)},fetchChildren:function(e){return n(this._getService(e),"fetchChildren",arguments)},createWorkspace:function(){return n(this._getService(),"createWorkspace",arguments)},loadWorkspaces:function(){return n(this._getService(),"loadWorkspaces",arguments)},loadWorkspace:function(e){return n(this._getService(e),"loadWorkspace",arguments)},createProject:function(e){return n(this._getService(e),"createProject",arguments)},createFolder:function(e){return n(this._getService(e),"createFolder",arguments)},createFile:function(e){return n(this._getService(e),"createFile",arguments)},deleteFile:function(e){return n(this._getService(e),"deleteFile",arguments)},moveFile:function(e,t,i){var o=this._getService(e),s=this._getService(t);if(o===s)return n(o,"moveFile",arguments);var a="/"===e[e.length-1],l=t;if("/"!==l[l.length-1]&&(l+="/"),i)l+=encodeURIComponent(i);else{var c=e;a&&(c=c.substring(0,c.length-1)),l+=c.substring(c.lastIndexOf("/")+1)}return a&&"/"!==l[l.length-1]&&(l+="/"),r(o,e,s,l).then(function(){return n(o,"deleteFile",[e])})},copyFile:function(e,t,i){var o=this._getService(e),s=this._getService(t);if(o===s)return n(o,"copyFile",arguments);var a="/"===e[e.length-1],l=t;if("/"!==l[l.length-1]&&(l+="/"),i)l+=encodeURIComponent(i);else{var c=e;a&&(c=c.substring(0,c.length-1)),l+=c.substring(c.lastIndexOf("/")+1)}return a&&"/"!==l[l.length-1]&&(l+="/"),r(o,e,s,l)},read:function(e){return n(this._getService(e),"read",arguments)},readBlob:function(e){return n(this._getService(e),"readBlob",arguments)},write:function(e){return n(this._getService(e),"write",arguments)},remoteImport:function(e){return n(this._getService(e),"remoteImport",arguments)},remoteExport:function(e){return n(this._getService(e),"remoteExport",arguments)},search:function(e){return n(this._getService(e.resource),"search",arguments)}},o.prototype.constructor=o,{FileClient:o}}),define("orion/webui/SideMenu",["orion/webui/littlelib","orion/PageUtil","orion/URL-shim"],function(e,t){function i(t,i){if(this._parentNode=e.node(t),!this._parentNode)throw new Error("Missing parentNode");this._contentNode=e.node(i),this._categoryInfos=[],this._categorizedPageLinks={},this._categorizedRelatedLinks={},this._categorizedAnchors=null,this._state=localStorage.getItem(n)||s,this._currentCategory="",this._notificationTimeout=null,this._renderTimeout=null}var n="sideMenuNavigation",r="open",o="closed",s=r,a="40px",l=301;return i.prototype={constructor:i.prototype.constructor,setCategories:function(e){this._categoryInfos=e.getCategoryIDs().map(function(t){return e.getCategory(t)}).sort(function(e,t){var i=e.order||100,n=t.order||100;return n>i?-1:i>n?1:e.textContent.localeCompare(t.textContent)})},setPageLinks:function(e){this._categorizedPageLinks={},e.getAllLinks().forEach(function(e){var t=e.category;this._categorizedPageLinks[t]=this._categorizedPageLinks[t]||[],this._categorizedPageLinks[t].push({title:e.textContent,order:e.order||100,href:e.href})},this)},setRelatedLinks:function(e,t){this._categorizedRelatedLinks={},e.forEach(function(e){var i=e.relatedLink,n=e.command,r=e.invocation;if(!t||-1===t.indexOf(i.id)){var o=i.category;this._categorizedRelatedLinks[o]=this._categorizedRelatedLinks[o]||[],this._categorizedRelatedLinks[o].push({title:n.name,order:i.order||100,href:n.hrefCallback.call(r.handler,r)})}},this),this._updateCategoryAnchors(),this._updateCategoryNotifications()},render:function(){if(null===this._categorizedAnchors){this._categorizedAnchors={};var e=new URL(window.location.href);e.hash="",this._currentCategory="",Object.keys(this._categorizedPageLinks).some(function(t){var i=this._categorizedPageLinks[t];return i.some(function(t){var i=new URL(t.href);return t.hash="",e.href===i.href})?(this._currentCategory=t,!0):void 0},this);var t=document.createElement("ul");t.classList.add("sideMenuList"),this._categoryInfos.forEach(function(e){var i=document.createElement("li");i.classList.add("sideMenuItem"),i.classList.add("sideMenu-notification"),this._currentCategory===e.id&&i.classList.add("sideMenuItemActive"),i.categoryId=e.id,i.categoryName=e.textContent||e.id;var n=document.createElement("a");if(n.classList.add("submenu-trigger"),"string"==typeof e.imageDataURI&&0===e.imageDataURI.indexOf("data:image")){var r=document.createElement("img");r.width="16",r.height="16",r.src=e.imageDataURI,n.appendChild(r)}else{var o=e.imageClass||"core-sprite-blank-menu-item";n.classList.add(o)}i.appendChild(n),t.appendChild(i),this._categorizedAnchors[e.id]=n},this),this._updateCategoryAnchors(),this._parentNode.appendChild(t)}this._state===o?(this._contentNode.style.left="0",this._renderTimeout&&(window.clearTimeout(this._renderTimeout),this._renderTimeout=null),this._renderTimeout=window.setTimeout(function(){this._parentNode.style.display="none",this._renderTimeout=null}.bind(this),l),this._parentNode.classList.add("animating")):(this._renderTimeout&&(window.clearTimeout(this._renderTimeout),this._renderTimeout=null),this._parentNode.classList.remove("animating"),this._parentNode.style.display="block",this._parentNode.style.width=a,this._contentNode.style.left=a)},hide:function(){localStorage.setItem(n,o),this._contentNode.style.left="0"},toggle:function(){var e=this._contentNode;e&&e.classList.add("content-fixedHeight-animation"),this._state=this._state===r?o:r,this._state===s?localStorage.removeItem(n):localStorage.setItem(n,this._state),this.render()},_updateCategoryAnchors:function(){Object.keys(this._categorizedAnchors).forEach(function(e){var t=this._categorizedAnchors[e],i=[];if(e===this._currentCategory)return t.href="",t.onclick=function(){return!1},void(t.title=t.parentElement.categoryName);if(this._categorizedPageLinks[e]&&i.push.apply(i,this._categorizedPageLinks[e]),this._categorizedRelatedLinks[e]&&i.push.apply(i,this._categorizedRelatedLinks[e]),0===i.length)t.href="",t.title=t.parentElement.categoryName;else{i.sort(function(e,t){return e.order<t.order?-1:t.order<e.order?1:e.title.localeCompare(t.title)});var n=i.shift();t.href=n.href,t.title=n.title}},this)},_updateCategoryNotifications:function(){clearTimeout(this._notificationTimeout),this._notificationTimeout=setTimeout(this._updateCategoryNotifications.bind(this),3e5);var e=t.matchResourceParameters().resource,i=new URL(e,window.location.href).href;this._categoryInfos.forEach(function(n){if(n.service&&n.service.getNotifications){var r=this._categorizedAnchors[n.id].parentElement;n.service.getNotifications(i).then(function(i){if(e===t.matchResourceParameters().resource){var n="";i.forEach(function(e){"info"!==e.level||n?"warn"!==e.level||n&&"info"!==n?"error"===e.level&&"error"!==n&&(n="error"):n="warn":n="info"}),n?r.setAttribute("level",n):r.removeAttribute("level")}},function(e){window.console.log(e)})}},this)}},i}),define("orion/globalCommands",["i18n!orion/nls/messages","require","orion/commonHTMLFragments","orion/keyBinding","orion/EventTarget","orion/commandRegistry","orion/commands","orion/parameterCollectors","orion/extensionCommands","orion/uiUtils","orion/keyBinding","orion/breadcrumbs","orion/webui/littlelib","orion/webui/splitter","orion/webui/dropdown","orion/webui/tooltip","orion/contentTypes","orion/URITemplate","orion/keyAssist","orion/PageUtil","orion/widgets/themes/ThemePreferences","orion/widgets/themes/container/ThemeData","orion/Deferred","orion/widgets/UserMenu","orion/PageLinks","orion/webui/dialogs/OpenResourceDialog","text!orion/banner/banner.html","text!orion/banner/footer.html","text!orion/banner/toolbar.html","orion/widgets/input/DropDownMenu","orion/util","orion/customGlobalCommands","orion/fileClient","orion/webui/SideMenu","orion/objects"],function(e,t,i,n,r,o,s,a,l,c,d,h,u,p,f,m,g,v,y,_,w,C,b,S,E,L,x,k,N,T,P,R,I,A,O){function F(e){var t=document.createElement("a");return t.href=e,t.href}function M(e,t){if(e.getLabel)return e.getLabel();var i=new b;return i.resolve(t.properties.name),i}function D(){var e=document.getElementById("userTrigger"),t=e.className;t+=" imageSprite core-sprite-silhouette",e.className=t}function B(t){var i=u.node("progressPane");i.setAttribute("aria-label",e["Operations - Press spacebar to show current operations"]);var n=t.getService("orion.page.progress");n&&n.init.bind(n)("progressPane")}function U(e){var t=e.getServiceReferences("orion.core.auth");rt=[];var i=nt.createMenuGenerator.apply(this,arguments);if(i)for(var n=0;n<t.length;n++){var r=t[n],o=e.getService(r);M(o,r).then(function(e){o.getKey().then(function(t){rt.push(t),o.getUser().then(function(n){i.addUserItem(t,o,e,n)},function(n,r){i.addUserItem(t,o,e,r)}),window.addEventListener("storage",function(){it[t]!==localStorage.getItem(t)&&(it[t]=localStorage.getItem(t),o.getUser().then(function(n){i.addUserItem(t,o,e,n)},function(){i.addUserItem(t,o,e)}))},!1)})})}}function $(e){return e}function H(e,t,i,n,r){function o(){if(u)return u;var t=e.getService("orion.core.contentTypeRegistry");return t||(t=new g.ContentTypeRegistry(e),t=e.getService("orion.core.contentTypeRegistry")),t.getContentTypes().then(function(e){return u=e})}function a(e){for(var t,i={},n=e.getPropertyKeys(),r=0;r<n.length;r++)t=n[r],i[t]=e.getProperty(t);return i}function c(e,t){var i=null;return e.some(function(e){return t===e.getProperty("id")?!!(i=e):!1}),i}function d(e){var i=e.command;return!i.visibleWhen||i.visibleWhen(t)?(e.invocation=new s.CommandInvocation(t,t,null,i,n),(new b).resolve(e)):"function"==typeof r?(p||(p=r()),b.when(p,function(r){return!r||t!==Q||i.visibleWhen&&!i.visibleWhen(r)?void 0:(e.invocation=new s.CommandInvocation(r,r,null,i,n),e)})):(new b).resolve()}function h(e,t,i){return i?(new b).resolve({relatedLink:e,command:i}):t.then(function(t){return{relatedLink:e,command:new s.Command(t)}})}var u,p,f=arguments,m=e&&e.getServiceReferences("orion.page.link.related");if(m&&0!==m.length){var v=this;b.when(o(),function(){if(nt.beforeGenerateRelatedLinks.apply(v,f)){var t=e.getServiceReferences("orion.navigate.command"),r=[];m.forEach(function(i){var o=a(i);if(o.id){var s;if((o.nls&&o.nameKey||o.name)&&o.uriTemplate)return s=l._createCommandOptions(o,i,e,u,!0),void r.push(h(o,s,null));var d=c(t,o.id);if(d){var p=a(d),f={};O.mixin(f,p,o);var m;(m=n.findCommand(o.id))?r.push(h(f,null,m)):(s=l._createCommandOptions(p,d,e,u,!0),r.push(h(f,s,null)))}}}),b.all(r,$).then(function(e){return e.sort(function(e,t){return e.command.name.localeCompare(t.command.name)}),b.all(e.map(d),$).then(function(t){var r=[];t=t.filter(function(t,i){return t?!0:(r.push(e[i]),!1)}),nt.addRelatedLinkCommands.call(v,n,t,r,i),nt.afterGenerateRelatedLinks.apply(v,f)})})}})}}function K(e){var t=u.node("globalActions");t&&(e.destroy(t),e.renderCommands(t.id,t,{},{},"tool"))}function j(e){ot=e}function W(e){et&&("*"!==et.charAt(0)||e||(et=et.substring(1)),e&&"*"!==et.charAt(0)&&(et="*"+et),window.document.title=et);var t=u.node("dirty");t&&(t.textContent=e?"*":"")}function G(e){var t,i,n=e.breadcrumbRootName,r=e.serviceRegistry;e.target?(e.searchService&&e.searchService.setLocationByMetaData(e.target),!e.fileService||e.breadcrumbTarget||e.staticBreadcrumb||(i=n?n+" ":"",i+=e.fileService.fileServiceName(e.target.Location),n=null),t=e.name||e.target.Name,Q=e.target,H.call(this,r,e.target,ot,e.commandService,e.makeAlternate)):(e.breadcrumbTarget||(n=n||e.task||e.name),t=e.name,H.call(this,r,{NoTarget:""},ot,e.commandService,e.makeAlternate)),et=e.title,et||(et=t?t+" - "+e.task:e.task),window.document.title=et,nt.afterSetPageTarget.apply(this,arguments);var o=u.node(e.breadCrumbContainer?e.breadCrumbContainer:"location");if(o)if(u.empty(o),e.staticBreadcrumb)new h.BreadCrumbs({container:o,rootSegmentName:n});else{var s=r&&new I.FileClient(r),a=e.breadcrumbTarget||e.target,l=s&&a&&a.Location?s.fileServiceRootURL(a.Location):null;new h.BreadCrumbs({container:o,resource:a,rootSegmentName:n,workspaceRootSegmentName:i,workspaceRootURL:l,makeFinalHref:e.makeBreadcrumFinalLink,makeHref:e.makeBreadcrumbLink})}}function z(e){var t=window.getComputedStyle(e,null);if(null===t)return e;var i=t.getPropertyValue("position");return"absolute"!==i&&e.parentNode&&e!==document.body?z(e.parentNode):e}function V(e){var t={},i=null;"string"==typeof e&&(e=u.node(e)),e||(e=u.node("pageActions"));for(var n=e;n&&n.classList;){if(n.classList.contains("toolComposite")){i=n;break}n=n.parentNode}if(e.classList.contains("commandMarker")&&(t.commandNode=e),i||(i=u.node("pageToolbar")),i&&(t.slideContainer=u.$(".slideParameters",i),t.parameterArea=u.$(".parameters",i),t.dismissArea=u.$(".parametersDismiss",i),t.notifications=u.$("#notificationArea",i),i.parentNode&&(t.toolbarTarget=u.$(".toolbarTarget",i.parentNode),t.toolbarTarget))){var r=u.bounds(t.toolbarTarget),o=u.bounds(z(t.toolbarTarget.parentNode));t.toolbarTargetY=r.top-o.top,t.toolbar=i}return t}function q(e){var t=e.slideContainer;if(t&&(t.style.left="",t.style.top="",t.classList.contains("slideContainerActive"))){var i=u.bounds(t),n=u.bounds(t.parentNode);t.style.left=(n.width-i.width)/2+"px",t.style.top="0"}}function Y(){return st}function J(){return at}function X(){return lt}function Z(r,o,l,c,d,h,f,m){function g(e){e=e;for(var t=u.$$array(".targetSelector"),i=0;i<t.length;i++)t[i].target=e}function v(e){e.registerService("orion.cm.managedservice",{updated:function(e){var t;t=e&&"undefined"!==e["links.newtab"]&&e["links.newtab"]?"_blank":"_self",g(t)}},{pid:"nav.config"})}new w.ThemePreferences(c,new C.ThemeData).apply();var _=u.node(r);if(!_)throw e["could not find banner parent, id was "]+r;var S=document.createRange();S.selectNode(_);var T=S.createContextualFragment(x);u.processTextNodes(T,e),_.firstChild?_.insertBefore(T,_.firstChild):_.appendChild(T);var R=u.node("home");R.href=t.toUrl("edit/edit.html"),R.setAttribute("aria-label",e["Orion Home"]);var I=u.node("progressPane");I.src=s.NO_IMAGE;var A=u.node("pageToolbar");A&&(A.classList.add("toolbarLayout"),A.innerHTML=N+i.slideoutHTMLFragment("mainToolbar"));var O=u.node("closeNotifications");if(O&&O.setAttribute("aria-label",e["Close notification"]),P.isFirefox<=17){var F=u.node("staticBanner");F&&(F.style.width="100%",F.style.MozBoxSizing="border-box")}var M=u.node("footer");M&&(M.innerHTML=k,u.processTextNodes(M,e)),l.setParameterCollector(new a.CommandParameterCollector(V,q)),document.addEventListener("keydown",function(e){if(e.keyCode===u.KEY.ESCAPE){var t=o.getService("orion.page.message");t&&t.setProgressMessage("")}},!1),nt.generateNavigationMenu.apply(this,arguments),nt.afterGenerateNavigationMenu.apply(this,arguments);var D=E.getCategoriesInfo(o),$=E.getPageLinksInfo(o,"orion.page.link");b.all([D,$]).then(function(e){if(this.sideMenu){var t=e[0],i=e[1];this.sideMenu.setCategories(t),this.sideMenu.setPageLinks(i),this.sideMenu.render()}}.bind(this));var H=u.$(".split");if(H){var j=u.$(".sidePanelLayout"),W=u.$(".mainPanelLayout");if(j&&W){st={side:j,main:W},st.splitter=new p.Splitter({node:H,sidePanel:j,mainPanel:W,toggle:!0,closeByDefault:m});var G=new s.Command({name:e["Toggle side panel"],tooltip:e["Open or close the side panel"],id:"orion.toggleSidePane",callback:function(){st.splitter.toggleSidePanel()}});l.addCommand(G),l.registerCommandContribution("pageActions","orion.toggleSidePane",1,null,!0,new n.KeyBinding("l",P.isMac?!1:!0,!0,!1,P.isMac?!0:!1))}}var z=!1,Y=function(e,t){if(!z){var i=t.getService("orion.page.progress"),n=new L.OpenResourceDialog({searcher:e,progress:i,searchRenderer:e.defaultRenderer,onHide:function(){z=!1}});window.setTimeout(function(){z=!0,n.show()},0)}},J=new s.Command({name:e["Find File Named..."],tooltip:e["Choose a file by name and open an editor on it"],id:"orion.openResource",callback:function(){Y(d,o)}});l.addCommand(J),l.registerCommandContribution("globalActions","orion.openResource",100,null,!0,new n.KeyBinding("f",!0,!0));var Z=!1,Q=function(){if(Z)return!1;var e=u.node("banner"),t=u.node("footer"),i=u.node("sideMenu"),n=u.$(".content-fixedHeight"),r="hidden"===e.style.visibility;return r?(e.style.visibility="visible",t.style.visibility="visible",n.classList.remove("content-fixedHeight-maximized"),i&&i.classList.remove("sideMenu-maximized")):(e.style.visibility="hidden",t.style.visibility="hidden",n.classList.add("content-fixedHeight-maximized"),i&&i.classList.add("sideMenu-maximized")),X().dispatchEvent({type:"toggleTrim",maximized:!r}),!0},et=window.orionNoTrim||!1;if(et)Q(),Z=!0,this.sideMenu.hide();else{var tt=new s.Command({name:e["Toggle banner and footer"],tooltip:e["Hide or show the page banner and footer"],id:"orion.toggleTrim",callback:Q});l.addCommand(tt),l.registerCommandContribution("globalActions","orion.toggleTrim",100,null,!0,new n.KeyBinding("m",!0,!0))}var it=new s.Command({name:e["System Configuration Details"],tooltip:e["System Config Tooltip"],id:"orion.configDetailsPage",hrefCallback:function(){return t.toUrl("help/about.html")}});l.addCommand(it),l.registerCommandContribution("globalActions","orion.configDetailsPage",100,null,!0,new n.KeyBinding(112,!0,!0));var rt=new s.Command({name:e["Background Operations"],tooltip:e["Background Operations Tooltip"],id:"orion.backgroundOperations",hrefCallback:function(){return t.toUrl("operations/list.html")}});l.addCommand(rt),l.registerCommandContribution("globalActions","orion.backgroundOperations",100,null,!0,new n.KeyBinding("o",!0,!0)),at=new y.KeyAssistPanel({commandRegistry:l});var ot=new s.Command({name:e["Show Keys"],tooltip:e["Show a list of all the keybindings on this page"],id:"orion.keyAssist",callback:function(){return at.isVisible()?at.hide():at.show(),!0}});l.addCommand(ot),l.registerCommandContribution("globalActions","orion.keyAssist",100,null,!0,new n.KeyBinding(191,!1,!0)),K(l),U(o,ot.callback),B(o),window.addEventListener("hashchange",function(){l.processURL(window.location.href)},!1),window.setTimeout(function(){v(o)},0),nt.afterGenerateBanner.apply(this,arguments)}var Q,et,tt=F(t.toUrl("auth/NotifyAuthentication.html")),it={},nt={createMenuGenerator:R.createMenuGenerator||function(t,i){var n=u.node("userMenu");if(n){var r=u.node("userDropdown"),o=new f.Dropdown({dropdown:r}),s=new S.UserMenu({dropdownNode:r,dropdown:o,serviceRegistry:t}),a=u.node("userTrigger");return new m.Tooltip({node:a,text:e.Options,position:["below","left"]}),D(),s.setKeyAssist(i),s}},beforeGenerateRelatedLinks:R.beforeGenerateRelatedLinks||function(){return!0},addRelatedLinkCommands:R.addRelatedLinkCommands||function(e,t,i,n){this.sideMenu&&this.sideMenu.setRelatedLinks(t,n)},afterGenerateRelatedLinks:R.afterGenerateRelatedLinks||function(){},afterSetPageTarget:R.afterSetPageTarget||function(){},generateNavigationMenu:R.generateNavigationMenu||function(){var t=u.node("sideMenu");if(t){var i=u.node("centralNavigation");new m.Tooltip({node:i,text:e.CentralNavTooltip,position:["right"]}),this.sideMenu=new A(t,u.node("pageContent")),i.addEventListener("click",this.sideMenu.toggle.bind(this.sideMenu));var n=u.node("sideMenuToggle");n&&n.addEventListener("click",this.sideMenu.toggle.bind(this.sideMenu))}},afterGenerateNavigationMenu:R.afterGenerateNavigationMenu||function(){},afterGenerateBanner:R.afterGenerateBanner||function(){}},rt=[],ot=[],st=null,at=null,lt=new r;return{generateBanner:Z,getToolbarElements:V,getMainSplitter:Y,getKeyAssist:J,getGlobalEventTarget:X,layoutToolbarElements:q,setPageTarget:G,setDirtyIndicator:W,setPageCommandExclusions:j,notifyAuthenticationSite:tt}}),define("orion/urlUtils",["orion/PageUtil","orion/URL-shim"],function(e){function t(t){for(var i=/\[([^\]]*)\]\(([^\)]+)\)/g,n=i.exec(t),r=[],o=0;n;){if(3===n.length&&n[2].length>0){var s=new URL(n[2]);":"!==s.protocol&&e.validateURLScheme(s.href)&&(n.index>o&&r.push({segmentStr:t.substring(o,n.index)}),r.push({segmentStr:n[1].length>0?n[1]:n[2],urlStr:n[2]}),o=n.index+n[0].length)}n=i.exec(t)}return 0===o?null:(o<t.length&&r.push({segmentStr:t.substring(o)}),r)}function i(e,t){t.forEach(function(t){if(t.urlStr){var i=document.createElement("a");i.href=t.urlStr,i.appendChild(document.createTextNode(t.segmentStr)),e.appendChild(i)}else{var n=document.createElement("span");n.textContent=t.segmentStr,e.appendChild(n)}})}return{detectValidURL:t,processURLSegments:i}}),define("orion/status",["i18n!orion/nls/messages","orion/webui/littlelib","orion/globalCommands","orion/urlUtils"],function(e,t,i,n){function r(e,t,i,n,r){this._serviceRegistry=e,this._serviceRegistration=e.registerService("orion.page.message",this),this._operationsClient=t,this.notificationContainerDomId=r,this.domId=i,this.progressDomId=n||i,this._hookedClose=!1,this._timer=null,this._clickToDisMiss=!0,this._cancelMsg=null}var o;return r.prototype={_init:function(){var e=t.node("closeNotifications");if(e&&!this._hookedClose){e.style.cursor="pointer",this._hookedClose=!0;var i=t.node(this.notificationContainerDomId);t.addAutoDismiss([i],function(){this._clickToDisMiss&&this.close()}.bind(this)),e.addEventListener("click",function(){this.close()}.bind(this)),i.addEventListener("click",function(e){if(e&&e.target&&"a"===e.target.nodeName.toLowerCase()){var n=t.$$("a",i);n&&n.length&&1===n.length&&this.close()}}.bind(this))}},close:function(){window.clearTimeout(this._timer);var e=t.node("closeNotifications");this._cancelMsg&&this._cancelFunc&&e?(e.innerHTML="",e.classList.remove("cancelButton"),e.classList.add("dismissButton"),e.classList.add("core-sprite-close"),e.classList.add("imageSprite"),this._cancelFunc(),this._cancelMsg=null):this.setProgressMessage("")},_getNotifierElements:function(){return this._notifierElements||(this._notifierElements=i.getToolbarElements(this.notificationContainerDomId)),this._notifierElements},setMessage:function(e,i,n){this._init(),this.currentMessage=e;var r=t.node(this.domId);if("boolean"==typeof n){var o=r.getAttribute("aria-live");r.setAttribute("aria-live",n?"polite":"off"),window.setTimeout(function(){e===this.currentMessage&&(t.empty(r),r.appendChild(document.createTextNode(e)),window.setTimeout(function(){r.setAttribute("aria-live",o)},100))}.bind(this),100)}else t.empty(r),r.appendChild(document.createTextNode(e));"number"==typeof i&&window.setTimeout(function(){e===this.currentMessage&&(t.empty(r),r.appendChild(document.createTextNode("")))}.bind(this),i)},setErrorMessage:function(e){this._clickToDisMiss=!0,this.currentMessage=e,this._init();var i=e.responseText||e.message||e;if("string"==typeof i)try{i=JSON.parse(i)}catch(n){}var r=i.Message||i,o="red";if(i.Severity)switch(i.Severity){case"Warning":o="#FFCC00";break;case"Error":o="red";break;case"Info":case"Ok":o="green"}var s=document.createElement("span");s.style.color=o,s.appendChild(document.createTextNode(r));var a=t.node(this.domId);t.empty(a),a.appendChild(s)},setProgressMessage:function(e){this._clickToDisMiss=!1,this._init(),this.currentMessage=e;var i=document.createElement("span");i.classList.add("progressIcon");var n=t.node(this.progressDomId);t.empty(n),n.appendChild(i),n.appendChild(document.createTextNode(e));var r=t.node(this.notificationContainerDomId);if(r.classList.remove("notificationHide"),e&&e.length>0)r.classList.add("progressNormal"),r.classList.add("notificationShow");else{if(this._progressMonitors&&this._progressMonitors.length>0)return this._renderOngoingMonitors();r.classList.remove("notificationShow"),r.classList.add("notificationHide")}},setCancelFunction:function(e){this._cancelFunc=e},setProgressResult:function(i,r){this._clickToDisMiss=!1,this._cancelMsg=r,this.currentMessage=i;var o=i.responseText||i;if("string"==typeof o)try{o=JSON.parse(o)}catch(s){}this._init();var a=o.Message||o.toString(),l=e.UnknownError,c="core-sprite-information",d="progressNormal",h=document.createElement("span");h.classList.add("imageSprite"),h.classList.add("progressIcon");var u=[];if(o.Severity)switch(o.Severity){case"Warning":l=e.UnknownWarning,c="core-sprite-warning",d="progressWarning",u.push("progressInfo"),u.push("progressError"),u.push("progressNormal"),this._clickToDisMiss=!0;break;case"Error":c="core-sprite-error",d="progressError",u.push("progressWarning"),u.push("progressInfo"),u.push("progressNormal"),this._clickToDisMiss=!0;break;default:d="progressNormal",u.push("progressWarning"),u.push("progressError"),u.push("progressNormal")}u.push("notificationHide"),h.classList.add(c);var p=t.node(this.progressDomId),f=t.node(this.notificationContainerDomId);if(t.empty(p),p.appendChild(h),a===Object.prototype.toString()&&(a=l),o.HTML){var m=document.createElement("span");m.innerHTML=a,p.appendChild(m)}else{var g,v=n.detectValidURL(a);v?(g=document.createDocumentFragment(),n.processURLSegments(g,v),Array.prototype.forEach.call(t.$$("a",g),function(e){e.target="_blank"})):("Warning"===o.Severity||"Error"===o.Severity||r||(this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(function(){this.setProgressMessage(""),this._timer=null}.bind(this),5e3)),g=document.createTextNode(a)),p.appendChild(g)}if(d&&this.progressDomId!==this.domId){f.classList.add(d);for(var y=0;y<u.length;y++)f.classList.remove(u[y])}f.classList.add("notificationShow");var _=t.node("closeNotifications");_&&(this._cancelMsg?(_.classList.add("cancelButton"),_.classList.remove("dismissButton"),_.classList.remove("core-sprite-close"),_.classList.remove("imageSprite"),_.innerHTML=this._cancelMsg):(_.innerHTML="",_.classList.remove("cancelButton"),_.classList.add("dismissButton"),_.classList.add("core-sprite-close"),_.classList.add("imageSprite")))},showWhile:function(e,t){var i=this;if(t){i.setProgressMessage(t);var n=function(){t===i.currentMessage&&i.setProgressMessage("")};e.then(n,n)}return e},_lastProgressId:0,_progressMonitors:{length:0},createProgressMonitor:function(e,t){return new o(this,++this._lastProgressId,e,t)},_renderOngoingMonitors:function(){if(this._progressMonitors.length>0){var e="",t=!0;for(var i in this._progressMonitors)this._progressMonitors[i].status&&(t||(e+=", "),e+=this._progressMonitors[i].status,t=!1);this.setProgressMessage(e)}else this.setProgressMessage("")},_beginProgressMonitor:function(e){this._progressMonitors[e.progressId]=e,this._progressMonitors.length++,this._renderOngoingMonitors()},_workedProgressMonitor:function(e){this._progressMonitors[e.progressId]=e,this._renderOngoingMonitors()},_doneProgressMonitor:function(e){delete this._progressMonitors[e.progressId],this._progressMonitors.length--,e.status?this.setProgressResult(e.status):this._renderOngoingMonitors()}},r.prototype.constructor=r,o=function(e,t,i,n){if(this.statusService=e,this.progressId=t,i){this.deferred=i,this.begin(n);var r=this;i.then(function(){r.done.bind(r)()},function(){r.done.bind(r)()})}},o.prototype.begin=function(e){this.status=e,this.statusService._beginProgressMonitor(this)},o.prototype.done=function(e){this.status=e,this.statusService._doneProgressMonitor(this)},o.prototype.worked=function(e){this.status=e,this.statusService._workedProgressMonitor(this)},o.prototype.constructor=o,{StatusReportingService:r,ProgressMonitor:o}}),define("orion/operations/nls/root/messages",{More:"More","No Matching OperationService for location:":"No Matching OperationService for location:","No operations services registered.":"No operations services registered.","could not find toolbar ":"could not find toolbar ","Remove Completed":"Remove Completed","Remove all completed operations":"Remove all completed operations",Remove:"Remove","Remove operations from the operations list.":"Remove operations from the operations list.",Cancel:"Cancel","Cancel operations from the operations list.":"Cancel operations from the operations list.","Operation resulted in a warning.":"Operation resulted in a warning.","Operation resulted in an error.":"Operation resulted in an error.","Operation is running.":"Operation is running.","Operation is canceled.":"Operation is canceled.","Operation failed.":"Operation failed.",Name:"Name",Actions:"Actions",Status:"Status",Scheduled:"Scheduled"}),define("orion/operations/nls/messages",["orion/i18n!orion/operations/nls/messages","orion/operations/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/webui/popupdialog",["i18n!orion/widgets/nls/messages","require","orion/webui/littlelib","orion/webui/tooltip"],function(e,t,i,n){function r(){}return r.prototype={_initialize:function(t,r,o,s,a){this._tooltip=new n.Tooltip({node:t,hideDelay:a||0,afterShowing:this._afterShowingFunction(r).bind(this),afterHiding:o,trigger:s?s:"click"}),this.$parent=this._tooltip.contentContainer(),this.$parent.role="dialog";var l=document.createRange();l.selectNode(this.$parent);var c=l.createContextualFragment(this.TEMPLATE);this.messages&&i.processTextNodes(c,e),this.$parent.appendChild(c);var d=this._tooltip;this.$parent.addEventListener("keydown",function(e){e.keyCode===i.KEY.ESCAPE&&d.hide()},!1),this._bindElements(this.$parent),"function"==typeof this._bindToDom&&this._bindToDom(this.$parent)},_bindElements:function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];i.id&&(this["$"+i.id]=i),this._bindElements(i)}},_afterShowingFunction:function(e){return function(){if(e&&e.bind(this)(),!this.customFocus){var t=i.firstTabbable(this.$parent);t&&t.focus()}}},hide:function(){this._tooltip.hide()},show:function(){this._tooltip.show()}},r.prototype.constructor=r,{PopupDialog:r}}),define("orion/operationsCommands",["i18n!orion/operations/nls/messages","require","orion/webui/littlelib","orion/commands"],function(e,t,i,n){var r={};return function(){var t=!1;r.updateNavTools=function(n,r,o,s,a,l){var c=r,d=i.node(s);if(!d)throw e["could not find toolbar "]+s;if(c.destroy(d),c.renderCommands(s,d,l,o,"button"),a){var h=i.node(a);h&&(c.destroy(h),c.renderCommands(a,h,null,o,"button"))}t||(t=!0,n.getService("orion.page.selection").addEventListener("selectionChanged",function(e){var t=i.node(a);t&&(c.destroy(t),c.renderCommands(a,t,e.selections,o,"button"))}))},r.createOperationsCommands=function(t,i,r){function o(e){return e.operation&&e.operation.type?"loadstart"===e.operation.type||"progress"===e.operation.type:!1}function s(e){return e.operation&&e.operation.cancelable?!0:!1}var a=new n.Command({name:e["Remove Completed"],tooltip:e["Remove all completed operations"],id:"eclipse.removeCompletedOperations",callback:function(){r.removeCompletedOperations().then(function(){i.loadOperations.bind(i)()})},visibleWhen:function(){return!0}});t.addCommand(a);var l=new n.Command({name:e.Remove,tooltip:e["Remove operations from the operations list."],imageClass:"core-sprite-delete",id:"eclipse.removeOperation",callback:function(e){for(var t=Array.isArray(e.items)?e.items:[e.items],n=0;n<t.length;n++){var o=t[n];r.removeOperation.bind(r)(o.Location).then(function(){i.loadOperations.bind(i)()},function(){i.loadOperations.bind(i)()})}},visibleWhen:function(e){if(!Array.isArray(e)||0===e.length)return!o(e);for(var t in e)if(o(e[t]))return!1;return!0}});t.addCommand(l);var c=new n.Command({name:e.Cancel,tooltip:e["Cancel operations from the operations list."],imageClass:"core-sprite-stop",id:"eclipse.cancelOperation",callback:function(e){for(var t=Array.isArray(e.items)?e.items:[e.items],i=0;i<t.length;i++){var n=t[i];
n.deferred&&n.deferred.cancel()}},visibleWhen:function(e){if(!Array.isArray(e)||0===e.length)return o(e)&&s(e);for(var t in e)if(!o(e[t])||!s(e[t]))return!1;return!0}});t.addCommand(c)}}(),r}),define("orion/webui/dialogs/OperationsDialog",["i18n!orion/operations/nls/messages","require","orion/webui/littlelib","orion/webui/popupdialog","orion/operationsCommands"],function(e,t,i,n,r){function o(e){this._options=e}return o.prototype=new n.PopupDialog,o.prototype.TEMPLATE='<table style="width: 360px;"><tr><td><h2>Recent operations</h2></td><td style="text-align: right;"><a id="allOperationsLink" class="navlinkonpage">All Operations</a></td></tr></table><div id="operationsExist"><div style="padding-left: 7px" id="myOperationsListEmpty">No operations running on this page.</div><table id="myOperationsList" style="display: none;"></table></div><div style="padding-left: 7px" id="operationsDontExist">No operations running.</div>',o.prototype._init=function(e){this._myOperations=[],this._operationsDeferreds=[],this._commandService=e.commandRegistry,r.createOperationsCommands(this._commandService),this._commandService.registerCommandContribution("operationsDialogItems","eclipse.cancelOperation",1),this._initialize(e.triggerNode)},o.prototype._bindToDom=function(){this.$allOperationsLink.href=t.toUrl("operations/list.html"),this._setOperationsVisibility()},o.prototype.setOperations=function(e,t){if(this._myOperations||this._init(this._options),this._myOperations=[],this._operationsDeferreds=[],e)for(var i in e)this._myOperations.push(e[i]),this._operationsDeferreds.push(t[i]);this._renderOperations()},o.prototype.parseProgressResult=function(e){if(!e)return{};var t=e.responseText||e;try{t=JSON.parse(t)}catch(i){}var n={Message:t.Message||t,Severity:t.Severity};return t.DetailedMessage&&t.DetailedMessage!==n.Message&&(n.DetailedMessage=t.DetailedMessage),n},o.prototype._renderOperations=function(){this._renderOperationsTable(this.$myOperationsList,this._myOperations,this._operationsDeferreds)},o.prototype._renderOperationsTable=function(t,n,r){i.empty(t);for(var o=0;o<n.length;o++){var s=n[o],a=document.createElement("tr"),l=document.createElement("td");l.style.paddingLeft="5px",l.style.paddingRight="5px",l.textContent=s.Name,a.appendChild(l);var c=document.createElement("div");l.appendChild(c);var d=document.createElement("span");switch(d.style.paddingRight="5px",d.classList.add("imageSprite"),s.type){case"Warning":d.classList.add("core-sprite-warning"),d.setAttribute("aria-label",e["Operation resulted in a warning."]);break;case"error":d.classList.add("core-sprite-error"),d.setAttribute("aria-label",e["Operation resulted in an error."]);break;case"loadstart":case"progress":d.classList.add("core-sprite-start"),d.setAttribute("aria-label",e["Operation is running."]);break;case"abort":d.classList.add("core-sprite-stop"),d.setAttribute("aria-label",e["Operation is canceled."]);break;case"load":case"loadend":d.classList.add("core-sprite-ok"),d.setAttribute("aria-label","Operation ok.")}c.appendChild(d);var h=document.createElement("span");if(h.classList.add("operationStatus"),h.textContent=s.Name,c.appendChild(h),s.error){var u=s.error.Message||s.error;s.error.DetailedMessage&&""!==s.error.DetailedMessage&&(u+=": "+s.error.DetailedMessage),h.textContent=u,h.classList.remove("operationStatus"),h.classList.add("operationError")}this._commandService.renderCommands("operationsDialogItems",c,{operation:s,deferred:r[o]},this,"tool"),t.appendChild(a)}this._setOperationsVisibility()},o.prototype._setOperationsVisibility=function(){this.$myOperationsList.style.display=this._myOperations.length>0?"":"none",this.$myOperationsListEmpty.style.display=this._myOperations.length>0?"none":"",this.$operationsDontExist.style.display=this._myOperations.length>0?"none":"",this.$operationsExist.style.display=this._myOperations.length>0?"":"none"},o.prototype.constructor=o,{OperationsDialog:o}}),define("orion/progress",["i18n!orion/nls/messages","require","orion/Deferred","orion/webui/littlelib","orion/webui/dialogs/OperationsDialog"],function(e,t,i,n,r){function o(e,t){if(!this._progressPane){this._progressPane=n.node(e),this._operationsDialog=new r.OperationsDialog({triggerNode:this._progressPane,commandRegistry:t});var i=this;this._progressPane.addEventListener("keydown",function(e){(" "===e.charOrCode||e.keyCode===n.KEY.ENTER)&&i._operationsDialog.show()}),this._progressPane.addEventListener("click",function(){i._operationsDialog.show()}),this._operationsDialog.setOperations(null,null)}}function s(e,t,i,n){this._serviceRegistry=e,this._serviceRegistration=e.registerService("orion.page.progress",this),this._commandRegistry=i,this._operationsClient=t,this._operations={},this._operationDeferrds={},this._operationsIndex=0,this._lastOperation=null,this._lastIconClass=null,this._progressMonitorClass=n}return o.prototype={_switchIconTo:function(e){this._lastIconClass&&this._progressPane.classList.remove(this._lastIconClass),this._lastIconClass=e,this._progressPane.classList.add(this._lastIconClass)},generateOperationsInfo:function(t,i){var n={};for(var r in t)t[r].progressMonitor||(n[r]=t[r]);if(this._isEmpty(n))return this._switchIconTo("progressPane_empty"),this._progressPane.title=e.Operations,this._progressPane.alt=e.Operations,this._progressPane.hasAttribute("aria-valuetext")&&this._progressPane.removeAttribute("aria-valuetext"),void this._operationsDialog.setOperations(n,i);var o="";for(var r in n){var s=n[r];if(s.type&&("loadstart"===s.type||"progress"===s.type)){o="running";break}}switch(""===o&&null!=this._lastOperation&&this._lastOperation.type&&"error"===this._lastOperation.type,o){case"running":this._progressPane.title=e["Operations running"],this._progressPane.alt=e["Operations running"],this._progressPane.setAttribute("aria-valuetext",e["Operations running"]),this._switchIconTo("running");break;case"warning":this._progressPane.title=e["Some operations finished with warning"],this._progressPane.alt=e["Some operations finished with warning"],this._progressPane.setAttribute("aria-valuetext",e["Some operations finished with warning"]),this._switchIconTo("warning");break;case"error":this._progressPane.title=e["Some operations finished with error"],this._progressPane.alt=e["Some operations finished with error"],this._progressPane.setAttribute("aria-valuetext",e["Some operations finished with error"]),this._switchIconTo("error");break;default:this._progressPane.title=e.Operations,this._progressPane.alt=e.Operations,this._progressPane.hasAttribute("aria-valuetext")&&this._progressPane.removeAttribute("aria-valuetext"),this._switchIconTo("progressPane_empty")}this._operationsDialog.setOperations(n,i)},_isEmpty:function(e){for(var t in e)return!1;return!0}},o.prototype.constructor=o,s.prototype={init:function(e){this._progressMonitorClass||(this._progressMonitorTool=new o(e,this._commandRegistry))},progress:function(e,t,i){var n=this,r=this._operationsIndex++;return!i&&this._progressMonitorClass&&(i=new this._progressMonitorClass,i.begin(t)),e.then(function(){if(n._operations[r]){var o=n._operations[r];t&&(o.Name=t),n._lastOperation=o,o.type="loadend",i&&(o.progressMonitor=i),n.writeOperation.bind(n)(r,o,e),o.Location||n._removeOperationFromTheList.bind(n)(r)}},function(o){if(n._operations[r]){var s=n._operations[r];t&&(s.Name=t),i&&(s.progressMonitor=i),n._lastOperation=s,s.type=o.canceled?"abort":"error",s.error=o,n.writeOperation.bind(n)(r,s,e),s.Location||n._removeOperationFromTheList.bind(n)(r)}},function(o){t&&(o.Name=t),i&&(o.progressMonitor=i),n.writeOperation.bind(n)(r,o,e)}),e},removeOperation:function(e){var t=this;for(var i in this._operations)if(this._operations[i].Location&&this._operations[i].Location===e){this._removeOperationFromTheList(i);break}t._operationsClient.removeOperation.bind(t._operationsClient)(e)},_removeOperationFromTheList:function(e){var t=this._operations[e].progressMonitor;delete this._operations[e],delete this._operationDeferrds[e],t?t.done():this._progressMonitorTool.generateOperationsInfo(this._operations,this._operationDeferrds)},removeCompletedOperations:function(){for(var e in this._operations){var t=this._operations[e];if(t.type&&"loadstart"!==t.type&&"progress"!==t.type){var i=this._operations[e].progressMonitor;i&&i.done(),delete this._operations[e],delete this._operationDeferrds[e]}}this._progressMonitorTool.generateOperationsInfo(this._operations,this._operationDeferrds)},setProgressResult:function(e){this._serviceRegistry.getService("orion.page.message").setProgressResult(e)},showWhile:function(e,t,i){t&&this._serviceRegistry.getService("orion.page.message").setProgressMessage(t);var n=this;return e.then(function(){n._serviceRegistry.getService("orion.page.message").setProgressMessage("")},function(e){return i?n._serviceRegistry.getService("orion.page.message").setProgressMessage(""):n.setProgressResult.bind(n)(e),e}),this.progress(e,t)},writeOperation:function(e,t,i){this._operations[e]=t,this._operationDeferrds[e]=i,t.Location&&this._serviceRegistry.getService("orion.core.preference").getPreferences("/operations").then(function(e){e.put(t.Location,{Name:t.Name,expires:t.expires})}),t.progressMonitor?t.progressMonitor.progress(t.Name):this._progressMonitorTool.generateOperationsInfo(this._operations,this._operationDeferrds)}},s.prototype.constructor=s,{ProgressService:s}}),define("orion/operationsClient",["i18n!orion/operations/nls/messages","orion/Deferred"],function(e,t){function i(e,t,i){return e[t].apply(e,i)}function n(e){this._location=e}function r(){var i=new t;return i.reject(e["No Matching OperationService for location:"]+this._location),i}function o(e){this._services=[],this._patterns=[],this._operationListeners=[],this._currentLongpollingIds=[],this._preferenceService=e.getService("orion.core.preference");for(var t=e.getServiceReferences("orion.core.operation"),i=0;i<t.length;i++){var r=t[i],o=e.getService(r);this._services[i]=o;var s=t[i].getProperty("pattern")||".*";"^"!==s[0]&&(s="^"+s),this._patterns[i]=new RegExp(s)}this._getService=function(e){if(!e)return this._services[0];for(var t=0;t<this._patterns.length;++t)if(this._patterns[t].test(e))return this._services[t];return this._operations.remove(e),new n(e)}}return n.prototype={getOperation:r,getOperations:r,removeCompletedOperations:r,removeOperation:r,cancelOperation:r},n.prototype.constructor=n,o.prototype={getOperations:function(){var e=new t;if(this._operations)return e.resolve(this._operations),e;var i=this;return this._preferenceService.getPreferences("/operations").then(function(t){i._operations=t,e.resolve(i._operations)}),e},getOperation:function(e){return i(this._getService(e),"getOperation",arguments)},removeCompletedOperations:function(){for(var e=[],n=this,r=0;r<this._services.length;r++){var o=this._patterns[r],s=new t;e[r]=s.promise,i(this._services[r],"removeCompletedOperations").then(function(e){return function(t){Array.isArray(t)&&n.getOperations.bind(n)().then(function(i){for(var n=i.keys(),r=0;r<n.length;r++){var s=n[r];o.test(s)&&t.indexOf(s)<0&&i.remove(s)}e.resolve()})}}(s),function(e){return function(t){e.reject(t)}}(s))}return t.all(e)},removeOperation:function(e){var t=this;return i(this._getService(e),"removeOperation",arguments).then(function(){t.getOperations.bind(t)().then(function(t){t.remove(e)})},function(e){return e},function(e){return e})}},o.prototype.constructor=o,{OperationsClient:o}}),define("orion/search/nls/root/messages",{"Find:":"Find:","Find With":"Find With","ReplaceWith:":"ReplaceWith:","Replace With":"Replace With","Show all":"Show all","Wrap search":"Wrap search","Incremental search":"Incremental search","Whole Word":"Whole Word","Regular expression":"Regular expression","Find after replace":"Find after replace",Options:"Options","Find next match":"Find next match","Find previous match":"Find previous match",Next:"Next",Previous:"Previous",Replace:"Replace","Replace...":"Replace...","Replace All":"Replace All","Show Replace":"Show Replace","Hide Replace":"Hide Replace","Search ${0}":"Search ${0}","Type a keyword or wild card to search in ":"Type a keyword or wild card to search in ","Search failed.":"Search failed.","No matches found for ${0}":"No matches found for ${0}","Searching...":"Searching...","Resource has been changed by others.":"Resource has been changed by others.","Failed to write file.":"Failed to write file.",Results:"Results","Files ${0} of ${1} matching ${2}":"Files ${0} of ${1} matching ${2}","Replace ${0} with ${1} for files ${2} of ${3}":"Replace ${0} with ${1} for files ${2} of ${3}",Location:"Location","Click to compare":"Click to compare",'Search again in this folder with "${0}"':'Search again in this folder with "${0}"',"Files replaced":"Files replaced",Status:"Status","${0} out of ${1}  matches replaced.":"${0} out of ${1}  matches replaced.","Replace all matches with...":"Replace all matches with...","Apply Changes":"Apply Changes","Replace all selected matches":"Replace all selected matches","Hide Compare":"Hide Compare","Hide compare view of changes":"Hide compare view of changes","Show Compare":"Show Compare","Show compare view of changes":"Show compare view of changes","Show All":"Show All","Show all the results in one page":"Show all the results in one page","< Previous Page":"< Previous Page","Show previous page of search result":"Show previous page of search result","Next Page >":"Next Page >","Show next page of search result":"Show next page of search result","Next result":"Next result","Previous result":"Previous result","Expand all results":"Expand all results","Collapse all results":"Collapse all results","Writing files...":"Writing files...","Preparing preview...":"Preparing preview...","Replaced File (${0})":"Replaced File (${0})","Original File (${0})":"Original File (${0})","Sort by Name":"Sort by Name","Compare changes":"Compare changes","Search Results":"Search Results","Replace All Matches":"Replace All Matches","No matches":"No matches",Rename:"Rename","Save frequently used searches by clicking on the ${0} button above.":"Save frequently used searches by clicking on the ${0} button above.",Search:"Search","All types":"All types","File type":"File type","All ${0} files":"All ${0} files","${0} is already saved":"${0} is already saved","Type a search term":"Type a search term","Type a replace term":"Type a replace term","Case sensitive":"Case sensitive","File name":"File name","Path name":"Path name",Save:"Save","Type filter text":"Type filter text","Scope Search":"Scoped Search","Open in Search page for this directory":"Open the Search page for this folder.","${0}. Try your search again.":"${0}. Try your search again.","Click or use delete key to delete the search term":"Click or use delete key to delete the search term","${0} matches":"${0} matches","Regular expression is off. You can click here or use options to turn it on for replacement - e.g. when the option is on you can replace <td([\\s\\S]*?)</td> with <span$1</span>.":"Regular expression is off. You can click here or use options to turn it on for replacement - e.g. when the option is on you can replace <td([\\s\\S]*?)</td> with <span$1</span>.","Regular expression is on. You can click here or use options to turn it off - e.g. when the option is on you can replace <td([\\s\\S]*?)</td> with <span$1</span>.":"Regular expression is on. You can click here or use options to turn it off - e.g. when the option is on you can replace <td([\\s\\S]*?)</td> with <span$1</span>.",Scope:"Scope","Show previous search terms":"Show previous search terms","Show previous replace terms":"Show previous replace terms","Show replacement preview":"Show replacement preview","File name patterns (comma-separated)":"File name patterns (comma-separated)","(* = any string, ? = any character)":"(* = any string, ? = any character)","Choose a Folder":"Choose a Folder"}),define("orion/search/nls/messages",["orion/i18n!orion/search/nls/messages","orion/search/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/webui/treetable",["i18n!orion/nls/messages","orion/webui/littlelib"],function(e,t){function i(e){this._init(e)}return i.prototype={_init:function(i){var n=i.parent,r=this;if(n=t.node(n),!n)throw e["no parent"];if(!i.model)throw e["no tree model"];if(!i.renderer)throw e["no renderer"];this._parent=n,this._treeModel=i.model,this._onComplete=i.onComplete,this._renderer=i.renderer,this._showRoot=void 0===i.showRoot?!1:i.showRoot,this._indent=void 0===i.indent?16:i.indent,this._onCollapse=i.onCollapse,this._labelColumnIndex=void 0===i.labelColumnIndex?0:i.labelColumnIndex,this._id=void 0===i.id?"treetable":i.id,this._tableStyle=i.tableStyle,this._tableElement=i.tableElement||"table",this._tableBodyElement=i.tableBodyElement||"tbody",this._tableRowElement=i.tableRowElement||"tr",this._treeModel.getRoot(function(e){r._root=e,r._showRoot?(e._depth=0,r._generate([e],0)):r._treeModel.getChildren(e,function(e){r.destroyed||r._generate(e,0)})})},destroy:function(){this.destroyed=!0},_generate:function(e,i){t.empty(this._parent);var n=document.createElement("div");this._renderer.wrapperCallback&&this._renderer.wrapperCallback(n);var r=document.createElement(this._tableElement);this._renderer.tableCallback&&this._renderer.tableCallback(r),r.id=this._id,this._tableStyle&&r.classList.add(this._tableStyle),this._renderer.initTable(r,this),this._bodyElement=document.createElement(this._tableBodyElement),this._renderer.bodyCallback&&this._renderer.bodyCallback(this._bodyElement),this._bodyElement.id=this._id+"tbody",0===e.length?this._renderer.emptyCallback&&this._renderer.emptyCallback(this._bodyElement):this._generateChildren(e,i),r.appendChild(this._bodyElement),n.appendChild(r),this._parent.appendChild(n),this._rowsChanged(),this._onComplete&&this._onComplete(this)},_generateChildren:function(e,t,i){for(var n=0;n<e.length;n++){var r=document.createElement(this._tableRowElement);r.id=this._treeModel.getId(e[n]),r._depth=t,r._item=e[n],this._renderer.render(e[n],r);var o=this._indent*t;r.childNodes[Math.min(r.childNodes.length-1,this._labelColumnIndex)].style.paddingLeft=o+"px",this._renderer.rowCallback&&this._renderer.rowCallback(r,e[n]),i?(this._bodyElement.insertBefore(r,i.nextSibling),i&&(i=r)):this._bodyElement.appendChild(r)}},_rowsChanged:function(){this._renderer.rowsChanged&&this._renderer.rowsChanged()},getSelected:function(){return this._renderer.getSelected()},refresh:function(i,n,r){var o,s=this._treeModel.getId(i);if(s===this._id)this._removeChildRows(s),this._generateChildren(n,0),this._rowsChanged();else if(s===this._treeModel.getId(this._root)&&i.removeAll)this._removeAllRows(),this._generateChildren(n,0),this._rowsChanged();else{var a=t.node(s);a?(a._item=i,a&&(r||a._expanded)?(this._removeChildRows(s),n?(a._expanded=!0,this._renderer.updateExpandVisuals(a,!0),this._generateChildren(n,a._depth+1,a),this._rowsChanged()):(o=this,this._renderer.updateExpandVisuals(a,"progress"),n=this._treeModel.getChildren(a._item,function(e){o.destroyed||(o._renderer.updateExpandVisuals(a,!0),a._expanded||(a._expanded=!0,o._generateChildren(e,a._depth+1,a),o._rowsChanged()))}))):this._renderer.updateExpandVisuals(a,!1)):console.log(e["could not find table row "]+s)}},getItem:function(e){var i=t.node(e);return i&&i._item?i._item:e},toggle:function(e){var i=t.node(e);i&&(i._expanded?this.collapse(e):this.expand(e))},isExpanded:function(e){var i="string"==typeof e?e:this._treeModel.getId(e),n=t.node(i);return n?n._expanded:!1},expand:function(e,i,n){var r="string"==typeof e?e:this._treeModel.getId(e),o=t.node(r);if(o){var s=this;if(o._expanded)return void(i&&i.apply(s,n));this._renderer.updateExpandVisuals(o,"progress"),this._treeModel.getChildren(o._item,function(e){s.destroyed||(s._renderer.updateExpandVisuals(o,!0),o._expanded||(o._expanded=!0,s._generateChildren(e,o._depth+1,o),s._rowsChanged()),i&&i.apply(s,n))})}},_removeChildRows:function(e){for(var i=e===this._id,n=!1,r=-1,o=[],s=t.$$array(".treeTableRow",this._parent),a=0;a<s.length;a++){var l=s[a];if(n)break;i?l._depth>r?o.push(l):n=!0:l.id===e&&(i=!0,r=l._depth)}for(var c=0;c<o.length;c++){var d=o[c];d.parentNode.removeChild(d)}},_removeAllRows:function(){for(var e=t.$$array(".treeTableRow",this._parent),i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i])},collapse:function(e){var i="string"==typeof e?e:this._treeModel.getId(e),n=t.node(i);if(n){if(!n._expanded)return;n._expanded=!1,this._renderer.updateExpandVisuals(n,!1),this._removeChildRows(i),this._rowsChanged()}this._onCollapse&&this._onCollapse(n._item)},getIndent:function(){return this._indent}},i.prototype.constructor=i,{TableTree:i}}),define("orion/treeModelIterator",[],function(){var e={};return e.TreeModelIterator=function(){function e(e,t){this.firstLevelChildren=e,this.reset(),this._init(t)}return e.prototype={_init:function(e){e&&(this.isExpanded=e.isExpanded,this.isExpandable=e.isExpandable,this.forceExpandFunc=e.forceExpandFunc,this.getChildrenFunc=e.getChildrenFunc)},topLevel:function(e){return e.parent?e.parent===this.root:!0},_getChildren:function(e){return"function"==typeof this.getChildrenFunc?this.getChildrenFunc(e):e?e.children:null},_expanded:function(e){if(!e)return!0;var t=this._getChildren(e),i=t&&t.length>0;return this.isExpanded&&i&&(i=this.isExpanded(e)),i},_expandable:function(e){return e?this.isExpandable?this.isExpandable(e):!1:!0},_diveIn:function(e){if(this._expanded(e)){var t=this._getChildren(e);return this.setCursor(t[0]),this.cursor()}return null},_drillToLast:function(e){if(this._expanded(e)){var t=this._getChildren(e);return this._drillToLast(t[t.length-1])}return e},_forward:function(e){if(!this._cursor)return null;var t=this._diveIn(this._cursor);if(!t){if(e&&this._expandable(this._cursor)&&this.forceExpandFunc){var i=this;return this.forceExpandFunc(this._cursor,"first",function(e){e&&i.setCursor(e)})}t=this._findSibling(this._cursor,!0),t&&this.setCursor(t)}return t},_backward:function(e){if(!this._cursor)return null;var t=this._findSibling(this._cursor,!1);if(t&&t!==this._cursor.parent&&(t=this._drillToLast(t)),e&&t&&this._expandable(t)&&this.forceExpandFunc&&t!==this._cursor.parent){var i=this;return this.forceExpandFunc(t,"last",function(e){e&&i.setCursor(e)})}return t&&this.setCursor(t),t},_findSibling:function(e,t){for(var i=this.topLevel(e),n=this._getChildren(e.parent),r=i?this.firstLevelChildren:n,o=0;o<r.length;o++)if(r[o]===e)return 0!==o||t?o===r.length-1&&t?i?null:this._findSibling(e.parent,t):t?r[o+1]:r[o-1]:i?null:e.parent;return null},_inParentChain:function(e,t){for(var i=e.parent;i;){if(i===t)return!0;i=i.parent}return!1},_getTopLevelParent:function(e){if(this.topLevel(e))return e;for(var t=e.parent;t;){if(this.topLevel(t))return t;t=t.parent}return null},_onCollapse:function(e){return this._expanded(e.parent)?e:this._onCollapse(e.parent)},_scan:function(e,t,i){this.setCursor(t);var n=[];for(n.push(t);;){if(!this.iterate(e))break;if(n.push(this.cursor()),i===this.cursor())return n}return n=[],null},setCursor:function(e){this._prevCursor=this._cursor,this._cursor=e},setTree:function(e){this.firstLevelChildren=e,this.firstLevelChildren.length>0&&(this.root=this.firstLevelChildren[0].parent)},scan:function(e,t){var i=this.cursor(),n=this._scan(!0,e,t);return n||(n=this._scan(!1,e,t)),this.setCursor(i),n},iterate:function(e,t){return e?this._forward(t):this._backward(t)},iterateOnTop:function(e,t){var i=this._findSibling(this._getTopLevelParent(this.cursor()),e);i?this.setCursor(i):t&&this.firstLevelChildren.length>0&&this.setCursor(e?this.firstLevelChildren[0]:this.firstLevelChildren[this.firstLevelChildren.length-1])},collapse:function(e){return this._cursor&&this._inParentChain(this._cursor,e)?(this.setCursor(e),this._cursor):null},reset:function(){this._cursor=null,this._prevCursor=null,this.root=null,this.firstLevelChildren.length>0&&(this._cursor=this.firstLevelChildren[0],this.root=this.firstLevelChildren[0].parent)},cursorMoved:function(){return this._cursor!==this._prevCursor},cursor:function(){return this._cursor},prevCursor:function(){return this._prevCursor}},e}(),e}),define("orion/explorers/explorerNavHandler",["orion/webui/littlelib","orion/treeModelIterator","orion/uiUtils"],function(e,t,i){var n={},r=navigator.userAgent,o=-1!==r.indexOf("iPad"),s=-1!==window.navigator.platform.indexOf("Mac");return n.ExplorerNavHandler=function(){function n(n,r,o){this.explorer=n,this.model=this.explorer.model,this._navDict=r,this._listeners=[],this._selections=[],this._currentColumn=0;var s=this._getEventListeningDiv();s.tabIndex=0,s.classList.add("selectionModelContainer");var a=this;this._modelIterator=new t.TreeModelIterator([],{isExpanded:this.isExpanded.bind(this),getChildrenFunc:o.getChildrenFunc,isExpandable:this.explorer.renderer.isExpandable?function(e){return a.explorer.renderer.isExpandable(e)}:function(e){return a.isExpandable(e)},forceExpandFunc:this.explorer.forceExpandFunc?function(e,t,i){return a.explorer.forceExpandFunc(e,t,i)}:void 0}),this._init(o),o&&o.setFocus===!1||s.focus();var l=function(t){return i.isFormElement(t.target)?!0:a.explorer.preventDefaultFunc&&a.explorer.preventDefaultFunc(t,a._modelIterator.cursor())?!0:t.keyCode===e.KEY.DOWN?a.onDownArrow(t):t.keyCode===e.KEY.UP?a.onUpArrow(t):t.keyCode===e.KEY.RIGHT?a.onRightArrow(t):t.keyCode===e.KEY.LEFT?a.onLeftArrow(t):t.keyCode===e.KEY.SPACE?a.onSpace(t):t.keyCode===e.KEY.ENTER?a.onEnter(t):void 0};s.addEventListener("keydown",l,!1),this._listeners.push({type:"keydown",listener:l});var c=function(){a.explorer.onFocus?a.explorer.onFocus(!1):a.toggleCursor(null,!1)};s.addEventListener("blur",c,!1),this._listeners.push({type:"blur",listener:c});var d=function(){a.explorer.onFocus?a.explorer.onFocus(!0):a.toggleCursor(null,!0)};s.addEventListener("focus",d,!1),this._listeners.push({type:"focus",listener:d}),this._parentDiv=s}return n.prototype={destroy:function(){this._parentDiv.classList.remove("selectionModelContainer"),this.removeListeners()},_init:function(e){this._linearGridMove=!1,e&&(this._selectionPolicy=e.selectionPolicy,this.gridClickSelectionPolicy=e.gridClickSelectionPolicy||"none",this.preventDefaultFunc=e.preventDefaultFunc,this.postDefaultFunc=e.postDefaultFunc)},_ctrlKeyOn:function(e){return s?e.metaKey:e.ctrlKey},removeListeners:function(){if(this._listeners)for(var e=0;e<this._listeners.length;e++)this._parentDiv.removeEventListener(this._listeners[e].type,this._listeners[e].listener,!1)},focus:function(){var e=this._getEventListeningDiv();e&&e.focus()},_getEventListeningDiv:function(t){return this.explorer.keyEventListeningDiv&&"function"==typeof this.explorer.keyEventListeningDiv?this.explorer.keyEventListeningDiv(t):e.node(this.explorer._parentId)},isExpandable:function(t){if(!t)return!1;var i=e.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(t)));return i?!0:!1},isExpanded:function(e){return e?this.explorer.myTree.isExpanded(this.model.getId(e)):!1},refreshSelection:function(e,t){var i=this;this.explorer.selection&&this.explorer.selection.getSelections(function(n){i._clearSelection(t);for(var r=0;r<n.length;r++)i._selections.push(n[r]);i._selections.length>0?i.cursorOn(i._selections[0],!0,!1,e):i.cursorOn(null,!1,!1,e),i._shiftSelectionAnchor&&i._inSelection(i._shiftSelectionAnchor)>=0||(i._shiftSelectionAnchor=null)})},refreshModel:function(e,t,i,n){this._currentColumn=0,this.topIterationNodes=[],this.model=t,this._navDict=e,this.model.getTopIterationNodes?this.topIterationNodes=this.model.getTopIterationNodes():i&&(this.topIterationNodes=i),this._modelIterator.setTree(this.topIterationNodes),!n&&this.explorer.selection&&(this.toggleCursor(this._modelIterator.cursor(),!1),this._modelIterator.reset()),this.refreshSelection(!0)},getTopLevelNodes:function(){return this._modelIterator.firstLevelChildren},_inSelection:function(e){for(var t=this.model.getId(e),i=0;i<this._selections.length;i++)if(t===this.model.getId(this._selections[i]))return i;return-1},_clearSelection:function(e){if(e)for(var t=0;t<this._selections.length;t++)this._checkRow(this._selections[t],!0);this._selections=[]},getSelectionPolicy:function(){return this._selectionPolicy},setSelectionPolicy:function(e){this._selectionPolicy!==e&&(("readonlySelection"===this._selectionPolicy||"readonlySelection"===e)&&this._toggleSelectionClass("disabledRow","readonlySelection"===e),this._selectionPolicy=e,"cursorOnly"===this._selectionPolicy&&this._clearSelection(!0))},setSelection:function(e,t,i){if("readonlySelection"!==this._selectionPolicy){if("cursorOnly"===this._selectionPolicy)return void(t&&this.explorer.renderer._useCheckboxSelection&&this._checkRow(e,!0));if(this._isRowSelectable(e)){if(t&&"singleSelection"!==this._selectionPolicy){var n=this._inSelection(e);n>=0?(this._checkRow(e,!0),this._selections.splice(n,1)):(this._checkRow(e,!1),this._selections.push(e),this._lastSelection=e)}else this._clearSelection(!0),this._checkRow(e,!1),this._selections.push(e),this._lastSelection=e;i&&(this._shiftSelectionAnchor=this._lastSelection),this.explorer.selection&&(this.explorer.renderer.storeSelections(),this.explorer.selection.setSelections(this._selections))}}},moveColumn:function(e,t){e||(e=this.currentModel());var i=this._getGridChildren(e);if(i&&i.length>1||0===t&&i){0!==t&&this.toggleCursor(e,!1);var n=this._currentColumn,r=!0;return n+=t,0>n?(this._linearGridMove&&0!==t&&(this._modelIterator.iterate(!1)?e=this.currentModel():r=!1),n=r?i.length-1:this._currentColumn):n>=i.length&&(this._linearGridMove&&0!==t&&(this._modelIterator.iterate(!0)?e=this.currentModel():r=!1),n=r?0:this._currentColumn),this._currentColumn=n,0!==t&&this.toggleCursor(e,!0),!0}return!1},_getGridChildren:function(e){return this._navDict?this._navDict.getGridNavHolder(e):null},getCurrentGrid:function(e){e||(e=this.currentModel());var t=this._getGridChildren(e);return t&&t.length>0?t[this._currentColumn]:null},getAriaContainerElement:function(e){for(var t,i=this._parentDiv;e&&e!==i&&"grid"!==(t=e.getAttribute("role"))&&"tree"!==t&&"treegrid"!==t;)e=e.parentNode;return e===i?null:e},toggleCursor:function(e,t){var i=this.getRowDiv(e),n=this.getCurrentGrid(e);if(n){if(i&&(t?i.classList.add("treeIterationCursorRow"):i.classList.remove("treeIterationCursorRow")),n.domNode){var r=this.getAriaContainerElement(n.domNode);if(t){if(n.domNode.classList.add("treeIterationCursor"),r){var o=n.domNode.id;r.setAttribute("aria-activedescendant",o)}}else n.domNode.classList.remove("treeIterationCursor")}}else i&&(t?i.classList.add("treeIterationCursorRow_Dotted"):i.classList.remove("treeIterationCursorRow_Dotted"))},currentModel:function(){return this._modelIterator.cursor()},cursorOn:function(e,t,i,n){var r,o;if(e||t){if(o===this._modelIterator.cursor())return;r=this._modelIterator.cursor(),o=e,this._modelIterator.setCursor(o)}else r=this._modelIterator.prevCursor(),o=this._modelIterator.cursor();if((r!==o||t)&&(this.toggleCursor(r,!1),!t||o)){this.moveColumn(null,0),this.toggleCursor(o,!0);var s=this.getRowDiv();if(s&&!n){for(var a=s.parentNode,l=document.documentElement;a&&a!==l;){var c=window.getComputedStyle(a,null);if(!c)break;var d=c.getPropertyValue("overflow-y");if("auto"===d||"scroll"===d)break;a=a.parentNode}if(a){var h=!0;s.offsetTop<=a.scrollTop?(h=!1,void 0===i&&(i=!1)):s.offsetTop+s.offsetHeight>=a.scrollTop+a.clientHeight&&(h=!1,void 0===i&&(i=!0)),h||s.scrollIntoView(!i)}}this.explorer.onCursorChanged&&this.explorer.onCursorChanged(r,o)}},getSelection:function(){return this._selections},getSelectionIds:function(){for(var e=[],t=0;t<this._selections.length;t++)e.push(this.model.getId(this._selections[t]));return e},getRowDiv:function(t){var i=t?t:this._modelIterator.cursor();if(!i)return null;var n=this.model.getId(i),r=this._navDict.getValue(n);return r&&r.rowDomNode?r.rowDomNode:e.node(n)},iterate:function(e,t,i,n){var r=null;if(this.topIterationNodes&&0!==this.topIterationNodes.length)if(n){var o=this.currentModel();
for(r=this._modelIterator.iterate(e,t),r&&this._setCursorOnItem(e,i);r&&r.isNotSelectable;)r=this._modelIterator.iterate(e,t),r&&this._setCursorOnItem(e,i);r||(this.cursorOn(o,!0,!1,!0),this._setCursorOnItem(e,i))}else r=this._modelIterator.iterate(e,t),r&&this._setCursorOnItem(e,i)},_toggleSelectionClass:function(e,t){this._selections.forEach(function(i){var n=this.getRowDiv(i);n&&(t?n.classList.add(e):n.classList.remove(e))}.bind(this))},_setCursorOnItem:function(e,t){if(this.cursorOn(null,!1,e),t){var i=this._inSelection(this._modelIterator.prevCursor()),n=this._inSelection(this._modelIterator.cursor());i>=0&&n>=0?this.setSelection(this._modelIterator.prevCursor(),!0):this.setSelection(this.currentModel(),!0)}},_checkRow:function(t,i){if(this.explorer.renderer._useCheckboxSelection&&"singleSelection"!==this._selectionPolicy){var n=this.getRowDiv(t);if(!n)return;var r=e.node(this.explorer.renderer.getCheckBoxId(n.id)),o=i?!r.checked:!0;o!==r.checked&&this.explorer.renderer.onCheck(n,r,o,!0)}else this._select(t,i)},_select:function(e){e||(e=this._modelIterator.cursor());var t=this.getRowDiv(e);t&&(this._inSelection(e)<0?t.classList.add("checkedRow"):t.classList.remove("checkedRow"))},_onModelGrid:function(e,t){var i=this._getGridChildren(e);if(i)for(var n=0;n<i.length;n++)if(t.target===i[n].domNode)return!0;return!1},onClick:function(t,i){if("readonlySelection"===this._selectionPolicy||this.isDisabled(this.getRowDiv(t)))e.stop(i);else{var n=e.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(t)));if(i.target===n)return;if("none"===this.gridClickSelectionPolicy&&this._onModelGrid(t,i))return;if(this.cursorOn(t,!0,!1,!0),o)this.setSelection(t,!0);else if(this._ctrlKeyOn(i))this.setSelection(t,!0,!0);else if(i.shiftKey&&this._shiftSelectionAnchor){var r=this._modelIterator.scan(this._shiftSelectionAnchor,t);if(r){this._clearSelection(!0);for(var s=0;s<r.length;s++)this.setSelection(r[s],!0)}}else this.setSelection(t,!1,!0)}},onCollapse:function(e){this._modelIterator.collapse(e)&&this.cursorOn()},onUpArrow:function(e){return this.iterate(!1,!1,e.shiftKey,!0),this._ctrlKeyOn(e)||e.shiftKey||this.setSelection(this.currentModel(),!1,!0),e.preventDefault(),!1},onDownArrow:function(e){return this.iterate(!0,!1,e.shiftKey,!0),this._ctrlKeyOn(e)||e.shiftKey||this.setSelection(this.currentModel(),!1,!0),e.preventDefault(),!1},_shouldMoveColumn:function(e){var t=this.currentModel(),i=this._getGridChildren(t);return i&&i.length>1?this.isExpandable(t)?this._ctrlKeyOn(e):!0:!1},onLeftArrow:function(e){if(this._shouldMoveColumn(e))return this.moveColumn(null,-1),e.preventDefault(),!0;var t=this._modelIterator.cursor();return t?this.isExpandable(t)&&this.isExpanded(t)?(this.explorer.myTree.collapse(t),e.preventDefault(),!0):void(this._modelIterator.topLevel(t)?this.explorer.scopeUp&&"function"==typeof this.explorer.scopeUp&&this.explorer.scopeUp():(this.cursorOn(t.parent),this.setSelection(t.parent,!1,!0))):!1},onRightArrow:function(e){if(this._shouldMoveColumn(e))return this.moveColumn(null,1),e.preventDefault(),!0;var t=this._modelIterator.cursor();return t?this.isExpandable(t)&&!this.isExpanded(t)?(this.explorer.myTree.expand(t),this.explorer.postUserExpand&&this.explorer.postUserExpand(this.model.getId(t)),e.preventDefault(),!1):void 0:!1},_isRowSelectable:function(e){return this.explorer.isRowSelectable?this.explorer.isRowSelectable(e):!0},onSpace:function(e){this.setSelection(this.currentModel(),!0,!0),e.preventDefault()},onEnter:function(e){var t=this.getCurrentGrid(this._modelIterator.cursor());if(t)if(t.widget)"function"==typeof t.onClick?t.onClick():"function"==typeof t.widget.focus&&t.widget.focus();else{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,this._ctrlKeyOn(e),!1,!1,!1,0,null),t.domNode.dispatchEvent(i)}else{var n=this._modelIterator.cursor();if(n){if(this.explorer.renderer.getRowActionElement){var r=this.explorer.renderer.getRowActionElement(this.model.getId(n));r.href&&(this._ctrlKeyOn(e)?window.open(r.href):window.location.href=r.href)}return this.explorer.renderer.performRowAction?(this.explorer.renderer.performRowAction(e,n),e.preventDefault(),!1):void 0}}},setIsNotSelectable:function(e,t){e.isNotSelectable=t},disableItem:function(e){var t=this.getRowDiv(e);this.isExpandable(e)&&this.isExpanded(e)&&(this._modelIterator.collapse(e),this.explorer.myTree.toggle(t.id)),t.classList.remove("checkedRow"),t.classList.add("disabledNavRow"),this.setIsNotSelectable(e,!0)},isDisabled:function(e){return e.classList.contains("disabledNavRow")},enableItem:function(e){var t=this.getRowDiv(e);t&&(t.classList.remove("disabledNavRow"),this.setIsNotSelectable(e,!1))}},n}(),n.ExplorerNavDict=function(){function e(e){this._dict={},this._model=e}return e.prototype={addRow:function(e,t){var i=this._model.getId(e);this._dict[i]={model:e,rowDomNode:t}},getValue:function(e){return this._dict[e]},getGridNavHolder:function(e,t){if(!e)return null;var i=this._model.getId(e);return this._dict[i]?(!this._dict[i].gridChildren&&t&&(this._dict[i].gridChildren=[]),this._dict[i].gridChildren):null},initGridNavHolder:function(e){if(!e)return null;var t=this._model.getId(e);this._dict[t]&&(this._dict[t].gridChildren=null)}},e}(),n}),define("orion/explorers/explorer",["i18n!orion/nls/messages","require","orion/webui/littlelib","orion/webui/treetable","orion/explorers/explorerNavHandler","orion/commands"],function(e,t,i,n,r,o){var s={};return s.Explorer=function(){function e(e,t,i,n){this.registry=e,this.renderer=i,this.selection=t,this.commandService=n,this.renderer&&(this.renderer.explorer=this),this.myTree=null}return e.prototype={destroy:function(){this._navHandler&&this._navHandler.destroy(),this.model&&this.model.destroy(),this.myTree&&this.myTree.destroy(),this.destroyed=!0},changedItem:function(e,t){this.myTree&&this.myTree.refresh.bind(this.myTree)(e,t,!0)},updateCommands:function(e){this.myTree&&this.myTree._renderer.updateCommands.bind(this.myTree._renderer)(e)},makeNewItemPlaceholder:function(e,t,i){var n=null,r=this.getRow(e);if(r){var o=r.parentNode,s=document.createElement("tr");s.id=t+"placeHolderRow",s.classList.add("navRow");var a=document.createElement("td");if(a.id=t+"placeHolderCol",a.classList.add("navColumn"),s.appendChild(a),i){var l=r.nextSibling;o.insertBefore(s,l)}else o.insertBefore(s,r);a.style.paddingLeft=r.firstChild.style.paddingLeft,n={wrapperNode:s,refNode:a,destroyFunction:function(){try{s&&s.parentNode&&s.parentNode.removeChild(s)}catch(e){}}}}return n},getRow:function(e){var t=this.model.getId(e);return t?i.node(t):void 0},collapseAll:function(){for(var e=this._navHandler.getTopLevelNodes(),t=0;t<e.length;t++)this.myTree.collapse(e[t])},expandAll:function(e){if(e)this._expandRecursively(e);else{if(!this._navHandler)return;for(var t=this._navHandler.getTopLevelNodes(),i=0;i<t.length;i++)this._expandRecursively(t[i])}},_expandRecursively:function(e){if(this._navHandler&&this._navHandler.isExpandable(e)){var t=this;this.myTree.expand(e,function(){t.model.getChildren(e,function(e){if(void 0!==e&&null!==e)for(var i=e.length,n=0;i>n;n++)t._expandRecursively(e[n])})})}},createTree:function(e,t,o){e="string"==typeof e?e:e.id||e,this.selection&&this.selection.setSelections([]),this.getNavHandler()&&this.getNavHandler()._clearSelection();var s=e+"innerTree",a=i.node(s);a&&i.empty(a),t&&(t.rootId=s),this.model=t,this._parentId=e,this._treeOptions=o;var l=!o||o&&!o.noSelection;l&&(this.selectionPolicy=o?o.selectionPolicy:"",this._navDict=new r.ExplorerNavDict(this.model)),this.myTree=new n.TableTree({id:s,model:t,parent:e,onComplete:o?o.onComplete:void 0,labelColumnIndex:this.renderer.getLabelColumnIndex(),renderer:this.renderer,showRoot:o?!!o.showRoot:!1,indent:o?o.indent:void 0,onCollapse:o?o.onCollapse:void 0,navHandlerFactory:o?o.navHandlerFactory:void 0,tableElement:o?o.tableElement:void 0,tableBodyElement:o?o.tableBodyElement:void 0,tableRowElement:o?o.tableRowElement:void 0}),this.renderer._initializeUIState(),"cursorOnly"===this.selectionPolicy&&this.initNavHandler()},getNavHandler:function(){return this._navHandler},getNavDict:function(){return this._navDict},refreshSelection:function(){if(this.selection){var e=this.getNavHandler(),t=[];if(e&&this.getNavDict())for(var i=e.getSelection(),n=0;n<i.length;n++){var r=e.getRowDiv(i[n]);if(r&&r.parentNode){var o=this.getNavDict().getValue(this.model.getId(i[n]));o.model&&t.push(o.model)}}this.selection.setSelections(t)}},getRootPath:function(){return this.model&&this.model.root?this.model.root.Location:null},initNavHandler:function(){var e=this._treeOptions,t=!e||e&&!e.noSelection;if(t){if(!this.getNavHandler())if(e&&e.navHandlerFactory&&"function"==typeof e.navHandlerFactory.createNavHandler)this._navHandler=e.navHandlerFactory.createNavHandler(this,this._navDict,e);else{var i=e?e.getChildrenFunc:null;this._navHandler=new r.ExplorerNavHandler(this,this._navDict,{getChildrenFunc:i,setFocus:e&&e.setFocus,selectionPolicy:e?e.selectionPolicy:null})}var n=this;this.model.getRoot(function(t){t instanceof Array?n.getNavHandler().refreshModel(n.getNavDict(),n.model,t):t.children&&t.children instanceof Array&&n.getNavHandler().refreshModel(n.getNavDict(),n.model,t.children),e&&e.setFocus&&n.getNavHandler().cursorOn(null,!1,!1,!0)})}},_lastHash:null,checkbox:!1},e}(),s.createExplorerCommands=function(t,i){function n(e){return"function"==typeof e.getItemCount&&e.getItemCount()>0?i?i(e):!0:!1}var r=new o.Command({tooltip:e["Expand all"],imageClass:"core-sprite-expandAll",id:"orion.explorer.expandAll",groupId:"orion.explorerGroup",visibleWhen:function(e){return n(e)},callback:function(e){e.items.expandAll()}}),s=new o.Command({tooltip:e["Collapse all"],imageClass:"core-sprite-collapseAll",id:"orion.explorer.collapseAll",groupId:"orion.explorerGroup",visibleWhen:function(e){return n(e)},callback:function(e){e.items.collapseAll()}});t.addCommand(r),t.addCommand(s)},s.ExplorerModel=function(){function e(e,t,i){this.rootPath=e,this.fetchItems=t,this.idPrefix=i||""}return e.prototype={destroy:function(){this.destroyed=!0},getRoot:function(e){var t=this;this.fetchItems(this.rootPath).then(function(i){t.root=i,e(i)})},getChildren:function(e,t){e.Children?t(e.Children):e.ChildrenLocation?this.fetchItems(e.ChildrenLocation).then(function(i){e.Children=i,t(i)}):t([])},getId:function(e){if(e.Location===this.root.Location)return this.rootId;for(var t=e.Location.replace(/[\\\/]/g,""),i=this.idPrefix,n=0;n<t.length;n++)i+=t[n].match(/[^\.\:\-\_0-9A-Za-z]/g)?t.charCodeAt(n):t[n];return i}},e}(),s.ExplorerFlatModel=function(){function e(e,t,i){this.rootPath=e,this.fetchItems=t,this.root=i}return e.prototype=new s.ExplorerModel,e.prototype.getRoot=function(e){if(this.root)e(this.root);else{var t=this;this.fetchItems(this.rootPath).then(function(i){t.root=i,e(i)})}},e.prototype.getChildren=function(e,t){t(e===this.root?this.root:[])},e}(),s.ExplorerRenderer=function(){function e(e,t){this.explorer=t,this._init(e),this._expandImageClass="core-sprite-openarrow",this._collapseImageClass="core-sprite-closedarrow",this._progressImageClass="core-sprite-progress",this._twistieSpriteClass="modelDecorationSprite"}return e.prototype={_init:function(e){e&&(this._useCheckboxSelection=void 0===e.checkbox?!1:e.checkbox,this.selectionPolicy=e.singleSelection?"singleSelection":"",this._cachePrefix=e.cachePrefix,e.getCheckedFunc&&(this.getCheckedFunc=e.getCheckedFunc),e.onCheckedFunc&&(this.onCheckedFunc=e.onCheckedFunc),this._noRowHighlighting=e.noRowHighlighting,this._highlightSelection=!0,this._treeTableClass=e.treeTableClass||"treetable",e.highlightSelection===!1&&(this._highlightSelection=!1),this.actionScopeId||(this.actionScopeId=e.actionScopeId),this.commandService||(this.commandService=e.commandService))},getLabelColumnIndex:function(){return this.explorer.checkbox?1:0},initTable:function(e,t){this.tableTree=t,this.tableNode=e,i.empty(e),this._treeTableClass&&e.classList.add(this._treeTableClass),this.renderTableHeader(e)},getActionsColumn:function(e,t,i,n,r){i=i||"tool";var o=document.createElement("td");return o.id=t.id+"actionswrapper",n&&o.classList.add(n),this.actionScopeId&&this.commandService?this.commandService.renderCommands(this.actionScopeId,o,e,this.explorer,i,null,r&&this.explorer.getNavDict()?this.explorer.getNavDict().getGridNavHolder(e,!0):null):window.console.log("Warning, no command service or action scope was specified.  No commands rendered."),o},initCheckboxColumn:function(){if(this._useCheckboxSelection){var e=document.createElement("th");return e}},getCheckboxColumn:function(e,t){if(this._useCheckboxSelection){var i=document.createElement("td"),n=document.createElement("span");n.id=this.getCheckBoxId(t.id),n.classList.add("core-sprite-check"),n.classList.add("selectionCheckmarkSprite"),n.rowId=t.id,this.getCheckedFunc&&(n.checked=this.getCheckedFunc(e),n.checked?(this._highlightSelection&&t.classList.add("checkedRow"),n.classList.add("core-sprite-check_on")):(this._highlightSelection&&t.classList.remove("checkedRow"),n.classList.remove("core-sprite-check_on"))),i.appendChild(n);var r=this;return n.addEventListener("click",function(i){var n=i.target.checked?!1:!0;r.onCheck(t,i.target,n,!0,!1,e)},!1),i}},getCheckBoxId:function(e){return e+"selectedState"},onCheck:function(e,t,i,n,r,o){t.checked=i,i?t.classList.add("core-sprite-check_on"):t.classList.remove("core-sprite-check_on"),this.onCheckedFunc&&this.onCheckedFunc(t.rowId,i,n,o),this.explorer.getNavHandler()&&r&&this.explorer.getNavHandler().setSelection(this.explorer.getNavDict().getValue(e.id).model,!0)},storeSelections:function(){if(this.explorer.getNavHandler()){var e=this.explorer.getNavHandler().getSelectionIds(),t=this._getUIStatePreferencePath();t&&window.sessionStorage&&(window.sessionStorage[t+"selection"]=JSON.stringify(e))}},_restoreSelections:function(e){var t=this.explorer.getNavDict(),n=this.explorer.getNavHandler();if(n&&t&&"cursorOnly"!==n.getSelectionPolicy()){var r=window.sessionStorage[e+"selection"];"string"==typeof r&&(r=r.length>0?JSON.parse(r):null);var o;if(r){var s=[];for(o=0;o<r.length;o++){var a=t.getValue(r[o]);if(a&&a.rowDomNode&&a.model){s.push(a.model),this._highlightSelection&&a.rowDomNode.classList.add("checkedRow");var l=i.node(this.getCheckBoxId(a.rowDomNode.id));l&&(l.checked=!0,l.classList.add("core-sprite-check_on"))}}this.explorer.selection&&(this.explorer.selection.setSelections(s),this.explorer.getNavHandler()&&this.explorer.getNavHandler().refreshSelection())}}},_storeExpansions:function(e){window.sessionStorage[e+"expanded"]=JSON.stringify(this._expanded)},_restoreExpansions:function(e){var t=!1,n=window.sessionStorage[e+"expanded"];"string"==typeof n&&(n=n.length>0?JSON.parse(n):null);var r;if(n)for(r=0;r<n.length;r++){var o=i.node(n[r]);if(o){this._expanded.push(n[r]);var s=this;this.tableTree.expand(n[r],function(){s._restoreSelections(e)}),t=!0}}return!t},_getUIStatePreferencePath:function(){if(this.explorer){var e=this.explorer.getRootPath();if(this._cachePrefix&&e){var t=e.replace(/[^\.\:\-\_0-9A-Za-z]/g,"");return"/"+this._cachePrefix+"/"+t+"/uiState"}}return null},expandCollapseImageId:function(e){return e+"__expand"},updateExpandVisuals:function(e,t){var n=i.node(this.expandCollapseImageId(e.id));n&&(n.classList.remove(this._expandImageClass),n.classList.remove(this._collapseImageClass),n.classList.remove(this._progressImageClass),n.classList.add("progress"===t?this._progressImageClass:t?this._expandImageClass:this._collapseImageClass))},getExpandImage:function(e,t,i,n){var r=document.createElement("span");if(r.id=this.expandCollapseImageId(e.id),t.appendChild(r),r.classList.add(this._twistieSpriteClass),r.classList.add(this._collapseImageClass),i){var o=document.createElement("span");t.appendChild(o),o.classList.add(n||"imageSprite"),o.classList.add(i)}var s=this;return r.onclick=function(){if(!s.explorer.getNavHandler().isDisabled(e)){s.tableTree.toggle(e.id);var t=s.tableTree.isExpanded(e.id);if(t)s._expanded.push(e.id),s.explorer.postUserExpand&&s.explorer.postUserExpand(e.id);else for(var i in s._expanded)if(s._expanded[i]===e.id){s._expanded.splice(i,1);break}var n=s._getUIStatePreferencePath();n&&window.sessionStorage&&s._storeExpansions(n)}},r},render:function(e,t){t.classList.add("navRow"),this.renderRow(e,t)},rowsChanged:function(){if("cursorOnly"!==this.explorer.selectionPolicy&&(this.explorer.refreshSelection(),this.explorer.initNavHandler()),!this._noRowHighlighting){var e="darkSectionTreeTableRow",t="lightSectionTreeTableRow";(i.$(".sectionTreeTable",this.tableNode.parentNode)||i.$(".treetable",this.tableNode.parentNode))&&i.$$array(".treeTableRow",this.tableNode).forEach(function(i,n){var r=n%2?e:t,o=r===t?e:t;i.classList.add(r),i.classList.remove(o)})}},updateCommands:function(){if(this.commandService)for(var e=i.$$array(".treeTableRow"),t=0;t<e.length;t++){var n=e[t],r=n.id+"actionswrapper",o=i.node(r);this.commandService.destroy(o),this.actionScopeId&&this.commandService.renderCommands(this.actionScopeId,o,n._item,this.explorer,"tool")}},_initializeUIState:function(){this._expanded=[];var e=this._getUIStatePreferencePath();e&&window.sessionStorage&&this._restoreExpansions(e)&&this._restoreSelections(e)}},e}(),s.SelectionRenderer=function(){function e(e,t){this._init(e),this.explorer=t}return e.prototype=new s.ExplorerRenderer,e.prototype.renderTableHeader=function(e){var t=document.createElement("thead"),i=document.createElement("tr");t.classList.add("navTableHeading"),this._useCheckboxSelection&&i.appendChild(this.initCheckboxColumn(e));for(var n=0,r=this.getCellHeaderElement(n);r;)r.innerHTML.length>0&&r.classList.add("navColumn"),i.appendChild(r),r=this.getCellHeaderElement(++n);t.appendChild(i),n>0&&e.appendChild(t)},e.prototype.renderRow=function(e,t){if(t.verticalAlign="baseline",t.classList.add("treeTableRow"),void 0===e.selectable||e.selectable){var i=this.explorer.getNavDict();if(i){"cursorOnly"!==this.explorer.selectionPolicy&&t.classList.add("selectableNavRow"),i.addRow(e,t);var n=this;t.addEventListener("click",function(t){n.explorer.getNavHandler()&&n.explorer.getNavHandler().onClick(e,t)},!1)}var r=this.getCheckboxColumn(e,t);r&&(r.classList.add("checkColumn"),t.appendChild(r))}for(var o=0,s=this.getCellElement(o,e,t);s;)t.appendChild(s),s.classList.add(0===o?this.getPrimColumnStyle?this.getPrimColumnStyle(e):"navColumn":this.getSecondaryColumnStyle?this.getSecondaryColumnStyle():"secondaryColumn"),s=this.getCellElement(++o,e,t)},e.prototype.getCellHeaderElement=function(){},e.prototype.getCellElement=function(){},e}(),s.SimpleFlatModel=function(){function e(e,t,i){this.items=e,this.getKey=i,this.idPrefix=t,this.root={children:e}}return e.prototype=new s.ExplorerModel,e.prototype.getRoot=function(e){e(this.root)},e.prototype.getId=function(e){for(var t=this.getKey(e),i=t.replace(/[\\\/]/g,""),n="",r=0;r<i.length;r++)n+=i[r].match(/[^\.\:\-\_0-9A-Za-z]/g)?i.charCodeAt(r):i[r];return this.idPrefix+n},e.prototype.getChildren=function(e,t){t(e===this.root?this.items:[])},e}(),s}),define("orion/widgets/browse/commitInfoRenderer",["orion/objects","orion/URITemplate","orion/webui/littlelib","orion/xhr","orion/URL-shim"],function(e,t,i,n){function r(e){var t=new Date,i=new Date(e),n=t.getTime()-i.getTime(),r=Math.floor(n/1e3/60/60/24/365);n-=1e3*r*60*60*24*365;var o=Math.floor(n/1e3/60/60/24/30);n-=1e3*o*60*60*24*30;var s=Math.floor(n/1e3/60/60/24);n-=1e3*s*60*60*24;var a=Math.floor(n/1e3/60/60);n-=1e3*a*60*60;var l=Math.floor(n/1e3/60);n-=1e3*l*60;var c=Math.floor(n/1e3);return{year:r,month:o,day:s,hour:a,minute:l,second:c}}function o(e,t,i){return e>0?1===e?t+" ":e+" "+i+" ":""}function s(e){var t=r(e),i=o(t.year,"a year","years"),n=o(t.month,"a month","months"),s=o(t.day,"a day","days"),a=o(t.hour,"an hour","hours"),l=o(t.minute,"a minute","minutes"),c="";return i?c=t.year>0?i:i+n:n?c=t.month>0?n:n+s:s?c=t.day>0?s:s+a:a?c=t.hour>0?a:a+l:l&&(c=l),c?c+"ago":"Just now"}function a(e){this._parentDomNode=i.node(e.parent),this._commitInfo=e.commitInfo}return e.mixin(a.prototype,{destroy:function(){},_simpleMessage:function(e){var t=this._commitInfo.Message?this._commitInfo.Message:"";if(t){var i=t.replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n");i&&i.length>0&&(t=i[0]),e>10&&t.length>e&&(t=t.substring(0,e-3)+"...")}return t},_generateMessageNode:function(e){var i;if(this._commitInfo.URL||this._commitInfo.SHA1){if(i=document.createElement("a"),this._commitInfo.SHA1){var n=new URL("commit",window.location.href).href;n=decodeURIComponent(n),i.href=new t(n+"{/SHA1}").expand(this._commitInfo)}else i.href=this._commitInfo.URL;i.classList.add("commitInfolink"),i.appendChild(document.createTextNode(e))}else i=document.createElement("span"),i.appendChild(document.createTextNode(e));return i},_requestPhotoURL:function(e,t){var i=this,r="/manage/service/com.ibm.team.jazzhub.common.service.IPhotoService/getContributorPhotoURI",o=new URL(r,window.location.href);o.query.set("contributorUserId",e);var s=o.href;n("GET",s,{timeout:15e3}).then(function(e){var i=JSON.parse(e.response);t.src=i.photoURI},function(){i._useOtherPhotoURL(t)})},_useOtherPhotoURL:function(e){e.src=this._commitInfo.AvatarURL?this._commitInfo.AvatarURL:"https://www.gravatar.com/avatar/?d=mm"},renderSimple:function(e){this._parentDomNode.appendChild(this._generateMessageNode(this._simpleMessage(e)))},render:function(e,t){var n=this._commitInfo.Author&&this._commitInfo.Author.Date?s(this._commitInfo.Author.Date):"",r=this._simpleMessage(-1),o=this._commitInfo.Author&&this._commitInfo.Author.Name?this._commitInfo.Author.Name:"",a=e;if(a||(a="Commit"),a="Last "+a,t){var l=document.createElement("div"),c=new Image;this._commitInfo.Author&&this._commitInfo.Author.UserId?this._requestPhotoURL(this._commitInfo.Author.UserId,c):this._useOtherPhotoURL(c),c.classList.add("commitInfoAvatar"),l.appendChild(c),this._parentDomNode.appendChild(l)}else{var d=document.createElement("div");d.classList.add("commitInfoLabelContainer"),d.appendChild(document.createTextNode(a.toUpperCase())),this._parentDomNode.appendChild(d)}var h=document.createElement("div");h.classList.add("commitInfoMessageContainer");var u=document.createElement("div");u.classList.add("commitInfoAutorContainer");var p=document.createDocumentFragment(),f=document.createElement("span");f.appendChild(document.createTextNode(o)),f.classList.add("navColumnBold");var m;if(t){var g=document.createElement("span");g.appendChild(document.createTextNode(a)),g.classList.add("navColumnBold"),p.textContent=n?"${0} by ${1} "+n+".":"${0} by ${1}.",m=[g,f]}else p.textContent=n?"by ${0} "+n+".":"by ${0}.",m=[f];i.processDOMNodes(p,m),u.appendChild(p),h.appendChild(u);var v=document.createElement("div");v.classList.add("commitInfoMessageTextContainer"),v.appendChild(this._generateMessageNode(r)),h.appendChild(v),this._parentDomNode.appendChild(h)}}),{CommitInfoRenderer:a,calculateTime:s}}),define("orion/explorers/navigatorRenderer",["i18n!orion/navigate/nls/messages","orion/Deferred","orion/explorers/explorer","orion/explorers/navigationUtils","orion/extensionCommands","orion/objects","orion/URITemplate","orion/widgets/browse/commitInfoRenderer","orion/webui/littlelib"],function(e,t,i,n,r,o,s,a,l){function c(e){switch(e&&e.id){case"image/jpeg":case"image/png":case"image/gif":case"image/ico":case"image/tiff":case"image/svg":return!0}return!1}function d(e,t,i,n){if(e){var r,o=e.imageClass,s=e.image;o?(r=document.createElement("span"),r.className+=o,r.classList.add("thumbnail")):s&&(r=document.createElement("img"),r.src=s,r.classList.add("thumbnail")),r&&t.replaceChild(r,n)}}function h(){return f}function u(e,i,n,a,l,h,u,p,m){i=o.clone(i);var v;if(i.Directory){v=document.createElement("a"),v.className="navlinkonpage";var y=e?new s(e+"#{,resource,params*}"):g;v.href=y.expand({resource:i.ChildrenLocation}),i.Name&&v.appendChild(document.createTextNode(i.Name))}else{l||(l=r.getOpenWithCommands(n)),v=document.createElement("a"),v.className="navlink targetSelector",h&&"object"==typeof h&&Object.keys(h).forEach(function(e){v[e]=h[e]});var _=null,w=null;_=p?p.holderDom:v,_&&(w=document.createElement("span"),w.className="core-sprite-file modelDecorationSprite thumbnail",_.appendChild(w)),i.Name&&v.appendChild(document.createTextNode(i.Name));var C=i.Location;u&&"object"==typeof u&&(i.params={},o.mixin(i.params,u));var b=r.getOpenWithCommand(n,i,l);b&&(C=b.hrefCallback({items:i})),t.when(a.getFileContentType(i),function(e){_&&d(e,_,i.Location,w),v.href=C,m&&"function"==typeof m.updateFileNode&&m.updateFileNode(i,v,c(e))})}return v.addEventListener("click",function(){f=i}.bind(this),!1),v}function p(e,t,i,n){this.explorer=t,this.commandService=i,this.contentTypeService=n,this.openWithCommands=null,this.actionScopeId=e.actionScopeId,this._init(e),this.target="_self"}var f,m=60,g=new s("#{,resource,params*}");return p.prototype=new i.SelectionRenderer,p.prototype.wrapperCallback=function(e){e.setAttribute("role","tree")},p.prototype.tableCallback=function(t){t.setAttribute("aria-label",e.Navigator),t.setAttribute("role","presentation")},p.prototype.rowCallback=function(e){e.setAttribute("role","treeitem")},p.prototype.emptyCallback=function(t){var i=document.createElement("tr"),n=document.createElement("td");n.colSpan=this.oneColumn?1:3;var r=document.createElement("div");r.classList.add("noFile"),r.textContent=e.NoFile;var o=document.createElement("span");o.appendChild(document.createTextNode(e.File)),l.processDOMNodes(r,[o]),n.appendChild(r),i.appendChild(n),t.appendChild(i)},p.prototype.getDisplayTime=function(e){return new Date(e).toLocaleString()},p.prototype.getCommitRenderer=function(e,t){return new a.CommitInfoRenderer({parent:e,commitInfo:t})},p.prototype.getCellHeaderElement=function(e){if(this.oneColumn&&0!==e)return null;switch(e){case 0:case 1:case 2:var t=document.createElement("th");t.style.height="8px"}},p.prototype.setTarget=function(e){this.target=e},p.prototype.getFolderImage=function(){if(!this.showFolderImage)return null;var e=document.createElement("span");return e.className="core-sprite-folder modelDecorationSprite",e},p.prototype.createFolderNode=function(e){var t;if(this.showFolderLinks){t=u(this.folderLink||"",e,this.commandService,this.contentTypeService);var i=this.getFolderImage(e);i&&t.insertBefore(i,t.firstChild)}else t=document.createElement("span"),t.textContent=e.Name;return t},p.prototype.updateFileNode=function(){},p.prototype.showFolderLinks=!0,p.prototype.getCellElement=function(e,t,i){var o=t.LastCommit?2:1,s=t.LastCommit?3:2,a=t.LastCommit?1:-1;switch(e){case 0:var l=document.createElement("td"),c=document.createElement("span");c.id=i.id+"MainCol",c.setAttribute("role","presentation"),l.appendChild(c),l.setAttribute("role","presentation"),c.className="mainNavColumn";var d;return t.Directory?(this.getExpandImage(i,c),d=this.createFolderNode(t),c.appendChild(d),this.explorer._makeDropTarget(t,d),this.explorer._makeDropTarget(t,i)):(this.openWithCommands||(this.openWithCommands=r.getOpenWithCommands(this.commandService)),d=u("",t,this.commandService,this.contentTypeService,this.openWithCommands,{target:this.target},null,null,this),c.appendChild(d)),d&&(d.id=i.id+"NameLink",1===d.nodeType&&(n.addNavGrid(this.explorer.getNavDict(),t,d),d.setAttribute("role","link"),d.setAttribute("tabindex","-1"))),this.actionScopeId&&this.commandService.renderCommands(this.actionScopeId,c,t,this.explorer,"tool",null,!0),l;case o:if(this.oneColumn)return null;var h=document.createElement("td");return t.LocalTimeStamp&&(h.textContent=this.getDisplayTime(t.LocalTimeStamp)),h;case s:if(this.oneColumn)return null;var p=document.createElement("td");if(!t.Directory&&"number"==typeof t.Length){var f=parseInt(t.Length,10),g=f/1024;p.textContent=Math.ceil(g).toLocaleString()+" KB"}return p.style.textAlign="right",p;case a:if(this.oneColumn||!t.LastCommit)return null;var v=document.createElement("td");return this.getCommitRenderer(v,t.LastCommit).renderSimple(m),v}},p.prototype.constructor=p,{NavigatorRenderer:p,isImage:c,getClickedItem:h,createLink:u}}),define("orion/searchClient",["i18n!orion/search/nls/messages","require","orion/webui/littlelib","orion/i18nUtil","orion/searchUtils","orion/crawler/searchCrawler","orion/explorers/navigatorRenderer","orion/extensionCommands","orion/Deferred"],function(e,t,i,n,r,o,s,a,l){function c(e,t){this.serviceRegistry=e,this.commandRegistry=t,this.openWithCommands=null}function d(e){this.registry=e.serviceRegistry,this._commandService=e.commandService,this._fileService=e.fileService,this.defaultRenderer=new c(this.registry,this._commandService),this._fileService||console.error("No file service on search client")}return c.prototype.makeRenderFunction=function(o,c,d,h,u){function p(a,p,f,v){l.when(g.openWithCommands,function(l){if(f){i.empty(c);var g=document.createElement("div");return g.appendChild(document.createTextNode(e["Search failed."])),c.appendChild(g),void("function"==typeof h&&h(c))}var y=function(){function e(e,t){var i=t.folderName?t.folderName:t.path,n=document.createElement("span");n.id=i.replace(/[^a-zA-Z0-9_\.:\-]/g,""),n.appendChild(document.createTextNode(" - "+i+" ")),e.appendChild(n)}function t(t,n){var r=n.name;if(i.hasOwnProperty(r)){e(t,n);var o=i[r];"function"==typeof o&&(i[r]=null,o())}else i[r]=function(){e(t,n)}}var i={};return t}(),_=!1;if(i.empty(c),a&&a.length>0){var w=document.createElement("table");w.setAttribute("role","presentation");for(var C=0;C<a.length;C++){var b,S=a[C];if(!_&&(_=!0,d)){var E=w.insertRow(0);b=E.insertCell(0),b.textContent=d}var L=w.insertRow(-1);b=L.insertCell(0),b.colspan=2,u&&u(b);var x={Name:S.name,Directory:S.directory,Location:S.path||S.location},k=null;if("number"==typeof S.LineNumber&&(k={},k.line=S.LineNumber),v&&v.keyword&&!v.nameSearch){var N=r.generateSearchHelper(v);k=k||{},k.find=N.inFileQuery.searchStr,k.regEx=N.inFileQuery.wildCard?!0:void 0}var T=s.createLink(t.toUrl("edit/edit.html"),x,m,o,l,{"aria-describedby":(S.folderName?S.folderName:S.path).replace(/[^a-zA-Z0-9_\.:\-]/g,""),style:{verticalAlign:"middle"}},k);S.LineNumber&&T.appendChild(document.createTextNode(" (Line "+S.LineNumber+")")),b.appendChild(T),y(b,S)}c.appendChild(w),"function"==typeof h&&h(c)}if(!_&&p){var P=n.formatMessage(e["No matches found for ${0}"],p);i.empty(c),c.appendChild(document.createTextNode(P)),"function"==typeof h&&h(c)}})}var f=this.serviceRegistry,m=this.commandRegistry;this.openWithCommands=this.openWithCommands||a.createOpenWithCommands(f,o,m);var g=this;return p},d.prototype={search:function(e,t,i){var n=function(e){for(var i=[],n=0;n<e.response.docs.length;n++){var o=e.response.docs[n],s=o.Location,a=r.path2FolderName(o.Path?o.Path:o.Location,o.Name),l=a?a:s,c=t?l.indexOf(t)>=0:!0;c&&i.push({name:o.Name,path:s,folderName:a,directory:o.Directory,lineNumber:o.LineNumber})}return i};if(this._crawler&&e.nameSearch)this._crawler.searchName(e,function(t){i(n(t),e.keyword,null,e)});else try{this.registry.getService("orion.page.progress").progress(this._fileService.search(e),"Searching "+e.keyword).then(function(t){var r=e.keyword;r=r.substring(r.indexOf("}")+1),r=r.substring(r.indexOf(":")+1),i(n(t),r,null,e)},function(e){i(null,null,e,null)})}catch(s){if("string"==typeof s&&s.indexOf("search")>-1&&this._crawler)this._crawler.searchName(e,function(t){i(n(t),null,null,e)});else if("string"==typeof s&&s.indexOf("search")>-1&&!e.nameSearch){var a=new o.SearchCrawler(this.registry,this._fileService,e,{childrenLocation:this.getChildrenLocation()});a.search(function(t){i(n(t),null,null,e)})}else this.registry.getService("orion.page.message").setErrorMessage(s)}},getFileService:function(){return this._fileService},setCrawler:function(e){this._crawler=e},handleError:function(e,t){return console.error(e),i.empty(t),t.appendChild(document.createTextNode(e)),e},setLocationByMetaData:function(t,r){var o="",s=null;this._searchRootLocation=this._fileService.fileServiceRootURL(t.Location),r&&t&&t.Parents&&t.Parents.length>0?s="last"===r.index?t.Parents[t.Parents.length-1]:t.Parents[0]:t&&t.Directory&&t.Location&&t.Parents&&(s=t),s?(this.setLocationbyURL(s.Location),o=s.Name,this._childrenLocation=s.ChildrenLocation):t&&(this.setLocationbyURL(this._searchRootLocation),o=this._fileService.fileServiceName(t.Location),this._childrenLocation=t.ChildrenLocation);
var a=i.node("search");if(o||(o=""),a&&a.placeholder){a.value="";var l=n.formatMessage(e["Search ${0}"],o);a.placeholder=l.length>30?l.substring(0,27)+"...":n.formatMessage(e["Search ${0}"],o)}a&&a.title&&(a.title=e["Type a keyword or wild card to search in "]+o)},setLocationbyURL:function(e){this._searchLocation=e},setRootLocationbyURL:function(e){this._searchRootLocation=e},setChildrenLocationbyURL:function(e){this._childrenLocation=e},getSearchLocation:function(){return this._searchLocation?this._searchLocation:this._fileService.fileServiceRootURL()},getSearchRootLocation:function(){return this._searchRootLocation?this._searchRootLocation:this._fileService.fileServiceRootURL()},getChildrenLocation:function(){return this._childrenLocation?this._childrenLocation:this._fileService.fileServiceRootURL()},createSearchParams:function(e,t,i,n){var r=i?this.getSearchRootLocation():this.getSearchLocation();return t?{resource:r,sort:"NameLower asc",rows:100,start:0,nameSearch:!0,keyword:e}:{resource:r,sort:n&&n.sort?n.sort:"Path asc",rows:n&&n.rows?n.rows:40,start:0,caseSensitive:n?n.caseSensitive:void 0,regEx:n?n.regEx:void 0,fileType:n?n.fileType:void 0,fileNamePatterns:n&&n.fileNamePatterns?n.fileNamePatterns:void 0,keyword:e,replace:n?n.replace:void 0}}},d.prototype.constructor=d,{Searcher:d}}),define("orion/selection",["orion/EventTarget","orion/Deferred"],function(e){function t(t,i){i||(i="orion.page.selection"),this._serviceRegistry=t,e.attach(this),this._serviceRegistration=t.registerService(i,this),this._selections=null}return t.prototype={getSelection:function(e){var t=this._getSingleSelection();return"function"==typeof e&&e(t),t},getSelections:function(e){var t=Array.isArray(this._selections)?this._selections.slice():[];return"function"==typeof e&&e(t),t},_getSingleSelection:function(){return this._selections&&this._selections.length>0?this._selections[0]:null},setSelections:function(e){var t=this._selections;this._selections=Array.isArray(e)?e.length>0?e.slice():null:e?[e]:null,t!==this._selections&&this.dispatchEvent({type:"selectionChanged",selection:this._getSingleSelection(),selections:this._selections})}},t.prototype.constructor=t,{Selection:t}}),define("orion/dialogs",[],function(){function e(e){this._serviceRegistry=e,this._serviceRegistration=e.registerService("orion.page.dialog",this)}return e.prototype={confirm:function(e,t){t(window.confirm(e))},openFiles:function(){}},e.prototype.constructor=e,{DialogService:e}}),define("orion/fileUtils",["require","i18n!orion/nls/messages","orion/URL-shim"],function(e){function t(e){if(!e)return e;var t=window.location.protocol+"//"+window.location.host;return 0===e.indexOf(t)?e.substring(t.length):e}function i(e){if(!e)return!1;if("/workspace"===e)return!0;var t=new URL(e,window.location.href);return 0===t.href.indexOf(n)}var n;return n=e.toUrl?new URL(e.toUrl("workspace"),window.location.href).href:new URL("/",window.location.href).href,{makeRelative:t,isAtRoot:i}}),define("orion/sites/siteUtils",["require","orion/fileUtils","orion/URITemplate"],function(e,t,i){function n(n){var r=e.toUrl("sites/site.html");return new i(r+"#{,resource,params*}").expand({resource:t.makeRelative(n.Location)})}return{generateEditSiteHref:n}}),define("orion/sites/nls/root/messages",{OK:"OK","Name:":"Name:",Path:"Path","Mount at (server path)":"Mount at (server path)","Mappings:":"Mappings:","Hostname hint:":"Hostname hint:","Status:":"Status:","Not a valid name":"Not a valid name","Not a valid hostname":"Not a valid hostname","Convert to Self-Hosting":"Convert to Self-Hosting","Enable the site configuration to launch an Orion server running your local client code":"Enable the site configuration to launch an Orion server running your local client code",Save:"Save","Save the site configuration":"Save the site configuration","Choose folder...":"Choose folder…",ConvertToSelfHostingTitle:"Locate Required Folders",SelectRequiredFoldersSingle:"Locate the following required folder in your workspace.",SelectRequiredFolders:"Locate the following required folders in your workspace.",LocateFolderTitle:"Locate ${0}",FolderPrompt:"${0} (${1}):",orionClientLabel:"Orion client repository","Loading...":"Loading...",Add:"Add","Add a directory mapping to the site configuration":"Add a directory mapping to the site configuration","There are unsaved changes. Do you still want to navigate away?":"There are unsaved changes. Do you still want to navigate away?","There are unsaved changes.":"There are unsaved changes.","Service method missing: ":"Service method missing: ","No Matching SiteService for ":"No Matching SiteService for ",Create:"Create","Create a new site configuration":"Create a new site configuration",Edit:"Edit","Edit the site configuration":"Edit the site configuration",Delete:"Delete","Delete the site configuration":"Delete the site configuration",ConfirmDeleteSingle:"Are you sure you want to delete the site configuration '${0}'?",ConfirmDeleteMultiple:"Are you sure you want to delete these ${0} site configurations?",ViewOnSiteTitle:"View on Site",ViewOnSiteCaption:"Choose a site configuration to view '${0}' on.","Add to site":"Add to site","Add the file to this site":"Add the file to this site",View:"View","View the file on the site":"View the file on the site",Started:"Started at ${0}",Unknown:"Unknown",Name:"Name",Actions:"Actions",Status:"Status",URL:"URL","New Site":"New Site",WorkspaceFile:"Workspace file: ${0}",WorkspaceFolder:"Workspace folder: ${0}",WorkspaceResourceNotFound:"Workspace resource not found: ${0}",ExternalLinkTo:"External link to ${0}","Move Up":"Move Up","Move Down":"Move Down",HostHint:"HostHint",Start:"Start",Stop:"Stop","Optional; used to determine the URL where a started site can be accessed.":"Optional; used to determine the URL where a started site can be accessed.","Changes you make here won't affect the running site.":"Changes you make here won't affect the running site.",Stopped:"Stopped",Sites:"Sites",Mappings:"Mappings","SitesExplorer.NoSitesText":"You have no sites. Click ${0} to create a site."}),define("orion/sites/nls/messages",["orion/i18n!orion/sites/nls/messages","orion/sites/nls/root/messages"],function(e,t){var i={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof i[t]&&(i[t]=e[t])}),i}),define("orion/sites/siteClient",["i18n!orion/sites/nls/messages","require","orion/Deferred","orion/fileClient"],function(e,t,i,n){function r(t,n,r){var o=t[n],s=new i;if("function"!=typeof o)throw e["Service method missing: "]+n;var a=function(e){s.resolve(e)},l=function(e){s.reject(e)};return o.apply(t,r).then(a,l),s}function o(e,t){return new n.FileClient(e,function(e){var i=e.getProperty("top");return i&&0===i.indexOf(t)})}function s(e,t,i){this._serviceRegistry=e,this._siteService=t,this._selfHost=i.getProperty("canSelfHost"),this._selfHostConfig=i.getProperty("selfHostingConfig"),this._sitePattern=i.getProperty("sitePattern"),this._filePattern=i.getProperty("filePattern"),this._name=i.getProperty("name"),this._id=i.getProperty("id"),this._getService=function(){return this._siteService},this._getFilePattern=function(){return this._filePattern},this._getFileClient=function(){return o(this._serviceRegistry,this._getFilePattern())},this._canSelfHost=function(){return this._selfHost}}function a(e,t){e[t]=function(){return r(this._getService(),t,Array.prototype.slice.call(arguments))}}function l(t,i,n){for(var r=t.getServiceReferences("orion.site"),o=[],a=[],l=[],c=0;c<r.length;c++){var d,h=r[c].getProperty(i);d="^"!==h[0]?"^"+h:h,o.push(r[c]),a.push(new RegExp(d)),l.push(t.getService(r[c]))}var u=function(t){if("/"===t)return-1;if(!t||t.length&&0===t.length)return 0;for(var n=0;n<a.length;n++)if(a[n].test(t))return n;throw e["No Matching SiteService for "]+i+": "+t},p=u(n),f=l[p],m=o[p];return new s(t,f,m)}function c(e,t){return l(e,"pattern",t)}function d(e,t){return l(e,"filePattern",t)}return s.prototype={getSelfHostingConfig:function(){return this._selfHostConfig},isFileMapped:function(e,t){if(!e){var n=new i;return n.resolve(!1),n}return this.getURLOnSite(e,t).then(function(e){return null!==e})},mapOnSiteAndStart:function(e,t,n){function r(n,r,o){return s.isFileMapped(e,t).then(function(e){e||o.push({Source:n,Target:r,FriendlyPath:n});var t=new i;return t.resolve(),t})}var o,s=this,a="/"+t.Name;if(e)"started"===e.HostingStatus.Status&&(e.HostingStatus.Status="stopped"),o=s.toInternalForm(t.Location).then(function(t){return r(a,t,e.Mappings).then(function(){return s.updateSiteConfiguration(e.Location,e).then(function(e){return s.updateSiteConfiguration(e.Location,{HostingStatus:{Status:"started"}})})})});else{var l=t.Name+" site";o=s.toInternalForm(t.Location).then(function(e){var t=[];return r(a,e,t).then(function(){return s.createSiteConfiguration(l,n,t,null,{Status:"started"}).then(function(e){return e})})})}return o.then(function(e){return s.getURLOnSite(e,t)})}},["createSiteConfiguration","getSiteConfigurations","deleteSiteConfiguration","loadSiteConfiguration","updateSiteConfiguration","toFileLocation","toInternalForm","getMappingObject","getMappingProposals","updateMappingsDisplayStrings","parseInternalForm","isSelfHostingSite","convertToSelfHosting","getURLOnSite"].forEach(function(e){a(s.prototype,e)}),s.prototype.constructor=s,{forLocation:c,forFileLocation:d,getFileClient:o,SiteClient:s}}),define("orion/sites/siteCommands",["i18n!orion/sites/nls/messages","require","orion/commandRegistry","orion/commands","orion/sites/siteUtils","orion/sites/siteClient","orion/Deferred","orion/i18nUtil"],function(e,t,i,n,r,o,s,a){function l(t,s,a){function l(e){return o.getFileClient(t,e.getProperty("filePattern"))}a=a||{};var c=new n.Command({name:e.Create,tooltip:e["Create a new site configuration"],id:"orion.site.create",parameters:new i.ParametersDescription([new i.CommandParameter("name","text",e.Name)]),visibleWhen:function(){return!0},callback:function(e){var i=e.items,n=t.getService(i),o=l(i),s=e.parameters&&e.parameters.valueFor("name"),c=t.getService("orion.page.progress");(c?c.progress(o.loadWorkspaces(),"Loading workspaces"):o.loadWorkspaces()).then(function(e){var t=e&&e[0]&&e[0].Id;t&&s&&n.createSiteConfiguration(s,t).then(function(e){a.createCallback(r.generateEditSiteHref(e),e)},a.errorCallback)})}});s.addCommand(c)}function c(e){return e instanceof Array?e:[e]}function d(e){return function(t){return t instanceof Array&&1===t.length&&!(e instanceof Array)?t[0]:void 0}}function h(t,i){var n=t.getService("orion.page.dialog"),a=t.getService("orion.page.progress"),l=new p({name:e.Edit,tooltip:e["Edit the site configuration"],imageClass:"core-sprite-edit",id:"orion.site.edit",visibleWhen:function(e){return e instanceof Array&&1===e.length&&(e=e[0]),e.HostingStatus},hrefCallback:function(e){var t=e.items instanceof Array?e.items[0]:e.items;return r.generateEditSiteHref(t)}});i.addCommand(l);var h="userData.site requires a single site configuration to act upon",u=new p({name:e.Start,tooltip:e["Start the site"],imageClass:"core-sprite-start",id:"orion.site.start",visibleWhen:function(e){return c(e).some(function(e){return e.HostingStatus&&"stopped"===e.HostingStatus.Status})},callback:function(e){var i=c(e.items),n=e.userData;if(n.site&&i.length>1)throw new Error(h);var r=i.map(function(e){var i=n.site||{};i.HostingStatus={Status:"started"};var r=e.Location,s=o.forLocation(t,r);return s.updateSiteConfiguration(r,i)});a.showWhile(s.all(r)).then(d(e.items)).then(n.startCallback,n.errorCallback)}});i.addCommand(u);var m=function(e,i){var n=e?i:{};n.HostingStatus={Status:"stopped"};var r=i.Location,s=o.forLocation(t,r);return s.updateSiteConfiguration(r,n)},g=new p({name:e.Stop,tooltip:e["Stop the site"],imageClass:"core-sprite-stop",id:"orion.site.stop",visibleWhen:function(e){return c(e).some(function(e){return e.HostingStatus&&"started"===e.HostingStatus.Status})},callback:function(e){var t=c(e.items),i=e.userData;if(i.site&&t.length>1)throw new Error(h);t=t||[i.site];var n=t.map(m.bind(null,!!i.site));a.showWhile(s.all(n)).then(d(e.items)).then(i.stopCallback,i.errorCallback)}});i.addCommand(g);var v=new p({name:e.Delete,tooltip:e["Delete the site configuration"],imageClass:"core-sprite-delete",id:"orion.site.delete",visibleWhen:function(e){return c(e).length>0},callback:function(i){var r=c(i.items),a=i.userData,l=1===r.length?f(e.ConfirmDeleteSingle,r[0].Name):f(e.ConfirmDeleteMultiple,r.length);n.confirm(l,function(e){if(e){var n=r.map(function(e){var i=e.HostingStatus&&"stopped"!==e.HostingStatus.Status?m(!1,e):e;return s.when(i).then(function(){var i=e.Location,n=o.forLocation(t,i);return n.deleteSiteConfiguration(i)})});s.all(n).then(d(i.items)).then(a.deleteCallback,a.errorCallback)}})}});i.addCommand(v)}function u(t,i){var n=t.getService("orion.core.file");i.addCommand(new p({name:e["Add to site"],tooltip:e["Add the file to this site"],id:"orion.site.add-to",imageClass:"core-sprite-add",visibleWhen:function(e){return!e.IsFileRunningOn},callback:function(e){var i=e.userData.file,r=e.items.SiteConfiguration,s=t.getService("orion.page.progress");return(s?s.progress(n.loadWorkspaces(),"Loading workspaces"):n.loadWorkspaces()).then(function(e){return o.forFileLocation(t,i.Location).mapOnSiteAndStart(r,i,e[0].Id)}).then(e.userData.addToCallback,e.userData.errorCallback)}})),i.addCommand(new p({name:e.View,tooltip:e["View the file on the site"],id:"orion.site.view-on-link",visibleWhen:function(e){return e.IsFileRunningOn},hrefCallback:function(e){var i=e.userData.file,n=e.items.SiteConfiguration;return o.forFileLocation(t,i.Location).getURLOnSite(n,i)}}))}var p=n.Command,f=a.formatMessage;return{createSiteServiceCommands:l,createSiteCommands:h,createViewOnSiteCommands:u}}),define("orion/section",["orion/webui/littlelib","orion/selection","orion/commandRegistry","orion/commonHTMLFragments","orion/objects","orion/selection"],function(e,t,i,n,r,o){function s(t,i){var r=this;if(this._expandImageClass="core-sprite-openarrow",this._collapseImageClass="core-sprite-closedarrow",this._progressImageClass="core-sprite-progress",this._twistieSpriteClass="modelDecorationSprite",!i.id)throw new Error("Missing required argument: id");if(this.id=i.id,!i.title)throw new Error("Missing required argument: title");var o=i.useAuxStyle?["sectionWrapper","sectionWrapperAux","toolComposite"]:["sectionWrapper","toolComposite"];this.domNode=document.createElement("div"),t.appendChild(this.domNode);for(var s=0;s<o.length;s++)this.domNode.classList.add(o[s]);this.domNode.id=i.id,i.canHide&&(this.twistie=document.createElement("span"),this.twistie.classList.add("modelDecorationSprite"),this.twistie.classList.add("layoutLeft"),this.twistie.classList.add("sectionTitleTwistie"),this.domNode.style.cursor="pointer",this.domNode.appendChild(this.twistie),this.domNode.tabIndex=0,this.domNode.addEventListener("click",function(e){(e.target===r.titleNode||e.target===r.twistie||e.target===r.domNode)&&r._changeExpandedState()},!1),this.domNode.addEventListener("keydown",function(t){t.keyCode!==e.KEY.ENTER||t.target!==r.domNode&&t.target!==r.titleNode&&t.target!==r.twistie||r._changeExpandedState()},!1));var a;if(i.iconClass){var l=document.createElement("span");l.classList.add("sectionIcon"),this.domNode.appendChild(l),a=Array.isArray(i.iconClass)?i.iconClass:[i.iconClass],a.forEach(function(e){l.classList.add(e)})}if(i.headerClass&&(a=Array.isArray(i.headerClass)?i.headerClass:[i.headerClass],a.forEach(function(e){this.domNode.classList.add(e)}.bind(this))),this.titleActionsNode=document.createElement("div"),this.titleActionsNode.id=i.id+"TitleActionsArea",this.titleActionsNode.classList.add("layoutLeft"),this.titleActionsNode.classList.add("sectionActions"),this.domNode.appendChild(this.titleActionsNode),this.titleNode=document.createElement("div"),this.titleNode.id=i.id+"Title",this.titleNode.classList.add("sectionAnchor"),this.titleNode.classList.add("sectionTitle"),this.titleNode.classList.add("layoutLeft"),this.domNode.appendChild(this.titleNode),this.titleNode.textContent=i.title,"function"==typeof i.getItemCount){var c=document.createElement("div");c.classList.add("layoutLeft"),c.classList.add("sectionItemCount"),this.domNode.appendChild(c),c.textContent=i.getItemCount(this)}this._progressNode=document.createElement("div"),this._progressNode.id=i.id+"Progress",this._progressNode.classList.add("sectionProgress"),this._progressNode.classList.add("sectionTitle"),this._progressNode.classList.add("layoutLeft"),this._progressNode.style.display="none",this._progressNode.textContent="...",this.domNode.appendChild(this._progressNode),this.titleLeftActionsNode=document.createElement("div"),this.titleLeftActionsNode.id=i.id+"LeftTitleActionsArea",this.titleLeftActionsNode.classList.add("layoutLeft"),this.titleLeftActionsNode.classList.add("sectionActions"),this.domNode.appendChild(this.titleLeftActionsNode);var d=document.createElement("div");if(d.id=i.id+"FilterSearchBox",this.domNode.appendChild(d),this._toolActionsNode=document.createElement("div"),this._toolActionsNode.id=i.id+"ToolActionsArea",this._toolActionsNode.classList.add("layoutRight"),this._toolActionsNode.classList.add("sectionActions"),this.domNode.appendChild(this._toolActionsNode),this.actionsNode=document.createElement("ul"),this.actionsNode.id=i.id+"ActionArea",this.actionsNode.classList.add("layoutRight"),this.actionsNode.classList.add("commandList"),this.actionsNode.classList.add("sectionActions"),this.domNode.appendChild(this.actionsNode),this.selectionNode=document.createElement("ul"),this.selectionNode.id=i.id+"SelectionArea",this.selectionNode.classList.add("layoutRight"),this.selectionNode.classList.add("commandList"),this.selectionNode.classList.add("sectionActions"),this.domNode.appendChild(this.selectionNode),i.slideout){var h=n.slideoutHTMLFragment(i.id),u=document.createRange();u.selectNode(this.domNode),h=u.createContextualFragment(h),this.domNode.appendChild(h)}if(this._contentParent=document.createElement("div"),this._contentParent.id=this.id+"Content",this._contentParent.role="region",this._contentParent.classList.add("sectionTable"),this._contentParent.setAttribute("aria-labelledby",this.titleNode.id),t.appendChild(this._contentParent),i.content&&this.setContent(i.content),"function"==typeof i.onExpandCollapse&&(this._onExpandCollapse=i.onExpandCollapse),this._preferenceService=i.preferenceService,this._collapse(),this._preferenceService){var p=this;this._preferenceService.getPreferences("/window/views").then(function(e){var t=e.get(p.id);void 0===t?i.hidden||p._expand():t&&p._expand(),p._updateExpandedState(!1)})}else i.hidden||this._expand(),this._updateExpandedState(!1);this._commandService=i.commandService,this._lastMonitor=0,this._loading={}}function a(e){this._section=e,this._id=++e._lastMonitor}return s.prototype={setTitle:function(e){this.titleNode.textContent=e},getHeaderElement:function(){return this.domNode},getTitleElement:function(){return this.titleNode},getActionElement:function(){return this._toolActionsNode},setContent:function(e){"string"==typeof e?this._contentParent.innerHTML=e:(this._contentParent.innerHTML="",this._contentParent.appendChild(e))},getContentElement:function(){return this._contentParent},embedExplorer:function(t,i,n){this._contentParent.innerHTML="",t.parent||(t.parent=i),this._contentParent.appendChild(t.parent),t.section=this,r.mixin(t,{createActionSections:function(){this.actionsSections&&this.actionsSections.forEach(function(t){if(!e.node(t)){var i=document.createElement("ul");i.id=t,i.classList.add("commandList"),i.classList.add("layoutRight"),this.section.actionsNode.appendChild(i)}}.bind(this))},getCommandsVisible:function(){return"hidden"!==this.section.actionsNode.style.visibility},setCommandsVisible:function(t,i){this.section.actionsNode.style.visibility=t?"":"hidden",void 0===i&&(i=t?null:"cursorOnly"),this.renderer.selectionPolicy=i;var n=this.getNavHandler();n&&n.setSelectionPolicy(i),t?this.updateCommands():this.actionsSections&&this.actionsSections.forEach(function(t){e.node(t)&&this.commandRegistry.destroy(t)}.bind(this))},destroy:function(){Object.getPrototypeOf(this).destroy.call(this);var e=this;this.actionsSections&&(this.actionsSections.forEach(function(t){delete e[t]}),delete this.actionsSections)},updateCommands:function(e){this.section.actionsNode&&this.getCommandsVisible()&&(this.createActionSections(),Object.getPrototypeOf(this).updateCommands.call(this,e))},loaded:function(){var e=this;this.selection||n||(this.serviceRegistry||this.registry?(this.selection=new o.Selection(this.serviceRegistry||this.registry,this.parent.id+"Selection"),this.selection.addEventListener("selectionChanged",function(t){e.updateCommands(t.selections)})):window.console.error("Could not create a Selection for the explorer because of lack of serviceRegistry"));var t=this.registerCommands();t&&t.then?t.then(function(){e.updateCommands()}):e.updateCommands()}}),t.renderer&&(t.renderer.section=this,r.mixin(t.renderer,{getCellHeaderElement:function(e){var t=Object.getPrototypeOf(this).getCellHeaderElement.call(this,e);return t&&this.section.setTitle(t.innerHTML),null}}))},createProgressMonitor:function(){return new a(this)},_setMonitorMessage:function(e,t){this._progressNode.style.display="block",this._loading[e]=t;var i="";for(var n in this._loading)""!==i&&(i+="\n"),i+=this._loading[n];this._progressNode.title=i,this._updateExpandedState(!1)},_monitorDone:function(e){delete this._loading[e];var t="";for(var i in this._loading)""!==t&&(t+="\n"),t+=this._loading[i];this._progressNode.title=t,""===t&&(this._progressNode.style.display="none"),this._updateExpandedState(!1)},_changeExpandedState:function(){this.hidden?this._expand():this._collapse(),this._updateExpandedState(!0)},_updateExpandedState:function(e){var t=!this.hidden,i=this.working,n=this.twistie,r=this.id;n&&(n.classList.remove(this._expandImageClass),n.classList.remove(this._collapseImageClass),n.classList.remove(this._progressImageClass),n.classList.add(i?this._progressImageClass:t?this._expandImageClass:this._collapseImageClass)),this._preferenceService&&e&&this._preferenceService.getPreferences("/window/views").then(function(e){e.put(r,t)}),this._onExpandCollapse&&this._onExpandCollapse(t,this)},_expand:function(){this._contentParent.classList.remove("sectionClosed"),this.domNode.classList.remove("sectionClosed"),this.hidden=!1},_collapse:function(){this.hidden=!0,this._contentParent.classList.add("sectionClosed"),this.domNode.classList.add("sectionClosed")}},s.prototype.constructor=s,a.prototype={begin:function(e){this._section.working=!0,this.status=e,this._section._setMonitorMessage(this.id,e)},worked:function(e){this.status=e,this._section._setMonitorMessage(this.id,e)},done:function(e){this._section.working=!1,this.status=e,this._section._monitorDone(this.id)}},a.prototype.constructor=a,{Section:s}}),define("orion/sites/sitesExplorer",["i18n!orion/sites/nls/messages","orion/i18nUtil","orion/explorers/explorer","orion/Deferred","orion/commands","orion/keyBinding","orion/section","orion/globalCommands","orion/selection","orion/sites/siteUtils","orion/explorers/navigationUtils","orion/sites/siteClient","orion/sites/siteCommands","orion/webui/treetable","orion/webui/littlelib"],function(e,t,i,n,r,o,s,a,l,c,d,h,u,p,f){var m,g,v;return m=function(){function t(e,t,i,n){this.registry=e,this.checkbox=!1,this.parentId=n,this.selection=t,this.commandService=i,this.pageActionsWrapperId="pageActions",this.selectionActionsWrapperId="selectionTools",this.defaultActionWrapperId="DefaultActionWrapper"}return t.prototype=new i.Explorer,t.prototype._updatePageActions=function(e,t){var i=document.getElementById(this.pageActionsWrapperId);if(!i)throw"could not find toolbar "+this.pageActionsWrapperId;this.commandService.destroy(i),this.commandService.renderCommands(this.pageActionsWrapperId,i,t,this,"button",this.getRefreshHandler())},t.prototype._getSiteConfigurations=function(e){var t=e.map(function(e){return e.getSiteConfigurations().then(function(t){t=t||[];var i={};return i.siteService=e,i.siteConfigurations=t.sort(function(e,t){var i=e.Name&&e.Name.toLowerCase(),n=t.Name&&t.Name.toLowerCase();return n>i?-1:i>n?1:0}),i})});return n.all(t)},t.prototype.display=function(){var t=this,i=this.registry.getService("orion.page.message"),r=new n;i.showWhile(r,e["Loading..."]);var o=this.registry.getServiceReferences("orion.site");this.siteClients=[];for(var a=0;a<o.length;a++){var l=o[a],c=this.registry.getService(l);this.siteClients.push(new h.SiteClient(this.registry,c,l))}var d=this.commandService;this._getSiteConfigurations(this.siteClients).then(function(e){t.renderer=new g({registry:t.registry,commandService:t.commandService,actionScopeId:"sdsd",cachePrefix:"SitesExplorer",checkbox:!1},t),d.registerCommandContribution(t.pageActionsWrapperId,"orion.site.create",100),d.registerCommandContribution(t.defaultActionWrapperId,"orion.site.start",20),d.registerCommandContribution(t.defaultActionWrapperId,"orion.site.stop",30),d.registerCommandContribution(t.defaultActionWrapperId,"orion.site.delete",40,null,!1);var n=e.some(function(e){return e.siteConfigurations&&e.siteConfigurations.length>0});if(n)for(var a=0;a<e.length;a++){var l=e[a].siteService._id;if(e.length>1)new s.Section(document.getElementById(t.parentId),{id:l+"_Section",title:e[a].siteService._name,content:'<div id="'+l+'_Node" class="mainPadding siteGroup"></list>',canHide:!0});else{var c=document.createElement("div");c.setAttribute("role","region"),document.getElementById(t.parentId).appendChild(c);var h=document.createElement("div");h.id=l+"_Node",h.classList.add("mainPadding"),c.appendChild(h)}t.createTree(l+"_Node",new v(e[a].siteConfigurations),{setFocus:!1,noSelection:!0})}else t.renderNoSites(document.getElementById(t.parentId),o[0]);t._updatePageActions(t.registry,o[0]),r.resolve(),i.setProgressMessage("")})},t.prototype.getRefreshHandler=function(){return{startCallback:this.refresh.bind(this),stopCallback:this.refresh.bind(this),deleteCallback:this.refresh.bind(this),errorCallback:this.refresh.bind(this)}},t.prototype.refresh=function(){var e=this;this._getSiteConfigurations(this.siteClients).then(function(t){for(var i=!1,n=0;n<t.length;n++){var r=t[n].siteService._id+"_Node";f.empty(f.node(r)),t[n].siteConfigurations&&t[n].siteConfigurations.length>0&&(i=!0,e.createTree(r,new v(t[n].siteConfigurations),{setFocus:!1,noSelection:!0}))}if(!i){var o=e.registry.getServiceReferences("orion.site");e.renderNoSites(document.getElementById(e.parentId),o[0])}})},t.prototype.renderNoSites=function(t,i){var n=this,r=document.createElement("div");r.className="sitesPanel sectionWrapper sectionTitle";var o=document.createElement("span");n.commandService.renderCommands(n.pageActionsWrapperId,o,i,n,"button",n.getRefreshHandler()),r.appendChild(o);var s=document.createElement("span");s.textContent=e["SitesExplorer.NoSitesText"],f.processDOMNodes(s,[o]),r.appendChild(s),t.appendChild(r)},t}(),g=function(){function t(e,t){this._init(e),this.options=e,this.explorer=t,this.registry=e.registry,this.commandService=e.commandService}return t.prototype=new i.SelectionRenderer,t.prototype.render=function(t,i){var n=document.createElement("div");i.appendChild(n);var r=document.createElement("div");r.className="sectionWrapper toolComposite sitesPanel",i.appendChild(r);var o=document.createElement("div");o.className="sectionAnchor sectionTitle layoutLeft",r.appendChild(o);var s=document.createElement("span");o.appendChild(s);var a=c.generateEditSiteHref(t),l=document.createElement("a");l.href=a,s.appendChild(l),l.appendChild(document.createTextNode(t.Name));var d=document.createElement("div");d.className="layoutRight sectionActions",d.id="siteActionsArea",r.appendChild(d),this.commandService.renderCommands("DefaultActionWrapper",d,t,this.explorer,"button",this.explorer.getRefreshHandler());var h=document.createElement("div");h.className="sectionTable sectionTableItem",i.appendChild(h);var u=document.createElement("div");u.className="stretch",h.appendChild(u);var p=document.createElement("div");u.appendChild(p);var m=t.HostingStatus;if("object"==typeof m)if("started"===m.Status){var g=document.createElement("a");g.textContent=m.URL,g.href=m.URL,p.appendChild(g);var v=document.createElement("span");v.textContent=e.Started,f.processDOMNodes(v,[g]),p.appendChild(v)}else{var y=m.Status.substring(0,1).toUpperCase()+m.Status.substring(1);p.appendChild(document.createTextNode(y))}else p.appendChild(document.createTextNode(e.Unknown))},t}(),v=function(){function e(e,t){this._siteConfigurations=e,this._root={},this._id=t}return e.prototype={getRoot:function(e){e(this._root)},getChildren:function(e,t){if(e.children)t(e.children);else{if(e!==this._root)return t([]);e.children=this._siteConfigurations,t(this._siteConfigurations)}},getId:function(e){return e===this._root||e===this._id?this._id:e.Id}},e}(),m}),define("sites/sites",["orion/browserCompatibility","orion/bootstrap","orion/status","orion/progress","orion/commandRegistry","orion/fileClient","orion/operationsClient","orion/searchClient","orion/selection","orion/dialogs","orion/globalCommands","orion/sites/siteUtils","orion/sites/siteCommands","orion/sites/sitesExplorer","i18n!orion/sites/nls/messages"],function(e,t,i,n,r,o,s,a,l,c,d,h,u,p,f){t.startup().then(function(e){function t(){var e=v.setProgressResult.bind(v),t=function(e){window.location=e};u.createSiteServiceCommands(h,_,{createCallback:t,errorHandler:e}),u.createSiteCommands(h,_)}var h=e.serviceRegistry,m=e.preferences,g=(new c.DialogService(h),new s.OperationsClient(h)),v=new i.StatusReportingService(h,g,"statusPane","notifications","notificationArea"),y=new l.Selection(h),_=new r.CommandRegistry({}),w=(new n.ProgressService(h,g,_),new o.FileClient(h)),C=new a.Searcher({serviceRegistry:h,commandService:_,fileService:w});d.generateBanner("orion-sites",h,_,m,C),d.setPageTarget({task:f.Sites});var b=new p(h,y,_,"table");t(),b.display()})});