!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=r.shift();)e();s=!1}function t(e){r.push(e),s||(s=!0,a())}function n(e){return function(t){e(t)}}function i(e,t,i){try{var o=e(t),r=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof r)if(o===i.promise)i.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?i._parentCancel=s.bind(o):delete i._parentCancel,r.call(o,n(i.resolve),n(i.reject),n(i.progress))}else i.resolve(o)}catch(a){i.reject(a)}}function o(){function e(){for(var e;e=l.shift();){var t=e.deferred,n="fulfilled"===d?"resolve":"reject",o=e[n];"function"==typeof o?i(o,a,t):t[n](a)}}function n(n){delete c._parentCancel,d="rejected",a=n,l.length&&t(e)}function r(i){function s(e){return function(t){d&&"assumed"!==d||e(t)}}delete c._parentCancel;try{var h=i&&("object"==typeof i||"function"==typeof i)&&i.then;if("function"==typeof h)if(i===c)n(new TypeError);else{d="assumed";var u=i&&i.cancel;if("function"!=typeof u){var p=new o;i=p.promise;try{h(p.resolve,p.reject,p.progress)}catch(f){p.reject(f)}u=i.cancel,h=i.then}a=i,h.call(i,s(r),s(n)),c._parentCancel=u.bind(i)}else d="fulfilled",a=i,l.length&&t(e)}catch(m){s(n)(m)}}function s(){var e=c._parentCancel;if(e)delete c._parentCancel,e();else if(!d){var t=new Error("Cancel");t.name="Cancel",n(t)}}var a,d,l=[],c=this;this.resolve=function(e){return d||r(e),c},this.reject=function(e){return d||n(e),c},this.progress=function(e){return d||l.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),c.promise},this.cancel=function(){return c._parentCancel?setTimeout(s,0):s(),c},this.then=function(n,i,r){var s=new o;return s._parentCancel=c.promise.cancel,l.push({resolve:n,reject:i,progress:r,deferred:s}),("fulfilled"===d||"rejected"===d)&&t(e),s.promise},this.promise={then:c.then,cancel:c.cancel}}var r=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),i=new MutationObserver(e);return i.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function n(e,t){a||(s[e]=t,0===--r&&d.resolve(s))}function i(e,i){if(!a){if(t)try{return void n(e,t(i))}catch(o){i=o}d.reject(i)}}var r=e.length,s=[],a=!1,d=new o;return d.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===r?d.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),i.bind(void 0,t))}),d.promise},o.when=function(e,t,n,i){var r,s;return e&&"function"==typeof e.then?r=e:(s=new o,s.resolve(e),r=s.promise),r.then(t,n,i)},o}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function n(n){function i(e){p&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),p===self?p.postMessage(e):p.postMessage(e,"*"))}function o(){var e=[];return Object.keys(w).forEach(function(t){var n=w[t];e.push({serviceId:t,names:n.names,methods:n.methods,properties:n.properties})}),{headers:h||{},services:e}}function r(e,t){if(t&&t instanceof XMLHttpRequest){var n,i;try{n=t.status,i=t.statusText}catch(o){n=0,i=""}return{status:n||0,statusText:i}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,r)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(n){if(!p)return(new e).reject(new Error("plugin not connected"));n.id=String(f++);var i=new e;_[n.id]=i,i.then(null,function(e){u&&e instanceof Error&&"Cancel"===e.name&&C({requestId:n.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return n.params.forEach(function(e,r){if("[object Object]"===o.call(e)&&!(e instanceof t)){var s,a;for(s in e)"[object Function]"===o.call(e[s])&&(a=a||[],a.push(s));if(a){var d=m++;y[d]=e;var l=function(){delete y[d]};i.then(l,l),n.params[r]=new t(d,a)}}}),C(n),i.promise}function d(e,t){e||0===e?C({id:e,result:null,error:t}):console.log(t)}function l(e,t,n,i){i.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var n={};e.__methods.forEach(function(t){n[t]=function(){return a({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),i[t]=n}});var o=void 0===typeof e?null:{id:e,result:null,error:null};try{var r=n.apply(t,i);if(!o)return;r&&"function"==typeof r.then?(v[e]=r,r.then(function(t){delete v[e],o.result=t,C(o)},function(t){v[e]&&(delete v[e],o.error=s(t),C(o))},function(){C({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=r,C(o))}catch(d){o&&(o.error=s(d),C(o))}}function c(e){if(e.source===p||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var n=t.method,i=t.params||[];if("serviceId"in t){var o=w[t.serviceId];o||d(t.id,"service not found"),o=o.implementation,n in o?l(t.id,o,o[n],i):d(t.id,"method not found")}else if("objectId"in t){var r=y[t.objectId];r||d(t.id,"object not found"),!n in r?l(t.id,r,r[n],i):d(t.id,"method not found")}else if("requestId"in t){var s=v[t.requestId];s&&"cancel"===n&&s.cancel&&s.cancel.apply(s,i)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var a=_[t.responseId];a&&"progress"===n&&a.progress&&a.progress.apply(a,i)}}else{var c=_[String(t.id)];delete _[String(t.id)],t.error?c.reject(t.error):c.resolve(t.result)}}catch(h){console.log("Plugin._messageHandler "+h)}}}var h=n,u=!1,p=null,f=0,m=0,g=0,v={},_={},y={},w={},C=i;this.updateHeaders=function(e){if(u)throw new Error("Cannot update headers. Plugin Provider is connected");h=e},this.registerService=function(e,t,n){if(u)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var i=null,o=[];for(i in t)"function"==typeof t[i]&&o.push(i);w[g++]={names:e,methods:o,implementation:t,properties:n||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(u)return void(e&&e());if("undefined"==typeof window)p=self;else if(window!==window.parent)p=window.parent;else{if(null===window.opener)return void(t&&t("No valid plugin target"));p=window.opener}addEventListener("message",c,!1);var n={method:"plugin",params:[o()]};i(n),u=!0,e&&e()},this.disconnect=function(){u&&(removeEventListener("message",c),p=null,u=!1)}}return n}),function(){function e(e,t,n,i,o,r){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&i.push(o+e+"/"+r))}function t(e,t,n,i,o){var r=i+t+"/"+o;require._fileExists(e.toUrl(r+".js"))&&n.push(r)}function n(e,t,i){var o;for(o in t)!t.hasOwnProperty(o)||e.hasOwnProperty(o)&&!i?"object"==typeof t[o]&&n(e[o],t[o],i):e[o]=t[o]}var i=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(o){var r=o.config?o.config():{};return r=r||{},{version:"2.0.1+",load:function(o,s,a,d){d=d||{},d.locale&&(r.locale=d.locale);var l,c,h,u=i.exec(o),p=u[1],f=u[4],m=u[5],g=f.split("-"),v=[],_={},y="";if(u[5]?(p=u[1],l=p+m):(l=o,m=u[4],f=r.locale,f||(f=r.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=f.split("-")),d.isBuild){for(v.push(l),t(s,"root",v,p,m),c=0;c<g.length;c++)h=g[c],y+=(y?"-":"")+h,t(s,y,v,p,m);s(v,function(){a()})}else s([l],function(t){var i,o=[];for(e("root",t,o,v,p,m),c=0;c<g.length;c++)i=g[c],y+=(y?"-":"")+i,e(y,t,o,v,p,m);s(v,function(){var e,i,r;for(e=o.length-1;e>-1&&o[e];e--)r=o[e],i=t[r],(i===!0||1===i)&&(i=s(p+r+"/"+m)),n(_,i);a(_)})})}}})}(),define("orion/i18n",[],function(){return{load:function(e,t,n,i){i=i||{};var o=/(^.*(?:^|\/)nls(?:\/|$))([^\/]*)\/?([^\/]*)/,r=o.exec(e);if(!r)return void n(null);if(!t.defined||t.defined(e))try{return void n(t(e))}catch(s){}if(i.isBuild||i.isTest)return void n({});if(t.specified&&!t.specified("orion/bootstrap"))return void n({});var a=r[1],d=r[3]?r[2]:"",l=r[3]||r[2];t(["orion/bootstrap"],function(s){s.startup().then(function(s){var c=s.serviceRegistry,h=c.getServiceReferences("orion.i18n.message");if(d){var u=h.some(function(t){return e===t.getProperty("name")?(c.getService(t).getMessageBundle().then(function(e){n(e)},function(){n({})}),!0):!1});u||n({})}else{var p,f={};h.forEach(function(e){var n=e.getProperty("name");if((r=o.exec(n))&&a===r[1]&&l===(r[3]||r[2]))if(d=r[3]?r[2]:""){var s=i.locale||("undefined"!=typeof navigator?navigator.language||navigator.userLanguage:null);if(!s||0!==s.toLowerCase().indexOf(d.toLowerCase()))return;f[d]=!0,t.specified&&t.specified(n)||define(n,["orion/i18n!"+n],function(e){return e})}else p=e}),t.specified&&t.specified(e)?n(f):p?c.getService(p).getMessageBundle().then(function(t){Object.keys(f).forEach(function(e){"undefined"==typeof t[e]&&(t[e]=f[e])}),define(e,[],t),n(t)},function(){define(e,[],f),n(f)}):(define(e,[],f),n(f))}})})}}}),define("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Workspace Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Show Workspace",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer","Orion Markdown Editor":"Orion Markdown Editor","Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor","View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.","Show a list of all the keybindings on this page":"Show a list of all the keybindings on this page","Show Keys":"Show Keys","Hide or show the page banner and footer":"Hide or show the page banner and footer","Toggle banner and footer":"Toggle banner and footer","Choose a file by name and open an editor on it":"Choose a file by name and open an editor on it","Find File Named...":"Find File Named...","System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item","Can't search: no search service is available":"Can't search: no search service is available","could not find banner parent, id was ":"could not find banner parent, id was ",Related:"Related",Options:"Options",FAQ:"FAQ","Report a Bug":"Bugs","Privacy Policy":"Privacy","Terms of Use":"Terms","Copyright Agent":"Copyright","Orion Logo":"Orion Logo","Orion is in Beta. Please try it out but BEWARE your data may be lost.":"@buildLabel@","LOG: ":"LOG: ",View:"View","no parent":"no parent","no tree model":"no tree model","no renderer":"no renderer","could not find table row ":"could not find table row ","Resource is out of sync with the server. Do you want to save it anyway?":"Resource is out of sync with the server. Do you want to save it anyway?",Operations:"Operations","Operations running":"Operations running","Some operations finished with warning":"Some operations finished with warning","Some operations finished with error":"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",More:"More","Recent searches":"Recent searches","Regular expression":"Regular expression","Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification","Operations - Press spacebar to show current operations":"Operations - Press spacebar to show current operations","Type a keyword or wild card to search in root":"Type a keyword or wild card to search in root","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site","Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.","Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",UnknownError:"An unknown error occurred.",UnknownWarning:"An unknown warning occurred.",Filter:"Filter (* = any string, ? = any character)","To view the browser's context menu, trigger the context menu again.":"To view the browser's context menu, trigger the context menu again.",Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu"}),define("orion/nls/messages",["orion/i18n!orion/nls/messages","orion/nls/root/messages"],function(e,t){var n={root:t};return Object.keys(e).forEach(function(t){"undefined"==typeof n[t]&&(n[t]=e[t])}),n}),define("orion/util",[],function(){function e(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,n){return t[(n<<0)+1]})}function t(e,t){return e.createElementNS?e.createElementNS(_,t):e.createElement(t)}var n=navigator.userAgent,i=-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?document.documentMode:void 0,o=parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0,r=-1!==n.indexOf("Opera")?parseFloat(n.split("Version/")[1]):void 0,s=parseFloat(n.split("Chrome/")[1])||void 0,a=-1!==n.indexOf("Safari")&&!s,d=parseFloat(n.split("WebKit/")[1])||void 0,l=-1!==n.indexOf("Android"),c=-1!==n.indexOf("iPad"),h=-1!==n.indexOf("iPhone"),u=c||h,p=-1!==navigator.platform.indexOf("Mac"),f=-1!==navigator.platform.indexOf("Win"),m=-1!==navigator.platform.indexOf("Linux"),g="undefined"!=typeof document&&"ontouchstart"in document.createElement("input"),v=f?"\r\n":"\n",_="http://www.w3.org/1999/xhtml";return{formatMessage:e,createElement:t,isIE:i,isFirefox:o,isOpera:r,isChrome:s,isSafari:a,isWebkit:d,isAndroid:l,isIPad:c,isIPhone:h,isIOS:u,isMac:p,isWindows:f,isLinux:m,isTouch:g,platformDelimiter:v}}),define("orion/webui/littlelib",["orion/util"],function(e){function t(e,t){return t||(t=document),t.querySelector(e)}function n(e,t){return t||(t=document),t.querySelectorAll(e)}function i(e,t){return Array.prototype.slice.call(n(e,t))}function o(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function r(e,t){if(!e||!t)return!1;if(e===t)return!0;var n=e.compareDocumentPosition(t);return Boolean(16&n)}function s(e){var t=e.getBoundingClientRect();return{left:t.left+document.documentElement.scrollLeft,top:t.top+document.documentElement.scrollTop,width:t.width,height:t.height}}function a(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}}function d(t){var n=t.tabIndex;if(0===n&&e.isIE){var i={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0};i[t.nodeName.toLowerCase()]||t.attributes.tabIndex||(n=-1)}return n}function l(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=l(e.childNodes[t]);if(n)return n}return null}function c(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=e.childNodes.length-1;t>=0;t--){var n=c(e.childNodes[t]);if(n)return n}return null}function h(e,t){if(3===e.nodeType){var n=_.exec(e.nodeValue);n&&n.length>1&&t(e,n)}if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++)h(e.childNodes[i],t)}function u(e,t){h(e,function(e,n){var i=t[n[1]]||n[1];e.parentNode.replaceChild(document.createTextNode(i),e)})}function p(e,t){h(e,function(e,n){var i=t[n[1]];if(i){var o=document.createRange(),r=n.index;o.setStart(e,r),o.setEnd(e,r+n[0].length),o.deleteContents(),o.insertNode(i)}})}function f(t,n){function i(e){y.forEach(function(t){var n=!1,i=t.excludeNodes.some(function(t){return document.body.contains(t)?(n=!0,t.contains(e.target)):!1});if(n&&!i)try{t.dismiss(e)}catch(o){"undefined"!=typeof console&&console&&console.error(o&&o.message)}}),y=y.filter(function(e){return e.excludeNodes.some(function(e){return document.body.contains(e)})})}null===y&&(y=[],document.addEventListener("click",i,!0),e.isIOS&&document.addEventListener("touchend",function(e){function t(){e.target.removeEventListener("click",t)}0===e.touches.length&&e.target.addEventListener("click",t)},!1)),y.push({excludeNodes:t,dismiss:n})}function m(e){y=y.filter(function(t){return e!==t.dismiss})}function g(e){window.document.all&&(e.keyCode=0),e.preventDefault&&(e.preventDefault(),e.stopPropagation())}function v(e){for(var t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++)t[n].parentNode.style.pointerEvents=e?"":"none"}var _=/\$\{([^\}]+)\}/,y=null,w={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46};return{$:t,$$:n,$$array:i,node:o,contains:r,bounds:s,empty:a,firstTabbable:l,lastTabbable:c,stop:g,processTextNodes:u,processDOMNodes:p,addAutoDismiss:f,setFramesEnabled:v,removeAutoDismiss:m,KEY:w}}),define("orion/webui/treetable",["i18n!orion/nls/messages","orion/webui/littlelib"],function(e,t){function n(e){this._init(e)}return n.prototype={_init:function(n){var i=n.parent,o=this;if(i=t.node(i),!i)throw e["no parent"];if(!n.model)throw e["no tree model"];if(!n.renderer)throw e["no renderer"];this._parent=i,this._treeModel=n.model,this._onComplete=n.onComplete,this._renderer=n.renderer,this._showRoot=void 0===n.showRoot?!1:n.showRoot,this._indent=void 0===n.indent?16:n.indent,this._onCollapse=n.onCollapse,this._labelColumnIndex=void 0===n.labelColumnIndex?0:n.labelColumnIndex,this._id=void 0===n.id?"treetable":n.id,this._tableStyle=n.tableStyle,this._tableElement=n.tableElement||"table",this._tableBodyElement=n.tableBodyElement||"tbody",this._tableRowElement=n.tableRowElement||"tr",this._treeModel.getRoot(function(e){o._root=e,o._showRoot?(e._depth=0,o._generate([e],0)):o._treeModel.getChildren(e,function(e){o.destroyed||o._generate(e,0)})})},destroy:function(){this.destroyed=!0},_generate:function(e,n){t.empty(this._parent);var i=document.createElement("div");this._renderer.wrapperCallback&&this._renderer.wrapperCallback(i);var o=document.createElement(this._tableElement);this._renderer.tableCallback&&this._renderer.tableCallback(o),o.id=this._id,this._tableStyle&&o.classList.add(this._tableStyle),this._renderer.initTable(o,this),this._bodyElement=document.createElement(this._tableBodyElement),this._renderer.bodyCallback&&this._renderer.bodyCallback(this._bodyElement),this._bodyElement.id=this._id+"tbody",0===e.length?this._renderer.emptyCallback&&this._renderer.emptyCallback(this._bodyElement):this._generateChildren(e,n),o.appendChild(this._bodyElement),i.appendChild(o),this._parent.appendChild(i),this._rowsChanged(),this._onComplete&&this._onComplete(this)},_generateChildren:function(e,t,n){for(var i=0;i<e.length;i++){var o=document.createElement(this._tableRowElement);o.id=this._treeModel.getId(e[i]),o._depth=t,o._item=e[i],this._renderer.render(e[i],o);var r=this._indent*t;o.childNodes[Math.min(o.childNodes.length-1,this._labelColumnIndex)].style.paddingLeft=r+"px",this._renderer.rowCallback&&this._renderer.rowCallback(o,e[i]),n?(this._bodyElement.insertBefore(o,n.nextSibling),n&&(n=o)):this._bodyElement.appendChild(o)}},_rowsChanged:function(){this._renderer.rowsChanged&&this._renderer.rowsChanged()},getSelected:function(){return this._renderer.getSelected()},refresh:function(n,i,o){var r,s=this._treeModel.getId(n);if(s===this._id)this._removeChildRows(s),this._generateChildren(i,0),this._rowsChanged();else if(s===this._treeModel.getId(this._root)&&n.removeAll)this._removeAllRows(),this._generateChildren(i,0),this._rowsChanged();else{var a=t.node(s);a?(a._item=n,a&&(o||a._expanded)?(this._removeChildRows(s),i?(a._expanded=!0,this._renderer.updateExpandVisuals(a,!0),this._generateChildren(i,a._depth+1,a),this._rowsChanged()):(r=this,this._renderer.updateExpandVisuals(a,"progress"),i=this._treeModel.getChildren(a._item,function(e){r.destroyed||(r._renderer.updateExpandVisuals(a,!0),a._expanded||(a._expanded=!0,r._generateChildren(e,a._depth+1,a),r._rowsChanged()))}))):this._renderer.updateExpandVisuals(a,!1)):console.log(e["could not find table row "]+s)}},getItem:function(e){var n=t.node(e);return n&&n._item?n._item:e},toggle:function(e){var n=t.node(e);n&&(n._expanded?this.collapse(e):this.expand(e))},isExpanded:function(e){var n="string"==typeof e?e:this._treeModel.getId(e),i=t.node(n);return i?i._expanded:!1},expand:function(e,n,i){var o="string"==typeof e?e:this._treeModel.getId(e),r=t.node(o);if(r){var s=this;if(r._expanded)return void(n&&n.apply(s,i));this._renderer.updateExpandVisuals(r,"progress"),this._treeModel.getChildren(r._item,function(e){s.destroyed||(s._renderer.updateExpandVisuals(r,!0),r._expanded||(r._expanded=!0,s._generateChildren(e,r._depth+1,r),s._rowsChanged()),n&&n.apply(s,i))})}},_removeChildRows:function(e){for(var n=e===this._id,i=!1,o=-1,r=[],s=t.$$array(".treeTableRow",this._parent),a=0;a<s.length;a++){var d=s[a];if(i)break;n?d._depth>o?r.push(d):i=!0:d.id===e&&(n=!0,o=d._depth)}for(var l=0;l<r.length;l++){var c=r[l];c.parentNode.removeChild(c)}},_removeAllRows:function(){for(var e=t.$$array(".treeTableRow",this._parent),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n])},collapse:function(e){var n="string"==typeof e?e:this._treeModel.getId(e),i=t.node(n);if(i){if(!i._expanded)return;i._expanded=!1,this._renderer.updateExpandVisuals(i,!1),this._removeChildRows(n),this._rowsChanged()}this._onCollapse&&this._onCollapse(i._item)},getIndent:function(){return this._indent}},n.prototype.constructor=n,{TableTree:n}}),define("orion/treeModelIterator",[],function(){var e={};return e.TreeModelIterator=function(){function e(e,t){this.firstLevelChildren=e,this.reset(),this._init(t)}return e.prototype={_init:function(e){e&&(this.isExpanded=e.isExpanded,this.isExpandable=e.isExpandable,this.forceExpandFunc=e.forceExpandFunc,this.getChildrenFunc=e.getChildrenFunc)},topLevel:function(e){return e.parent?e.parent===this.root:!0},_getChildren:function(e){return"function"==typeof this.getChildrenFunc?this.getChildrenFunc(e):e?e.children:null},_expanded:function(e){if(!e)return!0;var t=this._getChildren(e),n=t&&t.length>0;return this.isExpanded&&n&&(n=this.isExpanded(e)),n},_expandable:function(e){return e?this.isExpandable?this.isExpandable(e):!1:!0},_diveIn:function(e){if(this._expanded(e)){var t=this._getChildren(e);return this.setCursor(t[0]),this.cursor()}return null},_drillToLast:function(e){if(this._expanded(e)){var t=this._getChildren(e);return this._drillToLast(t[t.length-1])}return e},_forward:function(e){if(!this._cursor)return null;var t=this._diveIn(this._cursor);if(!t){if(e&&this._expandable(this._cursor)&&this.forceExpandFunc){var n=this;return this.forceExpandFunc(this._cursor,"first",function(e){e&&n.setCursor(e)})}t=this._findSibling(this._cursor,!0),t&&this.setCursor(t)}return t},_backward:function(e){if(!this._cursor)return null;var t=this._findSibling(this._cursor,!1);if(t&&t!==this._cursor.parent&&(t=this._drillToLast(t)),e&&t&&this._expandable(t)&&this.forceExpandFunc&&t!==this._cursor.parent){var n=this;return this.forceExpandFunc(t,"last",function(e){e&&n.setCursor(e)})}return t&&this.setCursor(t),t},_findSibling:function(e,t){for(var n=this.topLevel(e),i=this._getChildren(e.parent),o=n?this.firstLevelChildren:i,r=0;r<o.length;r++)if(o[r]===e)return 0!==r||t?r===o.length-1&&t?n?null:this._findSibling(e.parent,t):t?o[r+1]:o[r-1]:n?null:e.parent;return null},_inParentChain:function(e,t){for(var n=e.parent;n;){if(n===t)return!0;n=n.parent}return!1},_getTopLevelParent:function(e){if(this.topLevel(e))return e;for(var t=e.parent;t;){if(this.topLevel(t))return t;t=t.parent}return null},_onCollapse:function(e){return this._expanded(e.parent)?e:this._onCollapse(e.parent)},_scan:function(e,t,n){this.setCursor(t);var i=[];for(i.push(t);;){if(!this.iterate(e))break;if(i.push(this.cursor()),n===this.cursor())return i}return i=[],null},setCursor:function(e){this._prevCursor=this._cursor,this._cursor=e},setTree:function(e){this.firstLevelChildren=e,this.firstLevelChildren.length>0&&(this.root=this.firstLevelChildren[0].parent)},scan:function(e,t){var n=this.cursor(),i=this._scan(!0,e,t);return i||(i=this._scan(!1,e,t)),this.setCursor(n),i},iterate:function(e,t){return e?this._forward(t):this._backward(t)},iterateOnTop:function(e,t){var n=this._findSibling(this._getTopLevelParent(this.cursor()),e);n?this.setCursor(n):t&&this.firstLevelChildren.length>0&&this.setCursor(e?this.firstLevelChildren[0]:this.firstLevelChildren[this.firstLevelChildren.length-1])},collapse:function(e){return this._cursor&&this._inParentChain(this._cursor,e)?(this.setCursor(e),this._cursor):null},reset:function(){this._cursor=null,this._prevCursor=null,this.root=null,this.firstLevelChildren.length>0&&(this._cursor=this.firstLevelChildren[0],this.root=this.firstLevelChildren[0].parent)},cursorMoved:function(){return this._cursor!==this._prevCursor},cursor:function(){return this._cursor},prevCursor:function(){return this._prevCursor}},e}(),e}),define("orion/uiUtils",["orion/webui/littlelib"],function(e){function t(t){var n="",i=-1!==navigator.platform.indexOf("Mac");if(i?(t.mod4&&(n+="⌃"),t.mod3&&(n+="⌥"),t.mod2&&(n+="⇧"),t.mod1&&(n+="⌘")):(t.mod1&&(n+="Ctrl+"),t.mod2&&(n+="Shift+"),t.mod3&&(n+="Alt+")),t.alphaKey)return n+t.alphaKey;if("keypress"===t.type)return n+t.keyCode;for(var o in e.KEY)if(e.KEY[o]===t.keyCode){if(i)switch(e.KEY[o]){case e.KEY.BKSPC:o="⌫";break;case e.KEY.TAB:o="⇥";break;case e.KEY.ENTER:o="⏎";break;case e.KEY.ESCAPE:o="⎋";break;case e.KEY.SPACE:o="␣";break;case e.KEY.PAGEUP:o="⇞";break;case e.KEY.PAGEDOWN:o="⇟";break;case e.KEY.END:o="⇲";break;case e.KEY.HOME:o="⇱";break;case e.KEY.DEL:o="⌦"}switch(e.KEY[o]){case e.KEY.DOWN:o="↓";break;case e.KEY.UP:o="↑";break;case e.KEY.RIGHT:o="→";break;case e.KEY.LEFT:o="←"}return n+o}var r;switch(t.keyCode){case 59:r=t.mod2?":":";";break;case 61:r=t.mod2?"+":"=";break;case 188:r=t.mod2?"<":",";break;case 190:r=t.mod2?">":".";break;case 191:r=t.mod2?"?":"/";break;case 192:r=t.mod2?"~":"`";break;case 219:r=t.mod2?"{":"[";break;case 220:r=t.mod2?"|":"\\";break;case 221:r=t.mod2?"}":"]";break;case 222:r=t.mod2?'"':"'"}return r?n+r:t.keyCode>=112&&t.keyCode<=123?n+"F"+(t.keyCode-111):n+String.fromCharCode(t.keyCode)}function n(e){for(var n="",i=e.getKeys(),o=0;o<i.length;o++)0!==o&&(n+=" "),n+=t(i[o]);return n}function i(t){var n=t.id,i=t.refNode,o=t.hideRefNode,r=t.initialText,s=t.onComplete,a=t.onEditDestroy,d=t.selectTo,l=t.isInitialValid,c=t.insertAsChild,h=!1,u=function(t){return function(d){if(!h){var c=e.node(n),u=c.value;if(c)return t&&d.keyCode===e.KEY.ESCAPE?(o&&(i.style.display="inline"),h=!0,c.parentNode.removeChild(c),void(a&&a())):void(t&&d.keyCode!==e.KEY.ENTER||(0===u.length||!l&&u===r?(o&&(i.style.display="inline"),h=!0):(s(u),o&&i.parentNode&&(i.style.display="inline"),h=!0),c.parentNode&&c.parentNode.removeChild(c),a&&a()))}}},p=document.createElement("input");p.id=n,p.value=r||"",c?i.appendChild(p):i.parentNode.insertBefore(p,i.nextSibling),p.classList.add("userEditBoxPrompt"),o&&(i.style.display="none"),p.addEventListener("keydown",u(!0),!1),p.addEventListener("blur",u(!1),!1),window.setTimeout(function(){if(p.focus(),r){var t=e.node(n),i=d?r.indexOf(d):-1;if(i>0)if(t.createTextRange){var o=t.createTextRange();o.collapse(!0),o.moveStart("character",0),o.moveEnd("character",i),o.select()}else t.setSelectionRange?t.setSelectionRange(0,i):void 0!==t.selectionStart&&(t.selectionStart=0,t.selectionEnd=i);else t.select()}},0)}function o(e){var t=-1!==window.navigator.platform.indexOf("Mac");return t&&e.metaKey||!t&&e.ctrlKey}function r(e,t){t&&o(t)?window.open(e):window.location=e}function s(t,n){var i=document.createElement("button");return i.className="orionButton commandButton commandMargins",i.addEventListener("click",function(t){n(),e.stop(t)},!1),t&&i.appendChild(document.createTextNode(t)),i}function a(){}function d(e){switch(e.tagName.toLowerCase()){case"button":case"fieldset":case"form":case"input":case"keygen":case"label":case"legend":case"meter":case"optgroup":case"output":case"progress":case"select":case"textarea":return!0}return!1}return{getUserKeyString:n,getUserText:i,openInNewWindow:o,followLink:r,createButton:s,createDropdownButton:a,isFormElement:d}}),define("orion/explorers/explorerNavHandler",["orion/webui/littlelib","orion/treeModelIterator","orion/uiUtils"],function(e,t,n){var i={},o=navigator.userAgent,r=-1!==o.indexOf("iPad"),s=-1!==window.navigator.platform.indexOf("Mac");return i.ExplorerNavHandler=function(){function i(i,o,r){this.explorer=i,this.model=this.explorer.model,this._navDict=o,this._listeners=[],this._selections=[],this._currentColumn=0;var s=this._getEventListeningDiv();s.tabIndex=0,s.classList.add("selectionModelContainer");var a=this;this._modelIterator=new t.TreeModelIterator([],{isExpanded:this.isExpanded.bind(this),getChildrenFunc:r.getChildrenFunc,isExpandable:this.explorer.renderer.isExpandable?function(e){return a.explorer.renderer.isExpandable(e)}:function(e){return a.isExpandable(e)},forceExpandFunc:this.explorer.forceExpandFunc?function(e,t,n){return a.explorer.forceExpandFunc(e,t,n)}:void 0}),this._init(r),r&&r.setFocus===!1||s.focus();var d=function(t){return n.isFormElement(t.target)?!0:a.explorer.preventDefaultFunc&&a.explorer.preventDefaultFunc(t,a._modelIterator.cursor())?!0:t.keyCode===e.KEY.DOWN?a.onDownArrow(t):t.keyCode===e.KEY.UP?a.onUpArrow(t):t.keyCode===e.KEY.RIGHT?a.onRightArrow(t):t.keyCode===e.KEY.LEFT?a.onLeftArrow(t):t.keyCode===e.KEY.SPACE?a.onSpace(t):t.keyCode===e.KEY.ENTER?a.onEnter(t):void 0};s.addEventListener("keydown",d,!1),this._listeners.push({type:"keydown",listener:d});var l=function(){a.explorer.onFocus?a.explorer.onFocus(!1):a.toggleCursor(null,!1)};s.addEventListener("blur",l,!1),this._listeners.push({type:"blur",listener:l});var c=function(){a.explorer.onFocus?a.explorer.onFocus(!0):a.toggleCursor(null,!0)};s.addEventListener("focus",c,!1),this._listeners.push({type:"focus",listener:c}),this._parentDiv=s}return i.prototype={destroy:function(){this._parentDiv.classList.remove("selectionModelContainer"),this.removeListeners()},_init:function(e){this._linearGridMove=!1,e&&(this._selectionPolicy=e.selectionPolicy,this.gridClickSelectionPolicy=e.gridClickSelectionPolicy||"none",this.preventDefaultFunc=e.preventDefaultFunc,this.postDefaultFunc=e.postDefaultFunc)},_ctrlKeyOn:function(e){return s?e.metaKey:e.ctrlKey},removeListeners:function(){if(this._listeners)for(var e=0;e<this._listeners.length;e++)this._parentDiv.removeEventListener(this._listeners[e].type,this._listeners[e].listener,!1)},focus:function(){var e=this._getEventListeningDiv();e&&e.focus()},_getEventListeningDiv:function(t){return this.explorer.keyEventListeningDiv&&"function"==typeof this.explorer.keyEventListeningDiv?this.explorer.keyEventListeningDiv(t):e.node(this.explorer._parentId)},isExpandable:function(t){if(!t)return!1;var n=e.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(t)));return n?!0:!1},isExpanded:function(e){return e?this.explorer.myTree.isExpanded(this.model.getId(e)):!1},refreshSelection:function(e,t){var n=this;this.explorer.selection&&this.explorer.selection.getSelections(function(i){n._clearSelection(t);for(var o=0;o<i.length;o++)n._selections.push(i[o]);n._selections.length>0?n.cursorOn(n._selections[0],!0,!1,e):n.cursorOn(null,!1,!1,e),n._shiftSelectionAnchor&&n._inSelection(n._shiftSelectionAnchor)>=0||(n._shiftSelectionAnchor=null)
})},refreshModel:function(e,t,n,i){this._currentColumn=0,this.topIterationNodes=[],this.model=t,this._navDict=e,this.model.getTopIterationNodes?this.topIterationNodes=this.model.getTopIterationNodes():n&&(this.topIterationNodes=n),this._modelIterator.setTree(this.topIterationNodes),!i&&this.explorer.selection&&(this.toggleCursor(this._modelIterator.cursor(),!1),this._modelIterator.reset()),this.refreshSelection(!0)},getTopLevelNodes:function(){return this._modelIterator.firstLevelChildren},_inSelection:function(e){for(var t=this.model.getId(e),n=0;n<this._selections.length;n++)if(t===this.model.getId(this._selections[n]))return n;return-1},_clearSelection:function(e){if(e)for(var t=0;t<this._selections.length;t++)this._checkRow(this._selections[t],!0);this._selections=[]},getSelectionPolicy:function(){return this._selectionPolicy},setSelectionPolicy:function(e){this._selectionPolicy!==e&&(("readonlySelection"===this._selectionPolicy||"readonlySelection"===e)&&this._toggleSelectionClass("disabledRow","readonlySelection"===e),this._selectionPolicy=e,"cursorOnly"===this._selectionPolicy&&this._clearSelection(!0))},setSelection:function(e,t,n){if("readonlySelection"!==this._selectionPolicy){if("cursorOnly"===this._selectionPolicy)return void(t&&this.explorer.renderer._useCheckboxSelection&&this._checkRow(e,!0));if(this._isRowSelectable(e)){if(t&&"singleSelection"!==this._selectionPolicy){var i=this._inSelection(e);i>=0?(this._checkRow(e,!0),this._selections.splice(i,1)):(this._checkRow(e,!1),this._selections.push(e),this._lastSelection=e)}else this._clearSelection(!0),this._checkRow(e,!1),this._selections.push(e),this._lastSelection=e;n&&(this._shiftSelectionAnchor=this._lastSelection),this.explorer.selection&&(this.explorer.renderer.storeSelections(),this.explorer.selection.setSelections(this._selections))}}},moveColumn:function(e,t){e||(e=this.currentModel());var n=this._getGridChildren(e);if(n&&n.length>1||0===t&&n){0!==t&&this.toggleCursor(e,!1);var i=this._currentColumn,o=!0;return i+=t,0>i?(this._linearGridMove&&0!==t&&(this._modelIterator.iterate(!1)?e=this.currentModel():o=!1),i=o?n.length-1:this._currentColumn):i>=n.length&&(this._linearGridMove&&0!==t&&(this._modelIterator.iterate(!0)?e=this.currentModel():o=!1),i=o?0:this._currentColumn),this._currentColumn=i,0!==t&&this.toggleCursor(e,!0),!0}return!1},_getGridChildren:function(e){return this._navDict?this._navDict.getGridNavHolder(e):null},getCurrentGrid:function(e){e||(e=this.currentModel());var t=this._getGridChildren(e);return t&&t.length>0?t[this._currentColumn]:null},getAriaContainerElement:function(e){for(var t,n=this._parentDiv;e&&e!==n&&"grid"!==(t=e.getAttribute("role"))&&"tree"!==t&&"treegrid"!==t;)e=e.parentNode;return e===n?null:e},toggleCursor:function(e,t){var n=this.getRowDiv(e),i=this.getCurrentGrid(e);if(i){if(n&&(t?n.classList.add("treeIterationCursorRow"):n.classList.remove("treeIterationCursorRow")),i.domNode){var o=this.getAriaContainerElement(i.domNode);if(t){if(i.domNode.classList.add("treeIterationCursor"),o){var r=i.domNode.id;o.setAttribute("aria-activedescendant",r)}}else i.domNode.classList.remove("treeIterationCursor")}}else n&&(t?n.classList.add("treeIterationCursorRow_Dotted"):n.classList.remove("treeIterationCursorRow_Dotted"))},currentModel:function(){return this._modelIterator.cursor()},cursorOn:function(e,t,n,i){var o,r;if(e||t){if(r===this._modelIterator.cursor())return;o=this._modelIterator.cursor(),r=e,this._modelIterator.setCursor(r)}else o=this._modelIterator.prevCursor(),r=this._modelIterator.cursor();if((o!==r||t)&&(this.toggleCursor(o,!1),!t||r)){this.moveColumn(null,0),this.toggleCursor(r,!0);var s=this.getRowDiv();if(s&&!i){for(var a=s.parentNode,d=document.documentElement;a&&a!==d;){var l=window.getComputedStyle(a,null);if(!l)break;var c=l.getPropertyValue("overflow-y");if("auto"===c||"scroll"===c)break;a=a.parentNode}if(a){var h=!0;s.offsetTop<=a.scrollTop?(h=!1,void 0===n&&(n=!1)):s.offsetTop+s.offsetHeight>=a.scrollTop+a.clientHeight&&(h=!1,void 0===n&&(n=!0)),h||s.scrollIntoView(!n)}}this.explorer.onCursorChanged&&this.explorer.onCursorChanged(o,r)}},getSelection:function(){return this._selections},getSelectionIds:function(){for(var e=[],t=0;t<this._selections.length;t++)e.push(this.model.getId(this._selections[t]));return e},getRowDiv:function(t){var n=t?t:this._modelIterator.cursor();if(!n)return null;var i=this.model.getId(n),o=this._navDict.getValue(i);return o&&o.rowDomNode?o.rowDomNode:e.node(i)},iterate:function(e,t,n,i){var o=null;if(this.topIterationNodes&&0!==this.topIterationNodes.length)if(i){var r=this.currentModel();for(o=this._modelIterator.iterate(e,t),o&&this._setCursorOnItem(e,n);o&&o.isNotSelectable;)o=this._modelIterator.iterate(e,t),o&&this._setCursorOnItem(e,n);o||(this.cursorOn(r,!0,!1,!0),this._setCursorOnItem(e,n))}else o=this._modelIterator.iterate(e,t),o&&this._setCursorOnItem(e,n)},_toggleSelectionClass:function(e,t){this._selections.forEach(function(n){var i=this.getRowDiv(n);i&&(t?i.classList.add(e):i.classList.remove(e))}.bind(this))},_setCursorOnItem:function(e,t){if(this.cursorOn(null,!1,e),t){var n=this._inSelection(this._modelIterator.prevCursor()),i=this._inSelection(this._modelIterator.cursor());n>=0&&i>=0?this.setSelection(this._modelIterator.prevCursor(),!0):this.setSelection(this.currentModel(),!0)}},_checkRow:function(t,n){if(this.explorer.renderer._useCheckboxSelection&&"singleSelection"!==this._selectionPolicy){var i=this.getRowDiv(t);if(!i)return;var o=e.node(this.explorer.renderer.getCheckBoxId(i.id)),r=n?!o.checked:!0;r!==o.checked&&this.explorer.renderer.onCheck(i,o,r,!0)}else this._select(t,n)},_select:function(e){e||(e=this._modelIterator.cursor());var t=this.getRowDiv(e);t&&(this._inSelection(e)<0?t.classList.add("checkedRow"):t.classList.remove("checkedRow"))},_onModelGrid:function(e,t){var n=this._getGridChildren(e);if(n)for(var i=0;i<n.length;i++)if(t.target===n[i].domNode)return!0;return!1},onClick:function(t,n){if("readonlySelection"===this._selectionPolicy||this.isDisabled(this.getRowDiv(t)))e.stop(n);else{var i=e.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(t)));if(n.target===i)return;if("none"===this.gridClickSelectionPolicy&&this._onModelGrid(t,n))return;if(this.cursorOn(t,!0,!1,!0),r)this.setSelection(t,!0);else if(this._ctrlKeyOn(n))this.setSelection(t,!0,!0);else if(n.shiftKey&&this._shiftSelectionAnchor){var o=this._modelIterator.scan(this._shiftSelectionAnchor,t);if(o){this._clearSelection(!0);for(var s=0;s<o.length;s++)this.setSelection(o[s],!0)}}else this.setSelection(t,!1,!0)}},onCollapse:function(e){this._modelIterator.collapse(e)&&this.cursorOn()},onUpArrow:function(e){return this.iterate(!1,!1,e.shiftKey,!0),this._ctrlKeyOn(e)||e.shiftKey||this.setSelection(this.currentModel(),!1,!0),e.preventDefault(),!1},onDownArrow:function(e){return this.iterate(!0,!1,e.shiftKey,!0),this._ctrlKeyOn(e)||e.shiftKey||this.setSelection(this.currentModel(),!1,!0),e.preventDefault(),!1},_shouldMoveColumn:function(e){var t=this.currentModel(),n=this._getGridChildren(t);return n&&n.length>1?this.isExpandable(t)?this._ctrlKeyOn(e):!0:!1},onLeftArrow:function(e){if(this._shouldMoveColumn(e))return this.moveColumn(null,-1),e.preventDefault(),!0;var t=this._modelIterator.cursor();return t?this.isExpandable(t)&&this.isExpanded(t)?(this.explorer.myTree.collapse(t),e.preventDefault(),!0):void(this._modelIterator.topLevel(t)?this.explorer.scopeUp&&"function"==typeof this.explorer.scopeUp&&this.explorer.scopeUp():(this.cursorOn(t.parent),this.setSelection(t.parent,!1,!0))):!1},onRightArrow:function(e){if(this._shouldMoveColumn(e))return this.moveColumn(null,1),e.preventDefault(),!0;var t=this._modelIterator.cursor();return t?this.isExpandable(t)&&!this.isExpanded(t)?(this.explorer.myTree.expand(t),this.explorer.postUserExpand&&this.explorer.postUserExpand(this.model.getId(t)),e.preventDefault(),!1):void 0:!1},_isRowSelectable:function(e){return this.explorer.isRowSelectable?this.explorer.isRowSelectable(e):!0},onSpace:function(e){this.setSelection(this.currentModel(),!0,!0),e.preventDefault()},onEnter:function(e){var t=this.getCurrentGrid(this._modelIterator.cursor());if(t)if(t.widget)"function"==typeof t.onClick?t.onClick():"function"==typeof t.widget.focus&&t.widget.focus();else{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,this._ctrlKeyOn(e),!1,!1,!1,0,null),t.domNode.dispatchEvent(n)}else{var i=this._modelIterator.cursor();if(i){if(this.explorer.renderer.getRowActionElement){var o=this.explorer.renderer.getRowActionElement(this.model.getId(i));o.href&&(this._ctrlKeyOn(e)?window.open(o.href):window.location.href=o.href)}return this.explorer.renderer.performRowAction?(this.explorer.renderer.performRowAction(e,i),e.preventDefault(),!1):void 0}}},setIsNotSelectable:function(e,t){e.isNotSelectable=t},disableItem:function(e){var t=this.getRowDiv(e);this.isExpandable(e)&&this.isExpanded(e)&&(this._modelIterator.collapse(e),this.explorer.myTree.toggle(t.id)),t.classList.remove("checkedRow"),t.classList.add("disabledNavRow"),this.setIsNotSelectable(e,!0)},isDisabled:function(e){return e.classList.contains("disabledNavRow")},enableItem:function(e){var t=this.getRowDiv(e);t&&(t.classList.remove("disabledNavRow"),this.setIsNotSelectable(e,!1))}},i}(),i.ExplorerNavDict=function(){function e(e){this._dict={},this._model=e}return e.prototype={addRow:function(e,t){var n=this._model.getId(e);this._dict[n]={model:e,rowDomNode:t}},getValue:function(e){return this._dict[e]},getGridNavHolder:function(e,t){if(!e)return null;var n=this._model.getId(e);return this._dict[n]?(!this._dict[n].gridChildren&&t&&(this._dict[n].gridChildren=[]),this._dict[n].gridChildren):null},initGridNavHolder:function(e){if(!e)return null;var t=this._model.getId(e);this._dict[t]&&(this._dict[t].gridChildren=null)}},e}(),i}),define("orion/EventTarget",[],function(){function e(){this._namedListeners={}}return e.prototype={dispatchEvent:function(e){if(!e.type)throw new Error("unspecified type");var t=this._namedListeners[e.type];return t&&t.forEach(function(t){try{"function"==typeof t?t(e):t.handleEvent(e)}catch(n){"undefined"!=typeof console&&console.log(n)}}),!e.defaultPrevented},addEventListener:function(e,t){("function"==typeof t||t.handleEvent)&&(this._namedListeners[e]=this._namedListeners[e]||[],this._namedListeners[e].push(t))},removeEventListener:function(e,t){var n=this._namedListeners[e];if(n)for(var i=0;i<n.length;i++)if(n[i]===t){1===n.length?delete this._namedListeners[e]:n.splice(i,1);break}}},e.prototype.constructor=e,e.attach=function(t){var n=new e;t.dispatchEvent=n.dispatchEvent.bind(n),t.addEventListener=n.addEventListener.bind(n),t.removeEventListener=n.removeEventListener.bind(n)},e}),define("orion/webui/dropdown",["require","orion/webui/littlelib","orion/EventTarget"],function(e,t,n){function i(e){n.attach(this),this._init(e)}function o(e,t){t=void 0===t?"span":t;var n=document.createElement(t);n.tabIndex=0,n.className="dropdownMenuItem",n.role="menuitem";var i=document.createElement("span");i.appendChild(document.createTextNode(e)),i.classList.add("dropdownCommandName"),n.appendChild(i);var o=document.createElement("li");return o.appendChild(n),o}function r(){var e=document.createElement("li");return e.classList.add("dropdownSeparator"),e}function s(e,t){var n=document.createElement("span");n.classList.add("dropdownKeyBinding"),n.appendChild(document.createTextNode(t)),e.appendChild(n)}return i.prototype={_init:function(e){if(this._dropdownNode=t.node(e.dropdown),!this._dropdownNode)throw"no dom node for dropdown found";if(this._populate=e.populate,this._selectionClass=e.selectionClass,this._parentDropdown=e.parentDropdown,this._positioningNode=e.positioningNode,!this._parentDropdown)for(var n=this._dropdownNode.parentNode;n&&document!==n;){if(n.classList&&n.classList.contains("dropdownMenu")){this._parentDropdown=n.dropdown;break}n=n.parentNode}if(this._dropdownNode.tabIndex=0,this._triggerNode=e.triggerNode?e.triggerNode:t.$(".dropdownTrigger",this._dropdownNode.parentNode),!this._triggerNode)throw"no dom node for dropdown trigger found";if(!e.skipTriggerEventListeners){var i=this;this._triggerNode.addEventListener("click",function(e){i.toggle(e)&&t.stop(e)},!1),"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&(i.toggle(),t.stop(e))},!1)}this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(e){var n=this;e.addEventListener("click",function(e){n.toggle(e)&&t.stop(e)},!1)},toggle:function(e){return this.isVisible()?this.close():this.open(e)},isVisible:function(){return this._isVisible},open:function(e){var n=!1;if(!this.isVisible()){this.dispatchEvent({type:"triggered",dropdown:this,event:e}),t.setFramesEnabled(!1),this._populate&&(this.empty(),this._populate(this._dropdownNode));var i=this.getItems();if(i.length>0){if(!this._hookedAutoDismiss){this._boundAutoDismiss?t.removeAutoDismiss(this._boundAutoDismiss):this._boundAutoDismiss=this._autoDismiss.bind(this);var o=t.$$array(".dropdownSubMenu",this._dropdownNode);t.addAutoDismiss([this._triggerNode].concat(o),this._boundAutoDismiss),this._hookedAutoDismiss=!0}this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),this._dropdownNode.classList.add("dropdownMenuOpen"),this._isVisible=!0,this._positionDropdown(e),this._focusDropdownNode(),n=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this)}}return n},_focusDropdownNode:function(){this._dropdownNode.focus()},_autoDismiss:function(e){if(this.close(!1)&&this._dropdownNode.contains(e.target))for(var t=this._parentDropdown;t;)t.close(!1),t=t._parentDropdown},_positionDropdown:function(){if(this._dropdownNode.style.left="",this._dropdownNode.style.top="",this._positioningNode)return void(this._dropdownNode.style.left=this._positioningNode.offsetLeft+"px");var e=t.bounds(this._dropdownNode),n=t.bounds(document.body);if(e.left+e.width>n.left+n.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-e.width+"px";else{var i=t.bounds(this._boundingNode(this._triggerNode)),o=t.bounds(this._triggerNode);this._dropdownNode.style.left=o.left-i.left-e.width+o.width+"px"}var r=e.top+e.height-(n.top+n.height);r>0&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-r)+"px")},_boundingNode:function(e){var t=window.getComputedStyle(e,null);if(null===t)return e;var n=t.getPropertyValue("position");return"absolute"!==n&&e.parentNode&&e!==document.body?this._boundingNode(e.parentNode):e},close:function(e){var n=!1;return this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),t.setFramesEnabled(!0),e&&this._triggerNode.focus(),this._isVisible=!1,this._selectedItem&&(this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=null),n=!0),n},getItems:function(){var e=t.$$array("li:not(.dropdownSeparator) > .dropdownMenuItem",this._dropdownNode,!0),n=[],i=this;return e.forEach(function(e){e.parentNode.parentNode===i._dropdownNode&&n.push(e)}),n.forEach(function(e){e._hasDropdownMouseover||(e.addEventListener("mouseover",function(n){e.dropdown?e.dropdown.open(n):(i._closeSelectedSubmenu(),t.stop(n)),i._selectItem(e)}),e._hasDropdownMouseover=!0)}),n},empty:function(){var e=t.$$array("li",this._dropdownNode),n=this;e.forEach(function(e){e.parentNode===n._dropdownNode&&e.parentNode.removeChild(e)}),this._hookedAutoDismiss=!1},_dropdownKeyDown:function(e){if(e.keyCode===t.KEY.UP||e.keyCode===t.KEY.DOWN||e.keyCode===t.KEY.RIGHT||e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.LEFT){var n=this.getItems();if(n.length&&n.length>0){if(this._selectedItem){var i=n.indexOf(this._selectedItem);0>i&&(i=n.indexOf(this._selectedItem.parentNode)),i>=0&&(e.keyCode===t.KEY.UP&&i>0?(i--,this._selectItem(n[i])):e.keyCode===t.KEY.DOWN&&i<n.length-1?(i++,this._selectItem(n[i])):e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.RIGHT?this._selectedItem.classList.contains("dropdownTrigger")&&this._selectedItem.dropdown?(this._selectedItem.dropdown.open(),this._selectedItem.dropdown._selectItem()):e.keyCode===t.KEY.ENTER&&this._selectedItem.click():e.keyCode===t.KEY.LEFT&&this._selectedItem.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&(this.close(!0),this._parentDropdown&&this._parentDropdown._dropdownNode.focus()))}else this._selectItem(n[0]);t.stop(e)}}else e.keyCode===t.KEY.ESCAPE&&(this.close(!0),t.stop(e))},_selectItem:function(e){var t=e||this.getItems()[0];t&&(this._selectedItem&&this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=t,this._selectedItem.classList.add("dropdownMenuItemSelected")),document.activeElement!==this._dropdownNode&&this._dropdownNode.focus()},submenuOpen:function(e){e!==this._selectedSubmenu&&(this._closeSelectedSubmenu(),this._selectedSubmenu=e)},_closeSelectedSubmenu:function(){for(var e=this._selectedSubmenu;e;)e.close(),e=e._selectedSubmenu},destroy:function(){this.empty(),this._boundAutoDismiss&&t.removeAutoDismiss(this._boundAutoDismiss)},appendMenuItem:function(e,t){var n=o(e,t);return this._dropdownNode.appendChild(n),n},appendSeparator:function(){var e=r();return this._dropdownNode.appendChild(e),e}},i.prototype.constructor=i,{Dropdown:i,appendKeyBindingString:s,createMenuItem:o,createSeparator:r}}),define("text",["module"],function(e){var t,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,a=s&&location.protocol&&location.protocol.replace(/\:/,""),d=s&&location.hostname,l=s&&(location.port||void 0),c=[],h=e.config&&e.config()||{};return t={version:"2.0.5",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(r);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(o){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,i,o=!1,r=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!s||r>1)?(t=e.substring(0,r),n=e.substring(r+1,e.length)):t=e,i=n||t,r=i.indexOf("!"),-1!==r&&(o="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:t=i),{moduleName:t,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,o){var r,s,a,d=t.xdRegExp.exec(e);return d?(r=d[2],s=d[3],s=s.split(":"),a=s[1],s=s[0],!(r&&r!==n||s&&s.toLowerCase()!==i.toLowerCase()||(a||s)&&a!==o)):!0},finishLoad:function(e,n,i,o){i=n?t.strip(i):i,h.isBuild&&(c[e]=i),o(i)},load:function(e,n,i,o){if(o.isBuild&&!o.inlineText)return void i();h.isBuild=o.isBuild;var r=t.parseName(e),c=r.moduleName+(r.ext?"."+r.ext:""),u=n.toUrl(c),p=h.useXhr||t.useXhr;!s||p(u,a,d,l)?t.get(u,function(n){t.finishLoad(e,r.strip,n,i)},function(e){i.error&&i.error(e)}):n([c],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)})},write:function(e,n,i){if(c.hasOwnProperty(n)){var o=t.jsEscape(c[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,o,r){var s=t.parseName(n),a=s.ext?"."+s.ext:"",d=s.moduleName+a,l=i.toUrl(s.moduleName+a)+".js";t.load(d,i,function(){var n=function(e){return o(l,e)};n.asModule=function(e,t){return o.asModule(e,l,t)},t.write(e,d,n,r)},r)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),t.get=function(e,t){var i=n.readFileSync(e,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),t(i)}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,n,i,o){var r,s=t.createXhr();if(s.open("GET",e,!0),o)for(r in o)o.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),o[r]);h.onXhr&&h.onXhr(s,e),s.onreadystatechange=function(){var t,o;4===s.readyState&&(t=s.status,t>399&&600>t?(o=new Error(e+" HTTP status: "+t),o.xhr=s,i(o)):n(s.responseText))},s.send(null)}:("rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var n,i,o="utf-8",r=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),o)),d="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);d=String(n.toString())}finally{a.close()}t(d)}),t}),define("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'<button class="dropdownTrigger">${ButtonText}<!--span class="dropdownArrowDown core-sprite-openarrow"></span--></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'<button class="dropdownTrigger dropdownDefaultButton">${ButtonText}<span class="dropdownArrowDown core-sprite-openarrow"></span></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/submenutriggerbutton.html",[],function(){return'<li class="dropdownSubMenu"><span class="dropdownTrigger dropdownMenuItem" role="menuitem" tabindex="0"><span class="dropdownCommandName">${ButtonText}</span><span class="dropdownArrowRight core-sprite-closedarrow"></span></span><ul class="dropdownMenu"></ul></li>'}),define("text!orion/webui/checkedmenuitem.html",[],function(){return'<li><label class="dropdownMenuItem"><input class="checkedMenuItem" role="menuitem" type="checkbox" />${ItemText}</label></li>'}),define("orion/webui/tooltip",["require","orion/webui/littlelib"],function(e,t){function n(e){this._init(e)}return n.prototype={_init:function(e){if(this._node=t.node(e.node),!this._node)throw"no dom node for tooltip found";this._position=e.position||["right","above","below","left"],this._text=e.text,this._hideDelay=void 0===e.hideDelay?200:e.hideDelay,this._tailSize=e.tailSize||10,this._trigger=e.trigger||"mouseover",this._afterShowing=e.afterShowing,this._afterHiding=e.afterHiding;var n=this;if("click"===this._trigger)this._showDelay=0,this._node.addEventListener("click",this._clickHandler=function(e){e.target===n._node&&(n.show(),t.stop(e))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===e.showDelay?500:e.showDelay;var i=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(e){t.contains(n._node,e.target)&&(n.show(),t.stop(e))},!1),this._leaveHandler=function(e){t.contains(n._node,e.target)&&n.hide()};for(var o=0;o<i.length;o++)this._node.addEventListener(i[o],this._leaveHandler,!1)}},_makeTipNode:function(){if(!this._tip){if(this._tip=document.createElement("span"),this._tip.classList.add("tooltipContainer"),this._tipInner=document.createElement("div"),this._tipInner.classList.add("tooltip"),this._text){this._tipTextContent=document.createElement("div"),this._tipTextContent.classList.add("textContent"),this._tipInner.appendChild(this._tipTextContent);var e=document.createTextNode(this._text);this._tipTextContent.appendChild(e)}this._tip.appendChild(this._tipInner),document.body.appendChild(this._tip);var n=this;t.addAutoDismiss([this._tip,this._node],function(){n.hide()}),"mouseover"===this._trigger&&(this._tipInner.role="tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(){n._timeout&&(window.clearTimeout(n._timeout),n._timeout=null),n._tip.addEventListener("mouseout",function(e){t.contains(n._tip,e.target)&&(n.hide(),t.stop(e))},!1)},!1))}return this._tip},_positionTip:function(e,n){this._makeTipNode(),"left"===e?this._tipInner.classList.add("left"):this._tipInner.classList.remove("left");var i,o=this._node;for(i=t.bounds(o);o&&!i.width&&!i.height;o=o.parentNode)i=t.bounds(o);var r,s,a=t.bounds(this._tipInner);switch(e){case"above":r=i.top-a.height-this._tailSize-1,s=i.left-this._tailSize;break;case"below":r=i.top+i.height+this._tailSize+1,s=i.left-this._tailSize;break;case"left":r=i.top-this._tailSize/2,s=i.left-a.width-this._tailSize-1;break;default:r=i.top-this._tailSize/2,s=i.left+i.width+this._tailSize+1}var d=t.bounds(document.documentElement);if(r+a.height>d.height){if(!n)return!1;r=d.height-a.height-1}if(s+a.width>d.width){if(!n)return!1;s=d.width-a.width-1}if(0>s){if(!n)return!1;s=4}if(0>r){if(!n)return!1;r=4}return this._tail&&this._tail.previousPosition!==e&&(this._tip.removeChild(this._tail),this._tail=null),this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+e),"above"===e||"left"===e?this._tip.appendChild(this._tail):this._tip.insertBefore(this._tail,this._tipInner),this._tail.previousPosition=e),this._tip.style.top=r+"px",this._tip.style.left=s+"px",!0},contentContainer:function(){return this._makeTipNode(),this._tipInner},show:function(){this._tip&&this._tip.classList.contains("tooltipShowing")||(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=window.setTimeout(this._showImmediately.bind(this),this._showDelay):this._showImmediately())},_showImmediately:function(){for(var e=!1,t=0;!e&&t<this._position.length;)e=this._positionTip(this._position[t]),t++;e||this._positionTip(this._position[0],!0),this._tip.classList.add("tooltipShowing"),this._afterShowing&&this._afterShowing()},hide:function(e){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._tip&&this._tip.classList.contains("tooltipShowing")){void 0===e&&(e=this._hideDelay);var t=this;this._timeout=window.setTimeout(function(){t._tip.classList.remove("tooltipShowing"),t._tip.removeAttribute("style"),t._afterHiding&&t._afterHiding()},e)}},destroy:function(){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._tip&&(document.body.removeChild(this._tip),this._tip=null,this._tipInner=null,this._tipTextContent=null,this._tail=null),this._node){this._node.removeEventListener("click",this._clickHandler,!1),this._node.removeEventListener("mouseover",this._mouseoverHandler,!1);for(var e=["mouseout","click"],t=0;t<e.length;t++)this._node.removeEventListener(e[t],this._leaveHandler,!1)}}},n.prototype.constructor=n,{Tooltip:n}}),define("orion/commands",["orion/util","orion/webui/littlelib","orion/webui/dropdown","text!orion/webui/dropdowntriggerbutton.html","text!orion/webui/dropdowntriggerbuttonwitharrow.html","text!orion/webui/submenutriggerbutton.html","text!orion/webui/checkedmenuitem.html","orion/webui/tooltip"],function(e,t,n,i,o,r,s,a){function d(e){E=e}function l(e){var t=e.invocation;if(t){var n=e.command;if(n.hrefCallback){var i=n.hrefCallback.call(t.handler||window,t);return i.then?i.then(function(e){window.open(e)}):window.open(i),!0}if(t.commandRegistry)return t.commandRegistry._invoke(t),!0;if(n.onClick||n.callback)return window.setTimeout(function(){(n.onClick||n.callback).call(t.handler||window,t)},0),!0}return!1}function c(e,n){for(var i in n)if(n[i]&&n[i].keyBinding&&n[i].command&&n[i].keyBinding.match(e)){var o=n[i],r=o.keyBinding;if((!r.domScope||t.contains(t.node(r.domScope),e.target))&&l(o))return void t.stop(e)}}function h(){var e={};if(E){var t,n,i;for(n=Object.keys(x),t=0;t<n.length;t++)i=n[t],e[i]=x[i];var o=E();for(n=Object.keys(o),t=0;t<n.length;t++)i=n[t],e[i]=o[i]}else e=x;return e}function u(e){c(e,h())}function p(t,n){function i(t){if(e.isMac){if(t.metaKey&&!t.altKey)return t.shiftKey||t.ctrlKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.ctrlKey)return!1}else{if(t.ctrlKey&&!t.altKey)return t.shiftKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.altKey&&!t.ctrlKey)return!1}if(t["char"])return t["char"].length>0;if(t.charCode||t.keyCode){var n=t.charCode||t.keyCode;switch(n){case 8:case 9:case 13:case 46:return!0;default:return n>=32&&112>n||n>123}}return!1}if(t=t||window.event,i(t)){if("true"===t.target.contentEditable)return;var o=t.target.nodeName.toLowerCase();if("input"===o){var r=t.target.type.toLowerCase();switch(r){case"text":case"password":case"search":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"range":case"tel":case"time":case"url":case"week":return}}else if("textarea"===o)return}n?n(t):u(t)}function f(){this._init()}function m(e,t,n){t.classList.add("commandImage");var i;return e.imageClass?e.addImageClassToElement?t.classList.add(e.imageClass):(i=document.createElement("span"),t.appendChild(i),i.classList.add(e.spriteClass),i.classList.add(e.imageClass)):(i=new Image,i.alt=e.name,i.name=n,i.id=n,i.src=e.image,t.appendChild(i)),i}function g(e,r,s,a,d,l,c,h,u){if(e=t.node(e),!e)throw"no parent node was specified";var p=document.createRange();p.selectNode(e);var f=p.createContextualFragment(u?o:i);t.processTextNodes(f,{ButtonText:r}),e.appendChild(f);var g,v,_=e.lastChild;return u?(g=_.previousSibling,v=g.lastChild):g=_.previousSibling,a?g.classList.add(a):(g.classList.add("orionButton"),g.classList.add("commandButton")),d&&(l||(g.textContent="",g.setAttribute("aria-label",r)),m({spriteClass:"commandSprite",imageClass:d},g,r),g.classList.add("orionButton")),g.dropdown=new n.Dropdown({dropdown:_,populate:s,selectionClass:c,skipTriggerEventListeners:!!v,positioningNode:h}),_.dropdown=g.dropdown,{menuButton:g,menu:_,dropdown:g.dropdown,dropdownArrow:v}}function v(e,n,i,o){if(e=t.node(e),!e)throw"no parent node was specified";var r=document.createRange();r.selectNode(e);var a=r.createContextualFragment(s);t.processTextNodes(a,{ItemText:n}),e.appendChild(a);var d=e.lastChild,l=t.$(".checkedMenuItem",d);return l.checked=i,l.addEventListener("change",o,!1),l}function _(e,t,n,i,o,r,s){var d;if(r=r||!t.name&&t.hasImage(),t.hrefCallback){d=document.createElement("a"),d.id=i,r&&t.hasImage()?m(t,d,i):(d.className="commandLink",d.appendChild(document.createTextNode(t.name)));var l=t.hrefCallback.call(n.handler,n);l.then?l.then(function(e){d.href=e}):d.href=l?l:"#"}else{if(d=document.createElement("button"),d.className="orionButton",r)t.hasImage()?(m(t,d,i),t.name&&d.setAttribute("aria-label",t.name)):(d.classList.add("commandButton"),d.classList.add("commandMissingImageButton"),d.appendChild(document.createTextNode(t.name)));else{d.classList.add("commandButton");var c=document.createTextNode(t.name);d.appendChild(c)}var h=s||t.callback;h&&(t.onClick=h,d.addEventListener("click",function(){h.call(n.handler,n)},!1))}if("ul"===e.nodeName.toLowerCase()){var u=document.createElement("li");e.appendChild(u),e=u}else d.classList.add("commandMargins");return e.appendChild(d),t.tooltip&&(d.commandTooltip=new a.Tooltip({node:d,text:t.tooltip,position:["above","below","right","left"]})),o&&(x[t.id]={keyBinding:o,command:t,invocation:n}),d}function y(e,i,o,r,s,d){var l,c,h=e.dropdown;if(i.hrefCallback){c=n.createMenuItem(i.name,"a"),l=c.firstElementChild;var u=i.hrefCallback.call(o.handler,o);u.then?u.then(function(e){l.href=e}):l.href=u?u:"#",l.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&l.click()},!1)}else{c=n.createMenuItem(i.name),l=c.firstElementChild;var p=s||i.callback;p&&(i.onClick=p,l.addEventListener("click",function(){h.close(!0),p.call(o.handler,o)},!1),l.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&(e.preventDefault(),l.click())},!1))}return i.tooltip&&(l.commandTooltip=new a.Tooltip({node:l,text:i.tooltip,position:["above","below","right","left"]})),d&&n.appendKeyBindingString(l,d),e.appendChild(c),r&&(x[i.id]={keyBinding:r,command:i,invocation:o}),l
}function w(e,t,n,i,o){this.commandRegistry=o,this.handler=e,this.items=t,this.userData=n,this.command=i,i.parameters&&(this.parameters=i.parameters.makeCopy()),this.id=i.id}function C(e){this._init(e)}var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",E=null,x={};return f.prototype={setProxy:function(e){this.proxy=e},setKeyBindings:function(e){this.bindings=e},_init:function(){var e=this;document.addEventListener("keydown",function(n){return p(n,function(n){var i=e.proxy,o=e.bindings;if(o&&i)for(var r=0;r<o.length;r++)o[r].match(n)&&(i.processKey({type:n.type,keyCode:n.keyCode,altKey:n.altKey,ctrlKey:n.ctrlKey,metaKey:n.metaKey,shiftKey:n.shiftKey}),t.stop(n))})})}},window.document.addEventListener("keydown",p,!1),w.prototype={collectsParameters:function(){return this.commandRegistry&&this.commandRegistry.collectsParameters()},makeCopy:function(e){var t=new w(this.handler,this.items,this.userData,this.command,this.commandRegistry);return t.domNode=this.domNode,t.domParent=this.domParent,e?t.parameters=e.makeCopy():this.parameters&&(t.parameters=this.parameters.makeCopy()),t}},w.prototype.constructor=w,C.prototype={_init:function(e){this.id=e.id,this.name=e.name,this.tooltip=e.tooltip,this.callback=e.callback,this.hrefCallback=e.hrefCallback,this.choiceCallback=e.choiceCallback,this.positioningNode=e.positioningNode,this.image=e.image||b,this.imageClass=e.imageClass,this.addImageClassToElement=e.addImageClassToElement,this.selectionClass=e.selectionClass,this.spriteClass=e.spriteClass||"commandSprite",this.visibleWhen=e.visibleWhen,this.parameters=e.parameters,this.isEditor=e.isEditor},populateChoicesMenu:function(e,n,i,o,r){var s=this.getChoices(n,i,o),a=s.some(function(e){return e.checked});s.forEach(function(i){if(i.name){var o=document.createElement("li");e.appendChild(o);var s=document.createElement("span");if(s.tabIndex=0,s.role="menuitem",s.classList.add("dropdownMenuItem"),a){var d=document.createElement("span");d.classList.add("check"),d.appendChild(document.createTextNode(i.checked?"●":"")),s.appendChild(d)}var l=document.createTextNode(i.name);s.appendChild(l),o.appendChild(s),s.choice=i,s.addEventListener("click",function(e){e.target.choice&&e.target.choice.callback.call(e.target.choice,n)},!1),s.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&e.target.choice&&e.target.choice.callback.call(e.target.choice,n)},!1)}else r._generateMenuSeparator(e)})},getChoices:function(e,t,n){return this.choiceCallback?this.choiceCallback.call(t,e,n):null},makeChoiceCallback:function(e,t){return function(n){e.callback&&e.callback.call(e,t,n)}},hasImage:function(){return this.imageClass||this.image!==b}},C.prototype.constructor=C,{Command:C,CommandInvocation:w,createDropdownMenu:g,createCheckedMenuItem:v,createCommandItem:_,createCommandMenuItem:y,executeBinding:l,setKeyBindingProvider:d,localKeyBindings:x,CommandsProxy:f,getKeyBindings:h,processKey:u,NO_IMAGE:b,_testMethodProcessKey:c}}),define("orion/explorers/explorer",["i18n!orion/nls/messages","require","orion/webui/littlelib","orion/webui/treetable","orion/explorers/explorerNavHandler","orion/commands"],function(e,t,n,i,o,r){var s={};return s.Explorer=function(){function e(e,t,n,i){this.registry=e,this.renderer=n,this.selection=t,this.commandService=i,this.renderer&&(this.renderer.explorer=this),this.myTree=null}return e.prototype={destroy:function(){this._navHandler&&this._navHandler.destroy(),this.model&&this.model.destroy(),this.myTree&&this.myTree.destroy(),this.destroyed=!0},changedItem:function(e,t){this.myTree&&this.myTree.refresh.bind(this.myTree)(e,t,!0)},updateCommands:function(e){this.myTree&&this.myTree._renderer.updateCommands.bind(this.myTree._renderer)(e)},makeNewItemPlaceholder:function(e,t,n){var i=null,o=this.getRow(e);if(o){var r=o.parentNode,s=document.createElement("tr");s.id=t+"placeHolderRow",s.classList.add("navRow");var a=document.createElement("td");if(a.id=t+"placeHolderCol",a.classList.add("navColumn"),s.appendChild(a),n){var d=o.nextSibling;r.insertBefore(s,d)}else r.insertBefore(s,o);a.style.paddingLeft=o.firstChild.style.paddingLeft,i={wrapperNode:s,refNode:a,destroyFunction:function(){try{s&&s.parentNode&&s.parentNode.removeChild(s)}catch(e){}}}}return i},getRow:function(e){var t=this.model.getId(e);return t?n.node(t):void 0},collapseAll:function(){for(var e=this._navHandler.getTopLevelNodes(),t=0;t<e.length;t++)this.myTree.collapse(e[t])},expandAll:function(e){if(e)this._expandRecursively(e);else{if(!this._navHandler)return;for(var t=this._navHandler.getTopLevelNodes(),n=0;n<t.length;n++)this._expandRecursively(t[n])}},_expandRecursively:function(e){if(this._navHandler&&this._navHandler.isExpandable(e)){var t=this;this.myTree.expand(e,function(){t.model.getChildren(e,function(e){if(void 0!==e&&null!==e)for(var n=e.length,i=0;n>i;i++)t._expandRecursively(e[i])})})}},createTree:function(e,t,r){e="string"==typeof e?e:e.id||e,this.selection&&this.selection.setSelections([]),this.getNavHandler()&&this.getNavHandler()._clearSelection();var s=e+"innerTree",a=n.node(s);a&&n.empty(a),t&&(t.rootId=s),this.model=t,this._parentId=e,this._treeOptions=r;var d=!r||r&&!r.noSelection;d&&(this.selectionPolicy=r?r.selectionPolicy:"",this._navDict=new o.ExplorerNavDict(this.model)),this.myTree=new i.TableTree({id:s,model:t,parent:e,onComplete:r?r.onComplete:void 0,labelColumnIndex:this.renderer.getLabelColumnIndex(),renderer:this.renderer,showRoot:r?!!r.showRoot:!1,indent:r?r.indent:void 0,onCollapse:r?r.onCollapse:void 0,navHandlerFactory:r?r.navHandlerFactory:void 0,tableElement:r?r.tableElement:void 0,tableBodyElement:r?r.tableBodyElement:void 0,tableRowElement:r?r.tableRowElement:void 0}),this.renderer._initializeUIState(),"cursorOnly"===this.selectionPolicy&&this.initNavHandler()},getNavHandler:function(){return this._navHandler},getNavDict:function(){return this._navDict},refreshSelection:function(){if(this.selection){var e=this.getNavHandler(),t=[];if(e&&this.getNavDict())for(var n=e.getSelection(),i=0;i<n.length;i++){var o=e.getRowDiv(n[i]);if(o&&o.parentNode){var r=this.getNavDict().getValue(this.model.getId(n[i]));r.model&&t.push(r.model)}}this.selection.setSelections(t)}},getRootPath:function(){return this.model&&this.model.root?this.model.root.Location:null},initNavHandler:function(){var e=this._treeOptions,t=!e||e&&!e.noSelection;if(t){if(!this.getNavHandler())if(e&&e.navHandlerFactory&&"function"==typeof e.navHandlerFactory.createNavHandler)this._navHandler=e.navHandlerFactory.createNavHandler(this,this._navDict,e);else{var n=e?e.getChildrenFunc:null;this._navHandler=new o.ExplorerNavHandler(this,this._navDict,{getChildrenFunc:n,setFocus:e&&e.setFocus,selectionPolicy:e?e.selectionPolicy:null})}var i=this;this.model.getRoot(function(t){t instanceof Array?i.getNavHandler().refreshModel(i.getNavDict(),i.model,t):t.children&&t.children instanceof Array&&i.getNavHandler().refreshModel(i.getNavDict(),i.model,t.children),e&&e.setFocus&&i.getNavHandler().cursorOn(null,!1,!1,!0)})}},_lastHash:null,checkbox:!1},e}(),s.createExplorerCommands=function(t,n){function i(e){return"function"==typeof e.getItemCount&&e.getItemCount()>0?n?n(e):!0:!1}var o=new r.Command({tooltip:e["Expand all"],imageClass:"core-sprite-expandAll",id:"orion.explorer.expandAll",groupId:"orion.explorerGroup",visibleWhen:function(e){return i(e)},callback:function(e){e.items.expandAll()}}),s=new r.Command({tooltip:e["Collapse all"],imageClass:"core-sprite-collapseAll",id:"orion.explorer.collapseAll",groupId:"orion.explorerGroup",visibleWhen:function(e){return i(e)},callback:function(e){e.items.collapseAll()}});t.addCommand(o),t.addCommand(s)},s.ExplorerModel=function(){function e(e,t,n){this.rootPath=e,this.fetchItems=t,this.idPrefix=n||""}return e.prototype={destroy:function(){this.destroyed=!0},getRoot:function(e){var t=this;this.fetchItems(this.rootPath).then(function(n){t.root=n,e(n)})},getChildren:function(e,t){e.Children?t(e.Children):e.ChildrenLocation?this.fetchItems(e.ChildrenLocation).then(function(n){e.Children=n,t(n)}):t([])},getId:function(e){if(e.Location===this.root.Location)return this.rootId;for(var t=e.Location.replace(/[\\\/]/g,""),n=this.idPrefix,i=0;i<t.length;i++)n+=t[i].match(/[^\.\:\-\_0-9A-Za-z]/g)?t.charCodeAt(i):t[i];return n}},e}(),s.ExplorerFlatModel=function(){function e(e,t,n){this.rootPath=e,this.fetchItems=t,this.root=n}return e.prototype=new s.ExplorerModel,e.prototype.getRoot=function(e){if(this.root)e(this.root);else{var t=this;this.fetchItems(this.rootPath).then(function(n){t.root=n,e(n)})}},e.prototype.getChildren=function(e,t){t(e===this.root?this.root:[])},e}(),s.ExplorerRenderer=function(){function e(e,t){this.explorer=t,this._init(e),this._expandImageClass="core-sprite-openarrow",this._collapseImageClass="core-sprite-closedarrow",this._progressImageClass="core-sprite-progress",this._twistieSpriteClass="modelDecorationSprite"}return e.prototype={_init:function(e){e&&(this._useCheckboxSelection=void 0===e.checkbox?!1:e.checkbox,this.selectionPolicy=e.singleSelection?"singleSelection":"",this._cachePrefix=e.cachePrefix,e.getCheckedFunc&&(this.getCheckedFunc=e.getCheckedFunc),e.onCheckedFunc&&(this.onCheckedFunc=e.onCheckedFunc),this._noRowHighlighting=e.noRowHighlighting,this._highlightSelection=!0,this._treeTableClass=e.treeTableClass||"treetable",e.highlightSelection===!1&&(this._highlightSelection=!1),this.actionScopeId||(this.actionScopeId=e.actionScopeId),this.commandService||(this.commandService=e.commandService))},getLabelColumnIndex:function(){return this.explorer.checkbox?1:0},initTable:function(e,t){this.tableTree=t,this.tableNode=e,n.empty(e),this._treeTableClass&&e.classList.add(this._treeTableClass),this.renderTableHeader(e)},getActionsColumn:function(e,t,n,i,o){n=n||"tool";var r=document.createElement("td");return r.id=t.id+"actionswrapper",i&&r.classList.add(i),this.actionScopeId&&this.commandService?this.commandService.renderCommands(this.actionScopeId,r,e,this.explorer,n,null,o&&this.explorer.getNavDict()?this.explorer.getNavDict().getGridNavHolder(e,!0):null):window.console.log("Warning, no command service or action scope was specified.  No commands rendered."),r},initCheckboxColumn:function(){if(this._useCheckboxSelection){var e=document.createElement("th");return e}},getCheckboxColumn:function(e,t){if(this._useCheckboxSelection){var n=document.createElement("td"),i=document.createElement("span");i.id=this.getCheckBoxId(t.id),i.classList.add("core-sprite-check"),i.classList.add("selectionCheckmarkSprite"),i.rowId=t.id,this.getCheckedFunc&&(i.checked=this.getCheckedFunc(e),i.checked?(this._highlightSelection&&t.classList.add("checkedRow"),i.classList.add("core-sprite-check_on")):(this._highlightSelection&&t.classList.remove("checkedRow"),i.classList.remove("core-sprite-check_on"))),n.appendChild(i);var o=this;return i.addEventListener("click",function(n){var i=n.target.checked?!1:!0;o.onCheck(t,n.target,i,!0,!1,e)},!1),n}},getCheckBoxId:function(e){return e+"selectedState"},onCheck:function(e,t,n,i,o,r){t.checked=n,n?t.classList.add("core-sprite-check_on"):t.classList.remove("core-sprite-check_on"),this.onCheckedFunc&&this.onCheckedFunc(t.rowId,n,i,r),this.explorer.getNavHandler()&&o&&this.explorer.getNavHandler().setSelection(this.explorer.getNavDict().getValue(e.id).model,!0)},storeSelections:function(){if(this.explorer.getNavHandler()){var e=this.explorer.getNavHandler().getSelectionIds(),t=this._getUIStatePreferencePath();t&&window.sessionStorage&&(window.sessionStorage[t+"selection"]=JSON.stringify(e))}},_restoreSelections:function(e){var t=this.explorer.getNavDict(),i=this.explorer.getNavHandler();if(i&&t&&"cursorOnly"!==i.getSelectionPolicy()){var o=window.sessionStorage[e+"selection"];"string"==typeof o&&(o=o.length>0?JSON.parse(o):null);var r;if(o){var s=[];for(r=0;r<o.length;r++){var a=t.getValue(o[r]);if(a&&a.rowDomNode&&a.model){s.push(a.model),this._highlightSelection&&a.rowDomNode.classList.add("checkedRow");var d=n.node(this.getCheckBoxId(a.rowDomNode.id));d&&(d.checked=!0,d.classList.add("core-sprite-check_on"))}}this.explorer.selection&&(this.explorer.selection.setSelections(s),this.explorer.getNavHandler()&&this.explorer.getNavHandler().refreshSelection())}}},_storeExpansions:function(e){window.sessionStorage[e+"expanded"]=JSON.stringify(this._expanded)},_restoreExpansions:function(e){var t=!1,i=window.sessionStorage[e+"expanded"];"string"==typeof i&&(i=i.length>0?JSON.parse(i):null);var o;if(i)for(o=0;o<i.length;o++){var r=n.node(i[o]);if(r){this._expanded.push(i[o]);var s=this;this.tableTree.expand(i[o],function(){s._restoreSelections(e)}),t=!0}}return!t},_getUIStatePreferencePath:function(){if(this.explorer){var e=this.explorer.getRootPath();if(this._cachePrefix&&e){var t=e.replace(/[^\.\:\-\_0-9A-Za-z]/g,"");return"/"+this._cachePrefix+"/"+t+"/uiState"}}return null},expandCollapseImageId:function(e){return e+"__expand"},updateExpandVisuals:function(e,t){var i=n.node(this.expandCollapseImageId(e.id));i&&(i.classList.remove(this._expandImageClass),i.classList.remove(this._collapseImageClass),i.classList.remove(this._progressImageClass),i.classList.add("progress"===t?this._progressImageClass:t?this._expandImageClass:this._collapseImageClass))},getExpandImage:function(e,t,n,i){var o=document.createElement("span");if(o.id=this.expandCollapseImageId(e.id),t.appendChild(o),o.classList.add(this._twistieSpriteClass),o.classList.add(this._collapseImageClass),n){var r=document.createElement("span");t.appendChild(r),r.classList.add(i||"imageSprite"),r.classList.add(n)}var s=this;return o.onclick=function(){if(!s.explorer.getNavHandler().isDisabled(e)){s.tableTree.toggle(e.id);var t=s.tableTree.isExpanded(e.id);if(t)s._expanded.push(e.id),s.explorer.postUserExpand&&s.explorer.postUserExpand(e.id);else for(var n in s._expanded)if(s._expanded[n]===e.id){s._expanded.splice(n,1);break}var i=s._getUIStatePreferencePath();i&&window.sessionStorage&&s._storeExpansions(i)}},o},render:function(e,t){t.classList.add("navRow"),this.renderRow(e,t)},rowsChanged:function(){if("cursorOnly"!==this.explorer.selectionPolicy&&(this.explorer.refreshSelection(),this.explorer.initNavHandler()),!this._noRowHighlighting){var e="darkSectionTreeTableRow",t="lightSectionTreeTableRow";(n.$(".sectionTreeTable",this.tableNode.parentNode)||n.$(".treetable",this.tableNode.parentNode))&&n.$$array(".treeTableRow",this.tableNode).forEach(function(n,i){var o=i%2?e:t,r=o===t?e:t;n.classList.add(o),n.classList.remove(r)})}},updateCommands:function(){if(this.commandService)for(var e=n.$$array(".treeTableRow"),t=0;t<e.length;t++){var i=e[t],o=i.id+"actionswrapper",r=n.node(o);this.commandService.destroy(r),this.actionScopeId&&this.commandService.renderCommands(this.actionScopeId,r,i._item,this.explorer,"tool")}},_initializeUIState:function(){this._expanded=[];var e=this._getUIStatePreferencePath();e&&window.sessionStorage&&this._restoreExpansions(e)&&this._restoreSelections(e)}},e}(),s.SelectionRenderer=function(){function e(e,t){this._init(e),this.explorer=t}return e.prototype=new s.ExplorerRenderer,e.prototype.renderTableHeader=function(e){var t=document.createElement("thead"),n=document.createElement("tr");t.classList.add("navTableHeading"),this._useCheckboxSelection&&n.appendChild(this.initCheckboxColumn(e));for(var i=0,o=this.getCellHeaderElement(i);o;)o.innerHTML.length>0&&o.classList.add("navColumn"),n.appendChild(o),o=this.getCellHeaderElement(++i);t.appendChild(n),i>0&&e.appendChild(t)},e.prototype.renderRow=function(e,t){if(t.verticalAlign="baseline",t.classList.add("treeTableRow"),void 0===e.selectable||e.selectable){var n=this.explorer.getNavDict();if(n){"cursorOnly"!==this.explorer.selectionPolicy&&t.classList.add("selectableNavRow"),n.addRow(e,t);var i=this;t.addEventListener("click",function(t){i.explorer.getNavHandler()&&i.explorer.getNavHandler().onClick(e,t)},!1)}var o=this.getCheckboxColumn(e,t);o&&(o.classList.add("checkColumn"),t.appendChild(o))}for(var r=0,s=this.getCellElement(r,e,t);s;)t.appendChild(s),s.classList.add(0===r?this.getPrimColumnStyle?this.getPrimColumnStyle(e):"navColumn":this.getSecondaryColumnStyle?this.getSecondaryColumnStyle():"secondaryColumn"),s=this.getCellElement(++r,e,t)},e.prototype.getCellHeaderElement=function(){},e.prototype.getCellElement=function(){},e}(),s.SimpleFlatModel=function(){function e(e,t,n){this.items=e,this.getKey=n,this.idPrefix=t,this.root={children:e}}return e.prototype=new s.ExplorerModel,e.prototype.getRoot=function(e){e(this.root)},e.prototype.getId=function(e){for(var t=this.getKey(e),n=t.replace(/[\\\/]/g,""),i="",o=0;o<n.length;o++)i+=n[o].match(/[^\.\:\-\_0-9A-Za-z]/g)?n.charCodeAt(o):n[o];return this.idPrefix+i},e.prototype.getChildren=function(e,t){t(e===this.root?this.items:[])},e}(),s}),define("orion/objects",[],function(){function e(e){for(var t=Object.prototype.hasOwnProperty,n=1,i=arguments.length;i>n;n++){var o=arguments[n];for(var r in o)t.call(o,r)&&(e[r]=o[r])}return e}return{clone:function(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var n=Object.create(Object.getPrototypeOf(t));return e(n,t),n},mixin:e,toArray:function(e){return Array.isArray(e)?e:[e]}}}),define("edit/content/jsonExplorer",["orion/explorers/explorer","orion/objects","orion/uiUtils","orion/Deferred","orion/webui/littlelib"],function(e,t,n,i,o){function r(e){this._root={key:"json",value:e,id:"json"},this._id="json"}function s(e,t){this._init(e),this.options=e,this.explorer=t}function a(e){this.checkbox=!1,this.parentId=e.parentId,this.update=e.update;var t=this,i=o.node(this.parentId);i.addEventListener("click",function(e){function i(e){if(r.isValue){var n=e;if("null"===e)n=null;else if("true"===e)n=!0;else if("false"===e)n=!1;else if(e.charAt(0)>="0"&&e.charAt(0)<="9")try{n=parseInt(e)}catch(i){}else if('"'===e.charAt(0)||"'"===e.charAt(0))n=e.substring(1,e.length-1);else if("{"===e.charAt(0)||"["===e.charAt(0))try{n=JSON.parse(e)}catch(i){}l.parent.value[l.key]=n,t.update(l)}else l.parent.value[e]||(l.parent.value[e]=l.value,delete l.parent.value[l.key],t.update({key:e,value:l.value,id:l.parent.id+"-"+e,parent:l.parent}))}var r=e.target;if(r.isKey||r.isValue){var s=r,a=s,d=s.id+"EditBox";if(o.node(d))return;for(;a&&!a._item;)a=a.parentNode;var l=a._item,c=r.textContent;n.getUserText({id:d,refNode:r,hideRefNode:!0,initialText:c,onComplete:i})}})}return r.prototype={getRoot:function(e){e(this._root)},getChildren:function(e,t){if(e.children)return void t(e.children);var n=[],i=e.value;if(Array.isArray(i))for(var o=0;o<i.length;o++)n.push({key:String(o),value:i[o],id:e.id+"-"+o,parent:e});else"object"==typeof i&&i&&Object.keys(i).sort().forEach(function(t){n.push({key:t,value:i[t],id:e.id+"-"+t,parent:e})});e.children=n,t(n)},getId:function(e){return e.id}},s.prototype=new e.SelectionRenderer,t.mixin(s.prototype,{labelColumnIndex:0,emptyCallback:function(e){var t=this.explorer.emptyMessage;if(t){var n=document.createElement("tr"),i=document.createElement("td");i.colSpan=3;var o=document.createElement("div");o.classList.add("emptyJSON"),o.appendChild(document.createTextNode(t)),i.appendChild(o),n.appendChild(i),e.appendChild(n)}},getCellElement:function(e,t,n){var i,o;switch(e){case 0:if(i=document.createElement("td"),Array.isArray(t.value)||"object"==typeof t.value)i.noWrap=!0,this.getExpandImage(n,i);else{var r=document.createElement("scan");r.classList.add("typeimage"),"number"==typeof t.value?r.classList.add("numbertype"):"boolean"==typeof t.value?r.classList.add("booleantype"):"string"==typeof t.value&&r.classList.add("stringtype"),i.appendChild(r)}return o=document.createElement("span"),i.appendChild(o),o.isKey=t.parent&&!Array.isArray(t.parent.value),o.appendChild(document.createTextNode(t.key)),o.classList.add("tablelabel"),i;case 1:i=document.createElement("td"),o=document.createElement("span");var s="";return null===t.value?s="null":void 0===t.value?s="undefined":Array.isArray(t.value)||"object"==typeof t.value?Array.isArray(t.value)?s="[]":"object"==typeof t.value&&(s="{}"):s=t.value,o.isValue=!0,o.appendChild(document.createTextNode(s)),i.appendChild(o),o.classList.add("tablelabel"),i;case 2:i=document.createElement("td"),o=document.createElement("span");var a="object";return Array.isArray(t.value)?a="array":"number"==typeof t.value?a="number":"boolean"==typeof t.value?a="boolean":"string"==typeof t.value&&(a="string"),o.appendChild(document.createTextNode(a)),i.appendChild(o),i}}}),a.prototype=new e.Explorer,t.mixin(a.prototype,{display:function(e){this.json=e,o.empty(this.parentId),this.renderer=new s({},this),this.createTree(this.parentId,new r(e||{}),{selectionPolicy:"cursorOnly"})},expandItem:function(e){var t=new i;return this.showItem(e).then(function(e){this.myTree.isExpanded(e)?t.resolve(e):this.myTree.expand(this.model.getId(e),function(){t.resolve(e)})}.bind(this),t.reject),t},reveal:function(e){return this.showItem(e).then(function(e){var t=this.getNavHandler();return t&&t.cursorOn(e,!0),e}.bind(this))},showItem:function(e){var t=new i,n=this.getRow(e);if(n)t.resolve(n._item||e);else if(e.parent)return this.expandItem(e.parent).then(function(){var t=this.getRow(e);return t?t._item||e:(new i).reject()}.bind(this));return t}}),{JSONExplorer:a}}),define("orion/keyBinding",["orion/util"],function(e){function t(e,t,n,i,o,r){this.type=r||"keydown",this.keyCode="string"==typeof e&&"keydown"===this.type?e.toUpperCase().charCodeAt(0):e,this.mod1=void 0!==t&&null!==t?t:!1,this.mod2=void 0!==n&&null!==n?n:!1,this.mod3=void 0!==i&&null!==i?i:!1,this.mod4=void 0!==o&&null!==o?o:!1}function n(e){this.keys=e}return t.prototype={getKeys:function(){return[this]},match:function(t,n){if(void 0!==n){if(0!==n)return!1}else if(t instanceof Array){if(t.length>1)return!1;t=t[0]}if(t.type!==this.type)return!1;if(this.keyCode===t.keyCode||this.keyCode===String.fromCharCode(e.isOpera?t.which:void 0!==t.charCode?t.charCode:t.keyCode)){var i=e.isMac?t.metaKey:t.ctrlKey;return this.mod1!==i?!1:"keydown"===this.type&&this.mod2!==t.shiftKey?!1:this.mod3!==t.altKey?!1:e.isMac&&this.mod4!==t.ctrlKey?!1:!0}return!1},equals:function(e){return e?this.keyCode!==e.keyCode?!1:this.mod1!==e.mod1?!1:this.mod2!==e.mod2?!1:this.mod3!==e.mod3?!1:this.mod4!==e.mod4?!1:this.type!==e.type?!1:!0:!1}},n.prototype={getKeys:function(){return this.keys.slice(0)},match:function(e,t){var n=this.keys;if(void 0!==t)return t>n.length?!1:n[t].match(e)?t===n.length-1?!0:t+1:!1;if(e instanceof Array||(e=[e]),e.length>n.length)return!1;var i;for(i=0;i<e.length;i++)if(!n[i].match(e[i]))return!1;return i===n.length?!0:i},equals:function(e){if(!e.keys)return!1;if(e.keys.length!==this.keys.length)return!1;for(var t=0;t<e.keys.length;t++)if(!e.keys[t].equals(this.keys[t]))return!1;return!0}},{KeyBinding:t,KeyStroke:t,KeySequence:n}}),define("edit/content/jsonEditorPlugin",["orion/plugin","edit/content/jsonExplorer","orion/Deferred","orion/commands","orion/keyBinding","orion/webui/littlelib"],function(e,t,n,i,o){function r(e,t){return c?(d=e,l=t,c.setText(JSON.stringify(a,null,"	"))):(new n).reject()}function s(){c&&c.getText().then(function(e){a={},h||(h=new t.JSONExplorer({parentId:document.body,update:r}));try{a=JSON.parse(e)}catch(n){h.emptyMessage="Error parsing JSON text: "+n.message}h.display(a),d&&(l?h.expandItem(d).then(function(){h.reveal(d)}):h.reveal(d))})}var a,d,l,c,h,u=new i.CommandsProxy,p="orion.editor.json",f={name:"Orion JSON Editor Plugin",version:"1.0",description:"This plugin provides editor for JSON files."},m=new e(f);m.registerService("orion.edit.editor",{setTextModel:function(e){return c=e,s(),u.setProxy(c),new n},onChanged:function(){s()},registerKeys:function(e){var t=[];e.forEach(function(e){t.push(new o.KeyBinding(e.keyCode,e.mod1,e.mod2,e.mod3,e.mod4))}),u.setKeyBindings(t)}},{id:p,nameKey:"Orion JSON Editor",nls:"orion/nls/messages",uriTemplate:"../edit/edit.html#{,Location,params*},editor="+p}),m.registerService("orion.navigate.openWith",{},{editor:p,contentType:["application/json"]}),m.registerService("orion.edit.command",{run:function(){for(var e,t="NewKey",n="NewValue",i=h.getNavHandler().currentModel()||h.model._root;i;){if(e=i.value,Array.isArray(e))t=e.length+"",e.push(n);else{if("object"!=typeof e){i=i.parent;continue}e[t]=n}r({key:t,value:n,id:i.id+"-"+t,parent:i});break}return null}},{name:"Add",contentTypes:["application/json"],editor:p,key:["a",!0]}),m.registerService("orion.edit.command",{run:function(){var e=h.getNavHandler().currentModel();if(e){var t=e.parent.value;Array.isArray(t)?t.splice(e.key,1):delete t[e.key],r(e.parent,!0)}return null}},{name:"Delete",contentTypes:["application/json"],editor:p,key:[46]}),m.connect()});