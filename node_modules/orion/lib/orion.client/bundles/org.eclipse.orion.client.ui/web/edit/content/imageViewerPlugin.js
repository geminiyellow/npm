!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=r.shift();)e();s=!1}function t(e){r.push(e),s||(s=!0,a())}function n(e){return function(t){e(t)}}function i(e,t,i){try{var o=e(t),r=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof r)if(o===i.promise)i.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?i._parentCancel=s.bind(o):delete i._parentCancel,r.call(o,n(i.resolve),n(i.reject),n(i.progress))}else i.resolve(o)}catch(a){i.reject(a)}}function o(){function e(){for(var e;e=c.shift();){var t=e.deferred,n="fulfilled"===d?"resolve":"reject",o=e[n];"function"==typeof o?i(o,a,t):t[n](a)}}function n(n){delete u._parentCancel,d="rejected",a=n,c.length&&t(e)}function r(i){function s(e){return function(t){d&&"assumed"!==d||e(t)}}delete u._parentCancel;try{var l=i&&("object"==typeof i||"function"==typeof i)&&i.then;if("function"==typeof l)if(i===u)n(new TypeError);else{d="assumed";var h=i&&i.cancel;if("function"!=typeof h){var f=new o;i=f.promise;try{l(f.resolve,f.reject,f.progress)}catch(p){f.reject(p)}h=i.cancel,l=i.then}a=i,l.call(i,s(r),s(n)),u._parentCancel=h.bind(i)}else d="fulfilled",a=i,c.length&&t(e)}catch(m){s(n)(m)}}function s(){var e=u._parentCancel;if(e)delete u._parentCancel,e();else if(!d){var t=new Error("Cancel");t.name="Cancel",n(t)}}var a,d,c=[],u=this;this.resolve=function(e){return d||r(e),u},this.reject=function(e){return d||n(e),u},this.progress=function(e){return d||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),u.promise},this.cancel=function(){return u._parentCancel?setTimeout(s,0):s(),u},this.then=function(n,i,r){var s=new o;return s._parentCancel=u.promise.cancel,c.push({resolve:n,reject:i,progress:r,deferred:s}),("fulfilled"===d||"rejected"===d)&&t(e),s.promise},this.promise={then:u.then,cancel:u.cancel}}var r=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),i=new MutationObserver(e);return i.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function n(e,t){a||(s[e]=t,0===--r&&d.resolve(s))}function i(e,i){if(!a){if(t)try{return void n(e,t(i))}catch(o){i=o}d.reject(i)}}var r=e.length,s=[],a=!1,d=new o;return d.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===r?d.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),i.bind(void 0,t))}),d.promise},o.when=function(e,t,n,i){var r,s;return e&&"function"==typeof e.then?r=e:(s=new o,s.resolve(e),r=s.promise),r.then(t,n,i)},o}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function n(n){function i(e){f&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),f===self?f.postMessage(e):f.postMessage(e,"*"))}function o(){var e=[];return Object.keys(y).forEach(function(t){var n=y[t];e.push({serviceId:t,names:n.names,methods:n.methods,properties:n.properties})}),{headers:l||{},services:e}}function r(e,t){if(t&&t instanceof XMLHttpRequest){var n,i;try{n=t.status,i=t.statusText}catch(o){n=0,i=""}return{status:n||0,statusText:i}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,r)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(n){if(!f)return(new e).reject(new Error("plugin not connected"));n.id=String(p++);var i=new e;_[n.id]=i,i.then(null,function(e){h&&e instanceof Error&&"Cancel"===e.name&&b({requestId:n.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return n.params.forEach(function(e,r){if("[object Object]"===o.call(e)&&!(e instanceof t)){var s,a;for(s in e)"[object Function]"===o.call(e[s])&&(a=a||[],a.push(s));if(a){var d=m++;w[d]=e;var c=function(){delete w[d]};i.then(c,c),n.params[r]=new t(d,a)}}}),b(n),i.promise}function d(e,t){e||0===e?b({id:e,result:null,error:t}):console.log(t)}function c(e,t,n,i){i.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var n={};e.__methods.forEach(function(t){n[t]=function(){return a({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),i[t]=n}});var o=void 0===typeof e?null:{id:e,result:null,error:null};try{var r=n.apply(t,i);if(!o)return;r&&"function"==typeof r.then?(v[e]=r,r.then(function(t){delete v[e],o.result=t,b(o)},function(t){v[e]&&(delete v[e],o.error=s(t),b(o))},function(){b({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=r,b(o))}catch(d){o&&(o.error=s(d),b(o))}}function u(e){if(e.source===f||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var n=t.method,i=t.params||[];if("serviceId"in t){var o=y[t.serviceId];o||d(t.id,"service not found"),o=o.implementation,n in o?c(t.id,o,o[n],i):d(t.id,"method not found")}else if("objectId"in t){var r=w[t.objectId];r||d(t.id,"object not found"),!n in r?c(t.id,r,r[n],i):d(t.id,"method not found")}else if("requestId"in t){var s=v[t.requestId];s&&"cancel"===n&&s.cancel&&s.cancel.apply(s,i)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var a=_[t.responseId];a&&"progress"===n&&a.progress&&a.progress.apply(a,i)}}else{var u=_[String(t.id)];delete _[String(t.id)],t.error?u.reject(t.error):u.resolve(t.result)}}catch(l){console.log("Plugin._messageHandler "+l)}}}var l=n,h=!1,f=null,p=0,m=0,g=0,v={},_={},w={},y={},b=i;this.updateHeaders=function(e){if(h)throw new Error("Cannot update headers. Plugin Provider is connected");l=e},this.registerService=function(e,t,n){if(h)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var i=null,o=[];for(i in t)"function"==typeof t[i]&&o.push(i);y[g++]={names:e,methods:o,implementation:t,properties:n||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(h)return void(e&&e());if("undefined"==typeof window)f=self;else if(window!==window.parent)f=window.parent;else{if(null===window.opener)return void(t&&t("No valid plugin target"));f=window.opener}addEventListener("message",u,!1);var n={method:"plugin",params:[o()]};i(n),h=!0,e&&e()},this.disconnect=function(){h&&(removeEventListener("message",u),f=null,h=!1)}}return n}),define("orion/util",[],function(){function e(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,n){return t[(n<<0)+1]})}function t(e,t){return e.createElementNS?e.createElementNS(_,t):e.createElement(t)}var n=navigator.userAgent,i=-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?document.documentMode:void 0,o=parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0,r=-1!==n.indexOf("Opera")?parseFloat(n.split("Version/")[1]):void 0,s=parseFloat(n.split("Chrome/")[1])||void 0,a=-1!==n.indexOf("Safari")&&!s,d=parseFloat(n.split("WebKit/")[1])||void 0,c=-1!==n.indexOf("Android"),u=-1!==n.indexOf("iPad"),l=-1!==n.indexOf("iPhone"),h=u||l,f=-1!==navigator.platform.indexOf("Mac"),p=-1!==navigator.platform.indexOf("Win"),m=-1!==navigator.platform.indexOf("Linux"),g="undefined"!=typeof document&&"ontouchstart"in document.createElement("input"),v=p?"\r\n":"\n",_="http://www.w3.org/1999/xhtml";return{formatMessage:e,createElement:t,isIE:i,isFirefox:o,isOpera:r,isChrome:s,isSafari:a,isWebkit:d,isAndroid:c,isIPad:u,isIPhone:l,isIOS:h,isMac:f,isWindows:p,isLinux:m,isTouch:g,platformDelimiter:v}}),define("orion/webui/littlelib",["orion/util"],function(e){function t(e,t){return t||(t=document),t.querySelector(e)}function n(e,t){return t||(t=document),t.querySelectorAll(e)}function i(e,t){return Array.prototype.slice.call(n(e,t))}function o(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function r(e,t){if(!e||!t)return!1;if(e===t)return!0;var n=e.compareDocumentPosition(t);return Boolean(16&n)}function s(e){var t=e.getBoundingClientRect();return{left:t.left+document.documentElement.scrollLeft,top:t.top+document.documentElement.scrollTop,width:t.width,height:t.height}}function a(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}}function d(t){var n=t.tabIndex;if(0===n&&e.isIE){var i={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0};i[t.nodeName.toLowerCase()]||t.attributes.tabIndex||(n=-1)}return n}function c(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=c(e.childNodes[t]);if(n)return n}return null}function u(e){if(d(e)>=0)return e;if(e.hasChildNodes())for(var t=e.childNodes.length-1;t>=0;t--){var n=u(e.childNodes[t]);if(n)return n}return null}function l(e,t){if(3===e.nodeType){var n=b.exec(e.nodeValue);n&&n.length>1&&t(e,n)}if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++)l(e.childNodes[i],t)}function h(e,t){l(e,function(e,n){var i=t[n[1]]||n[1];e.parentNode.replaceChild(document.createTextNode(i),e)})}function f(e,t){l(e,function(e,n){var i=t[n[1]];if(i){var o=document.createRange(),r=n.index;o.setStart(e,r),o.setEnd(e,r+n[0].length),o.deleteContents(),o.insertNode(i)}})}function p(t,n){function i(e){C.forEach(function(t){var n=!1,i=t.excludeNodes.some(function(t){return document.body.contains(t)?(n=!0,t.contains(e.target)):!1});if(n&&!i)try{t.dismiss(e)}catch(o){"undefined"!=typeof console&&console&&console.error(o&&o.message)}}),C=C.filter(function(e){return e.excludeNodes.some(function(e){return document.body.contains(e)})})}null===C&&(C=[],document.addEventListener("click",i,!0),e.isIOS&&document.addEventListener("touchend",function(e){function t(){e.target.removeEventListener("click",t)}0===e.touches.length&&e.target.addEventListener("click",t)},!1)),C.push({excludeNodes:t,dismiss:n})}function m(e){C=C.filter(function(t){return e!==t.dismiss})}function g(e){for(var t=e.parentNode,n=document.documentElement;t&&t!==n;){var i=window.getComputedStyle(t,null);if(!i)break;var o=i.getPropertyValue("overflow-y");if("auto"===o||"scroll"===o)break;t=t.parentNode}return t}function v(e){window.document.all&&(e.keyCode=0),e.preventDefault&&(e.preventDefault(),e.stopPropagation())}function _(e){for(var t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++)t[n].parentNode.style.pointerEvents=e?"":"none"}function w(e){return k[e]||null}function y(e,t){var n=t,i=null;return void 0===n&&(n=document.createElement("div")),n.innerHTML=e,i=1<n.childNodes.length?n.childNodes:n.firstChild}var b=/\$\{([^\}]+)\}/,C=null,E={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46},k=Object.create(null);return Object.keys(E).forEach(function(e){k[E[e]]=e}),{$:t,$$:n,$$array:i,node:o,contains:r,bounds:s,empty:a,firstTabbable:c,lastTabbable:u,stop:v,processTextNodes:h,processDOMNodes:f,addAutoDismiss:p,setFramesEnabled:_,getOffsetParent:g,removeAutoDismiss:m,keyName:w,KEY:E,createNodes:y}}),define("orion/EventTarget",[],function(){function e(){this._namedListeners={}}return e.prototype={dispatchEvent:function(e){if(!e.type)throw new Error("unspecified type");var t=this._namedListeners[e.type];return t&&t.forEach(function(t){try{"function"==typeof t?t(e):t.handleEvent(e)}catch(n){"undefined"!=typeof console&&console.log(n)}}),!e.defaultPrevented},addEventListener:function(e,t){("function"==typeof t||t.handleEvent)&&(this._namedListeners[e]=this._namedListeners[e]||[],this._namedListeners[e].push(t))},removeEventListener:function(e,t){var n=this._namedListeners[e];if(n)for(var i=0;i<n.length;i++)if(n[i]===t){1===n.length?delete this._namedListeners[e]:n.splice(i,1);break}}},e.prototype.constructor=e,e.attach=function(t){var n=new e;t.dispatchEvent=n.dispatchEvent.bind(n),t.addEventListener=n.addEventListener.bind(n),t.removeEventListener=n.removeEventListener.bind(n)},e}),define("orion/webui/dropdown",["orion/webui/littlelib","orion/EventTarget"],function(e,t){function n(e){t.attach(this),this._init(e)}function i(e,t){t=void 0===t?"span":t;var n=document.createElement(t);n.tabIndex=0,n.className="dropdownMenuItem",n.role="menuitem";var i=document.createElement("span");i.appendChild(document.createTextNode(e)),i.classList.add("dropdownCommandName"),n.appendChild(i);var o=document.createElement("li");return o.appendChild(n),o}function o(){var e=document.createElement("li");return e.classList.add("dropdownSeparator"),e}function r(e,t){var n=document.createElement("span");n.classList.add("dropdownKeyBinding"),n.appendChild(document.createTextNode(t)),e.appendChild(n)}return n.prototype={_init:function(t){if(this._dropdownNode=e.node(t.dropdown),!this._dropdownNode)throw"no dom node for dropdown found";if(this._populate=t.populate,this._selectionClass=t.selectionClass,this._parentDropdown=t.parentDropdown,this._positioningNode=t.positioningNode,!this._parentDropdown)for(var n=this._dropdownNode.parentNode;n&&document!==n;){if(n.classList&&n.classList.contains("dropdownMenu")){this._parentDropdown=n.dropdown;break}n=n.parentNode}if(this._dropdownNode.tabIndex=0,this._triggerNode=t.triggerNode?t.triggerNode:e.$(".dropdownTrigger",this._dropdownNode.parentNode),!this._triggerNode)throw"no dom node for dropdown trigger found";var i=function(t){var n=!1;n=this._triggerNode.classList.contains("dropdownMenuItem")?this.open(t):this.toggle(t),n&&e.stop(t)}.bind(this);t.skipTriggerEventListeners||(this._triggerNode.addEventListener("click",i,!1),"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",function(t){(t.keyCode===e.KEY.ENTER||t.keyCode===e.KEY.SPACE)&&i(t)}.bind(this),!1)),this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(t){var n=this;t.addEventListener("click",function(t){n.toggle(t)&&e.stop(t)},!1)},toggle:function(e){return this.isVisible()?this.close():this.open(e)},isVisible:function(){return this._isVisible},open:function(t){var n=!1;if(!this.isVisible()){this.dispatchEvent({type:"triggered",dropdown:this,event:t}),e.setFramesEnabled(!1),this._populate&&(this.empty(),this._populate(this._dropdownNode));var i=this.getItems();if(i.length>0){this._boundAutoDismiss&&e.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=this._autoDismiss.bind(this);var o=e.$$array(".dropdownSubMenu",this._dropdownNode);e.addAutoDismiss([this._triggerNode].concat(o),this._boundAutoDismiss),this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),this._dropdownNode.classList.add("dropdownMenuOpen"),this._isVisible=!0,this._positionDropdown(t),this._focusDropdownNode(),n=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this)}}return n},_focusDropdownNode:function(){this._dropdownNode.focus()},_autoDismiss:function(e){if(this.close(!1)&&this._dropdownNode.contains(e.target))for(var t=this._parentDropdown;t;)t.close(!1),t=t._parentDropdown},_positionDropdown:function(){if(this._dropdownNode.style.left="",this._dropdownNode.style.top="",this._positioningNode)return void(this._dropdownNode.style.left=this._positioningNode.offsetLeft+"px");var t=e.bounds(this._dropdownNode),n=e.bounds(document.body);if(t.left+t.width>n.left+n.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-t.width+"px";else{var i=e.bounds(this._boundingNode(this._triggerNode)),o=e.bounds(this._triggerNode);this._dropdownNode.style.left=o.left-i.left-t.width+o.width+"px"}var r=t.top+t.height-(n.top+n.height);r>0&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-r)+"px")},_boundingNode:function(e){var t=window.getComputedStyle(e,null);if(null===t)return e;var n=t.getPropertyValue("position");return"absolute"!==n&&e.parentNode&&e!==document.body?this._boundingNode(e.parentNode):e},close:function(t){var n=!1;return this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),e.setFramesEnabled(!0),t&&this._triggerNode.focus(),this._isVisible=!1,this._selectedItem&&(this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=null),this._boundAutoDismiss&&(e.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null),n=!0),n},getItems:function(){var t=e.$$array("li:not(.dropdownSeparator) > .dropdownMenuItem",this._dropdownNode,!0),n=[],i=this;return t.forEach(function(e){e.parentNode.parentNode===i._dropdownNode&&n.push(e)}),n.forEach(function(t){t._hasDropdownMouseover||(t.addEventListener("mouseover",function(n){t.dropdown?t.dropdown.open(n):(i._closeSelectedSubmenu(),e.stop(n)),i._selectItem(t)}),t._hasDropdownMouseover=!0)}),n},empty:function(){var t=e.$$array("li",this._dropdownNode),n=this;t.forEach(function(e){e.parentNode===n._dropdownNode&&e.parentNode.removeChild(e)})},_dropdownKeyDown:function(t){if(t.keyCode===e.KEY.UP||t.keyCode===e.KEY.DOWN||t.keyCode===e.KEY.RIGHT||t.keyCode===e.KEY.ENTER||t.keyCode===e.KEY.LEFT){var n=this.getItems();if(n.length&&n.length>0){if(this._selectedItem){var i=n.indexOf(this._selectedItem);0>i&&(i=n.indexOf(this._selectedItem.parentNode)),i>=0&&(t.keyCode===e.KEY.UP&&i>0?(i--,this._selectItem(n[i])):t.keyCode===e.KEY.DOWN&&i<n.length-1?(i++,this._selectItem(n[i])):t.keyCode===e.KEY.ENTER||t.keyCode===e.KEY.RIGHT?this._selectedItem.classList.contains("dropdownTrigger")&&this._selectedItem.dropdown?(this._selectedItem.dropdown.open(),this._selectedItem.dropdown._selectItem()):t.keyCode===e.KEY.ENTER&&this._selectedItem.click():t.keyCode===e.KEY.LEFT&&this._selectedItem.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&(this.close(!0),this._parentDropdown&&this._parentDropdown._dropdownNode.focus()))}else this._selectItem(n[0]);e.stop(t)}}else t.keyCode===e.KEY.ESCAPE&&(this.close(!0),e.stop(t))},_selectItem:function(e){var t=e||this.getItems()[0];t&&(this._selectedItem&&this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=t,this._selectedItem.classList.add("dropdownMenuItemSelected")),document.activeElement!==this._dropdownNode&&this._dropdownNode.focus()},submenuOpen:function(e){e!==this._selectedSubmenu&&(this._closeSelectedSubmenu(),this._selectedSubmenu=e)},_closeSelectedSubmenu:function(){for(var e=this._selectedSubmenu;e;)e.close(),e=e._selectedSubmenu},destroy:function(){this.empty(),this._boundAutoDismiss&&(e.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null)},appendMenuItem:function(e,t){var n=i(e,t);return this._dropdownNode.appendChild(n),n},appendSeparator:function(){var e=o();return this._dropdownNode.appendChild(e),e}},n.prototype.constructor=n,{Dropdown:n,appendKeyBindingString:r,createMenuItem:i,createSeparator:o}}),define("text",["module"],function(e){var t,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,a=s&&location.protocol&&location.protocol.replace(/\:/,""),d=s&&location.hostname,c=s&&(location.port||void 0),u=[],l=e.config&&e.config()||{};return t={version:"2.0.5",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(r);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:l.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(o){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,i,o=!1,r=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!s||r>1)?(t=e.substring(0,r),n=e.substring(r+1,e.length)):t=e,i=n||t,r=i.indexOf("!"),-1!==r&&(o="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:t=i),{moduleName:t,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,o){var r,s,a,d=t.xdRegExp.exec(e);return d?(r=d[2],s=d[3],s=s.split(":"),a=s[1],s=s[0],!(r&&r!==n||s&&s.toLowerCase()!==i.toLowerCase()||(a||s)&&a!==o)):!0},finishLoad:function(e,n,i,o){i=n?t.strip(i):i,l.isBuild&&(u[e]=i),o(i)},load:function(e,n,i,o){if(o.isBuild&&!o.inlineText)return void i();l.isBuild=o.isBuild;var r=t.parseName(e),u=r.moduleName+(r.ext?"."+r.ext:""),h=n.toUrl(u),f=l.useXhr||t.useXhr;!s||f(h,a,d,c)?t.get(h,function(n){t.finishLoad(e,r.strip,n,i)},function(e){i.error&&i.error(e)}):n([u],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)})},write:function(e,n,i){if(u.hasOwnProperty(n)){var o=t.jsEscape(u[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,o,r){var s=t.parseName(n),a=s.ext?"."+s.ext:"",d=s.moduleName+a,c=i.toUrl(s.moduleName+a)+".js";t.load(d,i,function(){var n=function(e){return o(c,e)};n.asModule=function(e,t){return o.asModule(e,c,t)},t.write(e,d,n,r)},r)}},"node"===l.env||!l.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),t.get=function(e,t){var i=n.readFileSync(e,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),t(i)}):"xhr"===l.env||!l.env&&t.createXhr()?t.get=function(e,n,i,o){var r,s=t.createXhr();if(s.open("GET",e,!0),o)for(r in o)o.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),o[r]);l.onXhr&&l.onXhr(s,e),s.onreadystatechange=function(){var t,o;4===s.readyState&&(t=s.status,t>399&&600>t?(o=new Error(e+" HTTP status: "+t),o.xhr=s,i(o)):n(s.responseText))},s.send(null)}:("rhino"===l.env||!l.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var n,i,o="utf-8",r=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),o)),d="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);d=String(n.toString())}finally{a.close()}t(d)}),t}),define("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'<button class="dropdownTrigger">${ButtonText}<!--span class="dropdownArrowDown core-sprite-openarrow"></span--></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'<button class="dropdownTrigger dropdownDefaultButton">${ButtonText}<span class="dropdownArrowDown core-sprite-openarrow"></span></button><ul class="dropdownMenu"></ul>'}),define("text!orion/webui/checkedmenuitem.html",[],function(){return'<li><label class="dropdownMenuItem"><input class="checkedMenuItem" role="menuitem" type="checkbox" />${ItemText}</label></li>'}),define("orion/webui/tooltip",["orion/webui/littlelib"],function(e){function t(e){this._init(e)}return t.prototype={_init:function(t){if(this._node=e.node(t.node),!this._node)throw"no dom node for tooltip found";this._position=t.position||["right","above","below","left"],this._text=t.text,this._hideDelay=void 0===t.hideDelay?200:t.hideDelay,this._tailSize=t.tailSize||10,this._trigger=t.trigger||"mouseover",this._afterShowing=t.afterShowing,this._afterHiding=t.afterHiding;var n=this;if("click"===this._trigger)this._showDelay=0,this._node.addEventListener("click",this._clickHandler=function(t){t.target===n._node&&(n.show(),e.stop(t))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===t.showDelay?500:t.showDelay;var i=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(t){e.contains(n._node,t.target)&&(n.show(),e.stop(t))},!1),this._leaveHandler=function(t){e.contains(n._node,t.target)&&n.hide()};for(var o=0;o<i.length;o++)this._node.addEventListener(i[o],this._leaveHandler,!1)}else"focus"===this._trigger&&(this._showDelay=void 0===t.showDelay?0:t.showDelay,this._hideDelay=void 0===t.hideDelay?0:t.hideDelay,this._node.addEventListener("focus",this._focusHandler=function(t){e.contains(n._node,t.target)&&n.show()},!1),this._blurHandler=function(t){e.contains(n._node,t.target)&&n.hide()},this._node.addEventListener("blur",this._blurHandler,!1))},_makeTipNode:function(){if(!this._tip){if(this._tip=document.createElement("span"),this._tip.classList.add("tooltipContainer"),this._tipInner=document.createElement("div"),this._tipInner.classList.add("tooltip"),this._text){this._tipTextContent=document.createElement("div"),this._tipTextContent.classList.add("textContent"),this._tipInner.appendChild(this._tipTextContent);var t=document.createTextNode(this._text);this._tipTextContent.appendChild(t)}this._tip.appendChild(this._tipInner),document.body.appendChild(this._tip);var n=this;e.addAutoDismiss([this._tip,this._node],function(){n.hide()}),"mouseover"===this._trigger&&(this._tipInner.role="tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(){n._timeout&&(window.clearTimeout(n._timeout),n._timeout=null),n._tip.addEventListener("mouseout",function(t){e.contains(n._tip,t.target)&&(n.hide(),e.stop(t))},!1)},!1))}return this._tip},_positionTip:function(t,n){this._makeTipNode(),"left"===t?this._tipInner.classList.add("left"):this._tipInner.classList.remove("left");var i,o=this._node;for(i=e.bounds(o);o&&!i.width&&!i.height;o=o.parentNode)i=e.bounds(o);var r,s,a=e.bounds(this._tipInner);switch(t){case"above":r=i.top-a.height-this._tailSize-1,s=i.left-this._tailSize;break;case"below":r=i.top+i.height+this._tailSize+1,s=i.left-this._tailSize;break;case"left":r=i.top-this._tailSize/2,s=i.left-a.width-this._tailSize-1;break;default:r=i.top-this._tailSize/2,s=i.left+i.width+this._tailSize+1}var d=e.bounds(document.documentElement);if(r+a.height>d.height){if(!n)return!1;r=d.height-a.height-1}if(s+a.width>d.width){if(!n)return!1;s=d.width-a.width-1}if(0>s){if(!n)return!1;s=4}if(0>r){if(!n)return!1;r=4}return this._tail&&this._tail.previousPosition!==t&&(this._tip.removeChild(this._tail),this._tail=null),this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+t),"above"===t||"left"===t?this._tip.appendChild(this._tail):this._tip.insertBefore(this._tail,this._tipInner),this._tail.previousPosition=t),this._tip.style.top=r+"px",this._tip.style.left=s+"px",!0},contentContainer:function(){return this._makeTipNode(),this._tipInner},isShowing:function(){return this._tip&&this._tip.classList.contains("tooltipShowing")},show:function(){this.isShowing()||(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=window.setTimeout(this._showImmediately.bind(this),this._showDelay):this._showImmediately())},_showImmediately:function(){for(var e=!1,t=0;!e&&t<this._position.length;)e=this._positionTip(this._position[t]),t++;e||this._positionTip(this._position[0],!0),this._tip.classList.add("tooltipShowing"),this._afterShowing&&this._afterShowing()},hide:function(e){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this.isShowing()){void 0===e&&(e=this._hideDelay);var t=this;this._timeout=window.setTimeout(function(){t._tip.classList.remove("tooltipShowing"),t._tip.removeAttribute("style"),t._afterHiding&&t._afterHiding()},e)}},destroy:function(){if(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._tip&&(document.body.removeChild(this._tip),this._tip=null,this._tipInner=null,this._tipTextContent=null,this._tail=null),this._node){this._node.removeEventListener("click",this._clickHandler,!1),this._node.removeEventListener("mouseover",this._mouseoverHandler,!1),this._node.removeEventListener("focus",this._focusHandler,!1),this._node.removeEventListener("blur",this._blurHandler,!1);for(var e=["mouseout","click"],t=0;t<e.length;t++)this._node.removeEventListener(e[t],this._leaveHandler,!1)}}},t.prototype.constructor=t,{Tooltip:t}}),define("orion/commands",["orion/util","orion/webui/littlelib","orion/webui/dropdown","text!orion/webui/dropdowntriggerbutton.html","text!orion/webui/dropdowntriggerbuttonwitharrow.html","text!orion/webui/checkedmenuitem.html","orion/webui/tooltip"],function(e,t,n,i,o,r,s){function a(e){C=e}function d(e){var t=e.invocation;if(t){var n=e.command;if(n.hrefCallback){var i=n.hrefCallback.call(t.handler||window,t);return i.then?i.then(function(e){window.open(e)}):window.open(i),!0}if(t.commandRegistry)return t.commandRegistry._invoke(t),!0;if(n.onClick||n.callback)return window.setTimeout(function(){(n.onClick||n.callback).call(t.handler||window,t)},0),!0}return!1}function c(e,n){for(var i in n)if(n[i]&&n[i].keyBinding&&n[i].command&&n[i].keyBinding.match(e)){var o=n[i],r=o.keyBinding;if((!r.domScope||t.contains(t.node(r.domScope),e.target))&&d(o))return void t.stop(e)}}function u(){var e={};if(C){var t,n,i;for(n=Object.keys(E),t=0;t<n.length;t++)i=n[t],e[i]=E[i];var o=C();for(n=Object.keys(o),t=0;t<n.length;t++)i=n[t],e[i]=o[i]}else e=E;return e}function l(e){c(e,u())}function h(t,n){function i(t){if(e.isMac){if(t.metaKey&&!t.altKey)return t.shiftKey||t.ctrlKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.ctrlKey)return!1}else{if(t.ctrlKey&&!t.altKey)return t.shiftKey||65!==t.keyCode&&67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode&&90!==t.keyCode?!1:!0;if(t.altKey&&!t.ctrlKey)return!1;if(t.ctrlKey&&t.altKey)return!1}if(t["char"])return t["char"].length>0;if(t.charCode||t.keyCode){var n=t.charCode||t.keyCode;switch(n){case 8:case 9:case 13:case 46:return!0;default:return n>=32&&112>n||n>123}}return!1}if(t=t||window.event,i(t)){if("true"===t.target.contentEditable)return;var o=t.target.nodeName.toLowerCase();if("input"===o){var r=t.target.type.toLowerCase();switch(r){case"text":case"password":case"search":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"range":case"tel":case"time":case"url":case"week":return}}else if("textarea"===o)return}n?n(t):l(t)}function f(){this._init()}function p(e,t,n){t.classList.add("commandImage");var i;return e.imageClass?e.addImageClassToElement?t.classList.add(e.imageClass):(i=document.createElement("span"),t.appendChild(i),i.classList.add(e.spriteClass),i.classList.add(e.imageClass)):(i=new Image,i.alt=e.name,i.name=n,i.id=n,i.src=e.image,t.appendChild(i)),i}function m(e,r,s,a,d,c,u,l,h,f){if(e=t.node(e),!e)throw"no parent node was specified";var m=document.createRange();m.selectNode(e);var g=m.createContextualFragment(h?o:i);t.processTextNodes(g,{ButtonText:r}),e.appendChild(g);var v,_,w=e.lastChild;return h?(v=w.previousSibling,_=v.lastChild):v=w.previousSibling,a?v.classList.add(a):(v.classList.add("orionButton"),v.classList.add("commandButton")),f&&f.split(" ").forEach(v.classList.add.bind(v.classList)),d&&(c||(v.textContent="",v.setAttribute("aria-label",r)),p({spriteClass:"commandSprite",imageClass:d},v,r),v.classList.add("orionButton")),v.dropdown=new n.Dropdown({dropdown:w,populate:s,selectionClass:u,skipTriggerEventListeners:!!_,positioningNode:l}),w.dropdown=v.dropdown,{menuButton:v,menu:w,dropdown:v.dropdown,dropdownArrow:_}}function g(e,n,i,o){if(e=t.node(e),!e)throw"no parent node was specified";var s=document.createRange();s.selectNode(e);var a=s.createContextualFragment(r);t.processTextNodes(a,{ItemText:n}),e.appendChild(a);var d=e.lastChild,c=t.$(".checkedMenuItem",d);return c.checked=i,c.addEventListener("change",o,!1),c}function v(e,n,i,o,r,a,d){var c,u;
a=a||!n.name&&n.hasImage();var l=function(){if(a)n.hasImage()?(p(n,c,o),n.name&&c.setAttribute("aria-label",n.name)):(c.classList.add("commandButton"),c.classList.add("commandMissingImageButton"),c.appendChild(document.createTextNode(n.name)));else{c.classList.add("commandButton");var e=document.createTextNode(n.name);c.appendChild(e)}};if(n.hrefCallback){c=u=document.createElement("a"),c.id=o,a&&n.hasImage()?p(n,c,o):(c.className="commandLink",c.appendChild(document.createTextNode(n.name)));var h=n.hrefCallback.call(i.handler,i);h.then?h.then(function(e){c.href=e}):c.href=h?h:"#"}else{if("switch"===n.type){c=document.createElement("div"),c.tabIndex=0,c.className="orionSwitch";var f=u=document.createElement("input");f.type="checkbox",f.className="orionSwitchCheck",f.id="orionSwitchCheck"+n.id,e.id&&(f.id=f.id+e.id),c.appendChild(f);var m=document.createElement("label");m.className="orionSwitchLabel",m.setAttribute("for",f.id);var g=document.createElement("span");g.className="orionSwitchInner";var v=document.createElement("span");v.className="orionSwitchSwitch",m.appendChild(g),m.appendChild(v),c.appendChild(m),c.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&f.click()},!1),f.checked=n.checked,g.classList.add(n.imageClass)}else"toggle"===n.type?(c=u=document.createElement("button"),c.className="orionButton",c.classList.add(n.checked?"orionToggleOn":"orionToggleOff"),c.id="orionToggle"+n.id,e.id&&(c.id=c.id+e.id),l()):(c=u=document.createElement("button"),c.className="orionButton",n.extraClass&&c.classList.add(n.extraClass),l());var _=d||n.callback;if(_){var w=function(){_.call(i.handler,i)};n.onClick=_,u.addEventListener("click",function(e){var t;t="switch"===n.type||"toggle"===n.type?function(e){"toggle"===n.type?(e&&(n.checked=!n.checked),n.checked?(c.classList.remove("orionToggleOff"),c.classList.add("orionToggleOn"),c.classList.add("orionToggleAnimate")):(c.classList.remove("orionToggleOn"),c.classList.add("orionToggleOff"),c.classList.add("orionToggleAnimate"))):e?n.checked=f.checked:f.checked=!f.checked,e&&window.setTimeout(w,250)}:function(e){e&&w()},n.preCallback?n.preCallback(i).then(function(e){t(e)}):t(!0),e.stopPropagation()},!1)}}if("ul"===e.nodeName.toLowerCase()){var y=document.createElement("li");e.appendChild(y),e=y}else c.classList.add("commandMargins");return e.appendChild(c),n.tooltip&&(c.commandTooltip=new s.Tooltip({node:c,text:n.tooltip,position:["above","below","right","left"]})),r&&(E[n.id]={keyBinding:r,command:n,invocation:i}),c}function _(e,i,o,r,a,d){var c,u,l=e.dropdown;if(i.hrefCallback){u=n.createMenuItem(i.name,"a"),c=u.firstElementChild;var h=i.hrefCallback.call(o.handler,o);h.then?h.then(function(e){c.href=e}):c.href=h?h:"#",c.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&c.click()},!1)}else{u=n.createMenuItem(i.name),c=u.firstElementChild;var f=a||i.callback;f&&(i.onClick=f,c.addEventListener("click",function(){l.close(!0),f.call(o.handler,o)},!1),c.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&(e.preventDefault(),c.click())},!1))}return i.tooltip&&(c.commandTooltip=new s.Tooltip({node:c,text:i.tooltip,position:["above","below","right","left"]})),d&&n.appendKeyBindingString(c,d),e.appendChild(u),r&&(E[i.id]={keyBinding:r,command:i,invocation:o}),c}function w(e,t,n,i,o){this.commandRegistry=o,this.handler=e,this.items=t,this.userData=n,this.command=i,i.parameters&&(this.parameters=i.parameters.makeCopy()),this.id=i.id}function y(e){this._init(e)}var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",C=null,E={};return f.prototype={setProxy:function(e){this.proxy=e},setKeyBindings:function(e){this.bindings=e},_init:function(){var e=this;document.addEventListener("keydown",function(n){return h(n,function(n){var i=e.proxy,o=e.bindings;if(o&&i)for(var r=0;r<o.length;r++)o[r].match(n)&&(i.processKey({type:n.type,keyCode:n.keyCode,altKey:n.altKey,ctrlKey:n.ctrlKey,metaKey:n.metaKey,shiftKey:n.shiftKey}),t.stop(n))})})}},window.document.addEventListener("keydown",h,!1),w.prototype={collectsParameters:function(){return this.commandRegistry&&this.commandRegistry.collectsParameters()},makeCopy:function(e){var t=new w(this.handler,this.items,this.userData,this.command,this.commandRegistry);return t.domNode=this.domNode,t.domParent=this.domParent,e?t.parameters=e.makeCopy():this.parameters&&(t.parameters=this.parameters.makeCopy()),t}},w.prototype.constructor=w,y.prototype={_init:function(e){this.id=e.id,this.name=e.name,this.tooltip=e.tooltip,this.callback=e.callback,this.preCallback=e.preCallback,this.hrefCallback=e.hrefCallback,this.choiceCallback=e.choiceCallback,this.positioningNode=e.positioningNode,this.image=e.image||b,this.imageClass=e.imageClass,this.addImageClassToElement=e.addImageClassToElement,this.extraClass=e.extraClass,this.selectionClass=e.selectionClass,this.spriteClass=e.spriteClass||"commandSprite",this.visibleWhen=e.visibleWhen,this.parameters=e.parameters,this.isEditor=e.isEditor,this.type=e.type,this.checked=e.checked,this.track=e.track},populateChoicesMenu:function(e,n,i,o,r){var s=this.getChoices(n,i,o),a=s.some(function(e){return e.checked});s.forEach(function(i){if(i.name){var o=document.createElement("li");e.appendChild(o);var s=document.createElement("span");if(s.tabIndex=0,s.role="menuitem",s.classList.add("dropdownMenuItem"),a){var d=document.createElement("span");d.classList.add("check"),d.appendChild(document.createTextNode(i.checked?"●":"")),s.appendChild(d)}var c=document.createTextNode(i.name);s.appendChild(c),o.appendChild(s),s.choice=i,s.addEventListener("click",function(e){e.target.choice&&e.target.choice.callback.call(e.target.choice,n)},!1),s.addEventListener("keydown",function(e){(e.keyCode===t.KEY.ENTER||e.keyCode===t.KEY.SPACE)&&e.target.choice&&e.target.choice.callback.call(e.target.choice,n)},!1)}else r._generateMenuSeparator(e)})},getChoices:function(e,t,n){return this.choiceCallback?this.choiceCallback.call(t,e,n):null},makeChoiceCallback:function(e,t){return function(n){e.callback&&e.callback.call(e,t,n)}},hasImage:function(){return this.imageClass||this.image!==b}},y.prototype.constructor=y,{Command:y,CommandInvocation:w,createDropdownMenu:m,createCheckedMenuItem:g,createCommandItem:v,createCommandMenuItem:_,executeBinding:d,setKeyBindingProvider:a,localKeyBindings:E,CommandsProxy:f,getKeyBindings:u,processKey:l,NO_IMAGE:b,_testMethodProcessKey:c}}),define("orion/keyBinding",["orion/util"],function(e){function t(e,t,n,i,o,r){this.type=r||"keydown",this.keyCode="string"==typeof e&&"keydown"===this.type?e.toUpperCase().charCodeAt(0):e,this.mod1=void 0!==t&&null!==t?t:!1,this.mod2=void 0!==n&&null!==n?n:!1,this.mod3=void 0!==i&&null!==i?i:!1,this.mod4=void 0!==o&&null!==o?o:!1}function n(e){this.keys=e}return t.prototype={getKeys:function(){return[this]},match:function(t,n){if(void 0!==n){if(0!==n)return!1}else if(t instanceof Array){if(t.length>1)return!1;t=t[0]}if(t.type!==this.type)return!1;if(this.keyCode===t.keyCode||this.keyCode===String.fromCharCode(e.isOpera?t.which:void 0!==t.charCode?t.charCode:t.keyCode)){var i=e.isMac?t.metaKey:t.ctrlKey;return this.mod1!==i?!1:"keydown"===this.type&&this.mod2!==t.shiftKey?!1:this.mod3!==t.altKey?!1:e.isMac&&this.mod4!==t.ctrlKey?!1:!0}return!1},equals:function(e){return e?this.keyCode!==e.keyCode?!1:this.mod1!==e.mod1?!1:this.mod2!==e.mod2?!1:this.mod3!==e.mod3?!1:this.mod4!==e.mod4?!1:this.type!==e.type?!1:!0:!1}},n.prototype={getKeys:function(){return this.keys.slice(0)},match:function(e,t){var n=this.keys;if(void 0!==t)return t>n.length?!1:n[t].match(e)?t===n.length-1?!0:t+1:!1;if(e instanceof Array||(e=[e]),e.length>n.length)return!1;var i;for(i=0;i<e.length;i++)if(!n[i].match(e[i]))return!1;return i===n.length?!0:i},equals:function(e){if(!e.keys)return!1;if(e.keys.length!==this.keys.length)return!1;for(var t=0;t<e.keys.length;t++)if(!e.keys[t].equals(this.keys[t]))return!1;return!0}},{KeyBinding:t,KeyStroke:t,KeySequence:n}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function n(e){return 0===e.length?"":e.join("&")}function i(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),n=t[1]?decodeURIComponent(t[1]):"",i=t[2]?decodeURIComponent(t[2]):"";return[n,i]}function o(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function r(e,n){var o="",r=[],s=0;return{next:function(){if(o!==e.query&&(o=e.query,r=t(o)),s<r.length){var a=i(r[s++]);switch(n){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw T}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var n=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=n+e.path}}else e.path=t.path}function d(e){return e.toLowerCase()}function c(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function u(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function l(e){e.scheme&&(e.scheme=d(e.scheme)),e.port&&(e.port=c(e.port)),e.host&&e.path&&(e.path=u(e.path))}function h(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function f(e,t){if("string"!=typeof e)throw new TypeError;e=h(e);var n=_.exec(e);if(!n)return null;var i={};if(i.scheme=n[1]||"",i.scheme&&!b.test(i.scheme))return null;var o=n[2];if(o){var r=w.exec(o);if(i.userinfo=r[1],i.host=r[2],i.port=r[3],i.port&&!C.test(i.port))return null}return i.path=n[3],i.query=n[4],i.fragment=n[5],a(i,t),l(i),i}function p(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function m(e,t){var n;if(t){if(t=t.href||t,n=f(t),!n||!n.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:n})}var i=f(e,n);if(!i)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:i,writable:!0});var o=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?o:null},enumerable:!0})}try{var g;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(g=new window.URL("http://www.w3.org?q")).protocol&&g.query)return}catch(v){}var _=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,w=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,y=/^\S*$/,b=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,C=/^\d*$/,E=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,k=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,N=/^([^?#\s]*)$/,L=/^([^\s]*)$/,x=y,I=/([^:]*):?(.*)/,T="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),S={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(n){e(n);var o,r=t(this._url.query);return r.some(function(e){var t=i(e);return t[0]===n?(o=t[1],!0):void 0}),o},enumerable:!0},set:{value:function(r,s){e(r),e(s);var a=t(this._url.query),d=a.some(function(e,t){var n=i(e);return n[0]===r?(n[1]=s,a[t]=o(n),!0):void 0});d||a.push(o([r,s])),this._url.query=n(a)},enumerable:!0},has:{value:function(n){e(n);var o=t(this._url.query);return o.some(function(e){var t=i(e);return t[0]===n?!0:void 0})},enumerable:!0},"delete":{value:function(o){e(o);var r=t(this._url.query),s=r.filter(function(e){var t=i(e);return t[0]!==o});return s.length!==r.length?(this._url.query=n(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var n=r(this._url,"keys+values");try{for(;;){var i=n.next();e.call(t,i[1],i[0],this)}}catch(o){if(o!==T)throw o}},enumerable:!0},keys:{value:function(){return r(this._url,"keys")},enumerable:!0},values:{value:function(){return r(this._url,"values")},enumerable:!0},items:{value:function(){return r(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(n){e(n);var o=[],r=t(this._url.query);return r.forEach(function(e){var t=i(e);t[0]===n&&o.push(t[1])}),o},enumerable:!0},append:{value:function(i,r){e(i),e(r);var s=t(this._url.query);s.push(o([i,r])),this._url.query=n(s)},enumerable:!0}}),Object.defineProperties(m.prototype,{href:{get:function(){return this._url?p(this._url):this._input},set:function(t){e(t),this._input=t,this._url=f(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var n=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===n||b.test(n))&&(this._url.scheme=d(n))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=I.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var n=I.exec(this._userinfo),i=[encodeURIComponent(t||"")];n[2]&&i.push(n[2]),this._userinfo=i.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=I.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var n=I.exec(this._userinfo),i=[n[1]||""];t&&i.push(encodeURIComponent(t)),this._userinfo=i.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var n=k.exec(t);n&&(this._url.host=n[1],this._url.port=c(n[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var n=E.exec(t);n&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===S[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var n=C.exec(t);n&&(this._url.port=c(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var n=N.exec(t);n&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?u(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var n=L.exec(t);n&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var n=x.exec(t);n&&(this._url.fragment=t)}},enumerable:!0}});var A=window.URL||window.webkitURL;A&&A.createObjectURL&&(Object.defineProperty(m,"createObjectURL",{value:A.createObjectURL.bind(A),enumerable:!1}),Object.defineProperty(m,"revokeObjectURL",{value:A.revokeObjectURL.bind(A),enumerable:!1})),window.URL=m}(),define("orion/URL-shim",function(){}),define("edit/content/imageViewerPlugin",["orion/plugin","orion/Deferred","orion/commands","orion/keyBinding","orion/webui/littlelib","orion/URL-shim"],function(e,t,n,i,o){function r(){if(u){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,n=e-2*a,i=t-2*d;c>n&&(n=c),c>i&&(i=c);var r=l>0&&h>0?l/h:1,f=n/i;r>=f?(u.width=l>n?n:l,u.height=u.width/r):(u.height=h>i?i:h,u.width=u.height*r);var p=document.getElementById("imageContainer");p.style.left=(e-u.width)/2+"px",p.style.top=(t-u.height)/2-s+"px";var m=document.getElementById("imageTitle");o.empty(m),m.appendChild(document.createTextNode(l+" x "+h+" pixels -- "+Math.floor(u.width/l*100)+"%"))}}var s=25,a=20,d=s+a,c=20,u=null,l=c,h=c;window.onresize=r;var f=new n.CommandsProxy,p="orion.viewer.image",m={name:"Orion Image Viewer Plugin",version:"1.0",description:"This plugin provides viewer for image files."},g=new e(m);g.registerService("orion.edit.editor",{setBlob:function(e){u=document.createElement("img");var t=URL.createObjectURL(e);u.src=t,u.onload=function(){URL.revokeObjectURL(t),l=u.width,h=u.height,r()};var n=document.getElementById("imageContent");o.empty(n),n.appendChild(u)},setTextModel:function(e){return f.setProxy(e),new t},onChanged:function(){},registerKeys:function(e){var t=[];e.forEach(function(e){t.push(new i.KeyBinding(e.keyCode,e.mod1,e.mod2,e.mod3,e.mod4))}),f.setKeyBindings(t)}},{id:p,"default":!0,nameKey:"Orion Image Viewer",nls:"orion/nls/messages",uriTemplate:"../edit/edit.html#{,Location,params*},editor="+p}),g.registerService("orion.navigate.openWith",{},{editor:p,contentType:["image/gif","image/jpeg","image/ico","image/png","image/tiff","image/svg"]}),g.connect()});