!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=o.shift();)e();s=!1}function t(e){o.push(e),s||(s=!0,a())}function n(e){return function(t){e(t)}}function r(e,t,r){try{var i=e(t),o=i&&("object"==typeof i||"function"==typeof i)&&i.then;if("function"==typeof o)if(i===r.promise)r.reject(new TypeError);else{var s=i.cancel;"function"==typeof s?r._parentCancel=s.bind(i):delete r._parentCancel,o.call(i,n(r.resolve),n(r.reject),n(r.progress))}else r.resolve(i)}catch(a){r.reject(a)}}function i(){function e(){for(var e;e=u.shift();){var t=e.deferred,n="fulfilled"===c?"resolve":"reject",i=e[n];"function"==typeof i?r(i,a,t):t[n](a)}}function n(n){delete l._parentCancel,c="rejected",a=n,u.length&&t(e)}function o(r){function s(e){return function(t){c&&"assumed"!==c||e(t)}}delete l._parentCancel;try{var h=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof h)if(r===l)n(new TypeError);else{c="assumed";var f=r&&r.cancel;if("function"!=typeof f){var p=new i;r=p.promise;try{h(p.resolve,p.reject,p.progress)}catch(d){p.reject(d)}f=r.cancel,h=r.then}a=r,h.call(r,s(o),s(n)),l._parentCancel=f.bind(r)}else c="fulfilled",a=r,u.length&&t(e)}catch(v){s(n)(v)}}function s(){var e=l._parentCancel;if(e)delete l._parentCancel,e();else if(!c){var t=new Error("Cancel");t.name="Cancel",n(t)}}var a,c,u=[],l=this;this.resolve=function(e){return c||o(e),l},this.reject=function(e){return c||n(e),l},this.progress=function(e){return c||u.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),l.promise},this.cancel=function(){return l._parentCancel?setTimeout(s,0):s(),l},this.then=function(n,r,o){var s=new i;return s._parentCancel=l.promise.cancel,u.push({resolve:n,reject:r,progress:o,deferred:s}),("fulfilled"===c||"rejected"===c)&&t(e),s.promise},this.promise={then:l.then,cancel:l.cancel}}var o=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),r=new MutationObserver(e);return r.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return i.all=function(e,t){function n(e,t){a||(s[e]=t,0===--o&&c.resolve(s))}function r(e,r){if(!a){if(t)try{return void n(e,t(r))}catch(i){r=i}c.reject(r)}}var o=e.length,s=[],a=!1,c=new i;return c.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===o?c.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),r.bind(void 0,t))}),c.promise},i.when=function(e,t,n,r){var o,s;return e&&"function"==typeof e.then?o=e:(s=new i,s.resolve(e),o=s.promise),o.then(t,n,r)},i}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function n(n){function r(e){p&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),p===self?p.postMessage(e):p.postMessage(e,"*"))}function i(){var e=[];return Object.keys(_).forEach(function(t){var n=_[t];e.push({serviceId:t,names:n.names,methods:n.methods,properties:n.properties})}),{headers:h||{},services:e}}function o(e,t){if(t&&t instanceof XMLHttpRequest){var n,r;try{n=t.status,r=t.statusText}catch(i){n=0,r=""}return{status:n||0,statusText:r}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,o)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(n){if(!p)return(new e).reject(new Error("plugin not connected"));n.id=String(d++);var r=new e;y[n.id]=r,r.then(null,function(e){f&&e instanceof Error&&"Cancel"===e.name&&w({requestId:n.id,method:"cancel",params:e.message?[e.message]:[]})});var i=Object.prototype.toString;return n.params.forEach(function(e,o){if("[object Object]"===i.call(e)&&!(e instanceof t)){var s,a;for(s in e)"[object Function]"===i.call(e[s])&&(a=a||[],a.push(s));if(a){var c=v++;S[c]=e;var u=function(){delete S[c]};r.then(u,u),n.params[o]=new t(c,a)}}}),w(n),r.promise}function c(e,t){e||0===e?w({id:e,result:null,error:t}):console.log(t)}function u(e,t,n,r){r.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var n={};e.__methods.forEach(function(t){n[t]=function(){return a({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),r[t]=n}});var i=void 0===typeof e?null:{id:e,result:null,error:null};try{var o=n.apply(t,r);if(!i)return;o&&"function"==typeof o.then?(m[e]=o,o.then(function(t){delete m[e],i.result=t,w(i)},function(t){m[e]&&(delete m[e],i.error=s(t),w(i))},function(){w({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(i.result=o,w(i))}catch(c){i&&(i.error=s(c),w(i))}}function l(e){if(e.source===p||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var n=t.method,r=t.params||[];if("serviceId"in t){var i=_[t.serviceId];i||c(t.id,"service not found"),i=i.implementation,n in i?u(t.id,i,i[n],r):c(t.id,"method not found")}else if("objectId"in t){var o=S[t.objectId];o||c(t.id,"object not found"),!n in o?u(t.id,o,o[n],r):c(t.id,"method not found")}else if("requestId"in t){var s=m[t.requestId];s&&"cancel"===n&&s.cancel&&s.cancel.apply(s,r)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var a=y[t.responseId];a&&"progress"===n&&a.progress&&a.progress.apply(a,r)}}else{var l=y[String(t.id)];delete y[String(t.id)],t.error?l.reject(t.error):l.resolve(t.result)}}catch(h){console.log("Plugin._messageHandler "+h)}}}var h=n,f=!1,p=null,d=0,v=0,g=0,m={},y={},S={},_={},w=r;this.updateHeaders=function(e){if(f)throw new Error("Cannot update headers. Plugin Provider is connected");h=e},this.registerService=function(e,t,n){if(f)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var r=null,i=[];for(r in t)"function"==typeof t[r]&&i.push(r);_[g++]={names:e,methods:i,implementation:t,properties:n||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(f)return void(e&&e());if("undefined"==typeof window)p=self;else if(window!==window.parent)p=window.parent;else{if(null===window.opener)return void(t&&t("No valid plugin target"));p=window.opener}addEventListener("message",l,!1);var n={method:"plugin",params:[i()]};r(n),f=!0,e&&e()},this.disconnect=function(){f&&(removeEventListener("message",l),p=null,f=!1)}}return n}),define("orion/xhr",["orion/Deferred"],function(e){function t(e,t,n,r){var i,o="undefined"!=typeof n.response?n.response:n.responseText,s="string"==typeof o?o:null;try{i=n.status}catch(a){i=0}var c={args:t,response:o,responseText:s,status:i,url:e,xhr:n};return"undefined"!=typeof r&&(c.error=r),c}function n(n,r,i){i=i||{};var o,s=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,a=new e,c=i.headers||{},u=i.log||!1;"undefined"==typeof c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof i.data||"POST"!==n&&"PUT"!==n||(o=i.data);var l=!1,h=!1;a.promise.then(void 0,function(e){l=!0,!h&&e instanceof Error&&"Cancel"===e.name&&s.abort()}),s.onabort=function(){if(h=!0,!l){var e=new Error("Cancel");e.name="Cancel",a.reject(e)}},s.onload=function(){var e=t(r,i,s);200<=s.status&&s.status<400?a.resolve(e):(a.reject(e),u&&"undefined"!=typeof console&&console.log(new Error(s.statusText)))},s.onerror=function(){var e=t(r,i,s);a.reject(e),u&&"undefined"!=typeof console&&console.log(new Error(s.statusText))},s.onprogress=function(e){e.xhr=s,a.progress(e)};try{if(s.open(n,r,!0),"string"==typeof i.responseType&&(s.responseType=i.responseType),"number"==typeof i.timeout)if("number"==typeof s.timeout)s.timeout=i.timeout,s.addEventListener("timeout",function(){a.reject(t(r,i,s,"Timeout exceeded"))});else{var f=setTimeout(function(){a.reject(t(r,i,s,"Timeout exceeded"))},i.timeout);a.promise.then(clearTimeout.bind(null,f),clearTimeout.bind(null,f))}Object.keys(c).forEach(function(e){s.setRequestHeader(e,c[e])}),s.send(o||null)}catch(p){a.reject(t(r,i,s,p))}return a.promise}return n}),define("orion/EventTarget",[],function(){function e(){this._namedListeners={}}return e.prototype={dispatchEvent:function(e){if(!e.type)throw new Error("unspecified type");var t=this._namedListeners[e.type];return t&&t.forEach(function(t){try{"function"==typeof t?t(e):t.handleEvent(e)}catch(n){"undefined"!=typeof console&&console.log(n)}}),!e.defaultPrevented},addEventListener:function(e,t){("function"==typeof t||t.handleEvent)&&(this._namedListeners[e]=this._namedListeners[e]||[],this._namedListeners[e].push(t))},removeEventListener:function(e,t){var n=this._namedListeners[e];if(n)for(var r=0;r<n.length;r++)if(n[r]===t){1===n.length?delete this._namedListeners[e]:n.splice(r,1);break}}},e.prototype.constructor=e,e.attach=function(t){var n=new e;t.dispatchEvent=n.dispatchEvent.bind(n),t.addEventListener=n.addEventListener.bind(n),t.removeEventListener=n.removeEventListener.bind(n)},e}),define("orion/serviceregistry",["orion/Deferred","orion/EventTarget"],function(e,t){function n(e,t,n){this._properties=n||{},this._properties["service.id"]=e,this._properties.objectClass=t,this._properties["service.names"]=t}function r(e,t,n){this._serviceId=e,this._serviceReference=t,this._internalRegistry=n}function i(t,n){function r(r){return function(){var i;try{if(!n())throw new Error("Service was unregistered");var o=t[r].apply(t,Array.prototype.slice.call(arguments));if(o&&"function"==typeof o.then)return o;i=new e,i.resolve(o)}catch(s){i=new e,i.reject(s)}return i.promise}}var i;for(i in t)"function"==typeof t[i]&&(this[i]=r(i))}function o(e,t){this.type=e,this.serviceReference=t}function s(){this._entries=[],this._namedReferences={},this._serviceEventTarget=new t;var e=this;this._internalRegistry={isRegistered:function(t){return e._entries[t]?!0:!1},unregisterService:function(t){var n=e._entries[t];if(!n)throw new Error("Service has already been unregistered: "+t);var r=n.reference;e._serviceEventTarget.dispatchEvent(new o("unregistering",r)),e._entries[t]=null;var i=r.getProperty("objectClass");i.forEach(function(t){for(var n=e._namedReferences[t],i=0;i<n.length;i++)if(n[i]===r){1===n.length?delete e._namedReferences[t]:n.splice(i,1);break}})},modifyService:function(t){var n=e._entries[t];if(!n)throw new Error("Service not found while trying to send modified event: "+t);var r=n.reference;e._serviceEventTarget.dispatchEvent(new o("modified",r))}}}return n.prototype={getPropertyKeys:function(){var e,t=[];for(e in this._properties)this._properties.hasOwnProperty(e)&&t.push(e);return t},getProperty:function(e){return this._properties[e]}},n.prototype.constructor=n,r.prototype={unregister:function(){this._internalRegistry.unregisterService(this._serviceId)},getReference:function(){if(!this._internalRegistry.isRegistered(this._serviceId))throw new Error("Service has already been unregistered: "+this._serviceId);return this._serviceReference},setProperties:function(e){var t=this._serviceReference._properties;this._serviceReference._properties=e||{},e["service.id"]=this._serviceId,e.objectClass=t.objectClass,e["service.names"]=t["service.names"],this._internalRegistry.modifyService(this._serviceId)}},r.prototype.constructor=r,s.prototype={getService:function(e){var t;if("string"==typeof e){var n=this._namedReferences[e];n&&n.some(function(e){return t=this._entries[e.getProperty("service.id")].service,!!t},this)}else{var r=this._entries[e.getProperty("service.id")];r&&(t=r.service)}return t||null},getServiceReferences:function(e){if(e)return this._namedReferences[e]?this._namedReferences[e]:[];var t=[];return this._entries.forEach(function(e){e&&t.push(e.reference)}),t},registerService:function(e,t,s){if("undefined"==typeof t||null===t)throw new Error("invalid service");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var a=this._entries.length,c=new n(a,e,s),u=this._namedReferences;e.forEach(function(e){u[e]=u[e]||[],u[e].push(c)});var l=new i(t,this._internalRegistry.isRegistered.bind(null,a));this._entries.push({reference:c,service:l});var h=this._internalRegistry;return this._serviceEventTarget.dispatchEvent(new o("registered",c)),new r(a,c,h)},addEventListener:function(e,t){this._serviceEventTarget.addEventListener(e,t)},removeEventListener:function(e,t){this._serviceEventTarget.removeEventListener(e,t)}},s.prototype.constructor=s,{ServiceRegistry:s}}),define("orion/operation",["orion/xhr","orion/Deferred"],function(e,t){function n(e){return e?"loadstart"===e||"progress"===e?!0:!1:!0}function r(t){e("DELETE",t,{headers:{"Orion-Version":"1"},timeout:15e3})}function i(t){e("PUT",t,{headers:{"Orion-Version":"1"},data:JSON.stringify({abort:!0}),timeout:15e3})}function o(t,i,s,a){e("GET",t,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){var c=e.response?JSON.parse(e.response):null;return i.progress(c),n(c.type)?void setTimeout(function(){o(t,i,s,a)},2e3):("error"===c.type||"abort"===c.type?i.reject(a?a(c):c.Result):i.resolve(s?s(c):c.Result.JsonData),void(c.Location||r(t)))},function(e){var t=e;if(void 0!==e.responseText){t=e.responseText;try{t=JSON.parse(e.responseText)}catch(n){}}void 0!==t.Message?(t.HttpCode=void 0===t.HttpCode?e.status:t.HttpCode,t.Severity=void 0===t.Severity?"Error":t.Severity,i.reject(t)):i.reject({Severity:"Error",Message:t,HttpCode:e.status})})}function s(e,t){t.then(null,function(t){t instanceof Error&&"Cancel"===t.name&&i(e)})}function a(e,n,r){var i=new t;return s(e,i),o(e,i,n,r),i}return{handle:a}}),define("orion/git/gitClient",["require","orion/xhr","orion/Deferred","orion/operation"],function(e,t,n,r){var i=i||{};return i.GitService=function(){function i(e){e&&(this._serviceRegistry=e,this._serviceRegistration=e.registerService("orion.git.provider",this))}var o="application/json; charset=UTF-8";return i.prototype={checkGitService:function(){},cloneGitRepository:function(r,i,s,a,c,u,l,h,f,p,d){var v=this,g={};r&&(g.Name=r),s&&(g.Path=s),i&&(g.GitUrl=i),g.Location=a,c&&(g.GitSshUsername=c),u&&(g.GitSshPassword=u),l&&(g.GitSshKnownHost=l),h&&(g.GitSshPrivateKey=h),f&&(g.GitSshPassphrase=f),p&&(p.GitMail&&(g.GitMail=p.GitMail),p.GitName&&(g.GitName=p.GitName)),d&&(g.initProject=d);var m=e.toUrl("gitapi/clone/._");m=m.substring(0,m.length-2);var y=new n;return t("POST",m,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify(g)}).then(function(e){v._getGitServiceResponse(y,e)},function(e){v._handleGitServiceResponseError(y,e)}),y},removeGitRepository:function(e){var r=this,i=new n;return t("DELETE",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},getGitStatus:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},stage:function(e){var r=this,i=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},stageMultipleFiles:function(e,r){var i=this,s=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Path:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},unstageAll:function(e,r){var i=this,s=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Reset:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},unstage:function(e,r){var i=this,s=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Path:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},checkoutPath:function(e,r){var i=this,s=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Path:r,RemoveUntracked:"true"})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},commitAll:function(e,r,i){var s=this,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:i}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},getGitClone:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},getGitCloneConfig:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},getGitBranch:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},getGitRemote:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},checkoutBranch:function(e,r){var i=this,s=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Branch:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},resetIndex:function(e,r,i){var s=this,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Commit:r,Reset:i?i:"HARD"})}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},addBranch:function(e,r,i){var s=this,a={};r&&(a.Name=r),i&&(a.Branch=i);var c=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify(a)}).then(function(e){s._getGitServiceResponse(c,e)},function(e){s._handleGitServiceResponseError(c,e)}),c},removeBranch:function(e){var r=this,i=new n;return t("DELETE",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},addRemote:function(e,r,i){var s=this,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Remote:r,RemoteURI:i})}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},removeRemote:function(e){var r=this,i=new n;return t("DELETE",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},doGitLog:function(e){var r=this,i=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},getDiff:function(e,r){var i=this,s=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({New:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},doFetch:function(e,r,i,s,a,c,u){var l=this,h=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Fetch:"true",Force:r,GitSshUsername:i,GitSshPassword:s,GitSshKnownHost:a,GitSshPrivateKey:c,GitSshPassphrase:u})}).then(function(e){l._getGitServiceResponse(h,e)},function(e){l._handleGitServiceResponseError(h,e)}),h},doPull:function(e,r,i,s,a,c,u){var l=this,h=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Pull:"true",Force:r,GitSshUsername:i,GitSshPassword:s,GitSshKnownHost:a,GitSshPrivateKey:c,GitSshPassphrase:u})}).then(function(e){l._getGitServiceResponse(h,e)},function(e){l._handleGitServiceResponseError(h,e)}),h},doMerge:function(e,r,i){var s=this,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Merge:r,Squash:i})}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},doCherryPick:function(e,r){var i=this,s=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({"Cherry-Pick":r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},doRevert:function(e,r){var i=this,s=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Revert:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},doRebase:function(e,r,i){var s=this,a={};a.Rebase=r,i&&(a.Operation=i);var c=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify(a)}).then(function(e){s._getGitServiceResponse(c,e)},function(e){s._handleGitServiceResponseError(c,e)}),c},doPush:function(e,r,i,s,a,c,u,l,h){var f=this,p=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({PushSrcRef:r,PushTags:i,Force:s,GitSshUsername:a,GitSshPassword:c,GitSshKnownHost:u,GitSshPrivateKey:l,GitSshPassphrase:h})}).then(function(e){f._getGitServiceResponse(p,e)},function(e){f._handleGitServiceResponseError(p,e)}),p},getLog:function(e,r){var i=this,s=new n,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({New:r})}).then(function(e){a.resolve(e.xhr.getResponseHeader("Location"))},function(e){i._handleGitServiceResponseError(s,e)}),a.then(function(e){t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)})}),s},getDefaultRemoteBranch:function(e){var r=this,i=new n,s=new n;return t("GET",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(s,e)},function(e){r._handleGitServiceResponseError(i,e)}),s.then(function(e){t("GET",e.Children[0].Location,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)})}),i},doAddTag:function(e,r){var i=this,s=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Name:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},doRemoveTag:function(e){var r=this,i=new n;return t("DELETE",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},checkoutTag:function(e,r,i){var s=this,a=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Tag:r,Branch:i})}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},addCloneConfigurationProperty:function(e,r,i){var s=this,a=new n;return t("POST",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Key:r,Value:i})}).then(function(e){s._getGitServiceResponse(a,e)},function(e){s._handleGitServiceResponseError(a,e)}),a},editCloneConfigurationProperty:function(e,r){var i=this,s=new n;return t("PUT",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({Value:r})}).then(function(e){i._getGitServiceResponse(s,e)},function(e){i._handleGitServiceResponseError(s,e)}),s},deleteCloneConfigurationProperty:function(e){var r=this,i=new n;return t("DELETE",e,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json"}).then(function(e){r._getGitServiceResponse(i,e)},function(e){r._handleGitServiceResponseError(i,e)}),i},sendCommitReviewRequest:function(e,r,i,s,a,c){var u=this,l=new n;return t("POST",r,{headers:{"Orion-Version":"1","Content-Type":o},timeout:15e3,handleAs:"json",data:JSON.stringify({ReviewReqCommit:e,ReviewReqUrl:s,ReviewReqNotifyLogin:i,ReviewReqAuthorName:a,ReviewMessage:c})}).then(function(e){u._getGitServiceResponse(l,e)},function(e){u._handleGitServiceResponseError(l,e)}),l},_getGitServiceResponse:function(e,t){var n=t.response?JSON.parse(t.response):null;if(t.xhr&&202===t.xhr.status){var i=r.handle(n.Location);return i.then(e.resolve,function(t){t.failedOperation=n.Location,e.reject(t)},e.progress),void e.then(null,function(e){i.reject(e)})}e.resolve(n)},_handleGitServiceResponseError:function(e,t){e.reject(t)}},i}(),i}),define("orion/ssh/sshTools",["orion/Deferred","orion/xhr"],function(e,t){var n=n||{};return n.SshService=function(){function n(n){if(n&&(this._serviceRegistry=n,this._authService=n.getService("orion.core.auth"),this._serviceRegistration=n.registerService("orion.net.ssh",this),!this._authService)){var r;this._authService={getUser:function(){if(r){var n=new e;return n.resolve(r),n}return t("POST","../../login",{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return r=e.response?JSON.parse(e.response):null},function(e){return r=null,e instanceof Error&&"Cancel"===e.name?"_cancel":e.response?JSON.parse(e.response):null})}}}}return n.prototype={KNOWN_HOSTS:"knownHosts",addKnownHost:function(t){t=t||{};var n=new e,r=this,i=t.host,o=t.keyType,s=t.hostKey,a=t.port||22;return i&&o&&s&&a?(this._authService.getUser().then(function(e){var t=localStorage.getItem(e.login+"/"+r.KNOWN_HOSTS);t=t?JSON.parse(t):[];for(var c=0;c<t.length;++c){var u=t[c];if(u.host===i&&u.port===a)return void n.resolve(u.host+" "+u.keyType+" "+u.hostKey)}var u={host:i,port:a,keyType:o,hostKey:s};t.push(u),localStorage.setItem(e.login+"/"+r.KNOWN_HOSTS,JSON.stringify(t)),n.resolve(u.host+" "+u.keyType+" "+u.hostKey)},function(e){n.reject(e)}),n):(n.reject(),n)},clearKnownHosts:function(){var t=new e,n=this;return this._authService.getUser().then(function(e){var r=localStorage.getItem(e.login+"/"+n.KNOWN_HOSTS);r=r?JSON.parse(r):[],localStorage.removeItem(e.login+"/"+n.KNOWN_HOSTS),t.resolve(r)},function(e){t.reject(e)}),t},getKnownHostCredentials:function(t,n){var r=new e,i=this;return n=n||22,t&&n?(this._authService.getUser().then(function(e){var o=localStorage.getItem(e.login+"/"+i.KNOWN_HOSTS);o=o?JSON.parse(o):[];for(var s=0;s<o.length;++s){var a=o[s];if(a.host===t&&a.port===n)return void r.resolve(a.host+" "+a.keyType+" "+a.hostKey)}r.resolve("")},function(e){r.reject(e)}),r):(r.reject(),r)}},n}(),n}),define("orion/i18nUtil",["require","orion/Deferred"],function(e,t){function n(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,n){return t[(n<<0)+1]})}function r(e){var t=localStorage.getItem("orion/messageBundle/"+e);if(t){var n=JSON.parse(t);if(n._expires&&n._expires>(new Date).getTime())return delete n._expires,n}return null}function i(e,t){t._expires=(new Date).getTime()+9e5,localStorage.setItem("orion/messageBundle/"+e,JSON.stringify(t)),delete t._expires}function o(n){function o(t){t?e(["i18n!"+n],function(e){e&&i(n,e),c.resolve(e)}):a(new Error(n))}function a(e){c.reject(e)}if(s[n])return s[n];var c=new t;s[n]=c;var u=r(n);if(u)return c.resolve(u),c;try{e([n],o,a)}catch(l){e(["orion/i18n!"+n],o,a)}return c}var s={};return{getMessageBundle:o,formatMessage:n}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function n(e){return 0===e.length?"":e.join("&")}function r(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),n=t[1]?decodeURIComponent(t[1]):"",r=t[2]?decodeURIComponent(t[2]):"";return[n,r]}function i(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function o(e,n){var i="",o=[],s=0;return{next:function(){if(i!==e.query&&(i=e.query,o=t(i)),s<o.length){var a=r(o[s++]);switch(n){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw j}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var n=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=n+e.path}}else e.path=t.path}function c(e){return e.toLowerCase()}function u(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function l(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function h(e){e.scheme&&(e.scheme=c(e.scheme)),e.port&&(e.port=u(e.port)),e.host&&e.path&&(e.path=l(e.path))}function f(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function p(e,t){if("string"!=typeof e)throw new TypeError;e=f(e);var n=y.exec(e);if(!n)return null;var r={};if(r.scheme=n[1]||"",r.scheme&&!w.test(r.scheme))return null;var i=n[2];if(i){var o=S.exec(i);if(r.userinfo=o[1],r.host=o[2],r.port=o[3],r.port&&!R.test(r.port))return null}return r.path=n[3],r.query=n[4],r.fragment=n[5],a(r,t),h(r),r}function d(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function v(e,t){var n;if(t){if(t=t.href||t,n=p(t),!n||!n.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:n})}var r=p(e,n);if(!r)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:r,writable:!0});var i=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?i:null},enumerable:!0})}try{var g;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(g=new window.URL("http://www.w3.org?q")).protocol&&g.query)return}catch(m){}var y=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,S=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,_=/^\S*$/,w=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,R=/^\d*$/,G=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,T=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,O=/^([^?#\s]*)$/,E=/^([^\s]*)$/,C=_,b=/([^:]*):?(.*)/,j="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),P={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(n){e(n);var i,o=t(this._url.query);return o.some(function(e){var t=r(e);return t[0]===n?(i=t[1],!0):void 0}),i},enumerable:!0},set:{value:function(o,s){e(o),e(s);var a=t(this._url.query),c=a.some(function(e,t){var n=r(e);return n[0]===o?(n[1]=s,a[t]=i(n),!0):void 0});c||a.push(i([o,s])),this._url.query=n(a)},enumerable:!0},has:{value:function(n){e(n);var i=t(this._url.query);return i.some(function(e){var t=r(e);return t[0]===n?!0:void 0})},enumerable:!0},"delete":{value:function(i){e(i);var o=t(this._url.query),s=o.filter(function(e){var t=r(e);
return t[0]!==i});return s.length!==o.length?(this._url.query=n(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var n=o(this._url,"keys+values");try{for(;;){var r=n.next();e.call(t,r[1],r[0],this)}}catch(i){if(i!==j)throw i}},enumerable:!0},keys:{value:function(){return o(this._url,"keys")},enumerable:!0},values:{value:function(){return o(this._url,"values")},enumerable:!0},items:{value:function(){return o(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(n){e(n);var i=[],o=t(this._url.query);return o.forEach(function(e){var t=r(e);t[0]===n&&i.push(t[1])}),i},enumerable:!0},append:{value:function(r,o){e(r),e(o);var s=t(this._url.query);s.push(i([r,o])),this._url.query=n(s)},enumerable:!0}}),Object.defineProperties(v.prototype,{href:{get:function(){return this._url?d(this._url):this._input},set:function(t){e(t),this._input=t,this._url=p(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var n=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===n||w.test(n))&&(this._url.scheme=c(n))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=b.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var n=b.exec(this._userinfo),r=[encodeURIComponent(t||"")];n[2]&&r.push(n[2]),this._userinfo=r.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=b.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var n=b.exec(this._userinfo),r=[n[1]||""];t&&r.push(encodeURIComponent(t)),this._userinfo=r.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var n=T.exec(t);n&&(this._url.host=n[1],this._url.port=u(n[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var n=G.exec(t);n&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===P[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var n=R.exec(t);n&&(this._url.port=u(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var n=O.exec(t);n&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?l(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var n=E.exec(t);n&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var n=C.exec(t);n&&(this._url.fragment=t)}},enumerable:!0}});var L=window.URL||window.webkitURL;L&&L.createObjectURL&&(Object.defineProperty(v,"createObjectURL",{value:L.createObjectURL.bind(L),enumerable:!1}),Object.defineProperty(v,"revokeObjectURL",{value:L.revokeObjectURL.bind(L),enumerable:!1})),window.URL=v}(),define("orion/URL-shim",function(){}),define("orion/git/util",["orion/URL-shim"],function(){function e(e){for(var t=0;t<u.length;t++)if(e.type===u[t])return!0;return!1}function t(e){for(var t=0;t<c.length;t++)if(e.type===c[t])return!0;return!1}function n(n){return e(n)||t(n)}function r(e){for(var t=0;t<u.length;t++)if(e[u[t]].length>0)return!0;return!1}function i(e){for(var t=0;t<c.length;t++)if(e[c[t]].length>0)return!0;return!1}function o(e){try{var t=new URL(e);return{host:t.hostname,port:t.port}}catch(n){try{var r=e.split(":"),i=r[0].split("@"),o=i.length>1?i[1]:i[0];return{host:o,port:22}}catch(s){return{host:"",port:""}}}}function s(e){for(var t=e.split(/\r\n|\n/),n=0;t.length>0&&/^\s*$/.test(t[n]);)n++;var r=100;return t[n].length>r?t[n].substring(0,r)+"...":t[n]}function a(e){for(var t=e.split(/\r\n|\n/),n={},r=0,i=!1,o=t.length-1;o>=0;--o){var s="Change-Id: ",a="Signed-off-by: ";if(0===t[o].indexOf(s)){if(n.changeId=t[o].substring(s.length,t[o].length),++r>1){n={};break}}else i||0!==t[o].indexOf(a)||(n.signedOffBy=t[o].substring(a.length,t[o].length),a=!0)}return n}var c=["Missing","Modified","Untracked","Conflicting"],u=["Added","Changed","Removed"],l="git/git-status.html";return{statusUILocation:l,isStaged:e,isUnstaged:t,isChange:n,hasStagedChanges:r,hasUnstagedChanges:i,parseSshGitUrl:o,trimCommitMessage:s,getGerritFooter:a}}),define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](u)}function t(){var t=l;c&&t.length&&(l=[],e(t))}function n(){c||(c=!0,s&&clearInterval(s),t())}function r(e){return c?e(u):l.push(e),r}var i,o,s,a="undefined"!=typeof window&&window.document,c=!a,u=a?document:null,l=[];if(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{i=null===window.frameElement}catch(h){}o.doScroll&&i&&window.external&&(s=setInterval(function(){try{o.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return r.version="2.0.1",r.load=function(e,t,n,i){i.isBuild?n(null):r(n)},r}),define("git/plugins/gitPlugin",["orion/plugin","orion/xhr","orion/serviceregistry","orion/git/gitClient","orion/ssh/sshTools","orion/i18nUtil","orion/Deferred","orion/git/util","orion/URL-shim","domReady!"],function(e,t,n,r,i,o,s,a){function c(e){var t=e,n={};e.indexOf("://")>0&&(t=e.substring(e.indexOf("://")+3));var r=t.split("/");return n.serverName=r[0],n.serverName.indexOf("@")&&(n.serverName=n.serverName.substring(n.serverName.indexOf("@")+1)),n.repoName=r[r.length-1],n.repoName.indexOf(".git")>0&&(n.repoName=n.repoName.substring(0,n.repoName.lastIndexOf(".git"))),n}function u(e){return e.indexOf("@")>0&&e.indexOf("ssh://")>=0?e.substring(0,e.indexOf("ssh://")+6)+e.substring(e.indexOf("@")+1):e}var l=document.createElement("a");l.href="../mixloginstatic/LoginWindow.html";var h=new n.ServiceRegistry,f=new r.GitService(h),p=new i.SshService(h),d=l.href,v={name:"Orion Git Support",version:"1.0",description:"This plugin provides Git Support to the Orion File Service.",login:d},g=new e(v);g.registerService("orion.page.link.category",null,{id:"git",nameKey:"Git",nls:"git/nls/gitmessages",imageClass:"core-sprite-git-logo",order:20}),g.registerService("orion.page.link",{},{nameKey:"Repositories",id:"orion.git.repositories",nls:"git/nls/gitmessages",category:"git",order:1e3,uriTemplate:"{+OrionHome}/git/git-repository.html#"}),g.registerService("orion.navigate.command",{},{nameKey:"Git Log",id:"eclipse.git.log",tooltipKey:"Go to Git Log",nls:"git/nls/gitmessages",validationProperties:[{source:"Git:CommitLocation",variableName:"GitLogLocation"}],uriTemplate:"{+OrionHome}/git/git-log.html#{,GitLogLocation}?page=1",forceSingleItem:!0}),g.registerService("orion.navigate.command",{},{nameKey:"Git Remote",id:"eclipse.git.remote",tooltipKey:"Go to Git Remote",nls:"git/nls/gitmessages",validationProperties:[{source:"Git:DefaultRemoteBranchLocation",variableName:"GitRemoteLocation"}],uriTemplate:"{+OrionHome}/git/git-log.html#{,GitRemoteLocation}?page=1",forceSingleItem:!0}),g.registerService("orion.navigate.command",null,{id:"eclipse.git.repository",nameKey:"Git Repository",tooltipKey:"Go to the git repository",nls:"git/nls/gitmessages",category:"git",validationProperties:[{source:"Git:CloneLocation",variableName:"GitRepoLocation"}],uriTemplate:"{+OrionHome}/git/git-repository.html#{,GitRepoLocation}"}),g.registerService("orion.core.content",null,{id:"orion.content.gitClone",nls:"git/nls/gitmessages",nameKey:"Clone Git Repository",descriptionKey:"Go to the Orion repositories page to provide a git repository URL. Once the repository is created, it will appear in the Navigator.",uriTemplate:"{+OrionHome}/git/git-repository.html#,cloneGitRepository=URL"}),g.registerService("orion.page.link.related",null,{id:"eclipse.git.repository",category:"git",order:10}),g.registerService("orion.page.link.related",null,{id:"eclipse.git.log",category:"git"}),g.registerService("orion.page.link.related",null,{nameKey:"Active Branch Log",id:"eclipse.orion.git.switchToCurrentLocal",tooltipKey:"Show the log for the active local branch",nls:"git/nls/gitmessages",category:"git",validationProperties:[{source:"Clone:ActiveBranch",variableName:"GitBranchLocation"},{source:"toRef:Type",match:"RemoteTrackingBranch"}],uriTemplate:"{+OrionHome}/git/git-log.html#{,GitBranchLocation}?page=1",forceSingleItem:!0}),g.registerService("orion.page.link.related",null,{nameKey:"Remote Branch Log",id:"eclipse.orion.git.switchToRemote2",tooltipKey:"Show the log for the corresponding remote tracking branch",nls:"git/nls/gitmessages",category:"git",validationProperties:[{source:"toRef:RemoteLocation:0:Children:0:CommitLocation",variableName:"GitRemoteLocation"}],uriTemplate:"{+OrionHome}/git/git-log.html#{,GitRemoteLocation}?page=1",forceSingleItem:!0}),g.registerService("orion.page.link.related",null,{id:"eclipse.git.repository2",category:"git",order:10,nameKey:"Git Repository",tooltipKey:"Go to the git repository",nls:"git/nls/gitmessages",validationProperties:[{source:"CloneLocation",variableName:"GitCloneLocation"},{source:"Type",match:"Commit"}],uriTemplate:"{+OrionHome}/git/git-repository.html#{,GitCloneLocation}"}),g.registerService("orion.page.link.related",null,{id:"eclipse.git.repository3",category:"git",order:10,nameKey:"Git Repository",tooltipKey:"Go to the git repository",nls:"git/nls/gitmessages",validationProperties:[{source:"Location",variableName:"GitCloneLocation"},{source:"Type",match:"Clone"}],uriTemplate:"{+OrionHome}/git/git-repository.html#{,GitCloneLocation}"}),g.registerService("orion.page.link.related",null,{id:"eclipse.git.repository",category:"git"}),g.registerService("orion.page.link.related",null,{id:"orion.git.gotoEclipseGit",nameKey:"Show Repository in eclipse.org",tooltipKey:"Show this repository in eclipse.org",nls:"git/nls/gitmessages",category:"git",validationProperties:[{source:"GitUrl|Clone:GitUrl",match:"git.eclipse.org/gitroot",variableName:"EclipseGitLocation",variableMatchPosition:"after"}],uriTemplate:"http://git.eclipse.org/c{+EclipseGitLocation}"}),g.registerService("orion.page.link.related",null,{id:"orion.git.gotoGithub",nameKey:"Show Repository in GitHub",nls:"git/nls/gitmessages",tooltipKey:"Show this repository in GitHub",category:"git",validationProperties:[{source:"GitUrl|Clone:GitUrl",match:"github.com.*.git",variableName:"GitHubLocation",variableMatchPosition:"only",replacements:[{pattern:":",replacement:"/"},{pattern:".git$",replacement:""}]}],uriTemplate:"https://{+GitHubLocation}"}),g.registerServiceProvider("orion.page.link.related",null,{id:"orion.git.gotoGithubCommit",nameKey:"Show Commit in GitHub",nls:"git/nls/gitmessages",tooltipKey:"Show this commit in GitHub",category:"git",validationProperties:[{source:"GitUrl",match:"github.com.*.git",variableName:"GitHubLocation",variableMatchPosition:"only",replacements:[{pattern:":",replacement:"/"},{pattern:".git$",replacement:""}]},{source:"Type",match:"Commit"},{source:"Name",variableName:"commitName"}],uriTemplate:"https://{+GitHubLocation}/commit/{+commitName}"}),g.registerServiceProvider("orion.page.link.related",null,{id:"orion.git.gotoEclipseGitCommit",nameKey:"Show Commit in eclipse.org",nls:"git/nls/gitmessages",tooltipKey:"Show this commit in eclipse.org",category:"git",validationProperties:[{source:"GitUrl",match:"git.eclipse.org/gitroot",variableName:"EclipseGitLocation",variableMatchPosition:"after"},{source:"Type",match:"Commit"},{source:"Name",variableName:"commitName"}],uriTemplate:"http://git.eclipse.org/c{+EclipseGitLocation}/commit/?id={+commitName}"}),l.href="../../gitapi/diff/";var m=l.href;g.registerService("orion.core.diff",{getDiffContent:function(e){var n=new URL(e,window.location);return n.query.set("parts","diff"),t("GET",n.href,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return e.responseText})},getDiffFileURI:function(e){var n=new URL(e,window.location);return n.query.set("parts","uris"),t("GET",n.href,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return JSON.parse(e.responseText)})}},{pattern:m}),g.registerService("orion.project.handler",{paramsToDependencyDescription:function(e){return{Type:"git",Location:u(e.url)}},_cloneRepository:function(e,t,n,r){var i=this,l=new s,h=a.parseSshGitUrl(e);return p.getKnownHostCredentials(h.host,h.port).then(function(s){f.cloneGitRepository(null,e,null,n,t.sshuser,t.sshpassword,s,t.sshprivateKey,t.sshpassphrase,null,r).then(function(e){f.getGitClone(e.Location).then(function(e){e.Children&&(e=e.Children[0]);var t=c(e.GitUrl);l.resolve(r?{ContentLocation:e.ContentLocation}:{Type:"git",Location:u(e.GitUrl),Name:(t.repoName||e.Name)+" at "+t.serverName})},l.reject,l.progress)}.bind(this),function(r){try{if(r&&void 0!==r.status)try{r=JSON.parse(r.responseText)}catch(s){r={Message:"Problem while performing the action"}}}catch(s){return void l.reject(r)}if(r.JsonData){if(r.JsonData.HostKey){if(confirm(o.formatMessage("Would you like to add ${0} key for host ${1} to continue operation? Key fingerpt is ${2}.",r.JsonData.KeyType,r.JsonData.Host,r.JsonData.HostFingerprint))){var c=a.parseSshGitUrl(r.JsonData.Url),u={host:r.JsonData.Host,keyType:r.JsonData.KeyType,hostKey:r.JsonData.HostKey,port:c.port};p.addKnownHost(u).then(function(){i._cloneRepository(e,t,n).then(l.resolve,l.reject,l.progress)})}else l.reject(r);return}if(r.JsonData.Host)return r.Retry={addParameters:[{id:"sshuser",type:"text",name:"User Name:"},{id:"sshpassword",type:"password",name:"Password:"}],optionalParameters:[{id:"sshprivateKey",type:"textarea",name:"Ssh Private Key:"},{id:"sshpassphrase",type:"password",name:"Ssh Passphrase:"}]},void l.reject(r)}l.reject(r)}.bind(this),l.progress)}),l},initDependency:function(e,t,n){var r=u(e.Location||t.url);return this._cloneRepository(r,t,n.WorkspaceLocation)},initProject:function(e,t){var n=u(e.url);return this._cloneRepository(n,e,t.WorkspaceLocation,!0)},getDependencyDescription:function(e){if(!e.Git)return null;var t=new s;return f.getGitClone(e.Git.CloneLocation).then(function(e){if(e.Children&&(e=e.Children[0]),e.GitUrl){var n=c(e.GitUrl);t.resolve({Type:"git",Location:u(e.GitUrl),Name:(n.repoName||e.Name)+" at "+n.serverName})}},t.reject,t.progress),t},getAdditionalProjectProperties:function(e){if(!e.Git)return null;var t=new s;return f.getGitClone(e.Git.CloneLocation).then(function(n){n.Children&&(n=n.Children[0]),t.resolve([{Name:"Git",Children:[{Name:"Git Url",Value:n.GitUrl},{Name:"Git Status",Value:"Git Status",Href:"{+OrionHome}/git/git-status.html#"+e.Git.StatusLocation}]}])},t.reject,t.progress),t}},{id:"orion.git.projecthandler",type:"git",addParameters:[{id:"url",type:"url",name:"Url:"}],optionalParameters:[{id:"sshuser",type:"text",name:"User Name:"},{id:"sshpassword",type:"password",name:"Password:"},{id:"sshprivateKey",type:"textarea",name:"Ssh Private Key:"},{id:"sshpassphrase",type:"password",name:"Ssh Passphrase:"}],addDependencyName:"Git Repository",addDependencyTooltip:"Associate a git repository with this project.",addProjectName:"Git Repository",addProjectTooltip:"Create a project from a git repository.",actionComment:"Cloning ${url}",validationProperties:[{source:"Git"}]}),g.connect()});